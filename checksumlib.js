(()=>{var Jw=Object.create;var kl=Object.defineProperty;var eM=Object.getOwnPropertyDescriptor;var tM=Object.getOwnPropertyNames;var nM=Object.getPrototypeOf,rM=Object.prototype.hasOwnProperty;var a=(t,e)=>kl(t,"name",{value:e,configurable:!0});var Zo=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var iM=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of tM(e))!rM.call(t,s)&&s!==n&&kl(t,s,{get:()=>e[s],enumerable:!(i=eM(e,s))||i.enumerable});return t};var Rr=(t,e,n)=>(n=t!=null?Jw(nM(t)):{},iM(e||!t||!t.__esModule?kl(n,"default",{value:t,enumerable:!0}):n,t));var Wh=Zo((os,Gl)=>{(function(t,e){typeof os=="object"&&typeof Gl=="object"?Gl.exports=e():typeof define=="function"&&define.amd?define([],e):typeof os=="object"?os.resq=e():(t.window=t.window||{},t.window.resq=e())})(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return a(n,"r"),n.m=t,n.c=e,n.d=function(i,s,l){n.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:l})},n.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,s){if(1&s&&(i=n(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var c in i)n.d(l,c,function(u){return i[u]}.bind(null,c));return l},n.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(s,"a",s),s},n.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},n.p="",n(n.s=16)}([function(t,e,n){"use strict";n.d(e,"a",function(){return k}),n.d(e,"d",function(){return $}),n.d(e,"b",function(){return Z}),n.d(e,"c",function(){return de});var i=n(1),s=n.n(i),l=n(14),c=n.n(l),u=n(2),h=n.n(u),f=n(15),p=n.n(f);function g(G,B){var X=Object.keys(G);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(G);B&&(j=j.filter(function(Q){return Object.getOwnPropertyDescriptor(G,Q).enumerable})),X.push.apply(X,j)}return X}a(g,"l");var y=Array.isArray,S=Object.keys;function w(G){return typeof G=="function"}a(w,"x");function M(G){return G instanceof HTMLElement||G instanceof Text}a(M,"y");function T(G){return h()(G)==="object"&&!y(G)}a(T,"h");function C(G){if(!G||typeof G=="string")return G;var B=function(X){for(var j=1;j<arguments.length;j++){var Q=arguments[j]!=null?arguments[j]:{};j%2?g(Object(Q),!0).forEach(function(ne){c()(X,ne,Q[ne])}):Object.getOwnPropertyDescriptors?Object.defineProperties(X,Object.getOwnPropertyDescriptors(Q)):g(Object(Q)).forEach(function(ne){Object.defineProperty(X,ne,Object.getOwnPropertyDescriptor(Q,ne))})}return X}({},G);return delete B.children,B}a(C,"b");function N(G,B){var X=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return!(!y(G)||!y(B))&&(X?G.length===B.length&&!G.find(function(j){return!B.includes(j)}):G.some(function(j){return B.includes(j)}))}a(N,"v");function A(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=arguments.length>2&&arguments[2]!==void 0&&arguments[2],j=[];if(!S(G).length)return!0;if(B===null||!S(B).length)return!1;if(X)return p()(G,B);var Q=S(G).filter(function(ne){return S(B).includes(ne)});return Q.forEach(function(ne){T(G[ne])&&T(B[ne])&&(j=j.concat(A(G[ne],B[ne]))),(G[ne]===B[ne]||N(G[ne],B[ne]))&&j.push(B)}),j.length>0&&j.filter(function(ne){return ne}).length===Q.length}a(A,"_");function k(G){var B,X={children:[]};if(!G)return X;X.name=w(B=G.type)?B.displayName||B.name:B,X.props=C(G.memoizedProps),X.state=function(Q){if(Q){var ne=Q.baseState;return ne||Q}}(G.memoizedState);var j=G.child;if(j)for(X.children.push(j);j.sibling;)X.children.push(j.sibling),j=j.sibling;return X.children=X.children.map(function(Q){return k(Q)}),w(G.type)&&function(Q){return Q.children.length>1}(X)?(X.node=function(Q){return Q.children.map(function(ne){return ne.node}).filter(function(ne){return!!ne})}(X),X.isFragment=!0):X.node=function(Q){return M(Q.stateNode)?Q.stateNode:Q.child&&M(Q.child.stateNode)?Q.child.stateNode:null}(G),X}a(k,"m");function z(G){for(;G.length;){var B=G.shift();if(B.node)return B.node;B.children&&Array.isArray(B.children)&&G.push.apply(G,s()(B.children))}}a(z,"g");function q(G,B){for(var X=[];G.length;){var j=G.shift().children;j&&Array.isArray(j)&&j.forEach(function(Q){B(Q)&&(!Q.node&&Array.isArray(Q.children)&&(Q.node=z(Q.children.concat([]))),X.push(Q)),G.push(Q)})}return X}a(q,"O");function oe(G,B){var X=function(j){if(j){var Q=j.split("(");return Q.length===1?j:Q.find(function(ne){return ne.includes(")")}).replace(/\)*/g,"")}}(B);return new RegExp("^"+G.split("*").map(function(j){return j.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join(".+")+"$").test(X)}a(oe,"w");function $(G,B){var X=arguments.length>3?arguments[3]:void 0;return G.reduce(function(j,Q){return j.concat(q(j,X&&typeof X=="function"?X:function(ne){return typeof ne.name=="string"?oe(Q,ne.name):ne.name!==null&&h()(ne.name)==="object"&&oe(Q,ne.name.displayName)}))},[B])}a($,"j");function Z(G,B,X){var j=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return w(X)?(console.warn("Functions are not supported as filter matchers"),[]):G.filter(function(Q){return T(X)&&A(X,Q[B],j)||y(X)&&N(X,Q[B],j)||Q[B]===X})}a(Z,"M");function de(G){if(G.hasOwnProperty("_reactRootContainer"))return G._reactRootContainer._internalRoot.current;var B=Object.keys(G).find(function(X){return X.startsWith("__reactInternalInstance")||X.startsWith("__reactFiber")||X.startsWith("__reactContainer")});return B?G[B]:void 0}a(de,"P")},function(t,e,n){var i=n(17),s=n(18),l=n(19),c=n(20);t.exports=function(u){return i(u)||s(u)||l(u)||c()},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?(t.exports=n=a(function(s){return typeof s},"r"),t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=a(function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},"r"),t.exports.default=t.exports,t.exports.__esModule=!0),n(i)}a(n,"r"),t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(i){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},t.exports.default=t.exports,t.exports.__esModule=!0,n(i)}a(n,"r"),t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(i,s){for(var l=0;l<s.length;l++){var c=s[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(i,c.key,c)}}a(n,"r"),t.exports=function(i,s,l){return s&&n(i.prototype,s),l&&n(i,l),i},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(i,s){return t.exports=n=Object.setPrototypeOf||function(l,c){return l.__proto__=c,l},t.exports.default=t.exports,t.exports.__esModule=!0,n(i,s)}a(n,"r"),t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var i=n(6);t.exports=function(s,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(l&&l.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),l&&i(s,l)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var i=n(3),s=n(6),l=n(22),c=n(23);function u(h){var f=typeof Map=="function"?new Map:void 0;return t.exports=u=a(function(p){if(p===null||!l(p))return p;if(typeof p!="function")throw new TypeError("Super expression must either be null or a function");if(f!==void 0){if(f.has(p))return f.get(p);f.set(p,g)}function g(){return c(p,arguments,i(this).constructor)}return a(g,"e"),g.prototype=Object.create(p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),s(g,p)},"c"),t.exports.default=t.exports,t.exports.__esModule=!0,u(h)}a(u,"c"),t.exports=u,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}t.exports=n},function(t,e){t.exports=function(n,i){(i==null||i>n.length)&&(i=n.length);for(var s=0,l=new Array(i);s<i;s++)l[s]=n[s];return l},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";(function(i){n.d(e,"a",function(){return l});var s=n(0);function l(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5e3,u=arguments.length>1?arguments[1]:void 0;if(i.isReactLoaded)return Promise.resolve("React already loaded");var h=a(function(){var f=document.createTreeWalker(document);if(u)return document.querySelector(u);for(;f.nextNode();)if(f.currentNode.hasOwnProperty("_reactRootContainer"))return f.currentNode},"o");return new Promise(function(f,p){var g=!1,y=null;a(function S(){var w=h();if(w&&(i.isReactLoaded=!0,i.rootReactElement=Object(s.c)(w),i.rootReactElement))return clearTimeout(y),f();g||setTimeout(S,200)},"e")(),y=setTimeout(function(){g=!0,p("Timed out")},c)})}a(l,"o")}).call(this,n(9))},function(t,e,n){"use strict";n.d(e,"a",function(){return z});var i=n(1),s=n.n(i),l=n(4),c=n.n(l),u=n(5),h=n.n(u),f=n(7),p=n.n(f),g=n(13),y=n.n(g),S=n(3),w=n.n(S),M=n(8),T=n.n(M),C=n(0);function N(q){var oe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var $,Z=w()(q);if(oe){var de=w()(this).constructor;$=Reflect.construct(Z,arguments,de)}else $=Z.apply(this,arguments);return y()(this,$)}}a(N,"v");var A=function(q){p()($,q);var oe=N($);function $(Z){return c()(this,$),Z||(Z=[]),oe.call.apply(oe,[this].concat(s()(Z)))}return a($,"r"),h()($,[{key:"byProps",value:a(function(Z){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},G=de.exact,B=Object(C.b)(this,"props",Z,G);return new $(B)},"value")},{key:"byState",value:a(function(Z){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},G=de.exact,B=Object(C.b)(this,"state",Z,G);return new $(B)},"value")}]),$}(T()(Array)),k=function(q){p()($,q);var oe=N($);function $(Z,de){var G;for(var B in c()(this,$),(G=oe.call(this,Z))._nodes=de,Z)G[B]=Z[B];return G}return a($,"r"),h()($,[{key:"byProps",value:a(function(Z){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},G=de.exact,B=Object(C.b)(this._nodes,"props",Z,G)[0];return new $(B,this._nodes)},"value")},{key:"byState",value:a(function(Z){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},G=de.exact,B=Object(C.b)(this._nodes,"state",Z,G)[0];return new $(B,this._nodes)},"value")}]),$}(T()(Object)),z=function(){function q(oe,$){c()(this,q),this.selectors=oe.split(" ").filter(function(Z){return!!Z}).map(function(Z){return Z.trim()}),this.rootComponent=$,this.tree=Object(C.a)(this.rootComponent)}return a(q,"t"),h()(q,[{key:"find",value:a(function(){return this.nodes=new A(Object(C.d)(this.selectors,this.tree,!0)),new k(this.nodes[0],this.nodes)},"value")},{key:"findAll",value:a(function(){return new A(Object(C.d)(this.selectors,this.tree))},"value")}]),q}()},function(t,e,n){var i=n(2).default,s=n(21);t.exports=function(l,c){return!c||i(c)!=="object"&&typeof c!="function"?s(l):c},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(n,i,s){return i in n?Object.defineProperty(n,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[i]=s,n},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";var i=Array.isArray,s=Object.keys,l=Object.prototype.hasOwnProperty;t.exports=a(function c(u,h){if(u===h)return!0;if(u&&h&&typeof u=="object"&&typeof h=="object"){var f,p,g,y=i(u),S=i(h);if(y&&S){if((p=u.length)!=h.length)return!1;for(f=p;f--!=0;)if(!c(u[f],h[f]))return!1;return!0}if(y!=S)return!1;var w=u instanceof Date,M=h instanceof Date;if(w!=M)return!1;if(w&&M)return u.getTime()==h.getTime();var T=u instanceof RegExp,C=h instanceof RegExp;if(T!=C)return!1;if(T&&C)return u.toString()==h.toString();var N=s(u);if((p=N.length)!==s(h).length)return!1;for(f=p;f--!=0;)if(!l.call(h,N[f]))return!1;for(f=p;f--!=0;)if(!c(u[g=N[f]],h[g]))return!1;return!0}return u!=u&&h!=h},"t")},function(t,e,n){"use strict";n.r(e),function(i){n.d(e,"resq$",function(){return h}),n.d(e,"resq$$",function(){return f});var s=n(12),l=n(11);n.d(e,"waitToLoadReact",function(){return l.a});var c=n(0);function u(p,g,y){if(!y&&!i.isReactLoaded)throw new Error("Could not find the root element of your application");var S=i.rootReactElement;if(y instanceof HTMLElement&&(S=Object(c.c)(y)),!S)throw new Error("Could not find instance of React in given element");return new s.a(p,S)[g]()}a(u,"i");function h(p,g){return u(p,"find",g)}a(h,"c");function f(p,g){return u(p,"findAll",g)}a(f,"f")}.call(this,n(9))},function(t,e,n){var i=n(10);t.exports=function(s){if(Array.isArray(s))return i(s)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var i=n(10);t.exports=function(s,l){if(s){if(typeof s=="string")return i(s,l);var c=Object.prototype.toString.call(s).slice(8,-1);return c==="Object"&&s.constructor&&(c=s.constructor.name),c==="Map"||c==="Set"?Array.from(s):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i(s,l):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(n){return Function.toString.call(n).indexOf("[native code]")!==-1},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var i=n(6),s=n(24);function l(c,u,h){return s()?(t.exports=l=Reflect.construct,t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=l=a(function(f,p,g){var y=[null];y.push.apply(y,p);var S=new(Function.bind.apply(f,y));return g&&i(S,g.prototype),S},"u"),t.exports.default=t.exports,t.exports.__esModule=!0),l.apply(null,arguments)}a(l,"u"),t.exports=l,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}},t.exports.default=t.exports,t.exports.__esModule=!0}])})});var _i=Zo((nA,Bh)=>{Bh.exports=t=>new Promise(e=>setTimeout(e,t))});var bm=Zo((Qr,ji)=>{(function(){var t,e="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",f=1,p=2,g=4,y=1,S=2,w=1,M=2,T=4,C=8,N=16,A=32,k=64,z=128,q=256,oe=512,$=30,Z="...",de=800,G=16,B=1,X=2,j=3,Q=1/0,ne=9007199254740991,Ne=17976931348623157e292,Ue=NaN,$e=4294967295,Ht=$e-1,ge=$e>>>1,Y=[["ary",z],["bind",w],["bindKey",M],["curry",C],["curryRight",N],["flip",oe],["partial",A],["partialRight",k],["rearg",q]],W="[object Arguments]",te="[object Array]",Te="[object AsyncFunction]",Re="[object Boolean]",ze="[object Date]",et="[object DOMException]",Yt="[object Error]",an="[object Function]",xe="[object GeneratorFunction]",qe="[object Map]",De="[object Number]",We="[object Null]",Je="[object Object]",Ie="[object Promise]",ai="[object Proxy]",li="[object RegExp]",Wt="[object Set]",ci="[object String]",ao="[object Symbol]",Ep="[object Undefined]",ui="[object WeakMap]",vp="[object WeakSet]",di="[object ArrayBuffer]",pr="[object DataView]",ma="[object Float32Array]",pa="[object Float64Array]",ga="[object Int8Array]",ya="[object Int16Array]",Ea="[object Int32Array]",va="[object Uint8Array]",Sa="[object Uint8ClampedArray]",ba="[object Uint16Array]",wa="[object Uint32Array]",Sp=/\b__p \+= '';/g,bp=/\b(__p \+=) '' \+/g,wp=/(__e\(.*?\)|\b__t\)) \+\n'';/g,jc=/&(?:amp|lt|gt|quot|#39);/g,Zc=/[&<>"']/g,Mp=RegExp(jc.source),Tp=RegExp(Zc.source),xp=/<%-([\s\S]+?)%>/g,Cp=/<%([\s\S]+?)%>/g,Qc=/<%=([\s\S]+?)%>/g,Ip=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ap=/^\w*$/,Rp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ma=/[\\^$.*+?()[\]{}|]/g,Lp=RegExp(Ma.source),Ta=/^\s+/,Np=/\s/,Dp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,_p=/\{\n\/\* \[wrapped with (.+)\] \*/,Op=/,? & /,kp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fp=/[()=,{}\[\]\/\s]/,Pp=/\\(\\)?/g,Hp=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Jc=/\w*$/,Wp=/^[-+]0x[0-9a-f]+$/i,Vp=/^0b[01]+$/i,Bp=/^\[object .+?Constructor\]$/,Gp=/^0o[0-7]+$/i,Up=/^(?:0|[1-9]\d*)$/,$p=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lo=/($^)/,zp=/['\n\r\u2028\u2029\\]/g,co="\\ud800-\\udfff",qp="\\u0300-\\u036f",Yp="\\ufe20-\\ufe2f",Kp="\\u20d0-\\u20ff",eu=qp+Yp+Kp,tu="\\u2700-\\u27bf",nu="a-z\\xdf-\\xf6\\xf8-\\xff",Xp="\\xac\\xb1\\xd7\\xf7",jp="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zp="\\u2000-\\u206f",Qp=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ru="A-Z\\xc0-\\xd6\\xd8-\\xde",iu="\\ufe0e\\ufe0f",ou=Xp+jp+Zp+Qp,xa="['\u2019]",Jp="["+co+"]",su="["+ou+"]",uo="["+eu+"]",au="\\d+",eg="["+tu+"]",lu="["+nu+"]",cu="[^"+co+ou+au+tu+nu+ru+"]",Ca="\\ud83c[\\udffb-\\udfff]",tg="(?:"+uo+"|"+Ca+")",uu="[^"+co+"]",Ia="(?:\\ud83c[\\udde6-\\uddff]){2}",Aa="[\\ud800-\\udbff][\\udc00-\\udfff]",gr="["+ru+"]",du="\\u200d",hu="(?:"+lu+"|"+cu+")",ng="(?:"+gr+"|"+cu+")",fu="(?:"+xa+"(?:d|ll|m|re|s|t|ve))?",mu="(?:"+xa+"(?:D|LL|M|RE|S|T|VE))?",pu=tg+"?",gu="["+iu+"]?",rg="(?:"+du+"(?:"+[uu,Ia,Aa].join("|")+")"+gu+pu+")*",ig="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",og="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yu=gu+pu+rg,sg="(?:"+[eg,Ia,Aa].join("|")+")"+yu,ag="(?:"+[uu+uo+"?",uo,Ia,Aa,Jp].join("|")+")",lg=RegExp(xa,"g"),cg=RegExp(uo,"g"),Ra=RegExp(Ca+"(?="+Ca+")|"+ag+yu,"g"),ug=RegExp([gr+"?"+lu+"+"+fu+"(?="+[su,gr,"$"].join("|")+")",ng+"+"+mu+"(?="+[su,gr+hu,"$"].join("|")+")",gr+"?"+hu+"+"+fu,gr+"+"+mu,og,ig,au,sg].join("|"),"g"),dg=RegExp("["+du+co+eu+iu+"]"),hg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],mg=-1,Pe={};Pe[ma]=Pe[pa]=Pe[ga]=Pe[ya]=Pe[Ea]=Pe[va]=Pe[Sa]=Pe[ba]=Pe[wa]=!0,Pe[W]=Pe[te]=Pe[di]=Pe[Re]=Pe[pr]=Pe[ze]=Pe[Yt]=Pe[an]=Pe[qe]=Pe[De]=Pe[Je]=Pe[li]=Pe[Wt]=Pe[ci]=Pe[ui]=!1;var Oe={};Oe[W]=Oe[te]=Oe[di]=Oe[pr]=Oe[Re]=Oe[ze]=Oe[ma]=Oe[pa]=Oe[ga]=Oe[ya]=Oe[Ea]=Oe[qe]=Oe[De]=Oe[Je]=Oe[li]=Oe[Wt]=Oe[ci]=Oe[ao]=Oe[va]=Oe[Sa]=Oe[ba]=Oe[wa]=!0,Oe[Yt]=Oe[an]=Oe[ui]=!1;var pg={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},gg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Eg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vg=parseFloat,Sg=parseInt,Eu=typeof global=="object"&&global&&global.Object===Object&&global,bg=typeof self=="object"&&self&&self.Object===Object&&self,rt=Eu||bg||Function("return this")(),La=typeof Qr=="object"&&Qr&&!Qr.nodeType&&Qr,Xn=La&&typeof ji=="object"&&ji&&!ji.nodeType&&ji,vu=Xn&&Xn.exports===La,Na=vu&&Eu.process,Lt=function(){try{var R=Xn&&Xn.require&&Xn.require("util").types;return R||Na&&Na.binding&&Na.binding("util")}catch{}}(),Su=Lt&&Lt.isArrayBuffer,bu=Lt&&Lt.isDate,wu=Lt&&Lt.isMap,Mu=Lt&&Lt.isRegExp,Tu=Lt&&Lt.isSet,xu=Lt&&Lt.isTypedArray;function Mt(R,_,D){switch(D.length){case 0:return R.call(_);case 1:return R.call(_,D[0]);case 2:return R.call(_,D[0],D[1]);case 3:return R.call(_,D[0],D[1],D[2])}return R.apply(_,D)}a(Mt,"apply");function wg(R,_,D,J){for(var ue=-1,Ce=R==null?0:R.length;++ue<Ce;){var tt=R[ue];_(J,tt,D(tt),R)}return J}a(wg,"arrayAggregator");function Nt(R,_){for(var D=-1,J=R==null?0:R.length;++D<J&&_(R[D],D,R)!==!1;);return R}a(Nt,"arrayEach");function Mg(R,_){for(var D=R==null?0:R.length;D--&&_(R[D],D,R)!==!1;);return R}a(Mg,"arrayEachRight");function Cu(R,_){for(var D=-1,J=R==null?0:R.length;++D<J;)if(!_(R[D],D,R))return!1;return!0}a(Cu,"arrayEvery");function Tn(R,_){for(var D=-1,J=R==null?0:R.length,ue=0,Ce=[];++D<J;){var tt=R[D];_(tt,D,R)&&(Ce[ue++]=tt)}return Ce}a(Tn,"arrayFilter");function ho(R,_){var D=R==null?0:R.length;return!!D&&yr(R,_,0)>-1}a(ho,"arrayIncludes");function Da(R,_,D){for(var J=-1,ue=R==null?0:R.length;++J<ue;)if(D(_,R[J]))return!0;return!1}a(Da,"arrayIncludesWith");function Ve(R,_){for(var D=-1,J=R==null?0:R.length,ue=Array(J);++D<J;)ue[D]=_(R[D],D,R);return ue}a(Ve,"arrayMap");function xn(R,_){for(var D=-1,J=_.length,ue=R.length;++D<J;)R[ue+D]=_[D];return R}a(xn,"arrayPush");function _a(R,_,D,J){var ue=-1,Ce=R==null?0:R.length;for(J&&Ce&&(D=R[++ue]);++ue<Ce;)D=_(D,R[ue],ue,R);return D}a(_a,"arrayReduce");function Tg(R,_,D,J){var ue=R==null?0:R.length;for(J&&ue&&(D=R[--ue]);ue--;)D=_(D,R[ue],ue,R);return D}a(Tg,"arrayReduceRight");function Oa(R,_){for(var D=-1,J=R==null?0:R.length;++D<J;)if(_(R[D],D,R))return!0;return!1}a(Oa,"arraySome");var xg=ka("length");function Cg(R){return R.split("")}a(Cg,"asciiToArray");function Ig(R){return R.match(kp)||[]}a(Ig,"asciiWords");function Iu(R,_,D){var J;return D(R,function(ue,Ce,tt){if(_(ue,Ce,tt))return J=Ce,!1}),J}a(Iu,"baseFindKey");function fo(R,_,D,J){for(var ue=R.length,Ce=D+(J?1:-1);J?Ce--:++Ce<ue;)if(_(R[Ce],Ce,R))return Ce;return-1}a(fo,"baseFindIndex");function yr(R,_,D){return _===_?Wg(R,_,D):fo(R,Au,D)}a(yr,"baseIndexOf");function Ag(R,_,D,J){for(var ue=D-1,Ce=R.length;++ue<Ce;)if(J(R[ue],_))return ue;return-1}a(Ag,"baseIndexOfWith");function Au(R){return R!==R}a(Au,"baseIsNaN");function Ru(R,_){var D=R==null?0:R.length;return D?Pa(R,_)/D:Ue}a(Ru,"baseMean");function ka(R){return function(_){return _==null?t:_[R]}}a(ka,"baseProperty");function Fa(R){return function(_){return R==null?t:R[_]}}a(Fa,"basePropertyOf");function Lu(R,_,D,J,ue){return ue(R,function(Ce,tt,_e){D=J?(J=!1,Ce):_(D,Ce,tt,_e)}),D}a(Lu,"baseReduce");function Rg(R,_){var D=R.length;for(R.sort(_);D--;)R[D]=R[D].value;return R}a(Rg,"baseSortBy");function Pa(R,_){for(var D,J=-1,ue=R.length;++J<ue;){var Ce=_(R[J]);Ce!==t&&(D=D===t?Ce:D+Ce)}return D}a(Pa,"baseSum");function Ha(R,_){for(var D=-1,J=Array(R);++D<R;)J[D]=_(D);return J}a(Ha,"baseTimes");function Lg(R,_){return Ve(_,function(D){return[D,R[D]]})}a(Lg,"baseToPairs");function Nu(R){return R&&R.slice(0,ku(R)+1).replace(Ta,"")}a(Nu,"baseTrim");function Tt(R){return function(_){return R(_)}}a(Tt,"baseUnary");function Wa(R,_){return Ve(_,function(D){return R[D]})}a(Wa,"baseValues");function hi(R,_){return R.has(_)}a(hi,"cacheHas");function Du(R,_){for(var D=-1,J=R.length;++D<J&&yr(_,R[D],0)>-1;);return D}a(Du,"charsStartIndex");function _u(R,_){for(var D=R.length;D--&&yr(_,R[D],0)>-1;);return D}a(_u,"charsEndIndex");function Ng(R,_){for(var D=R.length,J=0;D--;)R[D]===_&&++J;return J}a(Ng,"countHolders");var Dg=Fa(pg),_g=Fa(gg);function Og(R){return"\\"+Eg[R]}a(Og,"escapeStringChar");function kg(R,_){return R==null?t:R[_]}a(kg,"getValue");function Er(R){return dg.test(R)}a(Er,"hasUnicode");function Fg(R){return hg.test(R)}a(Fg,"hasUnicodeWord");function Pg(R){for(var _,D=[];!(_=R.next()).done;)D.push(_.value);return D}a(Pg,"iteratorToArray");function Va(R){var _=-1,D=Array(R.size);return R.forEach(function(J,ue){D[++_]=[ue,J]}),D}a(Va,"mapToArray");function Ou(R,_){return function(D){return R(_(D))}}a(Ou,"overArg");function Cn(R,_){for(var D=-1,J=R.length,ue=0,Ce=[];++D<J;){var tt=R[D];(tt===_||tt===h)&&(R[D]=h,Ce[ue++]=D)}return Ce}a(Cn,"replaceHolders");function mo(R){var _=-1,D=Array(R.size);return R.forEach(function(J){D[++_]=J}),D}a(mo,"setToArray");function Hg(R){var _=-1,D=Array(R.size);return R.forEach(function(J){D[++_]=[J,J]}),D}a(Hg,"setToPairs");function Wg(R,_,D){for(var J=D-1,ue=R.length;++J<ue;)if(R[J]===_)return J;return-1}a(Wg,"strictIndexOf");function Vg(R,_,D){for(var J=D+1;J--;)if(R[J]===_)return J;return J}a(Vg,"strictLastIndexOf");function vr(R){return Er(R)?Gg(R):xg(R)}a(vr,"stringSize");function Vt(R){return Er(R)?Ug(R):Cg(R)}a(Vt,"stringToArray");function ku(R){for(var _=R.length;_--&&Np.test(R.charAt(_)););return _}a(ku,"trimmedEndIndex");var Bg=Fa(yg);function Gg(R){for(var _=Ra.lastIndex=0;Ra.test(R);)++_;return _}a(Gg,"unicodeSize");function Ug(R){return R.match(Ra)||[]}a(Ug,"unicodeToArray");function $g(R){return R.match(ug)||[]}a($g,"unicodeWords");var zg=a(function R(_){_=_==null?rt:In.defaults(rt.Object(),_,In.pick(rt,fg));var D=_.Array,J=_.Date,ue=_.Error,Ce=_.Function,tt=_.Math,_e=_.Object,Ba=_.RegExp,qg=_.String,Dt=_.TypeError,po=D.prototype,Yg=Ce.prototype,Sr=_e.prototype,go=_["__core-js_shared__"],yo=Yg.toString,Le=Sr.hasOwnProperty,Kg=0,Fu=function(){var r=/[^.]+$/.exec(go&&go.keys&&go.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Eo=Sr.toString,Xg=yo.call(_e),jg=rt._,Zg=Ba("^"+yo.call(Le).replace(Ma,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vo=vu?_.Buffer:t,An=_.Symbol,So=_.Uint8Array,Pu=vo?vo.allocUnsafe:t,bo=Ou(_e.getPrototypeOf,_e),Hu=_e.create,Wu=Sr.propertyIsEnumerable,wo=po.splice,Vu=An?An.isConcatSpreadable:t,fi=An?An.iterator:t,jn=An?An.toStringTag:t,Mo=function(){try{var r=tr(_e,"defineProperty");return r({},"",{}),r}catch{}}(),Qg=_.clearTimeout!==rt.clearTimeout&&_.clearTimeout,Jg=J&&J.now!==rt.Date.now&&J.now,ey=_.setTimeout!==rt.setTimeout&&_.setTimeout,To=tt.ceil,xo=tt.floor,Ga=_e.getOwnPropertySymbols,ty=vo?vo.isBuffer:t,Bu=_.isFinite,ny=po.join,ry=Ou(_e.keys,_e),nt=tt.max,lt=tt.min,iy=J.now,oy=_.parseInt,Gu=tt.random,sy=po.reverse,Ua=tr(_,"DataView"),mi=tr(_,"Map"),$a=tr(_,"Promise"),br=tr(_,"Set"),pi=tr(_,"WeakMap"),gi=tr(_e,"create"),Co=pi&&new pi,wr={},ay=nr(Ua),ly=nr(mi),cy=nr($a),uy=nr(br),dy=nr(pi),Io=An?An.prototype:t,yi=Io?Io.valueOf:t,Uu=Io?Io.toString:t;function v(r){if(Xe(r)&&!he(r)&&!(r instanceof ve)){if(r instanceof _t)return r;if(Le.call(r,"__wrapped__"))return $d(r)}return new _t(r)}a(v,"lodash");var Mr=function(){function r(){}return a(r,"object"),function(o){if(!Ye(o))return{};if(Hu)return Hu(o);r.prototype=o;var d=new r;return r.prototype=t,d}}();function Ao(){}a(Ao,"baseLodash");function _t(r,o){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}a(_t,"LodashWrapper"),v.templateSettings={escape:xp,evaluate:Cp,interpolate:Qc,variable:"",imports:{_:v}},v.prototype=Ao.prototype,v.prototype.constructor=v,_t.prototype=Mr(Ao.prototype),_t.prototype.constructor=_t;function ve(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=$e,this.__views__=[]}a(ve,"LazyWrapper");function hy(){var r=new ve(this.__wrapped__);return r.__actions__=Et(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Et(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Et(this.__views__),r}a(hy,"lazyClone");function fy(){if(this.__filtered__){var r=new ve(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}a(fy,"lazyReverse");function my(){var r=this.__wrapped__.value(),o=this.__dir__,d=he(r),m=o<0,E=d?r.length:0,b=CE(0,E,this.__views__),x=b.start,I=b.end,L=I-x,F=m?I:x-1,P=this.__iteratees__,V=P.length,K=0,re=lt(L,this.__takeCount__);if(!d||!m&&E==L&&re==L)return fd(r,this.__actions__);var ae=[];e:for(;L--&&K<re;){F+=o;for(var me=-1,le=r[F];++me<V;){var Ee=P[me],be=Ee.iteratee,It=Ee.type,ft=be(le);if(It==X)le=ft;else if(!ft){if(It==B)continue e;break e}}ae[K++]=le}return ae}a(my,"lazyValue"),ve.prototype=Mr(Ao.prototype),ve.prototype.constructor=ve;function Zn(r){var o=-1,d=r==null?0:r.length;for(this.clear();++o<d;){var m=r[o];this.set(m[0],m[1])}}a(Zn,"Hash");function py(){this.__data__=gi?gi(null):{},this.size=0}a(py,"hashClear");function gy(r){var o=this.has(r)&&delete this.__data__[r];return this.size-=o?1:0,o}a(gy,"hashDelete");function yy(r){var o=this.__data__;if(gi){var d=o[r];return d===c?t:d}return Le.call(o,r)?o[r]:t}a(yy,"hashGet");function Ey(r){var o=this.__data__;return gi?o[r]!==t:Le.call(o,r)}a(Ey,"hashHas");function vy(r,o){var d=this.__data__;return this.size+=this.has(r)?0:1,d[r]=gi&&o===t?c:o,this}a(vy,"hashSet"),Zn.prototype.clear=py,Zn.prototype.delete=gy,Zn.prototype.get=yy,Zn.prototype.has=Ey,Zn.prototype.set=vy;function ln(r){var o=-1,d=r==null?0:r.length;for(this.clear();++o<d;){var m=r[o];this.set(m[0],m[1])}}a(ln,"ListCache");function Sy(){this.__data__=[],this.size=0}a(Sy,"listCacheClear");function by(r){var o=this.__data__,d=Ro(o,r);if(d<0)return!1;var m=o.length-1;return d==m?o.pop():wo.call(o,d,1),--this.size,!0}a(by,"listCacheDelete");function wy(r){var o=this.__data__,d=Ro(o,r);return d<0?t:o[d][1]}a(wy,"listCacheGet");function My(r){return Ro(this.__data__,r)>-1}a(My,"listCacheHas");function Ty(r,o){var d=this.__data__,m=Ro(d,r);return m<0?(++this.size,d.push([r,o])):d[m][1]=o,this}a(Ty,"listCacheSet"),ln.prototype.clear=Sy,ln.prototype.delete=by,ln.prototype.get=wy,ln.prototype.has=My,ln.prototype.set=Ty;function cn(r){var o=-1,d=r==null?0:r.length;for(this.clear();++o<d;){var m=r[o];this.set(m[0],m[1])}}a(cn,"MapCache");function xy(){this.size=0,this.__data__={hash:new Zn,map:new(mi||ln),string:new Zn}}a(xy,"mapCacheClear");function Cy(r){var o=Bo(this,r).delete(r);return this.size-=o?1:0,o}a(Cy,"mapCacheDelete");function Iy(r){return Bo(this,r).get(r)}a(Iy,"mapCacheGet");function Ay(r){return Bo(this,r).has(r)}a(Ay,"mapCacheHas");function Ry(r,o){var d=Bo(this,r),m=d.size;return d.set(r,o),this.size+=d.size==m?0:1,this}a(Ry,"mapCacheSet"),cn.prototype.clear=xy,cn.prototype.delete=Cy,cn.prototype.get=Iy,cn.prototype.has=Ay,cn.prototype.set=Ry;function Qn(r){var o=-1,d=r==null?0:r.length;for(this.__data__=new cn;++o<d;)this.add(r[o])}a(Qn,"SetCache");function Ly(r){return this.__data__.set(r,c),this}a(Ly,"setCacheAdd");function Ny(r){return this.__data__.has(r)}a(Ny,"setCacheHas"),Qn.prototype.add=Qn.prototype.push=Ly,Qn.prototype.has=Ny;function Bt(r){var o=this.__data__=new ln(r);this.size=o.size}a(Bt,"Stack");function Dy(){this.__data__=new ln,this.size=0}a(Dy,"stackClear");function _y(r){var o=this.__data__,d=o.delete(r);return this.size=o.size,d}a(_y,"stackDelete");function Oy(r){return this.__data__.get(r)}a(Oy,"stackGet");function ky(r){return this.__data__.has(r)}a(ky,"stackHas");function Fy(r,o){var d=this.__data__;if(d instanceof ln){var m=d.__data__;if(!mi||m.length<n-1)return m.push([r,o]),this.size=++d.size,this;d=this.__data__=new cn(m)}return d.set(r,o),this.size=d.size,this}a(Fy,"stackSet"),Bt.prototype.clear=Dy,Bt.prototype.delete=_y,Bt.prototype.get=Oy,Bt.prototype.has=ky,Bt.prototype.set=Fy;function $u(r,o){var d=he(r),m=!d&&rr(r),E=!d&&!m&&_n(r),b=!d&&!m&&!E&&Ir(r),x=d||m||E||b,I=x?Ha(r.length,qg):[],L=I.length;for(var F in r)(o||Le.call(r,F))&&!(x&&(F=="length"||E&&(F=="offset"||F=="parent")||b&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||fn(F,L)))&&I.push(F);return I}a($u,"arrayLikeKeys");function zu(r){var o=r.length;return o?r[tl(0,o-1)]:t}a(zu,"arraySample");function Py(r,o){return Go(Et(r),Jn(o,0,r.length))}a(Py,"arraySampleSize");function Hy(r){return Go(Et(r))}a(Hy,"arrayShuffle");function za(r,o,d){(d!==t&&!Gt(r[o],d)||d===t&&!(o in r))&&un(r,o,d)}a(za,"assignMergeValue");function Ei(r,o,d){var m=r[o];(!(Le.call(r,o)&&Gt(m,d))||d===t&&!(o in r))&&un(r,o,d)}a(Ei,"assignValue");function Ro(r,o){for(var d=r.length;d--;)if(Gt(r[d][0],o))return d;return-1}a(Ro,"assocIndexOf");function Wy(r,o,d,m){return Rn(r,function(E,b,x){o(m,E,d(E),x)}),m}a(Wy,"baseAggregator");function qu(r,o){return r&&Xt(o,it(o),r)}a(qu,"baseAssign");function Vy(r,o){return r&&Xt(o,St(o),r)}a(Vy,"baseAssignIn");function un(r,o,d){o=="__proto__"&&Mo?Mo(r,o,{configurable:!0,enumerable:!0,value:d,writable:!0}):r[o]=d}a(un,"baseAssignValue");function qa(r,o){for(var d=-1,m=o.length,E=D(m),b=r==null;++d<m;)E[d]=b?t:Cl(r,o[d]);return E}a(qa,"baseAt");function Jn(r,o,d){return r===r&&(d!==t&&(r=r<=d?r:d),o!==t&&(r=r>=o?r:o)),r}a(Jn,"baseClamp");function Ot(r,o,d,m,E,b){var x,I=o&f,L=o&p,F=o&g;if(d&&(x=E?d(r,m,E,b):d(r)),x!==t)return x;if(!Ye(r))return r;var P=he(r);if(P){if(x=AE(r),!I)return Et(r,x)}else{var V=ct(r),K=V==an||V==xe;if(_n(r))return gd(r,I);if(V==Je||V==W||K&&!E){if(x=L||K?{}:kd(r),!I)return L?yE(r,Vy(x,r)):gE(r,qu(x,r))}else{if(!Oe[V])return E?r:{};x=RE(r,V,I)}}b||(b=new Bt);var re=b.get(r);if(re)return re;b.set(r,x),uh(r)?r.forEach(function(le){x.add(Ot(le,o,d,le,r,b))}):lh(r)&&r.forEach(function(le,Ee){x.set(Ee,Ot(le,o,d,Ee,r,b))});var ae=F?L?hl:dl:L?St:it,me=P?t:ae(r);return Nt(me||r,function(le,Ee){me&&(Ee=le,le=r[Ee]),Ei(x,Ee,Ot(le,o,d,Ee,r,b))}),x}a(Ot,"baseClone");function By(r){var o=it(r);return function(d){return Yu(d,r,o)}}a(By,"baseConforms");function Yu(r,o,d){var m=d.length;if(r==null)return!m;for(r=_e(r);m--;){var E=d[m],b=o[E],x=r[E];if(x===t&&!(E in r)||!b(x))return!1}return!0}a(Yu,"baseConformsTo");function Ku(r,o,d){if(typeof r!="function")throw new Dt(s);return xi(function(){r.apply(t,d)},o)}a(Ku,"baseDelay");function vi(r,o,d,m){var E=-1,b=ho,x=!0,I=r.length,L=[],F=o.length;if(!I)return L;d&&(o=Ve(o,Tt(d))),m?(b=Da,x=!1):o.length>=n&&(b=hi,x=!1,o=new Qn(o));e:for(;++E<I;){var P=r[E],V=d==null?P:d(P);if(P=m||P!==0?P:0,x&&V===V){for(var K=F;K--;)if(o[K]===V)continue e;L.push(P)}else b(o,V,m)||L.push(P)}return L}a(vi,"baseDifference");var Rn=bd(Kt),Xu=bd(Ka,!0);function Gy(r,o){var d=!0;return Rn(r,function(m,E,b){return d=!!o(m,E,b),d}),d}a(Gy,"baseEvery");function Lo(r,o,d){for(var m=-1,E=r.length;++m<E;){var b=r[m],x=o(b);if(x!=null&&(I===t?x===x&&!Ct(x):d(x,I)))var I=x,L=b}return L}a(Lo,"baseExtremum");function Uy(r,o,d,m){var E=r.length;for(d=fe(d),d<0&&(d=-d>E?0:E+d),m=m===t||m>E?E:fe(m),m<0&&(m+=E),m=d>m?0:hh(m);d<m;)r[d++]=o;return r}a(Uy,"baseFill");function ju(r,o){var d=[];return Rn(r,function(m,E,b){o(m,E,b)&&d.push(m)}),d}a(ju,"baseFilter");function ot(r,o,d,m,E){var b=-1,x=r.length;for(d||(d=NE),E||(E=[]);++b<x;){var I=r[b];o>0&&d(I)?o>1?ot(I,o-1,d,m,E):xn(E,I):m||(E[E.length]=I)}return E}a(ot,"baseFlatten");var Ya=wd(),Zu=wd(!0);function Kt(r,o){return r&&Ya(r,o,it)}a(Kt,"baseForOwn");function Ka(r,o){return r&&Zu(r,o,it)}a(Ka,"baseForOwnRight");function No(r,o){return Tn(o,function(d){return mn(r[d])})}a(No,"baseFunctions");function er(r,o){o=Nn(o,r);for(var d=0,m=o.length;r!=null&&d<m;)r=r[jt(o[d++])];return d&&d==m?r:t}a(er,"baseGet");function Qu(r,o,d){var m=o(r);return he(r)?m:xn(m,d(r))}a(Qu,"baseGetAllKeys");function dt(r){return r==null?r===t?Ep:We:jn&&jn in _e(r)?xE(r):HE(r)}a(dt,"baseGetTag");function Xa(r,o){return r>o}a(Xa,"baseGt");function $y(r,o){return r!=null&&Le.call(r,o)}a($y,"baseHas");function zy(r,o){return r!=null&&o in _e(r)}a(zy,"baseHasIn");function qy(r,o,d){return r>=lt(o,d)&&r<nt(o,d)}a(qy,"baseInRange");function ja(r,o,d){for(var m=d?Da:ho,E=r[0].length,b=r.length,x=b,I=D(b),L=1/0,F=[];x--;){var P=r[x];x&&o&&(P=Ve(P,Tt(o))),L=lt(P.length,L),I[x]=!d&&(o||E>=120&&P.length>=120)?new Qn(x&&P):t}P=r[0];var V=-1,K=I[0];e:for(;++V<E&&F.length<L;){var re=P[V],ae=o?o(re):re;if(re=d||re!==0?re:0,!(K?hi(K,ae):m(F,ae,d))){for(x=b;--x;){var me=I[x];if(!(me?hi(me,ae):m(r[x],ae,d)))continue e}K&&K.push(ae),F.push(re)}}return F}a(ja,"baseIntersection");function Yy(r,o,d,m){return Kt(r,function(E,b,x){o(m,d(E),b,x)}),m}a(Yy,"baseInverter");function Si(r,o,d){o=Nn(o,r),r=Wd(r,o);var m=r==null?r:r[jt(Ft(o))];return m==null?t:Mt(m,r,d)}a(Si,"baseInvoke");function Ju(r){return Xe(r)&&dt(r)==W}a(Ju,"baseIsArguments");function Ky(r){return Xe(r)&&dt(r)==di}a(Ky,"baseIsArrayBuffer");function Xy(r){return Xe(r)&&dt(r)==ze}a(Xy,"baseIsDate");function bi(r,o,d,m,E){return r===o?!0:r==null||o==null||!Xe(r)&&!Xe(o)?r!==r&&o!==o:jy(r,o,d,m,bi,E)}a(bi,"baseIsEqual");function jy(r,o,d,m,E,b){var x=he(r),I=he(o),L=x?te:ct(r),F=I?te:ct(o);L=L==W?Je:L,F=F==W?Je:F;var P=L==Je,V=F==Je,K=L==F;if(K&&_n(r)){if(!_n(o))return!1;x=!0,P=!1}if(K&&!P)return b||(b=new Bt),x||Ir(r)?Dd(r,o,d,m,E,b):ME(r,o,L,d,m,E,b);if(!(d&y)){var re=P&&Le.call(r,"__wrapped__"),ae=V&&Le.call(o,"__wrapped__");if(re||ae){var me=re?r.value():r,le=ae?o.value():o;return b||(b=new Bt),E(me,le,d,m,b)}}return K?(b||(b=new Bt),TE(r,o,d,m,E,b)):!1}a(jy,"baseIsEqualDeep");function Zy(r){return Xe(r)&&ct(r)==qe}a(Zy,"baseIsMap");function Za(r,o,d,m){var E=d.length,b=E,x=!m;if(r==null)return!b;for(r=_e(r);E--;){var I=d[E];if(x&&I[2]?I[1]!==r[I[0]]:!(I[0]in r))return!1}for(;++E<b;){I=d[E];var L=I[0],F=r[L],P=I[1];if(x&&I[2]){if(F===t&&!(L in r))return!1}else{var V=new Bt;if(m)var K=m(F,P,L,r,o,V);if(!(K===t?bi(P,F,y|S,m,V):K))return!1}}return!0}a(Za,"baseIsMatch");function ed(r){if(!Ye(r)||_E(r))return!1;var o=mn(r)?Zg:Bp;return o.test(nr(r))}a(ed,"baseIsNative");function Qy(r){return Xe(r)&&dt(r)==li}a(Qy,"baseIsRegExp");function Jy(r){return Xe(r)&&ct(r)==Wt}a(Jy,"baseIsSet");function eE(r){return Xe(r)&&Ko(r.length)&&!!Pe[dt(r)]}a(eE,"baseIsTypedArray");function td(r){return typeof r=="function"?r:r==null?bt:typeof r=="object"?he(r)?id(r[0],r[1]):rd(r):Mh(r)}a(td,"baseIteratee");function Qa(r){if(!Ti(r))return ry(r);var o=[];for(var d in _e(r))Le.call(r,d)&&d!="constructor"&&o.push(d);return o}a(Qa,"baseKeys");function tE(r){if(!Ye(r))return PE(r);var o=Ti(r),d=[];for(var m in r)m=="constructor"&&(o||!Le.call(r,m))||d.push(m);return d}a(tE,"baseKeysIn");function Ja(r,o){return r<o}a(Ja,"baseLt");function nd(r,o){var d=-1,m=vt(r)?D(r.length):[];return Rn(r,function(E,b,x){m[++d]=o(E,b,x)}),m}a(nd,"baseMap");function rd(r){var o=ml(r);return o.length==1&&o[0][2]?Pd(o[0][0],o[0][1]):function(d){return d===r||Za(d,r,o)}}a(rd,"baseMatches");function id(r,o){return gl(r)&&Fd(o)?Pd(jt(r),o):function(d){var m=Cl(d,r);return m===t&&m===o?Il(d,r):bi(o,m,y|S)}}a(id,"baseMatchesProperty");function Do(r,o,d,m,E){r!==o&&Ya(o,function(b,x){if(E||(E=new Bt),Ye(b))nE(r,o,x,d,Do,m,E);else{var I=m?m(El(r,x),b,x+"",r,o,E):t;I===t&&(I=b),za(r,x,I)}},St)}a(Do,"baseMerge");function nE(r,o,d,m,E,b,x){var I=El(r,d),L=El(o,d),F=x.get(L);if(F){za(r,d,F);return}var P=b?b(I,L,d+"",r,o,x):t,V=P===t;if(V){var K=he(L),re=!K&&_n(L),ae=!K&&!re&&Ir(L);P=L,K||re||ae?he(I)?P=I:Ze(I)?P=Et(I):re?(V=!1,P=gd(L,!0)):ae?(V=!1,P=yd(L,!0)):P=[]:Ci(L)||rr(L)?(P=I,rr(I)?P=fh(I):(!Ye(I)||mn(I))&&(P=kd(L))):V=!1}V&&(x.set(L,P),E(P,L,m,b,x),x.delete(L)),za(r,d,P)}a(nE,"baseMergeDeep");function od(r,o){var d=r.length;if(d)return o+=o<0?d:0,fn(o,d)?r[o]:t}a(od,"baseNth");function sd(r,o,d){o.length?o=Ve(o,function(b){return he(b)?function(x){return er(x,b.length===1?b[0]:b)}:b}):o=[bt];var m=-1;o=Ve(o,Tt(se()));var E=nd(r,function(b,x,I){var L=Ve(o,function(F){return F(b)});return{criteria:L,index:++m,value:b}});return Rg(E,function(b,x){return pE(b,x,d)})}a(sd,"baseOrderBy");function rE(r,o){return ad(r,o,function(d,m){return Il(r,m)})}a(rE,"basePick");function ad(r,o,d){for(var m=-1,E=o.length,b={};++m<E;){var x=o[m],I=er(r,x);d(I,x)&&wi(b,Nn(x,r),I)}return b}a(ad,"basePickBy");function iE(r){return function(o){return er(o,r)}}a(iE,"basePropertyDeep");function el(r,o,d,m){var E=m?Ag:yr,b=-1,x=o.length,I=r;for(r===o&&(o=Et(o)),d&&(I=Ve(r,Tt(d)));++b<x;)for(var L=0,F=o[b],P=d?d(F):F;(L=E(I,P,L,m))>-1;)I!==r&&wo.call(I,L,1),wo.call(r,L,1);return r}a(el,"basePullAll");function ld(r,o){for(var d=r?o.length:0,m=d-1;d--;){var E=o[d];if(d==m||E!==b){var b=E;fn(E)?wo.call(r,E,1):il(r,E)}}return r}a(ld,"basePullAt");function tl(r,o){return r+xo(Gu()*(o-r+1))}a(tl,"baseRandom");function oE(r,o,d,m){for(var E=-1,b=nt(To((o-r)/(d||1)),0),x=D(b);b--;)x[m?b:++E]=r,r+=d;return x}a(oE,"baseRange");function nl(r,o){var d="";if(!r||o<1||o>ne)return d;do o%2&&(d+=r),o=xo(o/2),o&&(r+=r);while(o);return d}a(nl,"baseRepeat");function ye(r,o){return vl(Hd(r,o,bt),r+"")}a(ye,"baseRest");function sE(r){return zu(Ar(r))}a(sE,"baseSample");function aE(r,o){var d=Ar(r);return Go(d,Jn(o,0,d.length))}a(aE,"baseSampleSize");function wi(r,o,d,m){if(!Ye(r))return r;o=Nn(o,r);for(var E=-1,b=o.length,x=b-1,I=r;I!=null&&++E<b;){var L=jt(o[E]),F=d;if(L==="__proto__"||L==="constructor"||L==="prototype")return r;if(E!=x){var P=I[L];F=m?m(P,L,I):t,F===t&&(F=Ye(P)?P:fn(o[E+1])?[]:{})}Ei(I,L,F),I=I[L]}return r}a(wi,"baseSet");var cd=Co?function(r,o){return Co.set(r,o),r}:bt,lE=Mo?function(r,o){return Mo(r,"toString",{configurable:!0,enumerable:!1,value:Rl(o),writable:!0})}:bt;function cE(r){return Go(Ar(r))}a(cE,"baseShuffle");function kt(r,o,d){var m=-1,E=r.length;o<0&&(o=-o>E?0:E+o),d=d>E?E:d,d<0&&(d+=E),E=o>d?0:d-o>>>0,o>>>=0;for(var b=D(E);++m<E;)b[m]=r[m+o];return b}a(kt,"baseSlice");function uE(r,o){var d;return Rn(r,function(m,E,b){return d=o(m,E,b),!d}),!!d}a(uE,"baseSome");function _o(r,o,d){var m=0,E=r==null?m:r.length;if(typeof o=="number"&&o===o&&E<=ge){for(;m<E;){var b=m+E>>>1,x=r[b];x!==null&&!Ct(x)&&(d?x<=o:x<o)?m=b+1:E=b}return E}return rl(r,o,bt,d)}a(_o,"baseSortedIndex");function rl(r,o,d,m){var E=0,b=r==null?0:r.length;if(b===0)return 0;o=d(o);for(var x=o!==o,I=o===null,L=Ct(o),F=o===t;E<b;){var P=xo((E+b)/2),V=d(r[P]),K=V!==t,re=V===null,ae=V===V,me=Ct(V);if(x)var le=m||ae;else F?le=ae&&(m||K):I?le=ae&&K&&(m||!re):L?le=ae&&K&&!re&&(m||!me):re||me?le=!1:le=m?V<=o:V<o;le?E=P+1:b=P}return lt(b,Ht)}a(rl,"baseSortedIndexBy");function ud(r,o){for(var d=-1,m=r.length,E=0,b=[];++d<m;){var x=r[d],I=o?o(x):x;if(!d||!Gt(I,L)){var L=I;b[E++]=x===0?0:x}}return b}a(ud,"baseSortedUniq");function dd(r){return typeof r=="number"?r:Ct(r)?Ue:+r}a(dd,"baseToNumber");function xt(r){if(typeof r=="string")return r;if(he(r))return Ve(r,xt)+"";if(Ct(r))return Uu?Uu.call(r):"";var o=r+"";return o=="0"&&1/r==-Q?"-0":o}a(xt,"baseToString");function Ln(r,o,d){var m=-1,E=ho,b=r.length,x=!0,I=[],L=I;if(d)x=!1,E=Da;else if(b>=n){var F=o?null:bE(r);if(F)return mo(F);x=!1,E=hi,L=new Qn}else L=o?[]:I;e:for(;++m<b;){var P=r[m],V=o?o(P):P;if(P=d||P!==0?P:0,x&&V===V){for(var K=L.length;K--;)if(L[K]===V)continue e;o&&L.push(V),I.push(P)}else E(L,V,d)||(L!==I&&L.push(V),I.push(P))}return I}a(Ln,"baseUniq");function il(r,o){return o=Nn(o,r),r=Wd(r,o),r==null||delete r[jt(Ft(o))]}a(il,"baseUnset");function hd(r,o,d,m){return wi(r,o,d(er(r,o)),m)}a(hd,"baseUpdate");function Oo(r,o,d,m){for(var E=r.length,b=m?E:-1;(m?b--:++b<E)&&o(r[b],b,r););return d?kt(r,m?0:b,m?b+1:E):kt(r,m?b+1:0,m?E:b)}a(Oo,"baseWhile");function fd(r,o){var d=r;return d instanceof ve&&(d=d.value()),_a(o,function(m,E){return E.func.apply(E.thisArg,xn([m],E.args))},d)}a(fd,"baseWrapperValue");function ol(r,o,d){var m=r.length;if(m<2)return m?Ln(r[0]):[];for(var E=-1,b=D(m);++E<m;)for(var x=r[E],I=-1;++I<m;)I!=E&&(b[E]=vi(b[E]||x,r[I],o,d));return Ln(ot(b,1),o,d)}a(ol,"baseXor");function md(r,o,d){for(var m=-1,E=r.length,b=o.length,x={};++m<E;){var I=m<b?o[m]:t;d(x,r[m],I)}return x}a(md,"baseZipObject");function sl(r){return Ze(r)?r:[]}a(sl,"castArrayLikeObject");function al(r){return typeof r=="function"?r:bt}a(al,"castFunction");function Nn(r,o){return he(r)?r:gl(r,o)?[r]:Ud(Ae(r))}a(Nn,"castPath");var dE=ye;function Dn(r,o,d){var m=r.length;return d=d===t?m:d,!o&&d>=m?r:kt(r,o,d)}a(Dn,"castSlice");var pd=Qg||function(r){return rt.clearTimeout(r)};function gd(r,o){if(o)return r.slice();var d=r.length,m=Pu?Pu(d):new r.constructor(d);return r.copy(m),m}a(gd,"cloneBuffer");function ll(r){var o=new r.constructor(r.byteLength);return new So(o).set(new So(r)),o}a(ll,"cloneArrayBuffer");function hE(r,o){var d=o?ll(r.buffer):r.buffer;return new r.constructor(d,r.byteOffset,r.byteLength)}a(hE,"cloneDataView");function fE(r){var o=new r.constructor(r.source,Jc.exec(r));return o.lastIndex=r.lastIndex,o}a(fE,"cloneRegExp");function mE(r){return yi?_e(yi.call(r)):{}}a(mE,"cloneSymbol");function yd(r,o){var d=o?ll(r.buffer):r.buffer;return new r.constructor(d,r.byteOffset,r.length)}a(yd,"cloneTypedArray");function Ed(r,o){if(r!==o){var d=r!==t,m=r===null,E=r===r,b=Ct(r),x=o!==t,I=o===null,L=o===o,F=Ct(o);if(!I&&!F&&!b&&r>o||b&&x&&L&&!I&&!F||m&&x&&L||!d&&L||!E)return 1;if(!m&&!b&&!F&&r<o||F&&d&&E&&!m&&!b||I&&d&&E||!x&&E||!L)return-1}return 0}a(Ed,"compareAscending");function pE(r,o,d){for(var m=-1,E=r.criteria,b=o.criteria,x=E.length,I=d.length;++m<x;){var L=Ed(E[m],b[m]);if(L){if(m>=I)return L;var F=d[m];return L*(F=="desc"?-1:1)}}return r.index-o.index}a(pE,"compareMultiple");function vd(r,o,d,m){for(var E=-1,b=r.length,x=d.length,I=-1,L=o.length,F=nt(b-x,0),P=D(L+F),V=!m;++I<L;)P[I]=o[I];for(;++E<x;)(V||E<b)&&(P[d[E]]=r[E]);for(;F--;)P[I++]=r[E++];return P}a(vd,"composeArgs");function Sd(r,o,d,m){for(var E=-1,b=r.length,x=-1,I=d.length,L=-1,F=o.length,P=nt(b-I,0),V=D(P+F),K=!m;++E<P;)V[E]=r[E];for(var re=E;++L<F;)V[re+L]=o[L];for(;++x<I;)(K||E<b)&&(V[re+d[x]]=r[E++]);return V}a(Sd,"composeArgsRight");function Et(r,o){var d=-1,m=r.length;for(o||(o=D(m));++d<m;)o[d]=r[d];return o}a(Et,"copyArray");function Xt(r,o,d,m){var E=!d;d||(d={});for(var b=-1,x=o.length;++b<x;){var I=o[b],L=m?m(d[I],r[I],I,d,r):t;L===t&&(L=r[I]),E?un(d,I,L):Ei(d,I,L)}return d}a(Xt,"copyObject");function gE(r,o){return Xt(r,pl(r),o)}a(gE,"copySymbols");function yE(r,o){return Xt(r,_d(r),o)}a(yE,"copySymbolsIn");function ko(r,o){return function(d,m){var E=he(d)?wg:Wy,b=o?o():{};return E(d,r,se(m,2),b)}}a(ko,"createAggregator");function Tr(r){return ye(function(o,d){var m=-1,E=d.length,b=E>1?d[E-1]:t,x=E>2?d[2]:t;for(b=r.length>3&&typeof b=="function"?(E--,b):t,x&&ht(d[0],d[1],x)&&(b=E<3?t:b,E=1),o=_e(o);++m<E;){var I=d[m];I&&r(o,I,m,b)}return o})}a(Tr,"createAssigner");function bd(r,o){return function(d,m){if(d==null)return d;if(!vt(d))return r(d,m);for(var E=d.length,b=o?E:-1,x=_e(d);(o?b--:++b<E)&&m(x[b],b,x)!==!1;);return d}}a(bd,"createBaseEach");function wd(r){return function(o,d,m){for(var E=-1,b=_e(o),x=m(o),I=x.length;I--;){var L=x[r?I:++E];if(d(b[L],L,b)===!1)break}return o}}a(wd,"createBaseFor");function EE(r,o,d){var m=o&w,E=Mi(r);function b(){var x=this&&this!==rt&&this instanceof b?E:r;return x.apply(m?d:this,arguments)}return a(b,"wrapper"),b}a(EE,"createBind");function Md(r){return function(o){o=Ae(o);var d=Er(o)?Vt(o):t,m=d?d[0]:o.charAt(0),E=d?Dn(d,1).join(""):o.slice(1);return m[r]()+E}}a(Md,"createCaseFirst");function xr(r){return function(o){return _a(bh(Sh(o).replace(lg,"")),r,"")}}a(xr,"createCompounder");function Mi(r){return function(){var o=arguments;switch(o.length){case 0:return new r;case 1:return new r(o[0]);case 2:return new r(o[0],o[1]);case 3:return new r(o[0],o[1],o[2]);case 4:return new r(o[0],o[1],o[2],o[3]);case 5:return new r(o[0],o[1],o[2],o[3],o[4]);case 6:return new r(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new r(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var d=Mr(r.prototype),m=r.apply(d,o);return Ye(m)?m:d}}a(Mi,"createCtor");function vE(r,o,d){var m=Mi(r);function E(){for(var b=arguments.length,x=D(b),I=b,L=Cr(E);I--;)x[I]=arguments[I];var F=b<3&&x[0]!==L&&x[b-1]!==L?[]:Cn(x,L);if(b-=F.length,b<d)return Ad(r,o,Fo,E.placeholder,t,x,F,t,t,d-b);var P=this&&this!==rt&&this instanceof E?m:r;return Mt(P,this,x)}return a(E,"wrapper"),E}a(vE,"createCurry");function Td(r){return function(o,d,m){var E=_e(o);if(!vt(o)){var b=se(d,3);o=it(o),d=a(function(I){return b(E[I],I,E)},"predicate")}var x=r(o,d,m);return x>-1?E[b?o[x]:x]:t}}a(Td,"createFind");function xd(r){return hn(function(o){var d=o.length,m=d,E=_t.prototype.thru;for(r&&o.reverse();m--;){var b=o[m];if(typeof b!="function")throw new Dt(s);if(E&&!x&&Vo(b)=="wrapper")var x=new _t([],!0)}for(m=x?m:d;++m<d;){b=o[m];var I=Vo(b),L=I=="wrapper"?fl(b):t;L&&yl(L[0])&&L[1]==(z|C|A|q)&&!L[4].length&&L[9]==1?x=x[Vo(L[0])].apply(x,L[3]):x=b.length==1&&yl(b)?x[I]():x.thru(b)}return function(){var F=arguments,P=F[0];if(x&&F.length==1&&he(P))return x.plant(P).value();for(var V=0,K=d?o[V].apply(this,F):P;++V<d;)K=o[V].call(this,K);return K}})}a(xd,"createFlow");function Fo(r,o,d,m,E,b,x,I,L,F){var P=o&z,V=o&w,K=o&M,re=o&(C|N),ae=o&oe,me=K?t:Mi(r);function le(){for(var Ee=arguments.length,be=D(Ee),It=Ee;It--;)be[It]=arguments[It];if(re)var ft=Cr(le),At=Ng(be,ft);if(m&&(be=vd(be,m,E,re)),b&&(be=Sd(be,b,x,re)),Ee-=At,re&&Ee<F){var Qe=Cn(be,ft);return Ad(r,o,Fo,le.placeholder,d,be,Qe,I,L,F-Ee)}var Ut=V?d:this,gn=K?Ut[r]:r;return Ee=be.length,I?be=WE(be,I):ae&&Ee>1&&be.reverse(),P&&L<Ee&&(be.length=L),this&&this!==rt&&this instanceof le&&(gn=me||Mi(gn)),gn.apply(Ut,be)}return a(le,"wrapper"),le}a(Fo,"createHybrid");function Cd(r,o){return function(d,m){return Yy(d,r,o(m),{})}}a(Cd,"createInverter");function Po(r,o){return function(d,m){var E;if(d===t&&m===t)return o;if(d!==t&&(E=d),m!==t){if(E===t)return m;typeof d=="string"||typeof m=="string"?(d=xt(d),m=xt(m)):(d=dd(d),m=dd(m)),E=r(d,m)}return E}}a(Po,"createMathOperation");function cl(r){return hn(function(o){return o=Ve(o,Tt(se())),ye(function(d){var m=this;return r(o,function(E){return Mt(E,m,d)})})})}a(cl,"createOver");function Ho(r,o){o=o===t?" ":xt(o);var d=o.length;if(d<2)return d?nl(o,r):o;var m=nl(o,To(r/vr(o)));return Er(o)?Dn(Vt(m),0,r).join(""):m.slice(0,r)}a(Ho,"createPadding");function SE(r,o,d,m){var E=o&w,b=Mi(r);function x(){for(var I=-1,L=arguments.length,F=-1,P=m.length,V=D(P+L),K=this&&this!==rt&&this instanceof x?b:r;++F<P;)V[F]=m[F];for(;L--;)V[F++]=arguments[++I];return Mt(K,E?d:this,V)}return a(x,"wrapper"),x}a(SE,"createPartial");function Id(r){return function(o,d,m){return m&&typeof m!="number"&&ht(o,d,m)&&(d=m=t),o=pn(o),d===t?(d=o,o=0):d=pn(d),m=m===t?o<d?1:-1:pn(m),oE(o,d,m,r)}}a(Id,"createRange");function Wo(r){return function(o,d){return typeof o=="string"&&typeof d=="string"||(o=Pt(o),d=Pt(d)),r(o,d)}}a(Wo,"createRelationalOperation");function Ad(r,o,d,m,E,b,x,I,L,F){var P=o&C,V=P?x:t,K=P?t:x,re=P?b:t,ae=P?t:b;o|=P?A:k,o&=~(P?k:A),o&T||(o&=~(w|M));var me=[r,o,E,re,V,ae,K,I,L,F],le=d.apply(t,me);return yl(r)&&Vd(le,me),le.placeholder=m,Bd(le,r,o)}a(Ad,"createRecurry");function ul(r){var o=tt[r];return function(d,m){if(d=Pt(d),m=m==null?0:lt(fe(m),292),m&&Bu(d)){var E=(Ae(d)+"e").split("e"),b=o(E[0]+"e"+(+E[1]+m));return E=(Ae(b)+"e").split("e"),+(E[0]+"e"+(+E[1]-m))}return o(d)}}a(ul,"createRound");var bE=br&&1/mo(new br([,-0]))[1]==Q?function(r){return new br(r)}:Dl;function Rd(r){return function(o){var d=ct(o);return d==qe?Va(o):d==Wt?Hg(o):Lg(o,r(o))}}a(Rd,"createToPairs");function dn(r,o,d,m,E,b,x,I){var L=o&M;if(!L&&typeof r!="function")throw new Dt(s);var F=m?m.length:0;if(F||(o&=~(A|k),m=E=t),x=x===t?x:nt(fe(x),0),I=I===t?I:fe(I),F-=E?E.length:0,o&k){var P=m,V=E;m=E=t}var K=L?t:fl(r),re=[r,o,d,m,E,P,V,b,x,I];if(K&&FE(re,K),r=re[0],o=re[1],d=re[2],m=re[3],E=re[4],I=re[9]=re[9]===t?L?0:r.length:nt(re[9]-F,0),!I&&o&(C|N)&&(o&=~(C|N)),!o||o==w)var ae=EE(r,o,d);else o==C||o==N?ae=vE(r,o,I):(o==A||o==(w|A))&&!E.length?ae=SE(r,o,d,m):ae=Fo.apply(t,re);var me=K?cd:Vd;return Bd(me(ae,re),r,o)}a(dn,"createWrap");function Ld(r,o,d,m){return r===t||Gt(r,Sr[d])&&!Le.call(m,d)?o:r}a(Ld,"customDefaultsAssignIn");function Nd(r,o,d,m,E,b){return Ye(r)&&Ye(o)&&(b.set(o,r),Do(r,o,t,Nd,b),b.delete(o)),r}a(Nd,"customDefaultsMerge");function wE(r){return Ci(r)?t:r}a(wE,"customOmitClone");function Dd(r,o,d,m,E,b){var x=d&y,I=r.length,L=o.length;if(I!=L&&!(x&&L>I))return!1;var F=b.get(r),P=b.get(o);if(F&&P)return F==o&&P==r;var V=-1,K=!0,re=d&S?new Qn:t;for(b.set(r,o),b.set(o,r);++V<I;){var ae=r[V],me=o[V];if(m)var le=x?m(me,ae,V,o,r,b):m(ae,me,V,r,o,b);if(le!==t){if(le)continue;K=!1;break}if(re){if(!Oa(o,function(Ee,be){if(!hi(re,be)&&(ae===Ee||E(ae,Ee,d,m,b)))return re.push(be)})){K=!1;break}}else if(!(ae===me||E(ae,me,d,m,b))){K=!1;break}}return b.delete(r),b.delete(o),K}a(Dd,"equalArrays");function ME(r,o,d,m,E,b,x){switch(d){case pr:if(r.byteLength!=o.byteLength||r.byteOffset!=o.byteOffset)return!1;r=r.buffer,o=o.buffer;case di:return!(r.byteLength!=o.byteLength||!b(new So(r),new So(o)));case Re:case ze:case De:return Gt(+r,+o);case Yt:return r.name==o.name&&r.message==o.message;case li:case ci:return r==o+"";case qe:var I=Va;case Wt:var L=m&y;if(I||(I=mo),r.size!=o.size&&!L)return!1;var F=x.get(r);if(F)return F==o;m|=S,x.set(r,o);var P=Dd(I(r),I(o),m,E,b,x);return x.delete(r),P;case ao:if(yi)return yi.call(r)==yi.call(o)}return!1}a(ME,"equalByTag");function TE(r,o,d,m,E,b){var x=d&y,I=dl(r),L=I.length,F=dl(o),P=F.length;if(L!=P&&!x)return!1;for(var V=L;V--;){var K=I[V];if(!(x?K in o:Le.call(o,K)))return!1}var re=b.get(r),ae=b.get(o);if(re&&ae)return re==o&&ae==r;var me=!0;b.set(r,o),b.set(o,r);for(var le=x;++V<L;){K=I[V];var Ee=r[K],be=o[K];if(m)var It=x?m(be,Ee,K,o,r,b):m(Ee,be,K,r,o,b);if(!(It===t?Ee===be||E(Ee,be,d,m,b):It)){me=!1;break}le||(le=K=="constructor")}if(me&&!le){var ft=r.constructor,At=o.constructor;ft!=At&&"constructor"in r&&"constructor"in o&&!(typeof ft=="function"&&ft instanceof ft&&typeof At=="function"&&At instanceof At)&&(me=!1)}return b.delete(r),b.delete(o),me}a(TE,"equalObjects");function hn(r){return vl(Hd(r,t,Yd),r+"")}a(hn,"flatRest");function dl(r){return Qu(r,it,pl)}a(dl,"getAllKeys");function hl(r){return Qu(r,St,_d)}a(hl,"getAllKeysIn");var fl=Co?function(r){return Co.get(r)}:Dl;function Vo(r){for(var o=r.name+"",d=wr[o],m=Le.call(wr,o)?d.length:0;m--;){var E=d[m],b=E.func;if(b==null||b==r)return E.name}return o}a(Vo,"getFuncName");function Cr(r){var o=Le.call(v,"placeholder")?v:r;return o.placeholder}a(Cr,"getHolder");function se(){var r=v.iteratee||Ll;return r=r===Ll?td:r,arguments.length?r(arguments[0],arguments[1]):r}a(se,"getIteratee");function Bo(r,o){var d=r.__data__;return DE(o)?d[typeof o=="string"?"string":"hash"]:d.map}a(Bo,"getMapData");function ml(r){for(var o=it(r),d=o.length;d--;){var m=o[d],E=r[m];o[d]=[m,E,Fd(E)]}return o}a(ml,"getMatchData");function tr(r,o){var d=kg(r,o);return ed(d)?d:t}a(tr,"getNative");function xE(r){var o=Le.call(r,jn),d=r[jn];try{r[jn]=t;var m=!0}catch{}var E=Eo.call(r);return m&&(o?r[jn]=d:delete r[jn]),E}a(xE,"getRawTag");var pl=Ga?function(r){return r==null?[]:(r=_e(r),Tn(Ga(r),function(o){return Wu.call(r,o)}))}:_l,_d=Ga?function(r){for(var o=[];r;)xn(o,pl(r)),r=bo(r);return o}:_l,ct=dt;(Ua&&ct(new Ua(new ArrayBuffer(1)))!=pr||mi&&ct(new mi)!=qe||$a&&ct($a.resolve())!=Ie||br&&ct(new br)!=Wt||pi&&ct(new pi)!=ui)&&(ct=a(function(r){var o=dt(r),d=o==Je?r.constructor:t,m=d?nr(d):"";if(m)switch(m){case ay:return pr;case ly:return qe;case cy:return Ie;case uy:return Wt;case dy:return ui}return o},"getTag"));function CE(r,o,d){for(var m=-1,E=d.length;++m<E;){var b=d[m],x=b.size;switch(b.type){case"drop":r+=x;break;case"dropRight":o-=x;break;case"take":o=lt(o,r+x);break;case"takeRight":r=nt(r,o-x);break}}return{start:r,end:o}}a(CE,"getView");function IE(r){var o=r.match(_p);return o?o[1].split(Op):[]}a(IE,"getWrapDetails");function Od(r,o,d){o=Nn(o,r);for(var m=-1,E=o.length,b=!1;++m<E;){var x=jt(o[m]);if(!(b=r!=null&&d(r,x)))break;r=r[x]}return b||++m!=E?b:(E=r==null?0:r.length,!!E&&Ko(E)&&fn(x,E)&&(he(r)||rr(r)))}a(Od,"hasPath");function AE(r){var o=r.length,d=new r.constructor(o);return o&&typeof r[0]=="string"&&Le.call(r,"index")&&(d.index=r.index,d.input=r.input),d}a(AE,"initCloneArray");function kd(r){return typeof r.constructor=="function"&&!Ti(r)?Mr(bo(r)):{}}a(kd,"initCloneObject");function RE(r,o,d){var m=r.constructor;switch(o){case di:return ll(r);case Re:case ze:return new m(+r);case pr:return hE(r,d);case ma:case pa:case ga:case ya:case Ea:case va:case Sa:case ba:case wa:return yd(r,d);case qe:return new m;case De:case ci:return new m(r);case li:return fE(r);case Wt:return new m;case ao:return mE(r)}}a(RE,"initCloneByTag");function LE(r,o){var d=o.length;if(!d)return r;var m=d-1;return o[m]=(d>1?"& ":"")+o[m],o=o.join(d>2?", ":" "),r.replace(Dp,`{
/* [wrapped with `+o+`] */
`)}a(LE,"insertWrapDetails");function NE(r){return he(r)||rr(r)||!!(Vu&&r&&r[Vu])}a(NE,"isFlattenable");function fn(r,o){var d=typeof r;return o=o??ne,!!o&&(d=="number"||d!="symbol"&&Up.test(r))&&r>-1&&r%1==0&&r<o}a(fn,"isIndex");function ht(r,o,d){if(!Ye(d))return!1;var m=typeof o;return(m=="number"?vt(d)&&fn(o,d.length):m=="string"&&o in d)?Gt(d[o],r):!1}a(ht,"isIterateeCall");function gl(r,o){if(he(r))return!1;var d=typeof r;return d=="number"||d=="symbol"||d=="boolean"||r==null||Ct(r)?!0:Ap.test(r)||!Ip.test(r)||o!=null&&r in _e(o)}a(gl,"isKey");function DE(r){var o=typeof r;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?r!=="__proto__":r===null}a(DE,"isKeyable");function yl(r){var o=Vo(r),d=v[o];if(typeof d!="function"||!(o in ve.prototype))return!1;if(r===d)return!0;var m=fl(d);return!!m&&r===m[0]}a(yl,"isLaziable");function _E(r){return!!Fu&&Fu in r}a(_E,"isMasked");var OE=go?mn:Ol;function Ti(r){var o=r&&r.constructor,d=typeof o=="function"&&o.prototype||Sr;return r===d}a(Ti,"isPrototype");function Fd(r){return r===r&&!Ye(r)}a(Fd,"isStrictComparable");function Pd(r,o){return function(d){return d==null?!1:d[r]===o&&(o!==t||r in _e(d))}}a(Pd,"matchesStrictComparable");function kE(r){var o=qo(r,function(m){return d.size===u&&d.clear(),m}),d=o.cache;return o}a(kE,"memoizeCapped");function FE(r,o){var d=r[1],m=o[1],E=d|m,b=E<(w|M|z),x=m==z&&d==C||m==z&&d==q&&r[7].length<=o[8]||m==(z|q)&&o[7].length<=o[8]&&d==C;if(!(b||x))return r;m&w&&(r[2]=o[2],E|=d&w?0:T);var I=o[3];if(I){var L=r[3];r[3]=L?vd(L,I,o[4]):I,r[4]=L?Cn(r[3],h):o[4]}return I=o[5],I&&(L=r[5],r[5]=L?Sd(L,I,o[6]):I,r[6]=L?Cn(r[5],h):o[6]),I=o[7],I&&(r[7]=I),m&z&&(r[8]=r[8]==null?o[8]:lt(r[8],o[8])),r[9]==null&&(r[9]=o[9]),r[0]=o[0],r[1]=E,r}a(FE,"mergeData");function PE(r){var o=[];if(r!=null)for(var d in _e(r))o.push(d);return o}a(PE,"nativeKeysIn");function HE(r){return Eo.call(r)}a(HE,"objectToString");function Hd(r,o,d){return o=nt(o===t?r.length-1:o,0),function(){for(var m=arguments,E=-1,b=nt(m.length-o,0),x=D(b);++E<b;)x[E]=m[o+E];E=-1;for(var I=D(o+1);++E<o;)I[E]=m[E];return I[o]=d(x),Mt(r,this,I)}}a(Hd,"overRest");function Wd(r,o){return o.length<2?r:er(r,kt(o,0,-1))}a(Wd,"parent");function WE(r,o){for(var d=r.length,m=lt(o.length,d),E=Et(r);m--;){var b=o[m];r[m]=fn(b,d)?E[b]:t}return r}a(WE,"reorder");function El(r,o){if(!(o==="constructor"&&typeof r[o]=="function")&&o!="__proto__")return r[o]}a(El,"safeGet");var Vd=Gd(cd),xi=ey||function(r,o){return rt.setTimeout(r,o)},vl=Gd(lE);function Bd(r,o,d){var m=o+"";return vl(r,LE(m,VE(IE(m),d)))}a(Bd,"setWrapToString");function Gd(r){var o=0,d=0;return function(){var m=iy(),E=G-(m-d);if(d=m,E>0){if(++o>=de)return arguments[0]}else o=0;return r.apply(t,arguments)}}a(Gd,"shortOut");function Go(r,o){var d=-1,m=r.length,E=m-1;for(o=o===t?m:o;++d<o;){var b=tl(d,E),x=r[b];r[b]=r[d],r[d]=x}return r.length=o,r}a(Go,"shuffleSelf");var Ud=kE(function(r){var o=[];return r.charCodeAt(0)===46&&o.push(""),r.replace(Rp,function(d,m,E,b){o.push(E?b.replace(Pp,"$1"):m||d)}),o});function jt(r){if(typeof r=="string"||Ct(r))return r;var o=r+"";return o=="0"&&1/r==-Q?"-0":o}a(jt,"toKey");function nr(r){if(r!=null){try{return yo.call(r)}catch{}try{return r+""}catch{}}return""}a(nr,"toSource");function VE(r,o){return Nt(Y,function(d){var m="_."+d[0];o&d[1]&&!ho(r,m)&&r.push(m)}),r.sort()}a(VE,"updateWrapDetails");function $d(r){if(r instanceof ve)return r.clone();var o=new _t(r.__wrapped__,r.__chain__);return o.__actions__=Et(r.__actions__),o.__index__=r.__index__,o.__values__=r.__values__,o}a($d,"wrapperClone");function BE(r,o,d){(d?ht(r,o,d):o===t)?o=1:o=nt(fe(o),0);var m=r==null?0:r.length;if(!m||o<1)return[];for(var E=0,b=0,x=D(To(m/o));E<m;)x[b++]=kt(r,E,E+=o);return x}a(BE,"chunk");function GE(r){for(var o=-1,d=r==null?0:r.length,m=0,E=[];++o<d;){var b=r[o];b&&(E[m++]=b)}return E}a(GE,"compact");function UE(){var r=arguments.length;if(!r)return[];for(var o=D(r-1),d=arguments[0],m=r;m--;)o[m-1]=arguments[m];return xn(he(d)?Et(d):[d],ot(o,1))}a(UE,"concat");var $E=ye(function(r,o){return Ze(r)?vi(r,ot(o,1,Ze,!0)):[]}),zE=ye(function(r,o){var d=Ft(o);return Ze(d)&&(d=t),Ze(r)?vi(r,ot(o,1,Ze,!0),se(d,2)):[]}),qE=ye(function(r,o){var d=Ft(o);return Ze(d)&&(d=t),Ze(r)?vi(r,ot(o,1,Ze,!0),t,d):[]});function YE(r,o,d){var m=r==null?0:r.length;return m?(o=d||o===t?1:fe(o),kt(r,o<0?0:o,m)):[]}a(YE,"drop");function KE(r,o,d){var m=r==null?0:r.length;return m?(o=d||o===t?1:fe(o),o=m-o,kt(r,0,o<0?0:o)):[]}a(KE,"dropRight");function XE(r,o){return r&&r.length?Oo(r,se(o,3),!0,!0):[]}a(XE,"dropRightWhile");function jE(r,o){return r&&r.length?Oo(r,se(o,3),!0):[]}a(jE,"dropWhile");function ZE(r,o,d,m){var E=r==null?0:r.length;return E?(d&&typeof d!="number"&&ht(r,o,d)&&(d=0,m=E),Uy(r,o,d,m)):[]}a(ZE,"fill");function zd(r,o,d){var m=r==null?0:r.length;if(!m)return-1;var E=d==null?0:fe(d);return E<0&&(E=nt(m+E,0)),fo(r,se(o,3),E)}a(zd,"findIndex");function qd(r,o,d){var m=r==null?0:r.length;if(!m)return-1;var E=m-1;return d!==t&&(E=fe(d),E=d<0?nt(m+E,0):lt(E,m-1)),fo(r,se(o,3),E,!0)}a(qd,"findLastIndex");function Yd(r){var o=r==null?0:r.length;return o?ot(r,1):[]}a(Yd,"flatten");function QE(r){var o=r==null?0:r.length;return o?ot(r,Q):[]}a(QE,"flattenDeep");function JE(r,o){var d=r==null?0:r.length;return d?(o=o===t?1:fe(o),ot(r,o)):[]}a(JE,"flattenDepth");function ev(r){for(var o=-1,d=r==null?0:r.length,m={};++o<d;){var E=r[o];m[E[0]]=E[1]}return m}a(ev,"fromPairs");function Kd(r){return r&&r.length?r[0]:t}a(Kd,"head");function tv(r,o,d){var m=r==null?0:r.length;if(!m)return-1;var E=d==null?0:fe(d);return E<0&&(E=nt(m+E,0)),yr(r,o,E)}a(tv,"indexOf");function nv(r){var o=r==null?0:r.length;return o?kt(r,0,-1):[]}a(nv,"initial");var rv=ye(function(r){var o=Ve(r,sl);return o.length&&o[0]===r[0]?ja(o):[]}),iv=ye(function(r){var o=Ft(r),d=Ve(r,sl);return o===Ft(d)?o=t:d.pop(),d.length&&d[0]===r[0]?ja(d,se(o,2)):[]}),ov=ye(function(r){var o=Ft(r),d=Ve(r,sl);return o=typeof o=="function"?o:t,o&&d.pop(),d.length&&d[0]===r[0]?ja(d,t,o):[]});function sv(r,o){return r==null?"":ny.call(r,o)}a(sv,"join");function Ft(r){var o=r==null?0:r.length;return o?r[o-1]:t}a(Ft,"last");function av(r,o,d){var m=r==null?0:r.length;if(!m)return-1;var E=m;return d!==t&&(E=fe(d),E=E<0?nt(m+E,0):lt(E,m-1)),o===o?Vg(r,o,E):fo(r,Au,E,!0)}a(av,"lastIndexOf");function lv(r,o){return r&&r.length?od(r,fe(o)):t}a(lv,"nth");var cv=ye(Xd);function Xd(r,o){return r&&r.length&&o&&o.length?el(r,o):r}a(Xd,"pullAll");function uv(r,o,d){return r&&r.length&&o&&o.length?el(r,o,se(d,2)):r}a(uv,"pullAllBy");function dv(r,o,d){return r&&r.length&&o&&o.length?el(r,o,t,d):r}a(dv,"pullAllWith");var hv=hn(function(r,o){var d=r==null?0:r.length,m=qa(r,o);return ld(r,Ve(o,function(E){return fn(E,d)?+E:E}).sort(Ed)),m});function fv(r,o){var d=[];if(!(r&&r.length))return d;var m=-1,E=[],b=r.length;for(o=se(o,3);++m<b;){var x=r[m];o(x,m,r)&&(d.push(x),E.push(m))}return ld(r,E),d}a(fv,"remove");function Sl(r){return r==null?r:sy.call(r)}a(Sl,"reverse");function mv(r,o,d){var m=r==null?0:r.length;return m?(d&&typeof d!="number"&&ht(r,o,d)?(o=0,d=m):(o=o==null?0:fe(o),d=d===t?m:fe(d)),kt(r,o,d)):[]}a(mv,"slice");function pv(r,o){return _o(r,o)}a(pv,"sortedIndex");function gv(r,o,d){return rl(r,o,se(d,2))}a(gv,"sortedIndexBy");function yv(r,o){var d=r==null?0:r.length;if(d){var m=_o(r,o);if(m<d&&Gt(r[m],o))return m}return-1}a(yv,"sortedIndexOf");function Ev(r,o){return _o(r,o,!0)}a(Ev,"sortedLastIndex");function vv(r,o,d){return rl(r,o,se(d,2),!0)}a(vv,"sortedLastIndexBy");function Sv(r,o){var d=r==null?0:r.length;if(d){var m=_o(r,o,!0)-1;if(Gt(r[m],o))return m}return-1}a(Sv,"sortedLastIndexOf");function bv(r){return r&&r.length?ud(r):[]}a(bv,"sortedUniq");function wv(r,o){return r&&r.length?ud(r,se(o,2)):[]}a(wv,"sortedUniqBy");function Mv(r){var o=r==null?0:r.length;return o?kt(r,1,o):[]}a(Mv,"tail");function Tv(r,o,d){return r&&r.length?(o=d||o===t?1:fe(o),kt(r,0,o<0?0:o)):[]}a(Tv,"take");function xv(r,o,d){var m=r==null?0:r.length;return m?(o=d||o===t?1:fe(o),o=m-o,kt(r,o<0?0:o,m)):[]}a(xv,"takeRight");function Cv(r,o){return r&&r.length?Oo(r,se(o,3),!1,!0):[]}a(Cv,"takeRightWhile");function Iv(r,o){return r&&r.length?Oo(r,se(o,3)):[]}a(Iv,"takeWhile");var Av=ye(function(r){return Ln(ot(r,1,Ze,!0))}),Rv=ye(function(r){var o=Ft(r);return Ze(o)&&(o=t),Ln(ot(r,1,Ze,!0),se(o,2))}),Lv=ye(function(r){var o=Ft(r);return o=typeof o=="function"?o:t,Ln(ot(r,1,Ze,!0),t,o)});function Nv(r){return r&&r.length?Ln(r):[]}a(Nv,"uniq");function Dv(r,o){return r&&r.length?Ln(r,se(o,2)):[]}a(Dv,"uniqBy");function _v(r,o){return o=typeof o=="function"?o:t,r&&r.length?Ln(r,t,o):[]}a(_v,"uniqWith");function bl(r){if(!(r&&r.length))return[];var o=0;return r=Tn(r,function(d){if(Ze(d))return o=nt(d.length,o),!0}),Ha(o,function(d){return Ve(r,ka(d))})}a(bl,"unzip");function jd(r,o){if(!(r&&r.length))return[];var d=bl(r);return o==null?d:Ve(d,function(m){return Mt(o,t,m)})}a(jd,"unzipWith");var Ov=ye(function(r,o){return Ze(r)?vi(r,o):[]}),kv=ye(function(r){return ol(Tn(r,Ze))}),Fv=ye(function(r){var o=Ft(r);return Ze(o)&&(o=t),ol(Tn(r,Ze),se(o,2))}),Pv=ye(function(r){var o=Ft(r);return o=typeof o=="function"?o:t,ol(Tn(r,Ze),t,o)}),Hv=ye(bl);function Wv(r,o){return md(r||[],o||[],Ei)}a(Wv,"zipObject");function Vv(r,o){return md(r||[],o||[],wi)}a(Vv,"zipObjectDeep");var Bv=ye(function(r){var o=r.length,d=o>1?r[o-1]:t;return d=typeof d=="function"?(r.pop(),d):t,jd(r,d)});function Zd(r){var o=v(r);return o.__chain__=!0,o}a(Zd,"chain");function Gv(r,o){return o(r),r}a(Gv,"tap");function Uo(r,o){return o(r)}a(Uo,"thru");var Uv=hn(function(r){var o=r.length,d=o?r[0]:0,m=this.__wrapped__,E=a(function(b){return qa(b,r)},"interceptor");return o>1||this.__actions__.length||!(m instanceof ve)||!fn(d)?this.thru(E):(m=m.slice(d,+d+(o?1:0)),m.__actions__.push({func:Uo,args:[E],thisArg:t}),new _t(m,this.__chain__).thru(function(b){return o&&!b.length&&b.push(t),b}))});function $v(){return Zd(this)}a($v,"wrapperChain");function zv(){return new _t(this.value(),this.__chain__)}a(zv,"wrapperCommit");function qv(){this.__values__===t&&(this.__values__=dh(this.value()));var r=this.__index__>=this.__values__.length,o=r?t:this.__values__[this.__index__++];return{done:r,value:o}}a(qv,"wrapperNext");function Yv(){return this}a(Yv,"wrapperToIterator");function Kv(r){for(var o,d=this;d instanceof Ao;){var m=$d(d);m.__index__=0,m.__values__=t,o?E.__wrapped__=m:o=m;var E=m;d=d.__wrapped__}return E.__wrapped__=r,o}a(Kv,"wrapperPlant");function Xv(){var r=this.__wrapped__;if(r instanceof ve){var o=r;return this.__actions__.length&&(o=new ve(this)),o=o.reverse(),o.__actions__.push({func:Uo,args:[Sl],thisArg:t}),new _t(o,this.__chain__)}return this.thru(Sl)}a(Xv,"wrapperReverse");function jv(){return fd(this.__wrapped__,this.__actions__)}a(jv,"wrapperValue");var Zv=ko(function(r,o,d){Le.call(r,d)?++r[d]:un(r,d,1)});function Qv(r,o,d){var m=he(r)?Cu:Gy;return d&&ht(r,o,d)&&(o=t),m(r,se(o,3))}a(Qv,"every");function Jv(r,o){var d=he(r)?Tn:ju;return d(r,se(o,3))}a(Jv,"filter");var eS=Td(zd),tS=Td(qd);function nS(r,o){return ot($o(r,o),1)}a(nS,"flatMap");function rS(r,o){return ot($o(r,o),Q)}a(rS,"flatMapDeep");function iS(r,o,d){return d=d===t?1:fe(d),ot($o(r,o),d)}a(iS,"flatMapDepth");function Qd(r,o){var d=he(r)?Nt:Rn;return d(r,se(o,3))}a(Qd,"forEach");function Jd(r,o){var d=he(r)?Mg:Xu;return d(r,se(o,3))}a(Jd,"forEachRight");var oS=ko(function(r,o,d){Le.call(r,d)?r[d].push(o):un(r,d,[o])});function sS(r,o,d,m){r=vt(r)?r:Ar(r),d=d&&!m?fe(d):0;var E=r.length;return d<0&&(d=nt(E+d,0)),Xo(r)?d<=E&&r.indexOf(o,d)>-1:!!E&&yr(r,o,d)>-1}a(sS,"includes");var aS=ye(function(r,o,d){var m=-1,E=typeof o=="function",b=vt(r)?D(r.length):[];return Rn(r,function(x){b[++m]=E?Mt(o,x,d):Si(x,o,d)}),b}),lS=ko(function(r,o,d){un(r,d,o)});function $o(r,o){var d=he(r)?Ve:nd;return d(r,se(o,3))}a($o,"map");function cS(r,o,d,m){return r==null?[]:(he(o)||(o=o==null?[]:[o]),d=m?t:d,he(d)||(d=d==null?[]:[d]),sd(r,o,d))}a(cS,"orderBy");var uS=ko(function(r,o,d){r[d?0:1].push(o)},function(){return[[],[]]});function dS(r,o,d){var m=he(r)?_a:Lu,E=arguments.length<3;return m(r,se(o,4),d,E,Rn)}a(dS,"reduce");function hS(r,o,d){var m=he(r)?Tg:Lu,E=arguments.length<3;return m(r,se(o,4),d,E,Xu)}a(hS,"reduceRight");function fS(r,o){var d=he(r)?Tn:ju;return d(r,Yo(se(o,3)))}a(fS,"reject");function mS(r){var o=he(r)?zu:sE;return o(r)}a(mS,"sample");function pS(r,o,d){(d?ht(r,o,d):o===t)?o=1:o=fe(o);var m=he(r)?Py:aE;return m(r,o)}a(pS,"sampleSize");function gS(r){var o=he(r)?Hy:cE;return o(r)}a(gS,"shuffle");function yS(r){if(r==null)return 0;if(vt(r))return Xo(r)?vr(r):r.length;var o=ct(r);return o==qe||o==Wt?r.size:Qa(r).length}a(yS,"size");function ES(r,o,d){var m=he(r)?Oa:uE;return d&&ht(r,o,d)&&(o=t),m(r,se(o,3))}a(ES,"some");var vS=ye(function(r,o){if(r==null)return[];var d=o.length;return d>1&&ht(r,o[0],o[1])?o=[]:d>2&&ht(o[0],o[1],o[2])&&(o=[o[0]]),sd(r,ot(o,1),[])}),zo=Jg||function(){return rt.Date.now()};function SS(r,o){if(typeof o!="function")throw new Dt(s);return r=fe(r),function(){if(--r<1)return o.apply(this,arguments)}}a(SS,"after");function eh(r,o,d){return o=d?t:o,o=r&&o==null?r.length:o,dn(r,z,t,t,t,t,o)}a(eh,"ary");function th(r,o){var d;if(typeof o!="function")throw new Dt(s);return r=fe(r),function(){return--r>0&&(d=o.apply(this,arguments)),r<=1&&(o=t),d}}a(th,"before");var wl=ye(function(r,o,d){var m=w;if(d.length){var E=Cn(d,Cr(wl));m|=A}return dn(r,m,o,d,E)}),nh=ye(function(r,o,d){var m=w|M;if(d.length){var E=Cn(d,Cr(nh));m|=A}return dn(o,m,r,d,E)});function rh(r,o,d){o=d?t:o;var m=dn(r,C,t,t,t,t,t,o);return m.placeholder=rh.placeholder,m}a(rh,"curry");function ih(r,o,d){o=d?t:o;var m=dn(r,N,t,t,t,t,t,o);return m.placeholder=ih.placeholder,m}a(ih,"curryRight");function oh(r,o,d){var m,E,b,x,I,L,F=0,P=!1,V=!1,K=!0;if(typeof r!="function")throw new Dt(s);o=Pt(o)||0,Ye(d)&&(P=!!d.leading,V="maxWait"in d,b=V?nt(Pt(d.maxWait)||0,o):b,K="trailing"in d?!!d.trailing:K);function re(Qe){var Ut=m,gn=E;return m=E=t,F=Qe,x=r.apply(gn,Ut),x}a(re,"invokeFunc");function ae(Qe){return F=Qe,I=xi(Ee,o),P?re(Qe):x}a(ae,"leadingEdge");function me(Qe){var Ut=Qe-L,gn=Qe-F,Th=o-Ut;return V?lt(Th,b-gn):Th}a(me,"remainingWait");function le(Qe){var Ut=Qe-L,gn=Qe-F;return L===t||Ut>=o||Ut<0||V&&gn>=b}a(le,"shouldInvoke");function Ee(){var Qe=zo();if(le(Qe))return be(Qe);I=xi(Ee,me(Qe))}a(Ee,"timerExpired");function be(Qe){return I=t,K&&m?re(Qe):(m=E=t,x)}a(be,"trailingEdge");function It(){I!==t&&pd(I),F=0,m=L=E=I=t}a(It,"cancel");function ft(){return I===t?x:be(zo())}a(ft,"flush");function At(){var Qe=zo(),Ut=le(Qe);if(m=arguments,E=this,L=Qe,Ut){if(I===t)return ae(L);if(V)return pd(I),I=xi(Ee,o),re(L)}return I===t&&(I=xi(Ee,o)),x}return a(At,"debounced"),At.cancel=It,At.flush=ft,At}a(oh,"debounce");var bS=ye(function(r,o){return Ku(r,1,o)}),wS=ye(function(r,o,d){return Ku(r,Pt(o)||0,d)});function MS(r){return dn(r,oe)}a(MS,"flip");function qo(r,o){if(typeof r!="function"||o!=null&&typeof o!="function")throw new Dt(s);var d=a(function(){var m=arguments,E=o?o.apply(this,m):m[0],b=d.cache;if(b.has(E))return b.get(E);var x=r.apply(this,m);return d.cache=b.set(E,x)||b,x},"memoized");return d.cache=new(qo.Cache||cn),d}a(qo,"memoize"),qo.Cache=cn;function Yo(r){if(typeof r!="function")throw new Dt(s);return function(){var o=arguments;switch(o.length){case 0:return!r.call(this);case 1:return!r.call(this,o[0]);case 2:return!r.call(this,o[0],o[1]);case 3:return!r.call(this,o[0],o[1],o[2])}return!r.apply(this,o)}}a(Yo,"negate");function TS(r){return th(2,r)}a(TS,"once");var xS=dE(function(r,o){o=o.length==1&&he(o[0])?Ve(o[0],Tt(se())):Ve(ot(o,1),Tt(se()));var d=o.length;return ye(function(m){for(var E=-1,b=lt(m.length,d);++E<b;)m[E]=o[E].call(this,m[E]);return Mt(r,this,m)})}),Ml=ye(function(r,o){var d=Cn(o,Cr(Ml));return dn(r,A,t,o,d)}),sh=ye(function(r,o){var d=Cn(o,Cr(sh));return dn(r,k,t,o,d)}),CS=hn(function(r,o){return dn(r,q,t,t,t,o)});function IS(r,o){if(typeof r!="function")throw new Dt(s);return o=o===t?o:fe(o),ye(r,o)}a(IS,"rest");function AS(r,o){if(typeof r!="function")throw new Dt(s);return o=o==null?0:nt(fe(o),0),ye(function(d){var m=d[o],E=Dn(d,0,o);return m&&xn(E,m),Mt(r,this,E)})}a(AS,"spread");function RS(r,o,d){var m=!0,E=!0;if(typeof r!="function")throw new Dt(s);return Ye(d)&&(m="leading"in d?!!d.leading:m,E="trailing"in d?!!d.trailing:E),oh(r,o,{leading:m,maxWait:o,trailing:E})}a(RS,"throttle");function LS(r){return eh(r,1)}a(LS,"unary");function NS(r,o){return Ml(al(o),r)}a(NS,"wrap");function DS(){if(!arguments.length)return[];var r=arguments[0];return he(r)?r:[r]}a(DS,"castArray");function _S(r){return Ot(r,g)}a(_S,"clone");function OS(r,o){return o=typeof o=="function"?o:t,Ot(r,g,o)}a(OS,"cloneWith");function kS(r){return Ot(r,f|g)}a(kS,"cloneDeep");function FS(r,o){return o=typeof o=="function"?o:t,Ot(r,f|g,o)}a(FS,"cloneDeepWith");function PS(r,o){return o==null||Yu(r,o,it(o))}a(PS,"conformsTo");function Gt(r,o){return r===o||r!==r&&o!==o}a(Gt,"eq");var HS=Wo(Xa),WS=Wo(function(r,o){return r>=o}),rr=Ju(function(){return arguments}())?Ju:function(r){return Xe(r)&&Le.call(r,"callee")&&!Wu.call(r,"callee")},he=D.isArray,VS=Su?Tt(Su):Ky;function vt(r){return r!=null&&Ko(r.length)&&!mn(r)}a(vt,"isArrayLike");function Ze(r){return Xe(r)&&vt(r)}a(Ze,"isArrayLikeObject");function BS(r){return r===!0||r===!1||Xe(r)&&dt(r)==Re}a(BS,"isBoolean");var _n=ty||Ol,GS=bu?Tt(bu):Xy;function US(r){return Xe(r)&&r.nodeType===1&&!Ci(r)}a(US,"isElement");function $S(r){if(r==null)return!0;if(vt(r)&&(he(r)||typeof r=="string"||typeof r.splice=="function"||_n(r)||Ir(r)||rr(r)))return!r.length;var o=ct(r);if(o==qe||o==Wt)return!r.size;if(Ti(r))return!Qa(r).length;for(var d in r)if(Le.call(r,d))return!1;return!0}a($S,"isEmpty");function zS(r,o){return bi(r,o)}a(zS,"isEqual");function qS(r,o,d){d=typeof d=="function"?d:t;var m=d?d(r,o):t;return m===t?bi(r,o,t,d):!!m}a(qS,"isEqualWith");function Tl(r){if(!Xe(r))return!1;var o=dt(r);return o==Yt||o==et||typeof r.message=="string"&&typeof r.name=="string"&&!Ci(r)}a(Tl,"isError");function YS(r){return typeof r=="number"&&Bu(r)}a(YS,"isFinite");function mn(r){if(!Ye(r))return!1;var o=dt(r);return o==an||o==xe||o==Te||o==ai}a(mn,"isFunction");function ah(r){return typeof r=="number"&&r==fe(r)}a(ah,"isInteger");function Ko(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ne}a(Ko,"isLength");function Ye(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}a(Ye,"isObject");function Xe(r){return r!=null&&typeof r=="object"}a(Xe,"isObjectLike");var lh=wu?Tt(wu):Zy;function KS(r,o){return r===o||Za(r,o,ml(o))}a(KS,"isMatch");function XS(r,o,d){return d=typeof d=="function"?d:t,Za(r,o,ml(o),d)}a(XS,"isMatchWith");function jS(r){return ch(r)&&r!=+r}a(jS,"isNaN");function ZS(r){if(OE(r))throw new ue(i);return ed(r)}a(ZS,"isNative");function QS(r){return r===null}a(QS,"isNull");function JS(r){return r==null}a(JS,"isNil");function ch(r){return typeof r=="number"||Xe(r)&&dt(r)==De}a(ch,"isNumber");function Ci(r){if(!Xe(r)||dt(r)!=Je)return!1;var o=bo(r);if(o===null)return!0;var d=Le.call(o,"constructor")&&o.constructor;return typeof d=="function"&&d instanceof d&&yo.call(d)==Xg}a(Ci,"isPlainObject");var xl=Mu?Tt(Mu):Qy;function eb(r){return ah(r)&&r>=-ne&&r<=ne}a(eb,"isSafeInteger");var uh=Tu?Tt(Tu):Jy;function Xo(r){return typeof r=="string"||!he(r)&&Xe(r)&&dt(r)==ci}a(Xo,"isString");function Ct(r){return typeof r=="symbol"||Xe(r)&&dt(r)==ao}a(Ct,"isSymbol");var Ir=xu?Tt(xu):eE;function tb(r){return r===t}a(tb,"isUndefined");function nb(r){return Xe(r)&&ct(r)==ui}a(nb,"isWeakMap");function rb(r){return Xe(r)&&dt(r)==vp}a(rb,"isWeakSet");var ib=Wo(Ja),ob=Wo(function(r,o){return r<=o});function dh(r){if(!r)return[];if(vt(r))return Xo(r)?Vt(r):Et(r);if(fi&&r[fi])return Pg(r[fi]());var o=ct(r),d=o==qe?Va:o==Wt?mo:Ar;return d(r)}a(dh,"toArray");function pn(r){if(!r)return r===0?r:0;if(r=Pt(r),r===Q||r===-Q){var o=r<0?-1:1;return o*Ne}return r===r?r:0}a(pn,"toFinite");function fe(r){var o=pn(r),d=o%1;return o===o?d?o-d:o:0}a(fe,"toInteger");function hh(r){return r?Jn(fe(r),0,$e):0}a(hh,"toLength");function Pt(r){if(typeof r=="number")return r;if(Ct(r))return Ue;if(Ye(r)){var o=typeof r.valueOf=="function"?r.valueOf():r;r=Ye(o)?o+"":o}if(typeof r!="string")return r===0?r:+r;r=Nu(r);var d=Vp.test(r);return d||Gp.test(r)?Sg(r.slice(2),d?2:8):Wp.test(r)?Ue:+r}a(Pt,"toNumber");function fh(r){return Xt(r,St(r))}a(fh,"toPlainObject");function sb(r){return r?Jn(fe(r),-ne,ne):r===0?r:0}a(sb,"toSafeInteger");function Ae(r){return r==null?"":xt(r)}a(Ae,"toString");var ab=Tr(function(r,o){if(Ti(o)||vt(o)){Xt(o,it(o),r);return}for(var d in o)Le.call(o,d)&&Ei(r,d,o[d])}),mh=Tr(function(r,o){Xt(o,St(o),r)}),jo=Tr(function(r,o,d,m){Xt(o,St(o),r,m)}),lb=Tr(function(r,o,d,m){Xt(o,it(o),r,m)}),cb=hn(qa);function ub(r,o){var d=Mr(r);return o==null?d:qu(d,o)}a(ub,"create");var db=ye(function(r,o){r=_e(r);var d=-1,m=o.length,E=m>2?o[2]:t;for(E&&ht(o[0],o[1],E)&&(m=1);++d<m;)for(var b=o[d],x=St(b),I=-1,L=x.length;++I<L;){var F=x[I],P=r[F];(P===t||Gt(P,Sr[F])&&!Le.call(r,F))&&(r[F]=b[F])}return r}),hb=ye(function(r){return r.push(t,Nd),Mt(ph,t,r)});function fb(r,o){return Iu(r,se(o,3),Kt)}a(fb,"findKey");function mb(r,o){return Iu(r,se(o,3),Ka)}a(mb,"findLastKey");function pb(r,o){return r==null?r:Ya(r,se(o,3),St)}a(pb,"forIn");function gb(r,o){return r==null?r:Zu(r,se(o,3),St)}a(gb,"forInRight");function yb(r,o){return r&&Kt(r,se(o,3))}a(yb,"forOwn");function Eb(r,o){return r&&Ka(r,se(o,3))}a(Eb,"forOwnRight");function vb(r){return r==null?[]:No(r,it(r))}a(vb,"functions");function Sb(r){return r==null?[]:No(r,St(r))}a(Sb,"functionsIn");function Cl(r,o,d){var m=r==null?t:er(r,o);return m===t?d:m}a(Cl,"get");function bb(r,o){return r!=null&&Od(r,o,$y)}a(bb,"has");function Il(r,o){return r!=null&&Od(r,o,zy)}a(Il,"hasIn");var wb=Cd(function(r,o,d){o!=null&&typeof o.toString!="function"&&(o=Eo.call(o)),r[o]=d},Rl(bt)),Mb=Cd(function(r,o,d){o!=null&&typeof o.toString!="function"&&(o=Eo.call(o)),Le.call(r,o)?r[o].push(d):r[o]=[d]},se),Tb=ye(Si);function it(r){return vt(r)?$u(r):Qa(r)}a(it,"keys");function St(r){return vt(r)?$u(r,!0):tE(r)}a(St,"keysIn");function xb(r,o){var d={};return o=se(o,3),Kt(r,function(m,E,b){un(d,o(m,E,b),m)}),d}a(xb,"mapKeys");function Cb(r,o){var d={};return o=se(o,3),Kt(r,function(m,E,b){un(d,E,o(m,E,b))}),d}a(Cb,"mapValues");var Ib=Tr(function(r,o,d){Do(r,o,d)}),ph=Tr(function(r,o,d,m){Do(r,o,d,m)}),Ab=hn(function(r,o){var d={};if(r==null)return d;var m=!1;o=Ve(o,function(b){return b=Nn(b,r),m||(m=b.length>1),b}),Xt(r,hl(r),d),m&&(d=Ot(d,f|p|g,wE));for(var E=o.length;E--;)il(d,o[E]);return d});function Rb(r,o){return gh(r,Yo(se(o)))}a(Rb,"omitBy");var Lb=hn(function(r,o){return r==null?{}:rE(r,o)});function gh(r,o){if(r==null)return{};var d=Ve(hl(r),function(m){return[m]});return o=se(o),ad(r,d,function(m,E){return o(m,E[0])})}a(gh,"pickBy");function Nb(r,o,d){o=Nn(o,r);var m=-1,E=o.length;for(E||(E=1,r=t);++m<E;){var b=r==null?t:r[jt(o[m])];b===t&&(m=E,b=d),r=mn(b)?b.call(r):b}return r}a(Nb,"result");function Db(r,o,d){return r==null?r:wi(r,o,d)}a(Db,"set");function _b(r,o,d,m){return m=typeof m=="function"?m:t,r==null?r:wi(r,o,d,m)}a(_b,"setWith");var yh=Rd(it),Eh=Rd(St);function Ob(r,o,d){var m=he(r),E=m||_n(r)||Ir(r);if(o=se(o,4),d==null){var b=r&&r.constructor;E?d=m?new b:[]:Ye(r)?d=mn(b)?Mr(bo(r)):{}:d={}}return(E?Nt:Kt)(r,function(x,I,L){return o(d,x,I,L)}),d}a(Ob,"transform");function kb(r,o){return r==null?!0:il(r,o)}a(kb,"unset");function Fb(r,o,d){return r==null?r:hd(r,o,al(d))}a(Fb,"update");function Pb(r,o,d,m){return m=typeof m=="function"?m:t,r==null?r:hd(r,o,al(d),m)}a(Pb,"updateWith");function Ar(r){return r==null?[]:Wa(r,it(r))}a(Ar,"values");function Hb(r){return r==null?[]:Wa(r,St(r))}a(Hb,"valuesIn");function Wb(r,o,d){return d===t&&(d=o,o=t),d!==t&&(d=Pt(d),d=d===d?d:0),o!==t&&(o=Pt(o),o=o===o?o:0),Jn(Pt(r),o,d)}a(Wb,"clamp");function Vb(r,o,d){return o=pn(o),d===t?(d=o,o=0):d=pn(d),r=Pt(r),qy(r,o,d)}a(Vb,"inRange");function Bb(r,o,d){if(d&&typeof d!="boolean"&&ht(r,o,d)&&(o=d=t),d===t&&(typeof o=="boolean"?(d=o,o=t):typeof r=="boolean"&&(d=r,r=t)),r===t&&o===t?(r=0,o=1):(r=pn(r),o===t?(o=r,r=0):o=pn(o)),r>o){var m=r;r=o,o=m}if(d||r%1||o%1){var E=Gu();return lt(r+E*(o-r+vg("1e-"+((E+"").length-1))),o)}return tl(r,o)}a(Bb,"random");var Gb=xr(function(r,o,d){return o=o.toLowerCase(),r+(d?vh(o):o)});function vh(r){return Al(Ae(r).toLowerCase())}a(vh,"capitalize");function Sh(r){return r=Ae(r),r&&r.replace($p,Dg).replace(cg,"")}a(Sh,"deburr");function Ub(r,o,d){r=Ae(r),o=xt(o);var m=r.length;d=d===t?m:Jn(fe(d),0,m);var E=d;return d-=o.length,d>=0&&r.slice(d,E)==o}a(Ub,"endsWith");function $b(r){return r=Ae(r),r&&Tp.test(r)?r.replace(Zc,_g):r}a($b,"escape");function zb(r){return r=Ae(r),r&&Lp.test(r)?r.replace(Ma,"\\$&"):r}a(zb,"escapeRegExp");var qb=xr(function(r,o,d){return r+(d?"-":"")+o.toLowerCase()}),Yb=xr(function(r,o,d){return r+(d?" ":"")+o.toLowerCase()}),Kb=Md("toLowerCase");function Xb(r,o,d){r=Ae(r),o=fe(o);var m=o?vr(r):0;if(!o||m>=o)return r;var E=(o-m)/2;return Ho(xo(E),d)+r+Ho(To(E),d)}a(Xb,"pad");function jb(r,o,d){r=Ae(r),o=fe(o);var m=o?vr(r):0;return o&&m<o?r+Ho(o-m,d):r}a(jb,"padEnd");function Zb(r,o,d){r=Ae(r),o=fe(o);var m=o?vr(r):0;return o&&m<o?Ho(o-m,d)+r:r}a(Zb,"padStart");function Qb(r,o,d){return d||o==null?o=0:o&&(o=+o),oy(Ae(r).replace(Ta,""),o||0)}a(Qb,"parseInt");function Jb(r,o,d){return(d?ht(r,o,d):o===t)?o=1:o=fe(o),nl(Ae(r),o)}a(Jb,"repeat");function ew(){var r=arguments,o=Ae(r[0]);return r.length<3?o:o.replace(r[1],r[2])}a(ew,"replace");var tw=xr(function(r,o,d){return r+(d?"_":"")+o.toLowerCase()});function nw(r,o,d){return d&&typeof d!="number"&&ht(r,o,d)&&(o=d=t),d=d===t?$e:d>>>0,d?(r=Ae(r),r&&(typeof o=="string"||o!=null&&!xl(o))&&(o=xt(o),!o&&Er(r))?Dn(Vt(r),0,d):r.split(o,d)):[]}a(nw,"split");var rw=xr(function(r,o,d){return r+(d?" ":"")+Al(o)});function iw(r,o,d){return r=Ae(r),d=d==null?0:Jn(fe(d),0,r.length),o=xt(o),r.slice(d,d+o.length)==o}a(iw,"startsWith");function ow(r,o,d){var m=v.templateSettings;d&&ht(r,o,d)&&(o=t),r=Ae(r),o=jo({},o,m,Ld);var E=jo({},o.imports,m.imports,Ld),b=it(E),x=Wa(E,b),I,L,F=0,P=o.interpolate||lo,V="__p += '",K=Ba((o.escape||lo).source+"|"+P.source+"|"+(P===Qc?Hp:lo).source+"|"+(o.evaluate||lo).source+"|$","g"),re="//# sourceURL="+(Le.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++mg+"]")+`
`;r.replace(K,function(le,Ee,be,It,ft,At){return be||(be=It),V+=r.slice(F,At).replace(zp,Og),Ee&&(I=!0,V+=`' +
__e(`+Ee+`) +
'`),ft&&(L=!0,V+=`';
`+ft+`;
__p += '`),be&&(V+=`' +
((__t = (`+be+`)) == null ? '' : __t) +
'`),F=At+le.length,le}),V+=`';
`;var ae=Le.call(o,"variable")&&o.variable;if(!ae)V=`with (obj) {
`+V+`
}
`;else if(Fp.test(ae))throw new ue(l);V=(L?V.replace(Sp,""):V).replace(bp,"$1").replace(wp,"$1;"),V="function("+(ae||"obj")+`) {
`+(ae?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+V+`return __p
}`;var me=wh(function(){return Ce(b,re+"return "+V).apply(t,x)});if(me.source=V,Tl(me))throw me;return me}a(ow,"template");function sw(r){return Ae(r).toLowerCase()}a(sw,"toLower");function aw(r){return Ae(r).toUpperCase()}a(aw,"toUpper");function lw(r,o,d){if(r=Ae(r),r&&(d||o===t))return Nu(r);if(!r||!(o=xt(o)))return r;var m=Vt(r),E=Vt(o),b=Du(m,E),x=_u(m,E)+1;return Dn(m,b,x).join("")}a(lw,"trim");function cw(r,o,d){if(r=Ae(r),r&&(d||o===t))return r.slice(0,ku(r)+1);if(!r||!(o=xt(o)))return r;var m=Vt(r),E=_u(m,Vt(o))+1;return Dn(m,0,E).join("")}a(cw,"trimEnd");function uw(r,o,d){if(r=Ae(r),r&&(d||o===t))return r.replace(Ta,"");if(!r||!(o=xt(o)))return r;var m=Vt(r),E=Du(m,Vt(o));return Dn(m,E).join("")}a(uw,"trimStart");function dw(r,o){var d=$,m=Z;if(Ye(o)){var E="separator"in o?o.separator:E;d="length"in o?fe(o.length):d,m="omission"in o?xt(o.omission):m}r=Ae(r);var b=r.length;if(Er(r)){var x=Vt(r);b=x.length}if(d>=b)return r;var I=d-vr(m);if(I<1)return m;var L=x?Dn(x,0,I).join(""):r.slice(0,I);if(E===t)return L+m;if(x&&(I+=L.length-I),xl(E)){if(r.slice(I).search(E)){var F,P=L;for(E.global||(E=Ba(E.source,Ae(Jc.exec(E))+"g")),E.lastIndex=0;F=E.exec(P);)var V=F.index;L=L.slice(0,V===t?I:V)}}else if(r.indexOf(xt(E),I)!=I){var K=L.lastIndexOf(E);K>-1&&(L=L.slice(0,K))}return L+m}a(dw,"truncate");function hw(r){return r=Ae(r),r&&Mp.test(r)?r.replace(jc,Bg):r}a(hw,"unescape");var fw=xr(function(r,o,d){return r+(d?" ":"")+o.toUpperCase()}),Al=Md("toUpperCase");function bh(r,o,d){return r=Ae(r),o=d?t:o,o===t?Fg(r)?$g(r):Ig(r):r.match(o)||[]}a(bh,"words");var wh=ye(function(r,o){try{return Mt(r,t,o)}catch(d){return Tl(d)?d:new ue(d)}}),mw=hn(function(r,o){return Nt(o,function(d){d=jt(d),un(r,d,wl(r[d],r))}),r});function pw(r){var o=r==null?0:r.length,d=se();return r=o?Ve(r,function(m){if(typeof m[1]!="function")throw new Dt(s);return[d(m[0]),m[1]]}):[],ye(function(m){for(var E=-1;++E<o;){var b=r[E];if(Mt(b[0],this,m))return Mt(b[1],this,m)}})}a(pw,"cond");function gw(r){return By(Ot(r,f))}a(gw,"conforms");function Rl(r){return function(){return r}}a(Rl,"constant");function yw(r,o){return r==null||r!==r?o:r}a(yw,"defaultTo");var Ew=xd(),vw=xd(!0);function bt(r){return r}a(bt,"identity");function Ll(r){return td(typeof r=="function"?r:Ot(r,f))}a(Ll,"iteratee");function Sw(r){return rd(Ot(r,f))}a(Sw,"matches");function bw(r,o){return id(r,Ot(o,f))}a(bw,"matchesProperty");var ww=ye(function(r,o){return function(d){return Si(d,r,o)}}),Mw=ye(function(r,o){return function(d){return Si(r,d,o)}});function Nl(r,o,d){var m=it(o),E=No(o,m);d==null&&!(Ye(o)&&(E.length||!m.length))&&(d=o,o=r,r=this,E=No(o,it(o)));var b=!(Ye(d)&&"chain"in d)||!!d.chain,x=mn(r);return Nt(E,function(I){var L=o[I];r[I]=L,x&&(r.prototype[I]=function(){var F=this.__chain__;if(b||F){var P=r(this.__wrapped__),V=P.__actions__=Et(this.__actions__);return V.push({func:L,args:arguments,thisArg:r}),P.__chain__=F,P}return L.apply(r,xn([this.value()],arguments))})}),r}a(Nl,"mixin");function Tw(){return rt._===this&&(rt._=jg),this}a(Tw,"noConflict");function Dl(){}a(Dl,"noop");function xw(r){return r=fe(r),ye(function(o){return od(o,r)})}a(xw,"nthArg");var Cw=cl(Ve),Iw=cl(Cu),Aw=cl(Oa);function Mh(r){return gl(r)?ka(jt(r)):iE(r)}a(Mh,"property");function Rw(r){return function(o){return r==null?t:er(r,o)}}a(Rw,"propertyOf");var Lw=Id(),Nw=Id(!0);function _l(){return[]}a(_l,"stubArray");function Ol(){return!1}a(Ol,"stubFalse");function Dw(){return{}}a(Dw,"stubObject");function _w(){return""}a(_w,"stubString");function Ow(){return!0}a(Ow,"stubTrue");function kw(r,o){if(r=fe(r),r<1||r>ne)return[];var d=$e,m=lt(r,$e);o=se(o),r-=$e;for(var E=Ha(m,o);++d<r;)o(d);return E}a(kw,"times");function Fw(r){return he(r)?Ve(r,jt):Ct(r)?[r]:Et(Ud(Ae(r)))}a(Fw,"toPath");function Pw(r){var o=++Kg;return Ae(r)+o}a(Pw,"uniqueId");var Hw=Po(function(r,o){return r+o},0),Ww=ul("ceil"),Vw=Po(function(r,o){return r/o},1),Bw=ul("floor");function Gw(r){return r&&r.length?Lo(r,bt,Xa):t}a(Gw,"max");function Uw(r,o){return r&&r.length?Lo(r,se(o,2),Xa):t}a(Uw,"maxBy");function $w(r){return Ru(r,bt)}a($w,"mean");function zw(r,o){return Ru(r,se(o,2))}a(zw,"meanBy");function qw(r){return r&&r.length?Lo(r,bt,Ja):t}a(qw,"min");function Yw(r,o){return r&&r.length?Lo(r,se(o,2),Ja):t}a(Yw,"minBy");var Kw=Po(function(r,o){return r*o},1),Xw=ul("round"),jw=Po(function(r,o){return r-o},0);function Zw(r){return r&&r.length?Pa(r,bt):0}a(Zw,"sum");function Qw(r,o){return r&&r.length?Pa(r,se(o,2)):0}return a(Qw,"sumBy"),v.after=SS,v.ary=eh,v.assign=ab,v.assignIn=mh,v.assignInWith=jo,v.assignWith=lb,v.at=cb,v.before=th,v.bind=wl,v.bindAll=mw,v.bindKey=nh,v.castArray=DS,v.chain=Zd,v.chunk=BE,v.compact=GE,v.concat=UE,v.cond=pw,v.conforms=gw,v.constant=Rl,v.countBy=Zv,v.create=ub,v.curry=rh,v.curryRight=ih,v.debounce=oh,v.defaults=db,v.defaultsDeep=hb,v.defer=bS,v.delay=wS,v.difference=$E,v.differenceBy=zE,v.differenceWith=qE,v.drop=YE,v.dropRight=KE,v.dropRightWhile=XE,v.dropWhile=jE,v.fill=ZE,v.filter=Jv,v.flatMap=nS,v.flatMapDeep=rS,v.flatMapDepth=iS,v.flatten=Yd,v.flattenDeep=QE,v.flattenDepth=JE,v.flip=MS,v.flow=Ew,v.flowRight=vw,v.fromPairs=ev,v.functions=vb,v.functionsIn=Sb,v.groupBy=oS,v.initial=nv,v.intersection=rv,v.intersectionBy=iv,v.intersectionWith=ov,v.invert=wb,v.invertBy=Mb,v.invokeMap=aS,v.iteratee=Ll,v.keyBy=lS,v.keys=it,v.keysIn=St,v.map=$o,v.mapKeys=xb,v.mapValues=Cb,v.matches=Sw,v.matchesProperty=bw,v.memoize=qo,v.merge=Ib,v.mergeWith=ph,v.method=ww,v.methodOf=Mw,v.mixin=Nl,v.negate=Yo,v.nthArg=xw,v.omit=Ab,v.omitBy=Rb,v.once=TS,v.orderBy=cS,v.over=Cw,v.overArgs=xS,v.overEvery=Iw,v.overSome=Aw,v.partial=Ml,v.partialRight=sh,v.partition=uS,v.pick=Lb,v.pickBy=gh,v.property=Mh,v.propertyOf=Rw,v.pull=cv,v.pullAll=Xd,v.pullAllBy=uv,v.pullAllWith=dv,v.pullAt=hv,v.range=Lw,v.rangeRight=Nw,v.rearg=CS,v.reject=fS,v.remove=fv,v.rest=IS,v.reverse=Sl,v.sampleSize=pS,v.set=Db,v.setWith=_b,v.shuffle=gS,v.slice=mv,v.sortBy=vS,v.sortedUniq=bv,v.sortedUniqBy=wv,v.split=nw,v.spread=AS,v.tail=Mv,v.take=Tv,v.takeRight=xv,v.takeRightWhile=Cv,v.takeWhile=Iv,v.tap=Gv,v.throttle=RS,v.thru=Uo,v.toArray=dh,v.toPairs=yh,v.toPairsIn=Eh,v.toPath=Fw,v.toPlainObject=fh,v.transform=Ob,v.unary=LS,v.union=Av,v.unionBy=Rv,v.unionWith=Lv,v.uniq=Nv,v.uniqBy=Dv,v.uniqWith=_v,v.unset=kb,v.unzip=bl,v.unzipWith=jd,v.update=Fb,v.updateWith=Pb,v.values=Ar,v.valuesIn=Hb,v.without=Ov,v.words=bh,v.wrap=NS,v.xor=kv,v.xorBy=Fv,v.xorWith=Pv,v.zip=Hv,v.zipObject=Wv,v.zipObjectDeep=Vv,v.zipWith=Bv,v.entries=yh,v.entriesIn=Eh,v.extend=mh,v.extendWith=jo,Nl(v,v),v.add=Hw,v.attempt=wh,v.camelCase=Gb,v.capitalize=vh,v.ceil=Ww,v.clamp=Wb,v.clone=_S,v.cloneDeep=kS,v.cloneDeepWith=FS,v.cloneWith=OS,v.conformsTo=PS,v.deburr=Sh,v.defaultTo=yw,v.divide=Vw,v.endsWith=Ub,v.eq=Gt,v.escape=$b,v.escapeRegExp=zb,v.every=Qv,v.find=eS,v.findIndex=zd,v.findKey=fb,v.findLast=tS,v.findLastIndex=qd,v.findLastKey=mb,v.floor=Bw,v.forEach=Qd,v.forEachRight=Jd,v.forIn=pb,v.forInRight=gb,v.forOwn=yb,v.forOwnRight=Eb,v.get=Cl,v.gt=HS,v.gte=WS,v.has=bb,v.hasIn=Il,v.head=Kd,v.identity=bt,v.includes=sS,v.indexOf=tv,v.inRange=Vb,v.invoke=Tb,v.isArguments=rr,v.isArray=he,v.isArrayBuffer=VS,v.isArrayLike=vt,v.isArrayLikeObject=Ze,v.isBoolean=BS,v.isBuffer=_n,v.isDate=GS,v.isElement=US,v.isEmpty=$S,v.isEqual=zS,v.isEqualWith=qS,v.isError=Tl,v.isFinite=YS,v.isFunction=mn,v.isInteger=ah,v.isLength=Ko,v.isMap=lh,v.isMatch=KS,v.isMatchWith=XS,v.isNaN=jS,v.isNative=ZS,v.isNil=JS,v.isNull=QS,v.isNumber=ch,v.isObject=Ye,v.isObjectLike=Xe,v.isPlainObject=Ci,v.isRegExp=xl,v.isSafeInteger=eb,v.isSet=uh,v.isString=Xo,v.isSymbol=Ct,v.isTypedArray=Ir,v.isUndefined=tb,v.isWeakMap=nb,v.isWeakSet=rb,v.join=sv,v.kebabCase=qb,v.last=Ft,v.lastIndexOf=av,v.lowerCase=Yb,v.lowerFirst=Kb,v.lt=ib,v.lte=ob,v.max=Gw,v.maxBy=Uw,v.mean=$w,v.meanBy=zw,v.min=qw,v.minBy=Yw,v.stubArray=_l,v.stubFalse=Ol,v.stubObject=Dw,v.stubString=_w,v.stubTrue=Ow,v.multiply=Kw,v.nth=lv,v.noConflict=Tw,v.noop=Dl,v.now=zo,v.pad=Xb,v.padEnd=jb,v.padStart=Zb,v.parseInt=Qb,v.random=Bb,v.reduce=dS,v.reduceRight=hS,v.repeat=Jb,v.replace=ew,v.result=Nb,v.round=Xw,v.runInContext=R,v.sample=mS,v.size=yS,v.snakeCase=tw,v.some=ES,v.sortedIndex=pv,v.sortedIndexBy=gv,v.sortedIndexOf=yv,v.sortedLastIndex=Ev,v.sortedLastIndexBy=vv,v.sortedLastIndexOf=Sv,v.startCase=rw,v.startsWith=iw,v.subtract=jw,v.sum=Zw,v.sumBy=Qw,v.template=ow,v.times=kw,v.toFinite=pn,v.toInteger=fe,v.toLength=hh,v.toLower=sw,v.toNumber=Pt,v.toSafeInteger=sb,v.toString=Ae,v.toUpper=aw,v.trim=lw,v.trimEnd=cw,v.trimStart=uw,v.truncate=dw,v.unescape=hw,v.uniqueId=Pw,v.upperCase=fw,v.upperFirst=Al,v.each=Qd,v.eachRight=Jd,v.first=Kd,Nl(v,function(){var r={};return Kt(v,function(o,d){Le.call(v.prototype,d)||(r[d]=o)}),r}(),{chain:!1}),v.VERSION=e,Nt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),Nt(["drop","take"],function(r,o){ve.prototype[r]=function(d){d=d===t?1:nt(fe(d),0);var m=this.__filtered__&&!o?new ve(this):this.clone();return m.__filtered__?m.__takeCount__=lt(d,m.__takeCount__):m.__views__.push({size:lt(d,$e),type:r+(m.__dir__<0?"Right":"")}),m},ve.prototype[r+"Right"]=function(d){return this.reverse()[r](d).reverse()}}),Nt(["filter","map","takeWhile"],function(r,o){var d=o+1,m=d==B||d==j;ve.prototype[r]=function(E){var b=this.clone();return b.__iteratees__.push({iteratee:se(E,3),type:d}),b.__filtered__=b.__filtered__||m,b}}),Nt(["head","last"],function(r,o){var d="take"+(o?"Right":"");ve.prototype[r]=function(){return this[d](1).value()[0]}}),Nt(["initial","tail"],function(r,o){var d="drop"+(o?"":"Right");ve.prototype[r]=function(){return this.__filtered__?new ve(this):this[d](1)}}),ve.prototype.compact=function(){return this.filter(bt)},ve.prototype.find=function(r){return this.filter(r).head()},ve.prototype.findLast=function(r){return this.reverse().find(r)},ve.prototype.invokeMap=ye(function(r,o){return typeof r=="function"?new ve(this):this.map(function(d){return Si(d,r,o)})}),ve.prototype.reject=function(r){return this.filter(Yo(se(r)))},ve.prototype.slice=function(r,o){r=fe(r);var d=this;return d.__filtered__&&(r>0||o<0)?new ve(d):(r<0?d=d.takeRight(-r):r&&(d=d.drop(r)),o!==t&&(o=fe(o),d=o<0?d.dropRight(-o):d.take(o-r)),d)},ve.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ve.prototype.toArray=function(){return this.take($e)},Kt(ve.prototype,function(r,o){var d=/^(?:filter|find|map|reject)|While$/.test(o),m=/^(?:head|last)$/.test(o),E=v[m?"take"+(o=="last"?"Right":""):o],b=m||/^find/.test(o);E&&(v.prototype[o]=function(){var x=this.__wrapped__,I=m?[1]:arguments,L=x instanceof ve,F=I[0],P=L||he(x),V=a(function(Ee){var be=E.apply(v,xn([Ee],I));return m&&K?be[0]:be},"interceptor");P&&d&&typeof F=="function"&&F.length!=1&&(L=P=!1);var K=this.__chain__,re=!!this.__actions__.length,ae=b&&!K,me=L&&!re;if(!b&&P){x=me?x:new ve(this);var le=r.apply(x,I);return le.__actions__.push({func:Uo,args:[V],thisArg:t}),new _t(le,K)}return ae&&me?r.apply(this,I):(le=this.thru(V),ae?m?le.value()[0]:le.value():le)})}),Nt(["pop","push","shift","sort","splice","unshift"],function(r){var o=po[r],d=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",m=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var E=arguments;if(m&&!this.__chain__){var b=this.value();return o.apply(he(b)?b:[],E)}return this[d](function(x){return o.apply(he(x)?x:[],E)})}}),Kt(ve.prototype,function(r,o){var d=v[o];if(d){var m=d.name+"";Le.call(wr,m)||(wr[m]=[]),wr[m].push({name:o,func:d})}}),wr[Fo(t,M).name]=[{name:"wrapper",func:t}],ve.prototype.clone=hy,ve.prototype.reverse=fy,ve.prototype.value=my,v.prototype.at=Uv,v.prototype.chain=$v,v.prototype.commit=zv,v.prototype.next=qv,v.prototype.plant=Kv,v.prototype.reverse=Xv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=jv,v.prototype.first=v.prototype.head,fi&&(v.prototype[fi]=Yv),v},"runInContext"),In=zg();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(rt._=In,define(function(){return In})):Xn?((Xn.exports=In)._=In,La._=In):rt._=In}).call(Qr)});var wm=Zo(dr=>{var Ws=bm();function Zi(t){return t.reduce(function(e,n,i,s){return e+n})}a(Zi,"sum");function nn(t){if(Ws.isArray(t))return t;if(typeof t=="string")return t.split("");throw Error("Parameter must be a string or array.")}a(nn,"ensureArr");dr.jarowinkler=function(t,e,q){t=nn(t),e=nn(e);var i,s;t.length>e.length?(i=t,s=e):(i=e,s=t);var l=q||.7,c=.1,u=Math.floor(Math.max(i.length/2-1,0)),h=[],f=[],p,g,y,S,w=0;for(p=0;p<s.length;p++)for(S=s[p],g=Math.max(p-u,0),y=Math.min(p+u+1,i.length);g<y;g++)if(!f[g]&&S===i[g]){h[p]=g,f[g]=!0,w++;break}var M=[],T=[],C,N,A=0,k=0;for(C=0,N=0;C<s.length;C++)h[C]>-1&&(M[N]=s[C],N++);for(C=0,N=0;C<i.length;C++)f[C]&&(T[N]=i[C],N++);for(p=0;p<M.length;p++)M[p]!==T[p]&&A++;for(p=0;p<s.length&&t[p]===e[p];p++)k++;var z=w,q=A/2;if(z){var oe=(z/t.length+z/e.length+(z-q)/z)/3,$=oe<l?oe:oe+Math.min(c,1/i.length)*k*(1-oe);return $}else return 0};dr.levenshtein=function(t,e,n){if(t=nn(t),e=nn(e),t.length===0)return e.length;if(e.length===0)return t.length;var i=n||{d:1,i:1,s:1},s=[],l=[],c=e.length+1,u,h,f,p;for(u=0;u<c;u++)s[u]=u;for(u=0;u<t.length;u++){for(l[0]=u+1,h=0;h<e.length;h++)f=t[u]===e[h]?0:i.s,l[h+1]=Math.min(l[h]+i.d,s[h+1]+i.i,s[h]+f);for(h=0;h<c;h++)s[h]=l[h]}return p=Math.max(t.length,e.length),(p-l[e.length])/p};dr.ngram=function(t,e,n){t=nn(t),e=nn(e);var i=t.length,s=e.length,l=n||2,c,u,h,f,p,g,y,S=[],w=[],M=[],T=[],C=[],N=i+1;if(i===0||s===0)return i===s?1:0;if(c=0,i<l||s<l){for(u=0,f=Math.min(i,s);u<f;u++)t[u]===e[u]&&c++;return c/Math.max(i,s)}for(u=0;u<i+l-1;u++)u<l-1?S[u]=0:S[u]=t[u-l+1];for(u=0;u<=i;u++)w[u]=u;for(h=1;h<=s;h++){if(h<l){for(p=0;p<l-h;p++)C[p]=0;for(p=l-h;p<l;p++)C[p]=e[p-(l-h)]}else C=e.slice(h-l,h);for(M[0]=h,u=1;u<=i;u++){for(c=0,g=l,f=0;f<l;f++)S[u-1+f]!==C[f]?c++:S[u-1+f]===0&&g--;y=c/g,M[u]=Math.min(Math.min(M[u-1]+1,w[u]+1),w[u-1]+y)}T=w,w=M,M=T}return 1-w[i]/Math.max(i,s)};dr.pearson=function(t,e){var n=[];Object.keys(t).forEach(function(g){e[g]&&n.push(g)});var i=n.length;if(i===0)return 0;var s=Zi(n.map(function(g){return t[g]})),l=Zi(n.map(function(g){return e[g]})),c=Zi(n.map(function(g){return Math.pow(t[g],2)})),u=Zi(n.map(function(g){return Math.pow(e[g],2)})),h=Zi(n.map(function(g){return t[g]*e[g]})),f=h-s*l/i,p=Math.sqrt((c-Math.pow(s,2)/i)*(u-Math.pow(l,2)/i));return p===0?0:f/p};dr.jaccard=function(t,e){return t=nn(t),e=nn(e),Ws.intersection(t,e).length/Ws.union(t,e).length};dr.tanimoto=function(t,e){t=nn(t),e=nn(e);var n=Ws.intersection(t,e).length;return n/(t.length+e.length-n)}});var xh={examinedAttributes:["class","src","placeholder","href","checked","disabled","contenteditable","draggable","hidden","inputmode","role","title","name","type","readonly","size","required","multiple","min","max","step","maxlength","alt","loop","controls","poster"]};var Lr={attributesToExtract:xh.examinedAttributes,structuralVicinity:{type:"fixed",value:6,useDecayingLimit:!0},visualVicinity:{radius:50,scanStep:10},vicinityFeatureElementsOnly:!0,react:{}};var Ii=(s=>(s[s.Query=0]="Query",s[s.Intersection=1]="Intersection",s[s.Interactables=2]="Interactables",s[s.All=3]="All",s))(Ii||{});var Qo={rect:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"]},Nr=class{constructor(e){this.document=e;this.limit=5;this.extractSVG=a(e=>Array.from(e.children).map(n=>{let i=Qo[n.tagName.toLowerCase()];if(!i)return null;let s=i.reduce((c,u)=>{let h=n.getAttribute(u);return{...c,[u]:h}},{});return{tagName:n.tagName.toLowerCase(),attributes:s}}).filter(n=>!!n),"extractSVG")}static{a(this,"SVGsExtractor")}extract(e){let n=e.matches("svg")?[e]:e.querySelectorAll("svg");if(!(!n.length||n.length>this.limit))return Array.from(n).map(this.extractSVG)}};function Ai(t){if(!t)return!1;let e=t.getBoundingClientRect();return e.top<=window.innerHeight&&e.left<=window.innerWidth&&e.bottom>=0&&e.right>=0}a(Ai,"isElementInViewport");function Jo(t,e=!0){let n=window.getComputedStyle(t),i=n.opacity==="0";return{visible:n.visibility!=="hidden"&&n.display!=="none"&&(!e||!i),isTransparent:i}}a(Jo,"isElementVisibleByStyles");function Ch(t,e,n=!0,i=!0){let s=t.getBoundingClientRect(),l=e.getBoundingClientRect(),c=s.left<l.right&&s.right>l.left,u=s.top<l.bottom&&s.bottom>l.top;return(!n||c)&&(!i||u)}a(Ch,"elementsOverlap");function Ih(t){let e=t.getBoundingClientRect(),n=t.ownerDocument.defaultView;if(!n)return null;let i=t.ownerDocument,s={top:0,left:0,right:n.innerWidth||i.documentElement.clientWidth,bottom:n.innerHeight||i.documentElement.clientHeight},l={top:Math.max(e.top,s.top),left:Math.max(e.left,s.left),right:Math.min(e.right,s.right),bottom:Math.min(e.bottom,s.bottom),height:0,width:0};return l.width=l.right-l.left,l.height=l.bottom-l.top,l.width>0&&l.height>0?l:null}a(Ih,"getOverlappingRectangleWithViewport");function Fl(t){try{return getComputedStyle(t).position==="fixed"?!0:!t.parentElement||t.parentElement===document.body?!1:Fl(t.parentElement)}catch(e){return console.error("isAncestorOrSelfFixed",e),!1}}a(Fl,"isAncestorOrSelfFixed");function Pl(t){let{top:e}=t.getBoundingClientRect();return e<0?-e:0}a(Pl,"getHeightOfCroppedElementAboveViewport");function Hl(t){let{bottom:e}=t.getBoundingClientRect(),n=window.innerHeight;return e>n?e-n:0}a(Hl,"getHeightsOfCroppedElementBelowViewport");function Ah(t){if(!t.src)return!0;let e=window.location.origin;try{let n=new URL(t.src).origin;return e!==n}catch{return!1}}a(Ah,"isCrossOriginIframe");var pe=a((t,e=document,{excludeCrossOriginIframes:n=!1,includeHTML:i=!1}={})=>{let s=[],l=a(u=>{u.querySelectorAll(t).forEach(h=>s.push(h))},"queryElement"),c=a(u=>{l(u);let h=[],f=a(p=>{p.shadowRoot&&h.push(p.shadowRoot),p.childNodes?.forEach(g=>f(g))},"findShadowRoots");f(u),h.forEach(p=>c(p)),u.querySelectorAll("iframe").forEach(p=>{if(!(n&&Ah(p)))try{let g=p.contentDocument;g&&c(g)}catch{return}})},"queryNode");return c(e),i&&e instanceof Document&&e.documentElement.matches(t)&&s.push(e.documentElement),s},"querySelectorAllExtended"),ir=a((t,e)=>{if(t.matches(e))return t;let n=t.slot;if(n){let l=t.parentElement;for(;l;){if(l.shadowRoot){let c=l.shadowRoot.querySelector(`slot[name="${n}"]`);if(c)return ir(c,e)}l=l.parentElement}return null}let i=t.closest(e);if(i)return i;let s=t.getRootNode();return s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ir(s.host,e):null},"closestExtended"),On=a((t,{flattenShadowRootChildren:e=!1}={})=>{if(!t)return[];let n=Array.from(t.childNodes);if(t.nodeType===Node.ELEMENT_NODE){let i=t;i.shadowRoot&&(n=n.filter(s=>!s.assignedSlot),e?n=n.concat(Array.from(i.shadowRoot.childNodes)):n.push(i.shadowRoot)),i.tagName.toLowerCase()==="slot"&&n.push(...i.assignedNodes())}return n},"childNodesExtended"),Rh=a(t=>{let e=Array.from(t.children);return t.shadowRoot&&(e=e.filter(n=>!n.assignedSlot),e.push(...Array.from(t.shadowRoot.children))),t.tagName.toLowerCase()==="slot"&&e.push(...t.assignedElements()),e},"childrenExtended");var Zt=a(t=>{let e=t.parentElement;if(e)return e;switch(t.nodeType){case Node.ELEMENT_NODE:let i=t;if(i.assignedSlot)return i.assignedSlot;break;case Node.DOCUMENT_FRAGMENT_NODE:return t.host}let n=t.parentNode;if(n)switch(n.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return n.host;case Node.DOCUMENT_NODE:if(window.document===n)return null;let s=Array.from(window.document.querySelectorAll("iframe")).find(l=>l.contentDocument===n);if(s)return s}return null},"parentElementExtended");var Ri=a((t,{includeComments:e=!0,includeCDATA:n=!0,trim:i=!0,limitAttributeLength:s=!1}={})=>{if(!t)return"";function l(f){switch(f.nodeType){case Node.ELEMENT_NODE:return h(f);case Node.TEXT_NODE:return f.nodeValue;case Node.CDATA_SECTION_NODE:return n&&f.nodeValue.trim().length>0?`<![CDATA[${f.nodeValue}]]>`:"";case Node.COMMENT_NODE:return e&&f.nodeValue.trim().length>0?`<!--${f.nodeValue}-->`:"";default:return""}}a(l,"serializeNode");function c(f){return Array.from(f.childNodes).map(l).join("")}a(c,"serializeShadowRoot");function u(f){try{let p=f.contentDocument||f.contentWindow.document;return Ri(p.documentElement)}catch{return""}}a(u,"serializeIframe");function h(f){let p=f.tagName.toLowerCase(),g=`<${p}`;return Array.from(f.attributes).forEach(y=>{let S=y.value.slice(0,s?100:void 0);g+=` ${y.name}="${S}"`}),g+=">",f.shadowRoot?g+=c(f.shadowRoot):["script","style","svg"].includes(p)||Array.from(f.childNodes).forEach(y=>{y instanceof Element&&y.tagName.toLowerCase()==="iframe"?g+=u(y):g+=l(y)}),g+=`</${p}>`,g}return a(h,"serializeElementNode"),t.tagName.toLowerCase()==="iframe"?u(t):l(t)},"serializeElement");var st=class{static{a(this,"ScrollHelper")}constructor(e){this.element=e,this.elRect=this.element.getBoundingClientRect()}scrollIntoView({dontScrollIfAlreadyInView:e=!0}={}){if(e&&Ai(this.element))return this;if(this.getScrollableParentsPositions(),!this.initialScrollPositions.length)return this;if(this.element.scrollIntoView({block:"center",inline:"center"}),!Ai(this.element))for(let n of this.initialScrollPositions){let i=n.element.getBoundingClientRect();if(this.elRect.top<i.top||this.elRect.bottom>i.bottom){let s=this.elRect.top-i.top+n.element.scrollTop;n.element.scrollTop=s}}return this}restore(){this.initialScrollPositions&&this.initialScrollPositions.forEach(({element:e,top:n,left:i})=>{try{e.scroll(i,n)}catch(s){console.warn("[ScrollHelper/restore] couldn't restore initial scroll for",{element:e,top:n,left:i},s)}})}static getScrollData(e){let n=a(u=>{let h=u==="top"?"scrollTop":"scrollLeft",f=e[h];try{if(e[h]=f+1,e[h]!==f||(e[h]=f-1,e[h]!==f))return!0}finally{e[h]=f}return!1},"tryScroll"),s=e.scrollHeight>e.clientHeight&&n("top"),c=e.scrollWidth>e.clientWidth&&n("left");return{canScrollY:s,canScrollX:c,progressY:s?e.scrollTop/(e.scrollHeight-e.clientHeight):void 0,progressX:c?e.scrollLeft/(e.scrollWidth-e.clientWidth):void 0}}static scrollScrollableElement(e,n,i){let s=n==="y",l=s?e.scrollHeight:e.scrollWidth,c=s?e.clientHeight:e.clientWidth,u=s?e.scrollTop:e.scrollLeft,h;switch(i){case"forward":h=u+c;break;case"backwards":h=Math.max(0,u-c);break;case"end":h=l-c;break;case"start":h=0;break;default:if(typeof i=="number"){let f=Math.max(0,Math.min(i,100));h=(l-c)*f/100}else return console.log(`Invalid length parameter: expected "next", "end", "start", or a number, but received ${i}`),{result:!1,error:`Invalid parameter: expected "next", "end", "start", or a number, but received ${i}`};break}if(h=Math.max(0,Math.min(h,l-c)),console.log("ScrollHelper/scrollScrollableElement: new, left, top",h,e.scrollLeft,e.scrollTop),s){if(e.scrollTop===h)return{result:!1,error:"The element is already scrolled to the desired position"};e.scrollTop=h}else{if(e.scrollLeft===h)return{result:!1,error:"The element is already scrolled to the desired position"};e.scrollLeft=h}return{result:!0}}getScrollableParentsPositions(){this.initialScrollPositions=[];let e=Zt(this.element);for(;e!=null;)(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&this.initialScrollPositions.push({element:e,top:e.scrollTop,left:e.scrollLeft}),e=Zt(e)}};var wt=class t{constructor({target:e=document,disabled:n=!1,log:i=!0,name:s,monitorInput:l=!1}){this.ignoreMutationsWithAttributes=["checksum-data-visible","checksum-data-transparently-visible","checksum-data-visible-under-transparent-element","checksum-data-click-offset","checksum-target-node","checksumid","data-scrollable-x","data-scrollable-y","data-scrollable-x-progress","data-scrollable-y-progress","rrwebid"];this.ignoreMutationsWithAttributeRegexPatterns=["checksum-radial-traverse-.+"];this.ignoreElementsWithClasses=["checksum-dom-cache-ignore"];this.inputEnabledSelectors=["input","textarea","select","[contenteditable=true]"].join(",");this.shouldIgnoreMutationRecord=a(e=>{try{if(e.type==="attributes"&&this.ignoreMutationsWithAttributes.includes(e.attributeName)||e.type==="attributes"&&this.ignoreMutationsWithAttributeRegexPatterns.some(i=>new RegExp("^"+i+"$").test(e.attributeName)))return!0;if(e.type==="attributes"&&e.attributeName==="class"){let i=a(s=>s?s.split(" ").filter(l=>![":hover","rrweb-paused"].includes(l)).sort().join(" "):"","standardizeClassName");return i(e.oldValue)===i(e.target.className)}let n=a(i=>this.ignoreElementsWithClasses.some(s=>i.classList.contains(s)),"doesElementHaveIgnoredClass");if(e.type==="childList"&&Array.from(e.addedNodes).every(i=>n(i))&&Array.from(e.removedNodes).every(i=>n(i)))return!0}catch{}return!1},"shouldIgnoreMutationRecord");this.monitoredTextElements=[];this.monitorInputEnabledElement=a(e=>{e.addEventListener("input",n=>{this.invalidate()})},"monitorInputEnabledElement");this.target=e,this.name=s,this.disabled=n,this.logActivity=i,this.monitorInput=l,this.startObserver()}static{a(this,"DOMMutationDependentCache")}static{this.instances={}}static getInstance(e,n){let i=this.makeNameForCache(e,n?.flags);t.instances[i]||(t.instances[i]=new t({...n,name:n?.name??e}),n?.initialValue&&t.instances[i].set(n?.initialValue));let s=t.instances[i];return n?.invalidate&&s.invalidate(),s}static invalidateAll(){Object.values(t.instances).forEach(e=>e.invalidate())}static makeNameForCache(e,n){return`${e}${n?JSON.stringify(n):""}`}startObserver(){this.observer=new MutationObserver(e=>{e.every(this.shouldIgnoreMutationRecord)||(this.invalidate(),this.monitorInput&&e.forEach(n=>{n.addedNodes.forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE&&i.nodeType===Node.ELEMENT_NODE){let s=i;s.matches(this.inputEnabledSelectors)||s.isContentEditable?this.monitorInputEnabledElement(s):Array.from(s.querySelectorAll("*")).filter(l=>l.matches&&l.matches(this.inputEnabledSelectors)||l.isContentEditable).forEach(this.monitorInputEnabledElement)}})}))}),this.observer.observe(this.target,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.monitorInput&&this.startInputMonitoring()}startInputMonitoring(){this.monitoredTextElements=pe(this.inputEnabledSelectors),this.monitoredTextElements.forEach(this.monitorInputEnabledElement)}get(){return this.log("get","has cache:",!!this.cache),this.cache}set(e){this.disabled||(this.cache=e)}hasCache(){return this.log("hasCache",!!this.cache),!!this.cache}invalidate(){this.set(void 0)}log(...e){this.logActivity&&console.log(`[DOMMutationDependentCache] ${this.name?`[${this.name}]`:""}:`,...e)}};function Be(t,e,n=!0){try{if(!t.ownerDocument)return!1;let i=t.ownerDocument.defaultView;return i?t instanceof i[e]||t instanceof i.top?.[e]||n&&oM(t,e.toString()):!1}catch{}return!1}a(Be,"isNodeInstanceOf");function oM(t,e){if(typeof t!="object"||t===null)return!1;let n=Object.getPrototypeOf(t);for(;n!==null;){if(n.constructor&&n.constructor.name===e)return!0;n=Object.getPrototypeOf(n)}return!1}a(oM,"isNodeInstanceOfAlt");function Dr(t,e){return e??t?.ownerDocument?.defaultView??window}a(Dr,"getElementWindow");async function Wl(t,e,n){if(!e.length)return[];let i=t.ownerDocument;if(i===document)return[];let s=e.find(c=>c.contentDocument===i);if(!s)return[];let l=await n(s);return[...await Wl(s,e,n),l]}a(Wl,"getParentFramesSelectors");function Lh({rootDocument:t=document,ignoredIframesSelectors:e=[],flags:n={}}={}){let i=a(u=>u.filter(h=>!e.some(f=>h.matches(f))),"makeReturnValue"),s=wt.getInstance("playwrightElementSelectorGeneratorIframes",{log:!1,flags:n});if(s.hasCache())return i(s.get());let l=t.defaultView,c=pe("iframe",l?.document);return s.set(c),i(c)}a(Lh,"getIframes");function ut(t,e={}){let{markTransparentElementsAsHidden:n=!0,markElementsHiddenByTransparentElementAsVisible:i=!1,scrollIntoView:s=!0,useCache:l=!1}=e;if(l){let y=sM(t,{markTransparentElementsAsHidden:n,markElementsHiddenByTransparentElementAsVisible:i,scrollIntoView:s});if(y)return y}let c,u={isHidden:!0},h=a((y,S=!0)=>(S&&c&&c.restore(),l&&aM(t,y,{markTransparentElementsAsHidden:n,markElementsHiddenByTransparentElementAsVisible:i}),{...u,...y}),"prepareResult");if(!t)return h({isHidden:!0});t=t.tagName==="OPTION"&&(t.closest("select")||t.closest("datalist"))||t;let{visible:f,isTransparent:p}=Jo(t,n);if(u.isTransparent=p,!f)return h({isHidden:!0});if(lM(t,{scrollIntoView:s}))return h({isHidden:!0});try{let w=function(A){let k=A;for(;k;){if(k.nodeType===11)return[k,k.ownerDocument.defaultView];k=k.parentNode}};var g=w;a(w,"findShadowDocument"),s&&(c=new st(t).scrollIntoView());let y=Ih(t);if(!y)return h({isHidden:!0});let S=[[y.width/2,y.height/2,!0],[Math.max(y.width*.01,1),Math.max(y.height*.01,1)],[Math.min(y.width*.99,y.width-1),Math.max(y.height*.01,1)],[Math.max(y.width*.01,1),Math.min(y.height*.99,y.height-1)],[Math.min(y.width*.99,y.width-1),Math.min(y.height*.99,y.height-1)]],[M,T]=w(t)??[t.ownerDocument,t.ownerDocument.defaultView],C,N=Dr(t);if(N&&t instanceof N.HTMLInputElement&&t.id&&t.type&&["checkbox","radio"].includes(t.type)){let A=pe(`label[for="${t.id}"]`,M);A.length&&(C=A[0])}for(let[A,k,z]of S){let q=y.left+A>=0&&y.left+A<=T.innerWidth?y.left+A:A,oe=y.top+k>=0&&y.top+k<=T.innerHeight?y.top+k:k,$=M.elementFromPoint(q,oe);if($===t)return h({isHidden:!1,clickOffset:z?void 0:{x:A,y:k}});if(!$)continue;if(z===!0&&$.shadowRoot)return h(ut($,e));let Z=$;for(;Z;){if(Z===t||C&&C===Z)return h({isHidden:!1,clickOffset:z?void 0:{x:A,y:k}});Z=Zt(Z)}if(i)try{let de=M.elementsFromPoint(q,oe);for(let G of de){if(G===t)return h({isHidden:!1,clickOffset:z?void 0:{x:A,y:k},isBehindTransparentElement:!0});let B=T.getComputedStyle(G),X=G.getBoundingClientRect(),j=t.getBoundingClientRect(),Q=Nh(j,X);if(!(Nh(X,j)&&!uM(X,j)&&!Dh(B))&&(Dh(B)||cM(X,y)))break}}catch(de){console.error("Error while checking transparent elements over interactable",de)}}return c&&(c.restore(),c=void 0),C?ut(C,e):h({isHidden:!0})}catch(y){throw y}}a(ut,"isElementHidden");var Oh=a(t=>{let e=wt.getInstance("isElementHidden",{log:!1,flags:t}),n=e.get();return n||(n=new Map,e.set(n)),n},"getIsHiddenMapFromCache");function sM(t,e={}){let n=Oh(e);return n.has(t)?n.get(t):void 0}a(sM,"getIsElementHiddenFromCache");var aM=a((t,e,n={})=>{Oh(n).set(t,e)},"setIsElemenetHiddenInCache");function lM(t,{scrollIntoView:e=!0}={}){let n=t.parentElement,i=window.getComputedStyle(t);if(i.position==="absolute"||i.position==="fixed")return!1;let s;e&&(s=new st(t).scrollIntoView());let l=a(u=>(s&&s.restore(),u),"restoreAndReturn"),c=Dr(t);if(!c)return l(!1);for(;n;){if(!(n instanceof c.Element))return l(!1);let u=window.getComputedStyle(n);if(u.position==="absolute"||u.position==="fixed")return l(!1);let h=u.overflowX==="hidden",f=u.overflowY==="hidden";if((h||f)&&!Ch(n,t,h,f))return l(!0);n=n.parentElement}return l(!1)}a(lM,"isHiddenByOverflow");function Nh(t,e){try{let n=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),i=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),s=n*i,l=t.width*t.height,c=e.width*e.height,u=Math.min(l,c)*.5;return s>u}catch(n){return console.error("Error while checking large overlap",n),!1}}a(Nh,"isSignificantOverlap");function Dh(t){return!(t.opacity==="0"||t.visibility==="hidden"||/rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*0\s*\)/.test(t.backgroundColor))}a(Dh,"isNotTransparent");function cM(t,e,n=.2){let i=_h(t),s=_h(e),l=i.widthRatio/s.widthRatio,c=i.heightRatio/s.heightRatio;return l>1+n||c>1+n}a(cM,"isElementSignificantlyLarger");function _h(t){let e={width:window.innerWidth,height:window.innerHeight,top:0,left:0,bottom:window.innerHeight,right:window.innerWidth},n=t.width/e.width,i=t.height/e.height;return{widthRatio:n,heightRatio:i}}a(_h,"getNormalizedElementSize");function uM(t,e,n=.2){let i=t.width/e.width,s=t.height/e.height,l=t.width-e.width,c=t.height-e.height,u=window.innerWidth,h=window.innerHeight,f=l/u,p=c/h,g=(i-1+(s-1))/2,y=(f+p)/2;return g*y>n}a(uM,"isSignificantlyLargerNormalized");var or=a(t=>ut(t,{useCache:!0}).isHidden,"getIsElementHidden"),es=a((t,e)=>{let n=t.tagName.toLowerCase();switch(n){case"img":case"video":case"audio":return{type:0,tag:n,src:t.getAttribute("src"),size:{width:t.clientWidth,height:t.clientHeight},screenSize:{width:window.innerWidth,height:window.innerHeight},isRoot:e,isHidden:or(t)};case"svg":return{type:6,tag:n,components:new Nr(document).extract(t)[0],isRoot:e,isHidden:or(t)};case"a":return{type:2,tag:n,href:t.getAttribute("href"),text:t.innerText,isRoot:e,isHidden:or(t)};case"button":return{type:3,tag:n,text:t.innerText,buttonType:t.getAttribute("type")||"button",isRoot:e,isHidden:or(t)};case"input":return{type:4,tag:n,inputType:t.getAttribute("type"),placeholder:t.getAttribute("placeholder"),isRoot:e,isHidden:or(t)};case"table":case"form":case"textarea":case"iframe":case"select":return{type:1,tag:n,isRoot:e,isHidden:or(t)}}if(t.innerHTML.trim()===t.innerText&&t.innerHTML.length)return{type:5,tag:n,text:dM(t.innerHTML),isRoot:e,isHidden:or(t)}},"extractFeatureFromElement"),dM=a(t=>t.length>256?t.substring(0,256)+"...":t,"shortenText");var Li=a(t=>Object.keys(t||{}).reduce((e,n)=>{let i=t[n];return i&&(e[n]=i),e},{}),"sanitizeStaticMetadata"),kh=a((t,e)=>{let n=Li(t),i=Li(e),s=a(u=>!u||Object.keys(u).length===0,"isEmpty");if(s(n)&&s(i))return!0;if(s(n)||s(i))return!1;let l=Object.keys(n).sort(),c=Object.keys(i).sort();if(l.length!==c.length||!l.every((u,h)=>u===c[h]))return!1;for(let u in n)if(n[u]!==i[u])return!1;return!0},"staticDataMatch"),ts=a(t=>{let e=Li(t);return!(!e||!Object.keys(e).length)},"hasStaticData");function Fh(t,e){let n=t.filter(u=>!u.isRoot);n.length>10&&(n=Object.values(n.reduce((u,h)=>{let f=`${h.type}_${h.tag}`;return u[f]?u:{...u,[f]:h}},{})));let i=Math.min(Math.ceil(n.length*e.innerFeatures.mandatoryPercentage),e.innerFeatures.mandatoryMax),l=a(u=>u.reduce((h,f)=>{let p=h.map(g=>[...g,f]).filter(g=>g.length<=i);return h.concat(p)},[[]]),"combinations")(n).filter(u=>u.length===i),c=[];return l.forEach(u=>{let h=[];u.forEach(p=>h.push(_r(p))),ns(h).forEach(p=>c.push(p.map(g=>`:has(${g})`).join("")))}),c}a(Fh,"getInnerFeaturesQueries");function ns(t){if(!t.length)return[];let e=[],n=t.length-1;function i(s,l){for(let c=0,u=t[l].length;c<u;c++){let h=s.slice(0);h.push(t[l][c]),l===n?e.push(h):i(h,l+1)}}return a(i,"helper"),i([],0),e}a(ns,"cartesian");function _r(t){let e=[t.tag];switch(t.type){case 0:t.src&&e.push(`${t.tag}[src="${t.src}"]`);break;case 2:e.push(`${t.tag}[href="${t.href}"]`);break;case 3:break;case 4:e.push(`${t.tag}[type="${t.inputType}"]`),t.placeholder&&e.push(`${t.tag}[placeholder="${t.placeholder}"]`);break}return e}a(_r,"getFeatureSelector");var Ph=a((t,e,{contains:n=!1,matchWholeWord:i=!1}={})=>(e=e.replaceAll(`
`,"\\A ").replaceAll('"','\\"'),n?i?`[${t}="${e}"],[${t}*="${e} "],[${t}*=" ${e} "],[${t}*=" ${e}"]`:`[${t}*="${e}"]`:`[${t}="${e}"]`),"buildAttributeEqualityQuerySelector"),Bl=a((t,e,{contains:n=!1,matchWholeWord:i=!1}={})=>n?i?t===e||t.startsWith(e)||t.includes(` ${e} `)||t.endsWith(e):t.includes(e):t===e,"checkStringEquality");var Or=class{constructor(e){this.document=e;this.elementsByQueryCache={}}static{a(this,"AttributesExtractor")}getElementsByQuery(e){return this.elementsByQueryCache[e]||(this.elementsByQueryCache[e]=pe(e,this.document)),this.elementsByQueryCache[e]}extract({element:e,setClass:n,setAttribute:i,getElementsInStructuralVicinity:s,getElementsInVisualVicinity:l}){for(let c=0;c<e.attributes.length;++c){let{name:u,value:h}=e.attributes[c];if(Lr.attributesToExtract.includes(u)&&typeof h=="string"){if(u==="class"){h.split(" ").forEach(f=>{f.length&&n(f,this.processAttribute({element:e,getElementsInStructuralVicinity:s,getElementsInVisualVicinity:l},u,f,{contains:!0,matchWholeWord:!0}))});continue}i(u,this.processAttribute({element:e,getElementsInStructuralVicinity:s,getElementsInVisualVicinity:l},u,h))}}}processAttribute({element:e,getElementsInStructuralVicinity:n,getElementsInVisualVicinity:i},s,l,c={}){let u=this.getElementsByQuery("*"),h=Ph(s,l,c),f=this.getElementsByQuery(h),p=this.getElementsByQuery(`${e.tagName.toLowerCase()}`),g=f.filter(T=>T.tagName===e.tagName),y=n?n():[],S=y.filter(T=>T.element.attributes[s]&&Bl(T.element.attributes[s].value,l,c)),w=i?i():[],M=w.filter(T=>T.element.attributes[s]&&Bl(T.element.attributes[s].value,l,c));return{value:l,globalUniqueness:1-f.length/u.length,tagUniqueness:1-g.length/p.length,structuralVicinityUniqueness:n?1-S.length/y.length:void 0,visualVicinityUniqueness:i?1-M.length/w.length:void 0}}};var Hh=a((t,{tag:e="*"}={})=>pe(e).filter(n=>n.innerText?.trim()===t.trim()),"findElementsWithText");function Qt(t){let e=t.getRootNode();switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return hM(t,e);default:return t.innerText}}a(Qt,"getInnerText");function hM(t,e){let n=t.querySelectorAll("slot");if(!n.length)return t.innerText;let i=t.cloneNode(!0),s=i.querySelectorAll("slot");return n.forEach((l,c)=>{let u=l.assignedNodes();s[c].innerText=u.map(h=>{switch(h.nodeType){case Node.TEXT_NODE:return h.textContent;case Node.ELEMENT_NODE:return h.innerText}}).filter(h=>!!h).join(`
`)}),i.innerText.trim()}a(hM,"extractInnerTextForElementInShadowDOM");var rs=class{constructor(e){this.el=null;this.serializedElement="";this.attributes={};this.classes={};this.getElementsInStructuralVicinity=a(()=>this.structuralVicinityData.elementsInStructuralVicinity,"getElementsInStructuralVicinity");this.setElementStructuralVicinityData=a(e=>{this.structuralVicinityData=e},"setElementStructuralVicinityData");this.setElementVisualVicinityData=a(e=>{this.visualVicinityData=e},"setElementVisualVicinityData");this.getElementsInVisualVicinity=a(()=>this.visualVicinityData,"getElementsInVisualVicinity");this.setSerializedElement=a(e=>{this.serializedElement=e},"setSerializedElement");this.setAttribute=a((e,n)=>{this.attributes[e]=n},"setAttribute");this.setClass=a((e,n)=>{this.classes[e]=n},"setClass");this.setInnerText=a(e=>{this.innerText=e},"setInnerText");this.setStyle=a(e=>{this.style=e},"setStyle");this.setTag=a(e=>{this.tag=e},"setTag");this.setReact=a(e=>{this.react=e},"setReact");this.setInnerFeatures=a(e=>{this.innerFeatures=e},"setInnerFeatures");this.setPositioning=a(e=>{this.positioning=e},"setPositioning");this.setSVGs=a(e=>{this.svgs=e},"setSVGs");this.el=e,this.attributesExtractor=new Or(this.el.ownerDocument)}static{a(this,"ESRAElementMetadataBuilder")}serialize(){}getSerializedElement(){return this.serializedElement}get element(){return this.el}getAttributes(){return this.attributes}getClasses(){return this.classes}getStyle(){return this.style}getInlineStyle(){return this.style.inline}getComputedStyle(){return this.style.computed}getTag(){return this.tag}getInnerFeatures(){return this.innerFeatures}getInnerText(){return this.innerText}getSVGs(){return this.svgs}toMetadata(){return{structuralVicinity:this.makeStructuralVicinityMetadata(),visualVicinity:this.makeVisualVicinityMetadata(),serializedElement:this.getSerializedElement(),attributes:this.getAttributes(),classes:this.getClasses(),innerText:this.getInnerText(),tag:this.getTag(),style:this.getStyle(),innerFeatures:this.getInnerFeatures(),staticCandidates:this.extractStaticCandidates(),positioning:this.positioning,svgs:this.getSVGs()}}extractStaticCandidates(){return Li({text:this.extractStaticTextCandidate(),labeled:this.extractLabeled(),labeling:this.extractLabeling(),svgTitle:this.extractSVGTitle()})}makeVicinityMetadata(e,n){return e.reduce((i,s)=>{let{qualified:l,feature:c}=this.isVicinityQualifiedElement(s.element);if(!l)return i;let u={},h={};this.attributesExtractor.extract({element:s.element,setClass:a((p,g)=>u[p]=g,"setClass"),setAttribute:a((p,g)=>h[p]=g,"setAttribute")});let f={tag:s.element.tagName.toLowerCase(),classes:u,attributes:h,text:this.extractTextForMetadata(s.element),feature:c,relativePosition:this.element.compareDocumentPosition(s.element),...n(s)};return i.push(f),i},[])}makeStructuralVicinityMetadata(){return this.makeVicinityMetadata(this.getElementsInStructuralVicinity(),e=>({position:e.position}))}makeVisualVicinityMetadata(){return this.makeVicinityMetadata(this.getElementsInVisualVicinity(),e=>({position:[e.position],distance:e.distance}))}isVicinityQualifiedElement(e){if(e===this.element)return{qualified:!1};if(!Lr.vicinityFeatureElementsOnly)return{qualified:!0};let n=es(e);return{qualified:!!n,feature:n}}extractTextForMetadata(e){if(e.innerHTML!==e.innerText)return;let n=e.innerHTML;return n.length>256?n.substring(0,256)+"...":n}extractStaticTextCandidate(){switch(this.tag){case"input":case"textarea":return this.attributes?.placeholder?.value;default:return this.innerText?.content}}extractLabeling(){if(this.element.tagName.toLowerCase()==="label")return Qt(this.element);let e=ir(this.element,"label");if(e&&this.attributeExists(e.getAttribute("for")))return Qt(e);try{if(this.element.id&&this.element.id.length&&pe(`[aria-labelledby="${this.element.id}"]`).length)return Qt(this.element)}catch(n){console.error("extractLabeling error",n)}}extractLabeled(){let e=this.element.getAttribute("aria-label");if(this.attributeExists(e))return e;let n=ir(this.element,"label");if(n&&!this.attributeExists(n.getAttribute("for")))return Qt(n);if(this.element.id&&this.element.id.length)try{let s=pe(`label[for=${this.element.id}]`);if(s.length)return Qt(s[0])}catch{return}let i=this.element.getAttribute("aria-labelledby");if(this.attributeExists(i)){let s=pe(i.split(" ").map(l=>`#${l}`).join(","));if(s.length)return Qt(s[0])}}extractSVGTitle(){try{if(this.element.tagName.toLowerCase()!=="svg")return;let e=this.element.querySelector("title");return e?Qt(e):void 0}catch(e){console.error("extractSVGTitle error",e)}}attributeExists(e){return e&&e.length>0}};var is=class{constructor(e,n){this.structuralVicinityData={elementsInStructuralVicinity:[],html:""};this.element=e,this.config=n}static{a(this,"StructuralVicinityExtractor")}getInitialLimit(){switch(this.config.type){case"ratio":return document.querySelectorAll("*").length*this.config.value;case"fixed":return this.config.value}}calculate(){let e=Date.now().toString();return this.structuralVicinityData.html=this.populateStructuralVicinity(this.element,["element"],{runId:e,step:0,limit:this.getInitialLimit()}),this.structuralVicinityData.elementsInStructuralVicinity.forEach(n=>n.element.attributes.removeNamedItem(`checksum-radial-traverse-${e}`)),this.structuralVicinityData}populateStructuralVicinity(e,n,i){let{runId:s,step:l,limit:c}=i;if(!e||l>c||e.attributes[`checksum-radial-traverse-${s}`]!==void 0)return"";this.structuralVicinityData.elementsInStructuralVicinity.push({element:e,position:n}),e.setAttribute(`checksum-radial-traverse-${s}`,l.toString());let f={runId:s,step:l+1,limit:this.config.useDecayingLimit?c-1:c},p=this.populateStructuralVicinity(Zt(e),[...n,"parent"],f),g=this.populateStructuralVicinity(e.previousElementSibling,[...n,"left-sibling"],f),y=this.populateStructuralVicinity(e.nextElementSibling,[...n,"right-sibling"],f),S=[];Rh(e).map((M,T)=>S.push(this.populateStructuralVicinity(M,[...n,"child"],f)));let w=g+e.outerHTML.replace(e.innerHTML,S.join(""))+y;return p&&!p.includes(e.outerHTML)?p.replace("></",`>${w}</`):p?p.replace(e.outerHTML,w):w}};var Ni=class{constructor(e,n){this.document=e;this.config=n;this.debug=!1;this.sampleBoxColors={0:"green",1:"orange",2:"red",3:"blue"}}static{a(this,"VisualVicinityExtractor")}calculate(e){let n=[],i=this.config.radius,s=this.config.scanStep,l=e.getBoundingClientRect();for(let c=l.left-i;c<l.left+l.width+i;c+=s)for(let u=l.top-i;u<l.top+l.height+i;u+=s){let h=c+s/2,f=u+s/2;if(this.doesRectContain(l,{left:c,top:u,right:c+s,bottom:u+s})){this.addTrace(h,f,s,3);continue}let p=this.document.elementFromPoint(h,f);if(!p)continue;let g=p.getBoundingClientRect();if(g.width>i*2&&g.height>i*2||this.doesRectContain(g,l)){this.addTrace(h,f,s,2);continue}if(!!n.find(({element:M})=>M===p)){this.addTrace(h,f,s,1);continue}let{position:S,distance:w}=this.getPosition(l,g);n.push({element:p,position:S,distance:w}),this.addTrace(h,f,s,0)}return n}getPosition(e,n){let{x:i,y:s}=this.getCenter(n),{x:l,y:c}=this.getCenter(e),u=a(()=>{let f=i-l,p=s-c;return f<0&&p<0?"top-left":f>0&&p<0?"top-right":f<0&&p>0?"bottom-left":f>0&&p>0?"bottom-right":f===0&&p<0?"top":f===0&&p>0?"bottom":f<0&&p===0?"left":f>0&&p===0?"right":"center"},"calcPosition");return{distance:a(()=>Number(Math.sqrt(Math.pow(l-i,2)+Math.pow(c-s,2)).toFixed(2)),"calcDistance")(),position:u()}}getCenter(e){return{x:e.width/2+e.left,y:e.height/2+e.top}}addTrace(e,n,i,s){if(!this.debug)return;let l=this.document.createElement("xdiv");l.setAttribute("style",`position: absolute; width: ${i}px; height: ${i}px; top: ${n}px; left: ${e}px; background: ${this.sampleBoxColors[s]}; z-index: 999999999999;opacity:0.4`),this.document.getElementsByTagName("body")[0].prepend(l)}doesRectContain(e,n){return n.left>=e.left&&n.right<=e.right&&n.top>=e.top&&n.bottom<=e.bottom}doRectsOverlap(e,n){let i=e.right<n.left,s=e.left>n.right,l=e.top>n.bottom,c=e.top<n.top;return!(i||s||l||c)}};window.vve=new Ni({radius:50,scanStep:10});var Di=Rr(Wh());window.resq$=Di.resq$;window.resq$$=Di.resq$$;var Ul=class{static{a(this,"Provider")}extract(e){let n=this.findParentComponent(e,{ignoreBaseElement:!0});return{component:n,parentComponent:this.findParentComponent(n.node)}}findParentComponent(e,{ignoreBaseElement:n=!1,baseElement:i=void 0}={}){let s=(0,Di.resq$$)("*",e.parentElement).find(l=>l.children.length===1&&l.children[0].node===e);return i=i??e,s&&(n||s.node!==i)?this.parseRESQresult(s):this.findParentComponent(e.parentElement,{baseElement:i,ignoreBaseElement:n})}parseRESQresult(e){if(!e)return;let n=a(i=>{switch(typeof i){case"string":return[i];case"object":return Array.isArray(i)?i.map(n):Object.keys(i)}},"parseState");return{name:e.name,node:e.node,isFragment:e.isFragment,stateTokens:n(e.state),propsNames:Object.keys(e.props),hasChildren:!!e.children.length}}},Vh=new Ul;var $l=class{static{a(this,"Provider")}extract(e){return{component:void 0,parentComponent:void 0}}},E0=new $l;var ss=class{constructor(e,n){this.provider=Vh;this.element=e,this.config=n}static{a(this,"ReactMetadataExtractor")}extract(){return this.provider.extract(this.element)}};var as=class{constructor(e){this.document=e;this.tagBaseComputedStyle={}}static{a(this,"StyleExtractor")}extract({element:e,setStyle:n}){let i=e.tagName.toLowerCase();try{if(!this.tagBaseComputedStyle[i]){let s=this.document.createElement(i);this.document.getElementsByTagName("body")[0].prepend(s),this.tagBaseComputedStyle[i]=this.sanitzieStyle(window.getComputedStyle(s)),s.remove()}}catch(s){if(console.error("Failed to extract style for tag",i,s),!this.tagBaseComputedStyle[i])return}n({inline:this.sanitzieStyle(e.style,{acceptEmptyValue:!1}),computed:this.diffComputedStyle(this.tagBaseComputedStyle[i],this.sanitzieStyle(window.getComputedStyle(e)))})}diffComputedStyle(e,n){return a((l,c)=>Object.keys(c).reduce((u,h)=>l[h]===c[h]?u:{...u,[h]:c[h]},{}),"oneWayDiff")(e,n)}sanitzieStyle(e,{acceptEmptyValue:n=!0}={}){return Object.keys(e).reduce((i,s)=>{if(!isNaN(s))return i;let l=e[s];return!n&&!l||(i[s]=l),i},{})}};var yn=class{constructor(){this.makeFeatureNode=a((e,n=void 0)=>{let i=e.nodeType===Node.ELEMENT_NODE;return{type:e.nodeType,tag:i?e.tagName.toLowerCase():void 0,feature:i?es(e,n):void 0,children:[],isRoot:n}},"makeFeatureNode");this.includeRootElements=!0;this.rootElementsTypeExceptions=[5];this.cache=wt.getInstance("innerFeaturesExtractor",{log:!1})}static{a(this,"InnerFeaturesExtractor")}extract(e){let n=[],i=this.makeFeatureNode(e,!0);return this.walk(e,i,n),n}getMapFromCache(){let e=this.cache.get();return e||(e=new Map,this.cache.set(e)),e}getFeatureNodeFromCache(e){let n=this.getMapFromCache();return n.has(e)?n.get(e):void 0}addFeatureNodeToCache(e,n){let i=this.getMapFromCache();i.set(e,n),this.cache.set(i)}walk(e,n,i){let s=!1;On(e).forEach(c=>{let u=this.getFeatureNodeFromCache(c)??this.makeFeatureNode(c),h=this.walk(c,u,i);h&&n.children.push(u),s||=h});let l=!!n.feature;return l&&(!n.isRoot||this.shouldIncludeRootNode(n))&&i.push(n.feature),this.addFeatureNodeToCache(e,n),l||s}shouldIncludeRootNode(e){return!(!this.includeRootElements||this.rootElementsTypeExceptions.includes(e.type))}};window.inner_features_extractor=new yn;var kr=class{static{a(this,"InnerTextExtractor")}constructor(){}extract(e){return{content:Qt(e)??void 0}}};var ls=class{constructor(e){this.document=e}static{a(this,"PositioningExtractor")}extract(e){let{top:n,bottom:i,left:s,right:l}=e.getBoundingClientRect(),c=document.documentElement.scrollHeight,u=document.documentElement.scrollWidth;return{viewport:{size:{height:window.innerHeight,width:window.innerWidth},element:{top:this.normalize(n,window.innerHeight),bottom:this.normalize(i,window.innerHeight),left:this.normalize(s,window.innerWidth),right:this.normalize(l,window.innerWidth)}},document:{size:{height:c,width:u},element:{top:this.normalize(n+window.scrollY,c),bottom:this.normalize(i+window.scrollY,c),left:this.normalize(s+window.scrollX,u),right:this.normalize(l+window.scrollX,u)}}}}normalize(e,n){return e/n}};var mt=class{constructor(e,n){this.stats={serializeElement:0,populateElementsInStructuralVicinity:0,populateElementsInVisualVicinity:0,extractAttributes:0,extractInnerText:0,extractStyle:0,extractTag:0,extractInnerFeatures:0,extractPositioning:0,extractSVGComponents:0,final:0};this.xmlSerializer=new XMLSerializer,this.document=e,this.config=n??Lr,this.visualVicinityExtractor=new Ni(this.document,this.config.visualVicinity),this.styleExtractor=new as(this.document),this.innerFeaturesExtractor=new yn,this.innerTextExtractor=new kr,this.positioningExtractor=new ls(this.document)}static{a(this,"ESRAElementMetadataExtractor")}isSameDocument(e){return this.document===e}extract(e){let n=new st(e).scrollIntoView(),i=Date.now(),s=new rs(e);return this.serializeElement(s),this.stats.serializeElement+=Date.now()-i,i=Date.now(),this.populateElementsInStructuralVicinity(s),this.stats.populateElementsInStructuralVicinity+=Date.now()-i,i=Date.now(),this.populateElementsInVisualVicinity(s),this.stats.populateElementsInVisualVicinity+=Date.now()-i,i=Date.now(),this.extractAttributes(s),this.stats.extractAttributes+=Date.now()-i,i=Date.now(),this.extractInnerText(s),this.stats.extractInnerText+=Date.now()-i,i=Date.now(),this.extractStyle(s),this.stats.extractStyle+=Date.now()-i,i=Date.now(),this.extractTag(s),this.stats.extractTag+=Date.now()-i,i=Date.now(),this.extractInnerFeatures(s),this.stats.extractInnerFeatures+=Date.now()-i,i=Date.now(),this.extractPositioning(s),this.stats.extractPositioning+=Date.now()-i,i=Date.now(),this.extractSVGComponents(s),this.stats.extractSVGComponents+=Date.now()-i,i=Date.now(),n.restore(),this.stats.final+=Date.now()-i,s}extractReact({element:e,setReact:n}){n(new ss(e,this.config.react).extract())}extractTag({element:e,setTag:n}){n(e.tagName.toLowerCase())}extractPositioning({element:e,setPositioning:n}){n(this.positioningExtractor.extract(e))}extractSVGComponents({element:e,setSVGs:n}){n(new Nr(this.document).extract(e))}serializeElement({element:e,setSerializedElement:n}){}extractAttributes({element:e,setClass:n,setAttribute:i,getElementsInStructuralVicinity:s,getElementsInVisualVicinity:l}){return new Or(this.document).extract({element:e,setClass:n,setAttribute:i,getElementsInStructuralVicinity:s,getElementsInVisualVicinity:l})}populateElementsInStructuralVicinity({element:e,setElementStructuralVicinityData:n}){n(new is(e,this.config.structuralVicinity).calculate())}populateElementsInVisualVicinity({element:e,setElementVisualVicinityData:n}){n(this.visualVicinityExtractor.calculate(e))}extractInnerText({element:e,setInnerText:n}){n(this.innerTextExtractor.extract(e))}extractStyle({element:e,setStyle:n}){return this.styleExtractor.extract({element:e,setStyle:n})}extractInnerFeatures({element:e,setInnerFeatures:n}){n(this.innerFeaturesExtractor.extract(e))}};var $h=Rr(_i());var Oi=["button","select","input","textarea","option","a","[role=button]","[role=checkbox]","[role=radio]","[role=link]","[type=button]","[aria-disabled=false]",'[id^="react-select"]',"label[for]","canvas"],Gh=["pointer","grab","text","vertical-text","zoom-in","zoom-out","help"],Uh=["onClick","onMouseDown","onKeyDown","onKeyPress","onInput","onSelect","onDoubleClick","onDragStart","onDrag","onDragEnd","onDragOver","onDrop","onToggle","onMouseEnter"],zl=["onclick","onmousedown","onkeydown","onkeypress","oninput","onselect","ondblclick","ondragstart","ondrag","ondragend","ondragover","ondrop","ontoggle","onmouseenter"],Jt=[":hover",":focus",":active","\\:hover","\\:focus","\\:active"];var pt=class{static{a(this,"PlaywrightElementSelectorGenerator")}async injectSelectorsAndLocators(e,{testIdSelector:n,searchParentFrames:i=!0}={}){let s=e.map(l=>({container:l,removedAttributes:this.stripNodeAttributes(l.element)}));return s=await Promise.all(s.map(async l=>{let{selector:c,locator:u,parentFramesSelectors:h}=await this.getSelectorAndLocator(l.container.element,{testIdSelector:n,searchParentFrames:i,stripAttributes:!0});return{...l,selector:c,locator:u,parentFramesSelectors:h}})),s=await Promise.all(s.map(async l=>{if(!l.removedAttributes.id&&!l.removedAttributes.originalClasses||(this.restoreNodeAttributes(l.container.element,l.removedAttributes),window.playwright.$(l.selector)!==void 0))return l;let c=await this.getSelectorAndLocator(l.container.element,{testIdSelector:n,searchParentFrames:i,stripAttributes:!1});return console.log(`Selector ${l.selector} is not valid, generated new one: ${c.selector}`),Object.assign(l,c),l})),s.map(l=>{let{container:c,selector:u,locator:h,parentFramesSelectors:f}=l;return{...c,selector:u,locator:h,parentFramesSelectors:f}})}stripNodeAttributes(e){let n=e,i,s;n.id&&(i=n.id,n.removeAttribute("id"));try{if(s=n.getAttribute("class"),s&&typeof s=="string"){let l=s.split(" ").filter(c=>!c.startsWith("css-")&&!c.startsWith("jss-")&&!Jt.includes(c)).join(" ");n.setAttribute("class",l)}else s=void 0}catch(l){return console.warn("[playwright selector generator] error with class filtering",l),{}}return{id:i,originalClasses:s}}restoreNodeAttributes(e,n){let i=e,{id:s,originalClasses:l}=n;s&&i.setAttribute("id",s),l&&i.setAttribute("class",l)}getElementWindowPlaywright(e){let n=e.ownerDocument.defaultView;return n?(n!==window&&!n.playwright&&(n.playwright=window.playwright),n.playwright):window.playwright}async safeGetSelectorAndLocator(e,{retriesLeft:n=3}={}){try{try{return window.playwright.generateSelectorAndLocator(e)}catch{return this.getElementWindowPlaywright(e).generateSelectorAndLocator(e)}}catch{return n>0?(await(0,$h.default)(500),this.safeGetSelectorAndLocator(e,{retriesLeft:n-1})):{selector:"",locator:""}}}async getSelectorAndLocator(e,{testIdSelector:n,searchParentFrames:i=!0,stripAttributes:s=!0,ignoredIframesSelectors:l=[],rootDocument:c=document,flags:u={}}={}){try{if(!e)return null;let h=i?await Wl(e,Lh({rootDocument:c,ignoredIframesSelectors:l,flags:u}),async w=>(await this.getSelectorAndLocator(w,{searchParentFrames:!1})).selector):[],f=e,p=this.getTestAttributeSelector(f,n);if(p)return{selector:p,locator:`locator("${p}")`,parentFramesSelectors:h};let g;s&&(g=this.stripNodeAttributes(e));let{selector:y,locator:S}=await this.safeGetSelectorAndLocator(f);return g&&(this.restoreNodeAttributes(e,g),await this.getElementWindowPlaywright(e).$(y)!==e&&({selector:y,locator:S}=await this.safeGetSelectorAndLocator(f))),{selector:y,locator:S,parentFramesSelectors:h}}catch(h){return console.log("get selector and locator error",e,h),{selector:"",locator:""}}}async findIframeWindowByParentFrameSelectors(e=[]){let n=window.top;try{if(e&&e.length>0)for(let i of e){let s=await n.playwright.$(i);s||(s=await window.playwright.$(i)),s||(s=pe(i)[0]),s?n=s.contentWindow:console.warn("Failed to find iframe window by parent frame selectors",i)}}catch(i){console.log("find iframe window by parent frame selectors error",i,e)}return n}async selector(e,n){let i;try{i=await(await this.findIframeWindowByParentFrameSelectors(n)).playwright.$(e)}catch(s){console.log("selector error",e,s)}return i??this.selectFromFirstIframe(e)}getFirstIframeContentWindow(){let e=document.querySelector("iframe");if(!e)return;let n=e.contentWindow;return n.playwright||(n.playwright=window.playwright),n}async selectFromFirstIframe(e){let n=this.getFirstIframeContentWindow();if(n)try{return await n.playwright.$(e)}catch{console.log("selector error",e)}}getTestAttributeSelector(e,n){let i=["data-cy","data-testid","data-test-id","data-test"];for(let l of[n,...i])if(l&&e.getAttribute(l)){let c=`[${l}='${e.getAttribute(l)}']`;if(pe(c).length===1)return c;if(pe(c).length>1){let h=Array.from(pe(c)).indexOf(e);return`${c} >> nth=${h}`}}}escapeBackslash(e){return e.replace(/\\/g,"\\\\")}};var zh=[{selector:'path[d="M17.5 13V15.6667C17.5 16.0203 17.3361 16.3594 17.0444 16.6095C16.7527 16.8595 16.357 17 15.9444 17H5.05556C4.643 17 4.24733 16.8595 3.95561 16.6095C3.66389 16.3594 3.5 16.0203 3.5 15.6667V13"] + path[d="M14.6673 6.92057L10.5007 2.75391L6.33398 6.92057"] + path[d="M10.5 2.75391V12.7539"]',description:"export button"},{selector:'path[d="M16.0893 13.1868C16.6838 12.7754 17.1321 12.1858 17.3697 11.503C17.6072 10.8202 17.6216 10.0796 17.4107 9.38816C17.1999 8.69667 16.7748 8.09007 16.1968 7.65594C15.6187 7.2218 14.9177 6.9826 14.1948 6.97285H12.8308C12.6017 6.20011 12.1996 5.48973 11.6549 4.89565C11.1102 4.30157 10.4374 3.83943 9.68735 3.54431C8.93734 3.24918 8.12995 3.12885 7.32648 3.19244C6.52301 3.25603 5.7446 3.50187 5.05036 3.9113C4.35612 4.32072 3.7643 4.88297 3.31985 5.55533C2.8754 6.22769 2.59001 6.99248 2.48535 7.79164C2.38068 8.59079 2.4595 9.40329 2.71582 10.1674C2.97214 10.9316 3.39921 11.6272 3.96461 12.2016"] + path[d="M10.0273 10.0039V16.8241"] + path[d="M13.0585 13.0351L10.0273 10.0039L6.99609 13.0351"]',description:"import button"},{selector:'path[d="M20.4696 21.5303C20.7625 21.8232 21.2373 21.8232 21.5302 21.5303C21.8231 21.2374 21.8231 20.7626 21.5302 20.4697L20.4696 21.5303ZM17.1802 16.1197C16.8873 15.8268 16.4125 15.8268 16.1196 16.1197C15.8267 16.4126 15.8267 16.8874 16.1196 17.1803L17.1802 16.1197ZM18.25 11C18.25 15.0041 15.0041 18.25 11 18.25V19.75C15.8325 19.75 19.75 15.8325 19.75 11H18.25ZM11 18.25C6.99594 18.25 3.75 15.0041 3.75 11H2.25C2.25 15.8325 6.16751 19.75 11 19.75V18.25ZM3.75 11C3.75 6.99594 6.99594 3.75 11 3.75V2.25C6.16751 2.25 2.25 6.16751 2.25 11H3.75ZM11 3.75C15.0041 3.75 18.25 6.99594 18.25 11H19.75C19.75 6.16751 15.8325 2.25 11 2.25V3.75ZM21.5302 20.4697L17.1802 16.1197L16.1196 17.1803L20.4696 21.5303L21.5302 20.4697Z"]',description:"search"},{selector:'path[d="M3.75 10H16.875"] + path[d="M8.125 5L3.125 10L8.125 15"]',description:"back"},{selector:'path[d="M3.33301 8H12.6663"] + path[d="M8 3.33331L12.6667 7.99998L8 12.6666"]',description:"forward"},{selector:'path[d="M10 4.16667V15.8333"] + path[d="M4.16699 10H15.8337"]',description:"new or Add button"},{selector:'path[d="M10 10.75C10.4142 10.75 10.75 10.4142 10.75 10C10.75 9.58579 10.4142 9.25 10 9.25C9.58579 9.25 9.25 9.58579 9.25 10C9.25 10.4142 9.58579 10.75 10 10.75Z"] + path[d="M15.833 10.75C16.2472 10.75 16.583 10.4142 16.583 10C16.583 9.58579 16.2472 9.25 15.833 9.25C15.4188 9.25 15.083 9.58579 15.083 10C15.083 10.4142 15.4188 10.75 15.833 10.75Z"] + path[d="M4.16699 10.75C4.58121 10.75 4.91699 10.4142 4.91699 10C4.91699 9.58579 4.58121 9.25 4.16699 9.25C3.75278 9.25 3.41699 9.58579 3.41699 10C3.41699 10.4142 3.75278 10.75 4.16699 10.75Z"]',description:"open menu"},{selector:'path[d="M10 4.16667V15.8333"] + path[d="M4.16699 10H15.8337"]',description:"add filter"},{selector:'path[d="M15 5L5 15"] + path[d="M5 5L15 15"]',description:"close or remove"},{selector:'path[d="M4 6L8 10L12 6"]',description:"open or close dropdown"},{selector:'path[d="M10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5Z"] + path[d="M12.5 7.5L7.5 12.5"] + path[d="M7.5 7.5L12.5 12.5"]',description:"clear input"},{selector:'path[d="M3.33301 5.49054H4.81449H16.6663"] + path[d="M7.14286 5.49999V3.99999C7.14286 3.60216 7.29337 3.22063 7.56128 2.93932C7.82919 2.65802 8.19255 2.49998 8.57143 2.49998H11.4286C11.8075 2.49998 12.1708 2.65802 12.4387 2.93932C12.7066 3.22063 12.8571 3.60216 12.8571 3.99999V5.49999M15 5.49999V16C15 16.3978 14.8495 16.7793 14.5816 17.0607C14.3137 17.342 13.9503 17.5 13.5714 17.5H6.42857C6.04969 17.5 5.68633 17.342 5.41842 17.0607C5.15051 16.7793 5 16.3978 5 16V5.49999H15Z"] + path[d="M8.33203 9.23726V13.4039"] + path[d="M11.666 9.23726V13.4039"]',description:"delete"},{selector:'path[d="M13.3334 4L6.00008 11.3333L2.66675 8"]',description:"checked"},{selector:'path[d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"]',description:"downward-pointing arrow"},{selector:'path[d="M18.0893 3.08926C18.4147 2.76382 18.4147 2.23618 18.0893 1.91074C17.7638 1.58531 17.2362 1.58531 16.9107 1.91074L18.0893 3.08926ZM9.41074 9.41074L8.82149 10L10 11.1785L10.5893 10.5893L9.41074 9.41074ZM16.9107 1.91074L9.41074 9.41074L10.5893 10.5893L18.0893 3.08926L16.9107 1.91074Z"] + path[d="M17.5 2.5L12.25 17.5L9.25 10.75L2.5 7.75L17.5 2.5Z"]',description:"send"}];var fM=5*60*1e3,cs=class{constructor(){this.flashingTextElements=[]}static{a(this,"FlashingElementsDetector")}start(){this.stop(),this.flashingTextElements=[],this.observer=new MutationObserver(e=>{e.forEach(n=>{n.addedNodes.length>0&&n.addedNodes.forEach(i=>{i instanceof HTMLElement&&this.includeElement(i)&&setTimeout(()=>{this.flashingTextElements.push(this.processTextElements(i))},1e3)})})}),this.observer.observe(document.body,{childList:!0,subtree:!0}),this.monitoringPeriodTimeout=setTimeout(()=>{this.stop()},fM)}stop(){this.monitoringPeriodTimeout&&(clearTimeout(this.monitoringPeriodTimeout),this.monitoringPeriodTimeout=null),this.observer&&(this.observer.disconnect(),this.observer=null)}get(){let e=this.flashingTextElements.map(i=>i.filter(s=>!s.isConnected||ut(s.parentElement).isHidden)).filter(i=>i.length).map(i=>`<span>${i.map(s=>s.textContent).join("</span><span>")}</span>`),n=new Set(e);return Array.from(n)}stopAndGet(){return this.stop(),this.get()}includeElement(e){return!(e.getElementsByTagName("*").length>50||e.outerHTML.length>5e3)}processTextElements(e){let n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),i,s=[];for(;i=n.nextNode();)ut(i.parentNode).isHidden||s.push(i);return s}};var Fr=class{static{a(this,"AlphaNumericCounter")}constructor(e){this.counter=e??"0"}increment(){let e=this.counter.length-1;for(;e>=0;){let n=this.counter[e];if(n==="9"){this.counter=this.replaceAt(this.counter,e,"a");return}else if(n==="z"){if(this.counter=this.replaceAt(this.counter,e,"0"),e===0){this.counter="1"+this.counter;return}e--}else{this.counter=this.replaceAt(this.counter,e,String.fromCharCode(n.charCodeAt(0)+1));return}}}get(){return this.counter}incrementAndGet(){return this.increment(),this.get()}getAndIncrement(){let e=this.get();return this.increment(),e}replaceAt(e,n,i){return e.substr(0,n)+i+e.substr(n+i.length)}static compare(e,n){let i=e.length,s=n.length;if(i!==s)return i-s;for(let l=0;l<i;l++){let c=e.charCodeAt(l),u=n.charCodeAt(l);if(c!==u)return c-u}return 0}};var ki="checksum-ignore",ds="checksum-get-more-items",qh=20,mM=.7,us,Yh,pM=0,Kh=a((t,{forceIncludeAttribute:e,forceIncludeFileInput:n,forceIncludeElements:i,limit:s})=>{t.excludedElements?.forEach(S=>{S.removeAttribute(ki)}),t.excludedElements=new Set;let l=t.element,c=s??Math.min(Math.ceil(l.children.length*.5),l.children.length-qh),u=a(S=>e&&(S.hasAttribute(e)||Array.from(S.querySelectorAll(`[${e}]`)).length>0)||n&&S.tagName.toLowerCase()==="input"&&S.type==="file"?!0:i.includes(S),"isForceIncluded"),h=a(S=>{let w=0;if(t.elementsToKeep.includes(S))return w;let M=ql(S);M.length>=t.attributes.length&&w++;let T=M.filter(A=>t.attributes.includes(A)).length;T===t.attributes.length?w+=3:T>0&&w++;let N=Yl(S).filter(A=>t.classes.includes(A)).length;return N===t.classes.length?w+=2:N>0&&w++,w},"scoreElement"),f=Array.from(l.children).filter(S=>S.tagName===t.tagName&&!u(S)).map(S=>({element:S,score:h(S)})).sort((S,w)=>w.score-S.score),{inViewportElements:p,outOfViewportElements:g}=f.reduce((S,w)=>{let{element:M}=w;return Ai(Be(M,"Element")?M:M?.parentElement)?S.inViewportElements.push(M):S.outOfViewportElements.push(M),S},{inViewportElements:[],outOfViewportElements:[]}),y=a(S=>{for(let w of S)if(t.excludedElements.add(w),t.excludedElements.size===c)return!0},"excludeElements");return y(g)||y(p),gM(t),Array.from(t.excludedElements)},"viewportReducer");function gM(t){let{excludedElements:e,element:n}=t;e.forEach(i=>{i.setAttribute(ki,"")}),n._getmoreitemsid||(n._getmoreitemsid="gm"+pM++),t.id=n._getmoreitemsid,n.setAttribute(ds,t.id)}a(gM,"markTemplateElements");function ql(t){return Array.from(t.attributes).filter(e=>!e.name.startsWith("checksum")).map(e=>e.name.replace(/[0-9]/g,""))}a(ql,"mapAttributes");function Yl(t){return t.className?.split(" ").filter(e=>e)??[]}a(Yl,"getElementClasses");function en(t=document.body,{nodeRepetitionsThreshold:e=qh}={}){try{return console.time("bettertemplatize"),us=new Set,Xh(t,e),console.timeEnd("bettertemplatize"),console.log("[bettertemplatize] templates found:",Array.from(us)),Array.from(us)}catch(n){return console.error("[bettertemplatize] failed during template processing:",n.message),[]}}a(en,"bettertemplatize");function Xh(t,e){Array.from(t.children).forEach(n=>{if(n instanceof SVGElement)return;let i=n.children.length;if(i>=e){let s=Array.from(n.children),l=Math.ceil(i*mM);for(let c=0;c<i;c++){let u=0,h=s.slice(0,c);for(let f=c+1;f<i&&u+i-f>=l;f++)try{if(jh(s[c],s[f])){if(u++,u>=l){us.add({element:n,...Yh,elementsToKeep:h});return}}else h.push(s[f])}catch{return}}}Xh(n,e)})}a(Xh,"traverse");var yM=.8,EM=.5,vM=.8,SM=5;function jh(t,e,n=1){let i,s,l=a(M=>(M&&(Yh={attributes:i,classes:s,tagName:t.nodeName}),M),"response");if(t.nodeType!==e.nodeType)return l(!1);if(t instanceof SVGElement&&e instanceof SVGElement||t.nodeType===Node.TEXT_NODE)return l(!0);if(t.nodeType!==Node.ELEMENT_NODE)return l(!1);let c=t,u=e;if(c.tagName.toLowerCase()!==u.tagName.toLowerCase())return l(!1);let h=ql(c),f=ql(u);if(i=h.filter(M=>f.includes(M)),i.length/Math.max(h.length,f.length)<yM)return l(!1);let p=Yl(c),g=Yl(u);if(s=p.filter(M=>g.includes(M)),s.length/Math.max(p.length,g.length)<EM)return l(!1);if(n>=SM)return l(!0);if(c.shadowRoot&&!u.shadowRoot||!c.shadowRoot&&u.shadowRoot)return l(!1);let y=Array.from(c.shadowRoot?c.shadowRoot.children:c.children),S=Array.from(u.shadowRoot?u.shadowRoot.children:u.children);if(y.length===0&&S.length===0)return l(!0);let w=0;for(let M=0;M<Math.min(y.length,S.length);M++)jh(y[M],S[M],n+1)&&w++;return w/Math.max(y.length,S.length)<vM?l(!1):l(!0)}a(jh,"areSimilar");var kn=a(t=>{},"consoleTime"),Fn=a(t=>{},"consoleTimeEnd");var sr=a((t,e=[])=>{if(!t)return t;let n=window.getComputedStyle(t).cursor,i=a((l,c=()=>!1)=>{let u=l;for(;u;){let h=u.parentElement;if(!h||h.nodeType!==Node.ELEMENT_NODE)return u;if(c(h))break;if(window.getComputedStyle(h).cursor!==n)return u;u=h}},"getClosestElementWithCursor"),s=a(l=>{try{if(l.matches("label[for]")&&!l.matches(Oi.concat(e).filter(c=>!!c&&c!=="label[for]").join(","))){let c=l.getAttribute("for");if(!c)return!1;let u=document.getElementById(c);if(!u)return!1;let h=u.getAttribute("type");return h?u.tagName.toLowerCase()==="input"&&["checkbox","radio"].includes(h):!1}}catch(c){console.error("interactableParentIsValid",l,c)}return!0},"interactableParentIsValid");try{if("isContentEditable"in t&&t.isContentEditable)return t;if("closest"in t){let c=ir(t,Oi.concat(e).filter(u=>!!u).join(","));if(c&&s(c)){if(c===t)return t;let u=i(t,h=>h===c);return u||c}}if(["auto","default","context-menu","help","progress","wait"].includes(n))return t;let l=i(t);return l||t}catch(l){return console.error("getCompoundInteractableRootElement",t,l),t}},"getCompoundInteractableRootElement");var $t=a((t=document,e={},{allowDisabled:n=!1,useDataVisibleAttributes:i=!0,excludeCrossOriginIframes:s=!1,includeCompoundInnerElements:l=!0}={})=>{let c=wt.getInstance("getAllInteractableHTMLElements",{target:t,log:!1}),u=Date.now(),h=a(S=>{let w=S.reduce((M,T)=>!n&&T.state.disabled?M:[...M,T.element],[]);return console.log("[getAllInteractableHTMLElements] done, took",Date.now()-u,"ms"),w},"makeResponse");if(c.hasCache())return h(c.get());let f=pe("*",t,{excludeCrossOriginIframes:s});kn("[getAllInteractableHTMLElements] items");let p=f.reduce((S,w)=>{let M="disabled"in w&&!!w.disabled;return w.matches(Oi.concat(e.appSpecificInteractableElementsSelectors||[]).filter(C=>!!C).join(","))||Gh.includes(window.getComputedStyle(w).cursor)||w.isContentEditable&&!w.parentElement?.isContentEditable||!e.ignoreEventListenersWhenDeterminingInteractability&&(zl.some(C=>w[C])||wM(w))?[...S,{element:w,disabled:M}]:S},[]);Fn("[getAllInteractableHTMLElements] items"),kn("[getAllInteractableHTMLElements] getCompoundInteractableRootElement");let g=p.reduce((S,w)=>{let M=sr(w.element,e.appSpecificInteractableElementsSelectors||[]),T=S.find(C=>C.element===M);return T?!w.disabled&&T.state.disabled&&(T.state.disabled=!1):S.push({element:M,state:{disabled:w.disabled}}),l&&w.element!==M&&bM(w.element)&&S.push({...w,state:{disabled:w.disabled}}),S},[]);Fn("[getAllInteractableHTMLElements] getCompoundInteractableRootElement"),kn("[getAllInteractableHTMLElements] isElementHidden");let y=g.filter(({element:S})=>{if(i){if(!S)return!1;let w=S.getAttribute("checksum-data-visible");if(w){let M=w==="true",T=S.getAttribute("checksum-data-visible-under-transparent-element")==="true",C=S.getAttribute("checksum-data-transparently-visible")==="true";return M&&!T||C}}return!ut(S,{markTransparentElementsAsHidden:!1}).isHidden});return Fn("[getAllInteractableHTMLElements] isElementHidden"),c.set(y),h(y)},"getAllInteractableHTMLElements"),bM=a(t=>["img","video","audio","a","svg","button"].includes(t.tagName.toLowerCase())?!0:Array.from(t.childNodes).filter(e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim()).length>0,"hasUniqueFeatures"),wM=a(t=>{if(t._checksum_eventListenerList){let i=t._checksum_eventListenerList;if(zl.some(s=>i[s.slice(2)]))return!0}let e=Object.keys(t).find(i=>i.startsWith("__reactFiber")),n=e?t[e]:void 0;return!n||!n.memoizedProps?!1:Uh.some(i=>n.memoizedProps[i])},"hasFrameworkInteractionListener");var Zh=16e3;var MM=!0,Kl={markTransparentElementsAsHidden:!1,markElementsHiddenByTransparentElementAsVisible:!0},Pr=class{constructor(){this.checksumIdToRRwebIdMap={};this.flashingElementsDetector=new cs;this.forceIncludeElements=[];this.preMapReducedHTMLSelectors=!1;this.useRrwebIdsAsChecksumIds=!1;this.excludedNodes=0;this.reducePercentage=50;this.scrollableElements={};this.defaultReduceHTMLOptions={checkElementInstanceType:!0,extraAllowedAttributes:[],initialChecksumId:void 0,forceIncludeFileInput:!1,forceIncludeAttribute:void 0,invalidateCache:!1,svgIntegration:"aria-label",includeFlashingElements:!0,onForceIncludeElement:a(()=>{},"onForceIncludeElement"),limitNodeRepetitions:50,stopFlashingElementsDetection:!1,assignChecksumIdsToAllElements:!0,assignRrwebIdsToAllElements:!0,fromTimeMachine:!1}}static{a(this,"HTMLReducer")}preprocessDocument(e=document){kn("[preprocessDocument] querySelectorAllExtended");let n=pe("*",e,{includeHTML:!0});Fn("[preprocessDocument] querySelectorAllExtended"),kn("[preprocessDocument] isElementHidden");for(let i of n){if(this.shouldIgnoreElement(i))continue;let s=ut(i,Kl);i.setAttribute("checksum-data-visible",!s.isHidden&&!s.isTransparent?"true":"false"),!s.isHidden&&s.isTransparent&&i.setAttribute("checksum-data-transparently-visible","true"),s.isBehindTransparentElement&&i.setAttribute("checksum-data-visible-under-transparent-element","true"),s.clickOffset&&i.setAttribute("checksum-data-click-offset",`${s.clickOffset.x};${s.clickOffset.y}`),this.markScrollableElement(i)}Fn("[preprocessDocument] isElementHidden")}markScrollableElement(e){let{canScrollX:n,canScrollY:i,progressX:s,progressY:l}=st.getScrollData(e);if(n&&(e.setAttribute("data-scrollable-x","true"),e.setAttribute("data-scrollable-x-progress",s.toString())),i&&(e.setAttribute("data-scrollable-y","true"),e.setAttribute("data-scrollable-y-progress",l.toString())),n||i)try{let{id:c}=this.getSessionMirror().getMeta(e);c&&(this.scrollableElements[c]={x:n?s:void 0,y:i?l:void 0})}catch(c){console.error("[markScrollableElement] Error getting rrwebId and updating scrollable elements",e,c)}}setSessionRecorder(e){this.sessionRecorder=e}markInteractableElements(e,n=document,{forceIncludeAttribute:i,forceIncludeFileInput:s}={}){kn("[markInteractableElements]"),this.interactableElements=[];let l=$t(n,e,{allowDisabled:!0,excludeCrossOriginIframes:!1}),c=a((f,p)=>(f._checksumid||(f._checksumid=p??this.checksumIdCounter.getAndIncrement()),f.setAttribute("checksumid",f._checksumid),f.setAttribute("checksuminteractable","true"),f._checksumid),"setChecksumIdForElement"),u=a((f,p=!1,g)=>{if(this.shouldIgnoreElement(f))return;let y=f.getAttribute("checksum-data-click-offset")?.split(";"),S=y&&{x:parseInt(y[0]),y:parseInt(y[1])},w=c(f,g);this.interactableElements.push({checksumId:w,element:f,forced:p,clickOffset:S})},"handleInteractableElement");l.forEach(f=>u(f));let h=a(f=>{pe(f,n,{includeHTML:!0}).forEach(p=>u(p,!0))},"forceIncludeSelector");i&&h(`[${i}]`),s&&h("input[type='file']"),this.forceIncludeElements.filter(({element:f})=>f?.isConnected).forEach(({element:f,checksumid:p})=>u(f,!0,p)),console.log(`Marked ${this.interactableElements.length} interactable elements`),Fn("[markInteractableElements]")}truthyFilter(e){return!!e}shouldIgnoreElement(e){return e.hasAttribute(ki)}getSessionMirror(e=!1){return e?window.checksum.timeMachine.sessionReplayer:this.sessionRecorder}generateSimplifiedDom(e,n,{extraAllowedAttributes:i=[],checkElementInstanceType:s=!0,forceIncludeAttribute:l=void 0,forceIncludeFileInput:c=!1,svgIntegration:u="aria-label",onForceIncludeElement:h=void 0,contentWindow:f=window,assignChecksumIdsToAllElements:p=!0,assignRrwebIdsToAllElements:g=!0,fromTimeMachine:y=!1}={}){if(!e)return null;let S=a((ge,Y=ge)=>{if(ge._originalNode=Y,!Be(ge,"Element")||!Be(Y,"Element"))return ge;let W=ge,te=Y;if(p&&!te.hasAttribute("checksumid")&&(te._checksumid||(te._checksumid=this.checksumIdCounter.getAndIncrement()),W.setAttribute("checksumid",te._checksumid),this.nonInteractableElementsFromSimplifiedDom.push({checksumId:te._checksumid,element:te})),g){let Te=this.getSessionMirror(y);if(Te){let Re=Te.getMeta(te)?.id?.toString();Re&&(W.setAttribute("rrwebid",Re),this.useRrwebIdsAsChecksumIds&&(W.setAttribute("checksumid",Re),W._checksumid=Re))}}return this.checksumIdToRRwebIdMap[te._checksumid]=parseInt(te._rrwebid),ge},"processSimplifiedDOMNode"),w=a((ge,Y=e)=>S(document.createTextNode(ge),Y),"createTextNode"),M=a((ge,Y=e)=>S(document.createElement(ge),Y),"createElementNode");if(e.nodeType===Node.ELEMENT_NODE){let ge=e;if(ge.tagName.toLowerCase()==="head"||this.shouldIgnoreElement(ge))return null}if(e.nodeType===Node.TEXT_NODE)return!e.parentElement||e.parentElement.getAttribute("checksum-data-visible")==="false"&&!e.parentElement.hasAttribute("checksumid")||e.parentElement.tagName.toLowerCase()==="body"?null:e.textContent?.trim()?w(e.textContent+" "):null;if(e.nodeType!==Node.ELEMENT_NODE||s&&!(Be(e,"HTMLElement")||Be(e,"SVGElement")))return null;let T=e,C=T.tagName.toLowerCase()==="iframe"&&T.contentDocument,N=On(C?T.contentDocument.documentElement:T,{flattenShadowRootChildren:!0});n.esraSelectionRules?.limitChildren?.forEach(ge=>{T.matches(ge.selector)&&N.length>ge.limit&&N.splice(ge.limit)});let A=N.map(ge=>this.generateSimplifiedDom(ge,n,{extraAllowedAttributes:i,checkElementInstanceType:s,forceIncludeAttribute:l,forceIncludeFileInput:c,svgIntegration:u,onForceIncludeElement:h,contentWindow:C?T.contentWindow:f,assignChecksumIdsToAllElements:p,assignRrwebIdsToAllElements:g,fromTimeMachine:y})).filter(this.truthyFilter),k=T.getAttribute("checksum-data-visible")!=="false",z=T.hasAttribute("checksumid"),q=T.hasAttribute("role"),{customDescription:oe,customDescriptionTarget:$}=this.getElementCustomDescription(T,{enableSVGCustomDescription:!!u}),Z=!!oe,de=T.hasAttribute("aria-label")||T.hasAttribute("name")||T.hasAttribute("alt"),G=T.hasAttribute(ds)||this.forceIncludeElements.map(ge=>ge.element).includes(T)||!!l&&T.hasAttribute(l)||c&&T.tagName.toLowerCase()==="input"&&T.getAttribute("type")==="file",B=["form","button","input","textarea","a","table","th","tr","td","section","nav","header","footer","main","article","aside","li","ul","select","option","datalist"],X=z||k&&(q||de||Z||T.matches(B.join(",")));if(!(X||G)){if(!A.length)return null;if(A.length===1&&!Be(A[0],"Text"))return A[0]}!X&&G&&h?.(T);let Q=a(()=>{if(Z)switch($){case"svg":switch(u){case"aria-label":let Y=M("svg");return Y.setAttribute("aria-label",oe),{simplifiedNode:Y,appendChildren:!1};case"text":if(T.hasAttribute("checksumid")){let te=M("div");return te.innerText=oe,{simplifiedNode:te,appendChildren:!1}}return{simplifiedNode:w(` [${oe}] `),appendChildren:!1}}}let ge=T.tagName.toLowerCase()==="body"&&T.ownerDocument!==document?"div":T.tagName;return{simplifiedNode:M(ge)}},"makeSimplifiedNode"),{simplifiedNode:ne,appendChildren:Ne=!0}=Q();if(!Be(ne,"Element"))return ne;let Ue=ne,$e=["aria-.+","data-name","name","type","placeholder","content","value","role","icon","title","checksumid","checksuminteractable","checksum-get-more-items","checked","disabled","selected","label","required","inputmode","min","max","step","minlength","maxlength","alt","hidden","draggable","ondrop","ondragover","contenteditable","href","(data-)?test(-)?id"].concat(i),Ht=T.attributes;for(let ge of Ht)for(let Y of $e)new RegExp("^"+Y+"$").test(ge.name)&&Ue.setAttribute(ge.name,ge.value??!0);if(T.isContentEditable?Ue.setAttribute("contenteditable","true"):!["TEXTAREA","INPUT","SELECT"].includes(T.tagName)&&window.getComputedStyle(T).cursor==="text"&&Ue.setAttribute("contenteditable","cursor-text"),Be(T,"HTMLInputElement")&&T.getAttribute("type")==="checkbox")T.checked&&Ue.setAttribute("checked","true");else if(Be(T,"HTMLInputElement")||Be(T,"HTMLSelectElement"))Ue.setAttribute("value",T.value);else if(Be(T,"HTMLTextAreaElement")&&!T.childNodes.length&&T.value){let ge=w(T.value);Ue.appendChild(ge)}return Ne&&A.forEach(ge=>Ue.appendChild(ge)),Ue}getElementCustomDescription(e,{enableSVGCustomDescription:n=!0}={}){return(Be(e,"SVGElement")||e.tagName.toLowerCase()==="svg")&&n?{customDescriptionTarget:"svg",customDescription:this.getSVGDescriptionForElement(e)}:{}}getSVGDescriptionForElement(e){let n=this.findSvgElementDescriptionFromBank(e);if(n)return n;let i=e.querySelector("title");if(i)return i.textContent}findSvgElementDescriptionFromBank(e){return this.getSvgBank().find(n=>e.matches(`svg:has(${n.selector})`))?.description}getSvgBank(){return zh}restoreDom(e=document){pe("*",e).forEach(i=>{i.removeAttribute("checksum-data-visible"),i.removeAttribute("checksum-data-transparently-visible"),i.removeAttribute("checksum-data-visible-under-transparent-element"),i.removeAttribute("checksumid"),i.removeAttribute("checksuminteractable"),i.removeAttribute("checksum-data-click-offset"),i.removeAttribute(ki),i.removeAttribute(ds),i.removeAttribute("data-scrollable-x"),i.removeAttribute("data-scrollable-y"),i.removeAttribute("data-scrollable-x-progress"),i.removeAttribute("data-scrollable-y-progress"),i.removeAttribute("rrwebid")})}removeAttribute(e){pe("*",document).forEach(i=>{i.removeAttribute(e)})}async mapAndStoreSelectors(){let e={},n=new pt;for(let{checksumId:i,element:s,clickOffset:l,selector:c,locator:u,parentFramesSelectors:h}of await n.injectSelectorsAndLocators(this.interactableElementsFromSimplifiedDom)){if(!c){console.warn("Unable to get selector for element",s);continue}let f=s;e[i]={element:f,selector:c,locator:u,clickOffset:l,parentFramesSelectors:h,innerText:f.innerText,rrwebId:this.checksumIdToRRwebIdMap[i]}}return e}shouldFurtherReduce(e){return e?e.outerHTML.length>Zh:!0}async reduce(e=document,n,i={}){console.time("reduceHTML");let{initialChecksumId:s,forceIncludeAttribute:l,forceIncludeFileInput:c,invalidateCache:u,includeFlashingElements:h,limitNodeRepetitions:f,stopFlashingElementsDetection:p}=this.lastReduceHTMLOptions={...this.defaultReduceHTMLOptions,...i},g=wt.getInstance("reduce",{target:e,monitorInput:!0,invalidate:u,log:!1});if(g.hasCache())return g.get();let y=h?this.flashingElementsDetector.get():void 0;p&&this.flashingElementsDetector.stop(),this.nodeRepetitionsThreshold=f,this.reducePercentage=50,this.templateNodes=void 0,this.excludedNodes=0,this.scrollableElements={};let S=a(C=>Kh(C,{forceIncludeAttribute:l,forceIncludeFileInput:c,forceIncludeElements:this.forceIncludeElements.map(N=>N.element),limit:Math.min(Math.ceil(C.element.children.length*(this.reducePercentage/100)),C.element.children.length-6)}),"templateReducer");console.log("Running pre-templatize"),this.templatize(S),console.log("Preprocessing document..."),this.preprocessDocument(e);let w;for((s||!this.checksumIdCounter)&&(this.checksumIdCounter=new Fr(s??"0")),console.log("Marking interactable elements..."),this.markInteractableElements(n,e,{forceIncludeAttribute:l,forceIncludeFileInput:c});;){if(console.log("Generating simplified DOM..."),this.nonInteractableElementsFromSimplifiedDom=[],w=this.generateSimplifiedDom(e.documentElement,n,this.lastReduceHTMLOptions),!w)throw new Error("Unable to get simplified DOM");if(this.shouldFurtherReduce(w)){if(console.log(`Will further reduce (${w.outerHTML.length})...`),!this.templatize(S)){console.log(`Exceeded maximum html reduction, stopping (html size: ${w.outerHTML.length})`);break}}else break}console.log("Simplified DOM generated, length:",w.outerHTML.length);let M=new Set(Array.from(w.querySelectorAll("[checksumid]")).map(C=>C.getAttribute("checksumid")));this.interactableElementsFromSimplifiedDom=this.interactableElements.filter(C=>M.has(C.checksumId)),console.log(`Found ${this.interactableElementsFromSimplifiedDom.length} interactable elements in simplified DOM vs ${this.interactableElements.length} in original DOM`),console.log("Restoring DOM..."),this.restoreDom(e),this.preMapReducedHTMLSelectors=MM?!1:!!n.preMapReducedHTMLSelectors,this.preMapReducedHTMLSelectors?(console.log("Mapping selectors..."),this.selectors=await this.mapAndStoreSelectors(),console.log("Done mapping selectors")):this.selectors={},this.elementsInSimplifiedDomByChecksumId=[...this.interactableElementsFromSimplifiedDom,...this.nonInteractableElementsFromSimplifiedDom].reduce((C,N)=>(C[N.checksumId]=N,C),{});let T={reducedDomHTMLElement:w,reducedHTML:w.outerHTML,currentChecksumId:this.checksumIdCounter.get(),flashingHTML:y,scrollableElements:this.scrollableElements};return g.set(T),console.timeEnd("reduceHTML"),T}templatize(e){let n=this.excludedNodes,i=a(()=>Array.from(this.templateNodes).reduce((s,l)=>s+e(l).length,0),"calcExculdedNodes");if(!this.templateNodes)this.templateNodes=en(document.body,{nodeRepetitionsThreshold:this.nodeRepetitionsThreshold}),this.excludedNodes=i();else do{if(this.reducePercentage<98)this.reducePercentage=Math.min(this.reducePercentage+20,98),console.log("Increasing reduce percentage to",this.reducePercentage);else{if(this.nodeRepetitionsThreshold<=20)return!1;this.reducePercentage=50,this.nodeRepetitionsThreshold-=10,console.log("Reducing node repetitions threshold to",this.nodeRepetitionsThreshold),this.templateNodes=en(document.body,{nodeRepetitionsThreshold:this.nodeRepetitionsThreshold})}this.excludedNodes=i()}while(n===this.excludedNodes);return console.log(`[templatize] ${this.excludedNodes} elements marked to ignore for ${this.templateNodes.length} templates`),!0}getMoreElementsFromTemplate(e,n){try{let i=this.templateNodes.find(f=>f.id===e);if(!i)throw new Error("Template not found");let{element:s,excludedElements:l}=i;console.log("Preprocessing template node..."),this.preprocessDocument(s),console.log("Marking template interactable elements..."),this.markInteractableElements(n,s,this.lastReduceHTMLOptions);let c=[],u=a(()=>c.map(f=>f.outerHTML).join(""),"getElementsHTML"),h=l.values();for(;u().length<Zh*.5;){let f=h.next().value;if(!f)break;let p=Array.from(f.querySelectorAll("[checksumid]")).concat(f._checksumid?[f]:[]);this.interactableElements.filter(g=>p.includes(g.element)).forEach(g=>{this.elementsInSimplifiedDomByChecksumId[g.element._checksumid]=g}),c.push(this.generateSimplifiedDom(f,n,this.lastReduceHTMLOptions)),l.delete(f)}return this.restoreDom(s),{items:u(),hasMoreItems:l.size>0}}catch(i){console.error("[getMoreElementsFromTemplate] error",i);return}}async getSelectorForChecksumId(e,{forceGenerate:n=!1}={}){let i=a(f=>({selector:e,element:f?f.element:null,locator:"",parentFramesSelectors:[],invalid:!0,rrwebId:this.checksumIdToRRwebIdMap[e],clickOffset:f?.clickOffset,innerText:f?f.element.innerText:""}),"makeDefaultResult"),s=new pt,l=this.elementsInSimplifiedDomByChecksumId[e];if(!l||!l.element.isConnected)return this.preMapReducedHTMLSelectors&&this.selectors[e]?this.selectors[e]:i(l);let{selector:c,locator:u,parentFramesSelectors:h}=await s.getSelectorAndLocator(l.element);return{...i(l),selector:c,locator:u,parentFramesSelectors:h,invalid:!1}}getElementForChecksumId(e){return this.elementsInSimplifiedDomByChecksumId[e]?.element}hasInnerTextByChecksumId(e,{maxLength:n=void 0,minLength:i=void 0}={}){if(!this.preMapReducedHTMLSelectors){let l=this.elementsInSimplifiedDomByChecksumId[e]?.element?.innerText;return!(!l||i&&l.length<i||n&&l.length>n)}return!!this.selectors[e]?.innerText}getInteractableElements(){return this.interactableElements}getInteractableElementsInReducedHTML(){return this.interactableElementsFromSimplifiedDom}startFlashingElementsDetection(){return this.flashingElementsDetector.start()}addForceIncludeElement(e){this.forceIncludeElements.push(e),e.element._checksumid=e.checksumid}};var TM=!0,Hr=class{constructor(){this.esraExtractors=[];this.playwrightSelector=new pt;this.defaultModulesState={extractReducedHtmlAndSelector:!1,inspectInteractableElements:!1,extractEsraMetadata:!0,extractPlaywrightSelector:!0};this.previousTargetNodeForReducedHTML=void 0;this.currentReducedHTMLChecksumIdAllocationCount="0";this.htmlReducer=new Pr}static{a(this,"SessionDigesterSelector")}async getSelector(e,{extractPlaywrightSelector:n=!0,extractEsraMetadata:i=this.defaultModulesState.extractEsraMetadata,extractReducedHtmlAndSelector:s=this.defaultModulesState.extractReducedHtmlAndSelector,inspectInteractableElements:l=this.defaultModulesState.inspectInteractableElements}={}){if(!e)return null;let c={};if(i){console.log("extracting ESRA metadata...");let u=this.getESRAExtractor(e).extract(e);c.esraMetadata=u.toMetadata(),console.log("ESRA metadata extraction complete")}if(n){console.log("extracting playwright selector...");let{selector:u,locator:h,parentFramesSelectors:f}=await this.playwrightSelector.getSelectorAndLocator(e);c.playwrightSelector=u,c.playwrightLocator=h,c.playwrightParentFramesSelectors=f,console.log("Playwright selector extraction complete")}return s&&(console.log("extracting reduced HTML..."),c.reducedHTML=await this.getReducedHTMLAndTargetNodeSelector(e),console.log("Reduced HTML extraction complete")),l&&(console.log("extracting element inspection..."),c.interactionFoundOnInspection=await this.isElementInteractable(e),console.log("Element inspection extraction complete")),console.log("[SessionDigesterSelector] complete",c),c}async selector(e){return this.playwrightSelector.selector(e)}setAppRules(e){this.appSpecificRules=e}setOptions({defaultExtractReducedHtmlAndSelector:e,defaultInspectInteractableElements:n,defaultExtractEsraMetadata:i}){this.defaultModulesState.extractReducedHtmlAndSelector=e,this.defaultModulesState.inspectInteractableElements=n,this.defaultModulesState.extractEsraMetadata=i}async getReducedHTMLAndTargetNodeSelector(e){let n="checksum-target-node";e.setAttribute(n,"true");let i=this.previousTargetNodeForReducedHTML&&this.previousTargetNodeForReducedHTML!==e;this.previousTargetNodeForReducedHTML=e;let s=!1,l=a(g=>{g.hasAttribute(n)&&(s=!0)},"onForceIncludeElement"),{reducedDomHTMLElement:c,reducedHTML:u,currentChecksumId:h}=await this.htmlReducer.reduce(e.ownerDocument,{...this.appSpecificRules,preMapReducedHTMLSelectors:!1},{initialChecksumId:this.currentReducedHTMLChecksumIdAllocationCount,extraAllowedAttributes:[n],checkElementInstanceType:!1,forceIncludeAttribute:TM?n:void 0,invalidateCache:i,onForceIncludeElement:l});e.removeAttribute(n),this.currentReducedHTMLChecksumIdAllocationCount=h;let f=c.matches(`[${n}=true]`)?c:c.querySelector(`[${n}=true]`),p=f?f.getAttribute("checksumid"):void 0;return{html:u,selector:p,targetForceIncluded:s}}getESRAExtractor(e){let n=this.esraExtractors.find(s=>s.isSameDocument(e.ownerDocument));if(n)return n;let i=new mt(e.ownerDocument);return this.esraExtractors.push(i),i}async isElementInteractable(e){let n=this.htmlReducer.getInteractableElements();return n&&n.length?n.some(s=>s.element===e&&!s.forced):(await $t(e.ownerDocument,this.appSpecificRules)).includes(e)}};var xM=Object.defineProperty,CM=a((t,e,n)=>e in t?xM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"__defNormalProp"),O=a((t,e,n)=>(CM(t,typeof e!="symbol"?e+"":e,n),n),"__publicField"),Qh,IM=Object.defineProperty,AM=a((t,e,n)=>e in t?IM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"__defNormalProp$1"),ar=a((t,e,n)=>(AM(t,typeof e!="symbol"?e+"":e,n),n),"__publicField$1"),ce=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(ce||{});function Nf(t){return t.nodeType===t.ELEMENT_NODE}a(Nf,"isElement");function Wi(t){let e=t?.host;return e?.shadowRoot===t}a(Wi,"isShadowRoot");function Vi(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}a(Vi,"isNativeShadowDom");function RM(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t}a(RM,"fixBrowserCompatibilityIssuesInCSS");function LM(t){let{cssText:e}=t;if(e.split('"').length<3)return e;let n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}a(LM,"escapeImportStatement");function gs(t){try{let e=t.rules||t.cssRules;return e?RM(Array.from(e,Df).join("")):null}catch{return null}}a(gs,"stringifyStylesheet");function Df(t){let e;if(DM(t))try{e=gs(t.styleSheet)||LM(t)}catch{}else if(_M(t)&&t.selectorText.includes(":"))return NM(t.cssText);return e||t.cssText}a(Df,"stringifyRule");function NM(t){let e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}a(NM,"fixSafariColons");function DM(t){return"styleSheet"in t}a(DM,"isCSSImportRule");function _M(t){return"selectorText"in t}a(_M,"isCSSStyleRule");var $i=class{static{a(this,"Mirror")}constructor(){ar(this,"idNodeMap",new Map),ar(this,"nodeMetaMap",new WeakMap)}getId(e){var n;return e?((n=this.getMeta(e))==null?void 0:n.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){let i=n.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,n)}replace(e,n){let i=this.getNode(e);if(i){let s=this.nodeMetaMap.get(i);s&&this.nodeMetaMap.set(n,s)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function _f(){return new $i}a(_f,"createMirror$2");function bc({element:t,maskInputOptions:e,tagName:n,type:i,value:s,maskInputFn:l}){let c=s||"",u=i&&Bn(i);return(e[n.toLowerCase()]||u&&e[u])&&(l?c=l(c,t):c="*".repeat(c.length)),c}a(bc,"maskInputValue");function Bn(t){return t.toLowerCase()}a(Bn,"toLowerCase");var Jh="__rrweb_original__";function OM(t){let e=t.getContext("2d");if(!e)return!0;let n=50;for(let i=0;i<t.width;i+=n)for(let s=0;s<t.height;s+=n){let l=e.getImageData,c=Jh in l?l[Jh]:l;if(new Uint32Array(c.call(e,i,s,Math.min(n,t.width-i),Math.min(n,t.height-s)).data.buffer).some(h=>h!==0))return!1}return!0}a(OM,"is2DCanvasBlank");function kM(t,e){return!t||!e||t.type!==e.type?!1:t.type===ce.Document?t.compatMode===e.compatMode:t.type===ce.DocumentType?t.name===e.name&&t.publicId===e.publicId&&t.systemId===e.systemId:t.type===ce.Comment||t.type===ce.Text||t.type===ce.CDATA?t.textContent===e.textContent:t.type===ce.Element?t.tagName===e.tagName&&JSON.stringify(t.attributes)===JSON.stringify(e.attributes)&&t.isSVG===e.isSVG&&t.needBlock===e.needBlock:!1}a(kM,"isNodeMetaEqual");function wc(t){let e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Bn(e):null}a(wc,"getInputType");function Of(t,e){let n;try{n=new URL(t,e??window.location.href)}catch{return null}let i=/\.([0-9a-z]+)(?:$)/i,s=n.pathname.match(i);return s?.[1]??null}a(Of,"extractFileExtension");var FM=1,PM=new RegExp("[^a-z0-9-_:]"),zi=-2;function kf(){return FM++}a(kf,"genId");function HM(t){if(t instanceof HTMLFormElement)return"form";let e=Bn(t.tagName);return PM.test(e)?"div":e}a(HM,"getValidTagName$1");function WM(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}a(WM,"extractOrigin");var Wr,ef,VM=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,BM=/^(?:[a-z+]+:)?\/\//i,GM=/^www\..*/i,UM=/^(data:)([^,]*),(.*)/i;function ys(t,e){return(t||"").replace(VM,(n,i,s,l,c,u)=>{let h=s||c||u,f=i||l||"";if(!h)return n;if(BM.test(h)||GM.test(h))return`url(${f}${h}${f})`;if(UM.test(h))return`url(${f}${h}${f})`;if(h[0]==="/")return`url(${f}${WM(e)+h}${f})`;let p=e.split("/"),g=h.split("/");p.pop();for(let y of g)y!=="."&&(y===".."?p.pop():p.push(y));return`url(${f}${p.join("/")}${f})`})}a(ys,"absoluteToStylesheet");var $M=/^[^ \t\n\r\u000c]+/,zM=/^[, \t\n\r\u000c]+/;function qM(t,e){if(e.trim()==="")return e;let n=0;function i(l){let c,u=l.exec(e.substring(n));return u?(c=u[0],n+=c.length,c):""}a(i,"collectCharacters");let s=[];for(;i(zM),!(n>=e.length);){let l=i($M);if(l.slice(-1)===",")l=Ur(t,l.substring(0,l.length-1)),s.push(l);else{let c="";l=Ur(t,l);let u=!1;for(;;){let h=e.charAt(n);if(h===""){s.push((l+c).trim());break}else if(u)h===")"&&(u=!1);else if(h===","){n+=1,s.push((l+c).trim());break}else h==="("&&(u=!0);c+=h,n+=1}}}return s.join(", ")}a(qM,"getAbsoluteSrcsetString");var tf=new WeakMap;function Ur(t,e){return!e||e.trim()===""?e:Ds(t,e)}a(Ur,"absoluteToDoc");function YM(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}a(YM,"isSVGElement");function Ds(t,e){let n=tf.get(t);if(n||(n=t.createElement("a"),tf.set(t,n)),!e)e="";else if(e.startsWith("blob:")||e.startsWith("data:"))return e;return n.setAttribute("href",e),n.href}a(Ds,"getHref");function Ff(t,e,n,i){return i&&(n==="src"||n==="href"&&!(e==="use"&&i[0]==="#")||n==="xlink:href"&&i[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?Ur(t,i):n==="srcset"?qM(t,i):n==="style"?ys(i,Ds(t)):e==="object"&&n==="data"?Ur(t,i):i)}a(Ff,"transformAttribute");function Pf(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}a(Pf,"ignoreAttribute");function KM(t,e,n){try{if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let i=t.classList.length;i--;){let s=t.classList[i];if(e.test(s))return!0}if(n)return t.matches(n)}catch{}return!1}a(KM,"_isBlockedElement");function Es(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return n?Es(t.parentNode,e,n):!1;for(let i=t.classList.length;i--;){let s=t.classList[i];if(e.test(s))return!0}return n?Es(t.parentNode,e,n):!1}a(Es,"classMatchesRegex");function Hf(t,e,n,i){try{let s=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(s===null)return!1;if(typeof e=="string"){if(i){if(s.closest(`.${e}`))return!0}else if(s.classList.contains(e))return!0}else if(Es(s,e,i))return!0;if(n){if(i){if(s.closest(n))return!0}else if(s.matches(n))return!0}}catch{}return!1}a(Hf,"needMaskingText");function XM(t,e,n){let i=t.contentWindow;if(!i)return;let s=!1,l;try{l=i.document.readyState}catch{return}if(l!=="complete"){let u=setTimeout(()=>{s||(e(),s=!0)},n);t.addEventListener("load",()=>{clearTimeout(u),s=!0,e()});return}let c="about:blank";if(i.location.href!==c||t.src===c||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}a(XM,"onceIframeLoaded");function jM(t,e,n){let i=!1,s;try{s=t.sheet}catch{return}if(s)return;let l=setTimeout(()=>{i||(e(),i=!0)},n);t.addEventListener("load",()=>{clearTimeout(l),i=!0,e()})}a(jM,"onceStylesheetLoaded");function ZM(t,e){let{doc:n,mirror:i,blockClass:s,blockSelector:l,needsMask:c,inlineStylesheet:u,maskInputOptions:h={},maskTextFn:f,maskInputFn:p,dataURLOptions:g={},inlineImages:y,recordCanvas:S,keepIframeSrcFn:w,newlyAddedElement:M=!1}=e,T=QM(n,i);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:ce.Document,childNodes:[],compatMode:t.compatMode}:{type:ce.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:ce.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:T};case t.ELEMENT_NODE:return eT(t,{doc:n,blockClass:s,blockSelector:l,inlineStylesheet:u,maskInputOptions:h,maskInputFn:p,dataURLOptions:g,inlineImages:y,recordCanvas:S,keepIframeSrcFn:w,newlyAddedElement:M,rootId:T});case t.TEXT_NODE:return JM(t,{doc:n,needsMask:c,maskTextFn:f,rootId:T});case t.CDATA_SECTION_NODE:return{type:ce.CDATA,textContent:"",rootId:T};case t.COMMENT_NODE:return{type:ce.Comment,textContent:t.textContent||"",rootId:T};default:return!1}}a(ZM,"serializeNode");function QM(t,e){if(!e.hasNode(t))return;let n=e.getId(t);return n===1?void 0:n}a(QM,"getRootId");function JM(t,e){var n;let{needsMask:i,maskTextFn:s,rootId:l}=e,c=t.parentNode&&t.parentNode.tagName,u=t.textContent,h=c==="STYLE"?!0:void 0,f=c==="SCRIPT"?!0:void 0;if(h&&u){try{t.nextSibling||t.previousSibling||(n=t.parentNode.sheet)!=null&&n.cssRules&&(u=gs(t.parentNode.sheet))}catch(p){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${p}`,t)}u=ys(u,Ds(e.doc))}return f&&(u="SCRIPT_PLACEHOLDER"),!h&&!f&&u&&i&&(u=s?s(u,t.parentElement):u.replace(/[\S]/g,"*")),{type:ce.Text,textContent:u||"",isStyle:h,rootId:l}}a(JM,"serializeTextNode");function eT(t,e){let{doc:n,blockClass:i,blockSelector:s,inlineStylesheet:l,maskInputOptions:c={},maskInputFn:u,dataURLOptions:h={},inlineImages:f,recordCanvas:p,keepIframeSrcFn:g,newlyAddedElement:y=!1,rootId:S}=e,w=KM(t,i,s),M=HM(t),T={},C=t.attributes.length;for(let A=0;A<C;A++){let k=t.attributes[A];Pf(M,k.name,k.value)||(T[k.name]=Ff(n,M,Bn(k.name),k.value))}if(M==="link"&&l){let A=Array.from(n.styleSheets).find(z=>z.href===t.href),k=null;A&&(k=gs(A)),k&&(delete T.rel,delete T.href,T._cssText=ys(k,A.href))}if(M==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){let A=gs(t.sheet);A&&(T._cssText=ys(A,Ds(n)))}if(M==="input"||M==="textarea"||M==="select"){let A=t.value,k=t.checked;T.type!=="radio"&&T.type!=="checkbox"&&T.type!=="submit"&&T.type!=="button"&&A?T.value=bc({element:t,type:wc(t),tagName:M,value:A,maskInputOptions:c,maskInputFn:u}):k&&(T.checked=k)}if(M==="option"&&(t.selected&&!c.select?T.selected=!0:delete T.selected),M==="canvas"&&p){if(t.__context==="2d")OM(t)||(T.rr_dataURL=t.toDataURL(h.type,h.quality));else if(!("__context"in t)){let A=t.toDataURL(h.type,h.quality),k=n.createElement("canvas");k.width=t.width,k.height=t.height;let z=k.toDataURL(h.type,h.quality);A!==z&&(T.rr_dataURL=A)}}if(M==="img"&&f){Wr||(Wr=n.createElement("canvas"),ef=Wr.getContext("2d"));let A=t,k=A.currentSrc||A.getAttribute("src")||"<unknown-src>",z=A.crossOrigin,q=a(()=>{A.removeEventListener("load",q);try{Wr.width=A.naturalWidth,Wr.height=A.naturalHeight,ef.drawImage(A,0,0),T.rr_dataURL=Wr.toDataURL(h.type,h.quality)}catch(oe){if(A.crossOrigin!=="anonymous"){A.crossOrigin="anonymous",A.complete&&A.naturalWidth!==0?q():A.addEventListener("load",q);return}else console.warn(`Cannot inline img src=${k}! Error: ${oe}`)}A.crossOrigin==="anonymous"&&(z?T.crossOrigin=z:A.removeAttribute("crossorigin"))},"recordInlineImage");A.complete&&A.naturalWidth!==0?q():A.addEventListener("load",q)}if(M==="audio"||M==="video"){let A=T;A.rr_mediaState=t.paused?"paused":"played",A.rr_mediaCurrentTime=t.currentTime,A.rr_mediaPlaybackRate=t.playbackRate,A.rr_mediaMuted=t.muted,A.rr_mediaLoop=t.loop,A.rr_mediaVolume=t.volume}if(y||(t.scrollLeft&&(T.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(T.rr_scrollTop=t.scrollTop)),w){let{width:A,height:k}=t.getBoundingClientRect();T={class:T.class,rr_width:`${A}px`,rr_height:`${k}px`}}M==="iframe"&&!g(T.src)&&(t.contentDocument||(T.rr_src=T.src),delete T.src);let N;try{customElements.get(M)&&(N=!0)}catch{}return{type:ce.Element,tagName:M,attributes:T,childNodes:[],isSVG:YM(t)||void 0,needBlock:w,rootId:S,isCustom:N}}a(eT,"serializeElementNode");function ke(t){return t==null?"":t.toLowerCase()}a(ke,"lowerIfExists");function tT(t,e){if(e.comment&&t.type===ce.Comment)return!0;if(t.type===ce.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&Of(t.attributes.href)==="js"))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(ke(t.attributes.name).match(/^msapplication-tile(image|color)$/)||ke(t.attributes.name)==="application-name"||ke(t.attributes.rel)==="icon"||ke(t.attributes.rel)==="apple-touch-icon"||ke(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&ke(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(ke(t.attributes.property).match(/^(og|twitter|fb):/)||ke(t.attributes.name).match(/^(og|twitter):/)||ke(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(ke(t.attributes.name)==="robots"||ke(t.attributes.name)==="googlebot"||ke(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(ke(t.attributes.name)==="author"||ke(t.attributes.name)==="generator"||ke(t.attributes.name)==="framework"||ke(t.attributes.name)==="publisher"||ke(t.attributes.name)==="progid"||ke(t.attributes.property).match(/^article:/)||ke(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(ke(t.attributes.name)==="google-site-verification"||ke(t.attributes.name)==="yandex-verification"||ke(t.attributes.name)==="csrf-token"||ke(t.attributes.name)==="p:domain_verify"||ke(t.attributes.name)==="verify-v1"||ke(t.attributes.name)==="verification"||ke(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}a(tT,"slimDOMExcluded");function $r(t,e){let{doc:n,mirror:i,blockClass:s,blockSelector:l,maskTextClass:c,maskTextSelector:u,skipChild:h=!1,inlineStylesheet:f=!0,maskInputOptions:p={},maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:w={},inlineImages:M=!1,recordCanvas:T=!1,onSerialize:C,onIframeLoad:N,iframeLoadTimeout:A=5e3,onStylesheetLoad:k,stylesheetLoadTimeout:z=5e3,keepIframeSrcFn:q=a(()=>!1,"keepIframeSrcFn"),newlyAddedElement:oe=!1}=e,{needsMask:$}=e,{preserveWhiteSpace:Z=!0}=e;!$&&t.childNodes&&($=Hf(t,c,u,$===void 0));let de=ZM(t,{doc:n,mirror:i,blockClass:s,blockSelector:l,needsMask:$,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:y,dataURLOptions:w,inlineImages:M,recordCanvas:T,keepIframeSrcFn:q,newlyAddedElement:oe});if(!de)return console.warn(t,"not serialized"),null;let G;i.hasNode(t)?G=i.getId(t):tT(de,S)||!Z&&de.type===ce.Text&&!de.isStyle&&!de.textContent.replace(/^\s+|\s+$/gm,"").length?G=zi:G=kf();let B=Object.assign(de,{id:G});if(i.add(t,B),G===zi)return null;C&&C(t);let X=!h;if(B.type===ce.Element){X=X&&!B.needBlock,delete B.needBlock;let j=t.shadowRoot;j&&Vi(j)&&(B.isShadowHost=!0)}if((B.type===ce.Document||B.type===ce.Element)&&X){S.headWhitespace&&B.type===ce.Element&&B.tagName==="head"&&(Z=!1);let j={doc:n,mirror:i,blockClass:s,blockSelector:l,needsMask:$,maskTextClass:c,maskTextSelector:u,skipChild:h,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:w,inlineImages:M,recordCanvas:T,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:N,iframeLoadTimeout:A,onStylesheetLoad:k,stylesheetLoadTimeout:z,keepIframeSrcFn:q};if(!(B.type===ce.Element&&B.tagName==="textarea"&&B.attributes.value!==void 0))for(let Q of Array.from(t.childNodes)){let ne=$r(Q,j);ne&&B.childNodes.push(ne)}if(Nf(t)&&t.shadowRoot)for(let Q of Array.from(t.shadowRoot.childNodes)){let ne=$r(Q,j);ne&&(Vi(t.shadowRoot)&&(ne.isShadow=!0),B.childNodes.push(ne))}}return t.parentNode&&Wi(t.parentNode)&&Vi(t.parentNode)&&(B.isShadow=!0),B.type===ce.Element&&B.tagName==="iframe"&&XM(t,()=>{let j=t.contentDocument;if(j&&N){let Q=$r(j,{doc:j,mirror:i,blockClass:s,blockSelector:l,needsMask:$,maskTextClass:c,maskTextSelector:u,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:w,inlineImages:M,recordCanvas:T,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:N,iframeLoadTimeout:A,onStylesheetLoad:k,stylesheetLoadTimeout:z,keepIframeSrcFn:q});Q&&N(t,Q)}},A),B.type===ce.Element&&B.tagName==="link"&&typeof B.attributes.rel=="string"&&(B.attributes.rel==="stylesheet"||B.attributes.rel==="preload"&&typeof B.attributes.href=="string"&&Of(B.attributes.href)==="css")&&jM(t,()=>{if(k){let j=$r(t,{doc:n,mirror:i,blockClass:s,blockSelector:l,needsMask:$,maskTextClass:c,maskTextSelector:u,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:y,slimDOMOptions:S,dataURLOptions:w,inlineImages:M,recordCanvas:T,preserveWhiteSpace:Z,onSerialize:C,onIframeLoad:N,iframeLoadTimeout:A,onStylesheetLoad:k,stylesheetLoadTimeout:z,keepIframeSrcFn:q});j&&k(t,j)}},z),B}a($r,"serializeNodeWithId");function nT(t,e){let{mirror:n=new $i,blockClass:i="rr-block",blockSelector:s=null,maskTextClass:l="rr-mask",maskTextSelector:c=null,inlineStylesheet:u=!0,inlineImages:h=!1,recordCanvas:f=!1,maskAllInputs:p=!1,maskTextFn:g,maskInputFn:y,slimDOM:S=!1,dataURLOptions:w,preserveWhiteSpace:M,onSerialize:T,onIframeLoad:C,iframeLoadTimeout:N,onStylesheetLoad:A,stylesheetLoadTimeout:k,keepIframeSrcFn:z=a(()=>!1,"keepIframeSrcFn")}=e||{};return $r(t,{doc:t,mirror:n,blockClass:i,blockSelector:s,maskTextClass:l,maskTextSelector:c,skipChild:!1,inlineStylesheet:u,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:p===!1?{password:!0}:p,maskTextFn:g,maskInputFn:y,slimDOMOptions:S===!0||S==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:S==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:S===!1?{}:S,dataURLOptions:w,inlineImages:h,recordCanvas:f,preserveWhiteSpace:M,onSerialize:T,onIframeLoad:C,iframeLoadTimeout:N,onStylesheetLoad:A,stylesheetLoadTimeout:k,keepIframeSrcFn:z,newlyAddedElement:!1})}a(nT,"snapshot");var nf=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function rT(t,e={}){let n=1,i=1;function s(Y){let W=Y.match(/\n/g);W&&(n+=W.length);let te=Y.lastIndexOf(`
`);i=te===-1?i+Y.length:Y.length-te}a(s,"updatePosition");function l(){let Y={line:n,column:i};return W=>(W.position=new u(Y),M(),W)}a(l,"position");let c=class Wf{static{a(this,"_Position2")}constructor(W){ar(this,"content"),ar(this,"start"),ar(this,"end"),ar(this,"source"),this.start=W,this.end={line:n,column:i},this.source=e.source,this.content=Wf.content}};ar(c,"content");let u=c;u.content=t;let h=[];function f(Y){let W=new Error(`${e.source||""}:${n}:${i}: ${Y}`);if(W.reason=Y,W.filename=e.source,W.line=n,W.column=i,W.source=t,e.silent)h.push(W);else throw W}a(f,"error");function p(){let Y=S();return{type:"stylesheet",stylesheet:{source:e.source,rules:Y,parsingErrors:h}}}a(p,"stylesheet");function g(){return w(/^{\s*/)}a(g,"open");function y(){return w(/^}/)}a(y,"close");function S(){let Y,W=[];for(M(),T(W);t.length&&t.charAt(0)!=="}"&&(Y=Ht()||ge());)Y&&(W.push(Y),T(W));return W}a(S,"rules2");function w(Y){let W=Y.exec(t);if(!W)return;let te=W[0];return s(te),t=t.slice(te.length),W}a(w,"match");function M(){w(/^\s*/)}a(M,"whitespace");function T(Y=[]){let W;for(;W=C();)W&&Y.push(W),W=C();return Y}a(T,"comments");function C(){let Y=l();if(t.charAt(0)!=="/"||t.charAt(1)!=="*")return;let W=2;for(;t.charAt(W)!==""&&(t.charAt(W)!=="*"||t.charAt(W+1)!=="/");)++W;if(W+=2,t.charAt(W-1)==="")return f("End of comment missing");let te=t.slice(2,W-2);return i+=2,s(te),t=t.slice(W),i+=2,Y({type:"comment",comment:te})}a(C,"comment");let N=new RegExp("^(("+[/[^\\]"(?:\\"|[^"])*"/.source,/[^\\]'(?:\\'|[^'])*'/.source,"[^{]"].join("|")+")+)");function A(){for(M();t[0]=="}";)f("extra closing bracket"),t=t.slice(1),M();let Y=w(N);if(!Y)return;let W=Y[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,te=>te.replace(/,/g,"\u200C"));return k(W).map(te=>te.replace(/\u200C/g,",").trim())}a(A,"selector");function k(Y){let W=[],te="",Te=0,Re=0,ze=null;for(let et of Y){let Yt=te.endsWith("\\");ze?ze===et&&!Yt&&(ze=null):et==="("?Te++:et===")"?Te--:et==="["?Re++:et==="]"?Re--:`'"`.includes(et)&&(ze=et),et===","&&Te===0&&Re===0?(W.push(te),te=""):te+=et}return te&&W.push(te),W}a(k,"customSplit");function z(){let Y=l(),W=w(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!W)return;let te=Pn(W[0]);if(!w(/^:\s*/))return f("property missing ':'");let Te=w(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),Re=Y({type:"declaration",property:te.replace(nf,""),value:Te?Pn(Te[0]).replace(nf,""):""});return w(/^[;\s]*/),Re}a(z,"declaration");function q(){let Y=[];if(!g())return f("missing '{'");T(Y);let W;for(;W=z();)W!==!1&&(Y.push(W),T(Y)),W=z();return y()?Y:f("missing '}'")}a(q,"declarations");function oe(){let Y,W=[],te=l();for(;Y=w(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)W.push(Y[1]),w(/^,\s*/);if(W.length)return te({type:"keyframe",values:W,declarations:q()})}a(oe,"keyframe");function $(){let Y=l(),W=w(/^@([-\w]+)?keyframes\s*/);if(!W)return;let te=W[1];if(W=w(/^([-\w]+)\s*/),!W)return f("@keyframes missing name");let Te=W[1];if(!g())return f("@keyframes missing '{'");let Re,ze=T();for(;Re=oe();)ze.push(Re),ze=ze.concat(T());return y()?Y({type:"keyframes",name:Te,vendor:te,keyframes:ze}):f("@keyframes missing '}'")}a($,"atkeyframes");function Z(){let Y=l(),W=w(/^@supports *([^{]+)/);if(!W)return;let te=Pn(W[1]);if(!g())return f("@supports missing '{'");let Te=T().concat(S());return y()?Y({type:"supports",supports:te,rules:Te}):f("@supports missing '}'")}a(Z,"atsupports");function de(){let Y=l();if(!w(/^@host\s*/))return;if(!g())return f("@host missing '{'");let te=T().concat(S());return y()?Y({type:"host",rules:te}):f("@host missing '}'")}a(de,"athost");function G(){let Y=l(),W=w(/^@media *([^{]+)/);if(!W)return;let te=Pn(W[1]);if(!g())return f("@media missing '{'");let Te=T().concat(S());return y()?Y({type:"media",media:te,rules:Te}):f("@media missing '}'")}a(G,"atmedia");function B(){let Y=l(),W=w(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(W)return Y({type:"custom-media",name:Pn(W[1]),media:Pn(W[2])})}a(B,"atcustommedia");function X(){let Y=l();if(!w(/^@page */))return;let te=A()||[];if(!g())return f("@page missing '{'");let Te=T(),Re;for(;Re=z();)Te.push(Re),Te=Te.concat(T());return y()?Y({type:"page",selectors:te,declarations:Te}):f("@page missing '}'")}a(X,"atpage");function j(){let Y=l(),W=w(/^@([-\w]+)?document *([^{]+)/);if(!W)return;let te=Pn(W[1]),Te=Pn(W[2]);if(!g())return f("@document missing '{'");let Re=T().concat(S());return y()?Y({type:"document",document:Te,vendor:te,rules:Re}):f("@document missing '}'")}a(j,"atdocument");function Q(){let Y=l();if(!w(/^@font-face\s*/))return;if(!g())return f("@font-face missing '{'");let te=T(),Te;for(;Te=z();)te.push(Te),te=te.concat(T());return y()?Y({type:"font-face",declarations:te}):f("@font-face missing '}'")}a(Q,"atfontface");let ne=$e("import"),Ne=$e("charset"),Ue=$e("namespace");function $e(Y){let W=new RegExp("^@"+Y+"\\s*((?:"+[/[^\\]"(?:\\"|[^"])*"/.source,/[^\\]'(?:\\'|[^'])*'/.source,"[^;]"].join("|")+")+);");return()=>{let te=l(),Te=w(W);if(!Te)return;let Re={type:Y};return Re[Y]=Te[1].trim(),te(Re)}}a($e,"_compileAtrule");function Ht(){if(t[0]==="@")return $()||G()||B()||Z()||ne()||Ne()||Ue()||j()||X()||de()||Q()}a(Ht,"atrule");function ge(){let Y=l(),W=A();return W?(T(),Y({type:"rule",selectors:W,declarations:q()})):f("selector missing")}return a(ge,"rule"),Jl(p())}a(rT,"parse");function Pn(t){return t?t.replace(/^\s+|\s+$/g,""):""}a(Pn,"trim");function Jl(t,e){let n=t&&typeof t.type=="string",i=n?t:e;for(let s of Object.keys(t)){let l=t[s];Array.isArray(l)?l.forEach(c=>{Jl(c,i)}):l&&typeof l=="object"&&Jl(l,i)}return n&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),t}a(Jl,"addParent");var rf={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function iT(t){let e=rf[t.tagName]?rf[t.tagName]:t.tagName;return e==="link"&&t.attributes._cssText&&(e="style"),e}a(iT,"getTagName");function of(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}a(of,"escapeRegExp");var Vf=/(max|min)-device-(width|height)/,oT=new RegExp(Vf.source,"g"),Bf=/([^\\]):hover/,sT=new RegExp(Bf.source,"g");function sf(t,e){let n=e?.stylesWithHoverClass.get(t);if(n)return n;let i=rT(t,{silent:!0});if(!i.stylesheet)return t;let s=[],l=[];function c(h){"selectors"in h&&h.selectors&&h.selectors.forEach(f=>{Bf.test(f)&&s.push(f)}),"media"in h&&h.media&&Vf.test(h.media)&&l.push(h.media),"rules"in h&&h.rules&&h.rules.forEach(c)}a(c,"getSelectors"),c(i.stylesheet);let u=t;if(s.length>0){let h=new RegExp(s.filter((f,p)=>s.indexOf(f)===p).sort((f,p)=>p.length-f.length).map(f=>of(f)).join("|"),"g");u=u.replace(h,f=>{let p=f.replace(sT,"$1.\\:hover");return`${f}, ${p}`})}if(l.length>0){let h=new RegExp(l.filter((f,p)=>l.indexOf(f)===p).sort((f,p)=>p.length-f.length).map(f=>of(f)).join("|"),"g");u=u.replace(h,f=>f.replace(oT,"$1-$2"))}return e?.stylesWithHoverClass.set(t,u),u}a(sf,"adaptCssForReplay");function af(){return{stylesWithHoverClass:new Map}}a(af,"createCache");function aT(t,e){var n;let{doc:i,hackCss:s,cache:l}=e;switch(t.type){case ce.Document:return i.implementation.createDocument(null,"",null);case ce.DocumentType:return i.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case ce.Element:{let c=iT(t),u;t.isSVG?u=i.createElementNS("http://www.w3.org/2000/svg",c):(t.isCustom&&((n=i.defaultView)!=null&&n.customElements)&&!i.defaultView.customElements.get(t.tagName)&&i.defaultView.customElements.define(t.tagName,class extends i.defaultView.HTMLElement{}),u=i.createElement(c));let h={};for(let f in t.attributes){if(!Object.prototype.hasOwnProperty.call(t.attributes,f))continue;let p=t.attributes[f];if(c==="option"&&f==="selected"&&p===!1||p===null)continue;if(p===!0&&(p=""),f.startsWith("rr_")){h[f]=p;continue}let g=c==="textarea"&&f==="value",y=c==="style"&&f==="_cssText";if(y&&s&&typeof p=="string"&&(p=sf(p,l)),(g||y)&&typeof p=="string"){u.appendChild(i.createTextNode(p)),t.childNodes=[];continue}try{if(t.isSVG&&f==="xlink:href")u.setAttributeNS("http://www.w3.org/1999/xlink",f,p.toString());else if(f==="onload"||f==="onclick"||f.substring(0,7)==="onmouse")u.setAttribute("_"+f,p.toString());else if(c==="meta"&&t.attributes["http-equiv"]==="Content-Security-Policy"&&f==="content"){u.setAttribute("csp-content",p.toString());continue}else c==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||c==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")||(c==="img"&&t.attributes.srcset&&t.attributes.rr_dataURL?u.setAttribute("rrweb-original-srcset",t.attributes.srcset):u.setAttribute(f,p.toString()))}catch{}}for(let f in h){let p=h[f];if(c==="canvas"&&f==="rr_dataURL"){let g=i.createElement("img");g.onload=()=>{let y=u.getContext("2d");y&&y.drawImage(g,0,0,g.width,g.height)},g.src=p.toString(),u.RRNodeType&&(u.rr_dataURL=p.toString())}else if(c==="img"&&f==="rr_dataURL"){let g=u;g.currentSrc.startsWith("data:")||(g.setAttribute("rrweb-original-src",t.attributes.src),g.src=p.toString())}if(f==="rr_width")u.style.width=p.toString();else if(f==="rr_height")u.style.height=p.toString();else if(f==="rr_mediaCurrentTime"&&typeof p=="number")u.currentTime=p;else if(f==="rr_mediaState")switch(p){case"played":u.play().catch(g=>console.warn("media playback error",g));break;case"paused":u.pause();break}else f==="rr_mediaPlaybackRate"&&typeof p=="number"?u.playbackRate=p:f==="rr_mediaMuted"&&typeof p=="boolean"?u.muted=p:f==="rr_mediaLoop"&&typeof p=="boolean"?u.loop=p:f==="rr_mediaVolume"&&typeof p=="number"&&(u.volume=p)}if(t.isShadowHost)if(!u.shadowRoot)u.attachShadow({mode:"open"});else for(;u.shadowRoot.firstChild;)u.shadowRoot.removeChild(u.shadowRoot.firstChild);return u}case ce.Text:return i.createTextNode(t.isStyle&&s?sf(t.textContent,l):t.textContent);case ce.CDATA:return i.createCDATASection(t.textContent);case ce.Comment:return i.createComment(t.textContent);default:return null}}a(aT,"buildNode");function Bi(t,e){let{doc:n,mirror:i,skipChild:s=!1,hackCss:l=!0,afterAppend:c,cache:u}=e;if(i.has(t.id)){let f=i.getNode(t.id),p=i.getMeta(f);if(kM(p,t))return i.getNode(t.id)}let h=aT(t,{doc:n,hackCss:l,cache:u});if(!h)return null;if(t.rootId&&i.getNode(t.rootId)!==n&&i.replace(t.rootId,n),t.type===ce.Document&&(n.close(),n.open(),t.compatMode==="BackCompat"&&t.childNodes&&t.childNodes[0].type!==ce.DocumentType&&(t.childNodes[0].type===ce.Element&&"xmlns"in t.childNodes[0].attributes&&t.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),h=n),i.add(h,t),(t.type===ce.Document||t.type===ce.Element)&&!s)for(let f of t.childNodes){let p=Bi(f,{doc:n,mirror:i,skipChild:!1,hackCss:l,afterAppend:c,cache:u});if(!p){console.warn("Failed to rebuild",f);continue}if(f.isShadow&&Nf(h)&&h.shadowRoot)h.shadowRoot.appendChild(p);else if(t.type===ce.Document&&f.type==ce.Element){let g=p,y=null;g.childNodes.forEach(S=>{S.nodeName==="BODY"&&(y=S)}),y?(g.removeChild(y),h.appendChild(p),g.appendChild(y)):h.appendChild(p)}else h.appendChild(p);c&&c(p,f.id)}return h}a(Bi,"buildNodeWithSN");function lT(t,e){function n(i){e(i)}a(n,"walk");for(let i of t.getIds())t.has(i)&&n(t.getNode(i))}a(lT,"visit");function cT(t,e){let n=e.getMeta(t);if(n?.type!==ce.Element)return;let i=t;for(let s in n.attributes){if(!(Object.prototype.hasOwnProperty.call(n.attributes,s)&&s.startsWith("rr_")))continue;let l=n.attributes[s];s==="rr_scrollLeft"&&(i.scrollLeft=l),s==="rr_scrollTop"&&(i.scrollTop=l)}}a(cT,"handleScroll");function uT(t,e){let{doc:n,onVisit:i,hackCss:s=!0,afterAppend:l,cache:c,mirror:u=new $i}=e,h=Bi(t,{doc:n,mirror:u,skipChild:!1,hackCss:s,afterAppend:l,cache:c});return lT(u,f=>{i&&i(f),cT(f,u)}),h}a(uT,"rebuild");function gt(t,e,n=document){let i={capture:!0,passive:!0};return n.addEventListener(t,e,i),()=>n.removeEventListener(t,e,i)}a(gt,"on");var Vr=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,lf={map:{},getId(){return console.error(Vr),-1},getNode(){return console.error(Vr),null},removeNodeFromMap(){console.error(Vr)},has(){return console.error(Vr),!1},reset(){console.error(Vr)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(lf=new Proxy(lf,{get(t,e,n){return e==="map"&&console.error(Vr),Reflect.get(t,e,n)}}));function qi(t,e,n={}){let i=null,s=0;return function(...l){let c=Date.now();!s&&n.leading===!1&&(s=c);let u=e-(c-s),h=this;u<=0||u>e?(i&&(clearTimeout(i),i=null),s=c,t.apply(h,l)):!i&&n.trailing!==!1&&(i=setTimeout(()=>{s=n.leading===!1?0:Date.now(),i=null,t.apply(h,l)},u))}}a(qi,"throttle");function _s(t,e,n,i,s=window){let l=s.Object.getOwnPropertyDescriptor(t,e);return s.Object.defineProperty(t,e,i?n:{set(c){setTimeout(()=>{n.set.call(this,c)},0),l&&l.set&&l.set.call(this,c)}}),()=>_s(t,e,l||{},!0)}a(_s,"hookSetter");function Xr(t,e,n){try{if(!(e in t))return()=>{};let i=t[e],s=n(i);return typeof s=="function"&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:i}})),t[e]=s,()=>{t[e]=i}}catch{return()=>{}}}a(Xr,"patch");var vs=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(vs=a(()=>new Date().getTime(),"nowTimestamp"));function Gf(t){var e,n,i,s,l,c;let u=t.document;return{left:u.scrollingElement?u.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:u?.documentElement.scrollLeft||((n=(e=u?.body)==null?void 0:e.parentElement)==null?void 0:n.scrollLeft)||((i=u?.body)==null?void 0:i.scrollLeft)||0,top:u.scrollingElement?u.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:u?.documentElement.scrollTop||((l=(s=u?.body)==null?void 0:s.parentElement)==null?void 0:l.scrollTop)||((c=u?.body)==null?void 0:c.scrollTop)||0}}a(Gf,"getWindowScroll");function Uf(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}a(Uf,"getWindowHeight");function $f(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}a($f,"getWindowWidth");function zf(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}a(zf,"closestElementOfNode");function yt(t,e,n,i){if(!t)return!1;let s=zf(t);if(!s)return!1;try{if(typeof e=="string"){if(s.classList.contains(e)||i&&s.closest("."+e)!==null)return!0}else if(Es(s,e,i))return!0}catch{}return!!(n&&(s.matches(n)||i&&s.closest(n)!==null))}a(yt,"isBlocked");function dT(t,e){return e.getId(t)!==-1}a(dT,"isSerialized");function Xl(t,e,n){return t.tagName==="TITLE"&&n.headTitleMutations?!0:e.getId(t)===zi}a(Xl,"isIgnored");function qf(t,e){if(Wi(t))return!1;let n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?qf(t.parentNode,e):!0:!0}a(qf,"isAncestorRemoved");function ec(t){return!!t.changedTouches}a(ec,"legacy_isTouchEvent");function Yf(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}a(Yf,"polyfill$1");function hT(t){let e={},n=a((s,l)=>{let c={value:s,parent:l,children:[]};return e[s.node.id]=c,c},"putIntoMap"),i=[];for(let s of t){let{nextId:l,parentId:c}=s;if(l&&l in e){let u=e[l];if(u.parent){let h=u.parent.children.indexOf(u);u.parent.children.splice(h,0,n(s,u.parent))}else{let h=i.indexOf(u);i.splice(h,0,n(s,null))}continue}if(c in e){let u=e[c];u.children.push(n(s,u));continue}i.push(n(s,null))}return i}a(hT,"queueToResolveTrees");function Kf(t,e){e(t.value);for(let n=t.children.length-1;n>=0;n--)Kf(t.children[n],e)}a(Kf,"iterateResolveTree");function Gi(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}a(Gi,"isSerializedIframe");function Xf(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}a(Xf,"isSerializedStylesheet");function jf(t,e){var n,i;let s=(i=(n=t.ownerDocument)==null?void 0:n.defaultView)==null?void 0:i.frameElement;if(!s||s===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};let l=s.getBoundingClientRect(),c=jf(s,e),u=l.height/s.clientHeight;return{x:l.x*c.relativeScale+c.x,y:l.y*c.relativeScale+c.y,relativeScale:u,absoluteScale:c.absoluteScale*u}}a(jf,"getBaseDimension");function lr(t){return!!t?.shadowRoot}a(lr,"hasShadowRoot");function Pi(t,e){let n=t[e[0]];return e.length===1?n:Pi(n.cssRules[e[1]].cssRules,e.slice(2))}a(Pi,"getNestedRule");function cf(t){let e=[...t],n=e.pop();return{positions:e,index:n}}a(cf,"getPositionsAndIndex");function fT(t){let e=new Set,n=[];for(let i=t.length;i--;){let s=t[i];e.has(s.id)||(n.push(s),e.add(s.id))}return n}a(fT,"uniqueTextMutations");var Ss=class{static{a(this,"StyleSheetMirror")}constructor(){O(this,"id",1),O(this,"styleIDMap",new WeakMap),O(this,"idStyleMap",new Map)}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let i;return n===void 0?i=this.id++:i=n,this.styleIDMap.set(e,i),this.idStyleMap.set(i,e),i}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Zf(t){var e,n;let i=null;return((n=(e=t.getRootNode)==null?void 0:e.call(t))==null?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(i=t.getRootNode().host),i}a(Zf,"getShadowHost");function mT(t){let e=t,n;for(;n=Zf(e);)e=n;return e}a(mT,"getRootShadowHost");function pT(t){let e=t.ownerDocument;if(!e)return!1;let n=mT(t);return e.contains(n)}a(pT,"shadowHostInDom");function Qf(t){let e=t.ownerDocument;return e?e.contains(t)||pT(t):!1}a(Qf,"inDom");var U=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(U||{}),H=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(H||{}),ie=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(ie||{}),En=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(En||{}),vn=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(vn||{}),Wn=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange",t[t.RateChange=4]="RateChange",t))(Wn||{}),Se=(t=>(t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back",t.Destroy="destroy",t))(Se||{});function uf(t){return"__ln"in t}a(uf,"isNodeInLinkedList");var tc=class{static{a(this,"DoubleLinkedList")}constructor(){O(this,"length",0),O(this,"head",null),O(this,"tail",null)}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let i=0;i<e;i++)n=n?.next||null;return n}addNode(e){let n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&uf(e.previousSibling)){let i=e.previousSibling.__ln.next;n.next=i,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,i&&(i.previous=n)}else if(e.nextSibling&&uf(e.nextSibling)&&e.nextSibling.__ln.previous){let i=e.nextSibling.__ln.previous;n.previous=i,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,i&&(i.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){let n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}},df=a((t,e)=>`${t}@${e}`,"moveKey"),nc=class{static{a(this,"MutationBuffer")}constructor(){O(this,"frozen",!1),O(this,"locked",!1),O(this,"texts",[]),O(this,"attributes",[]),O(this,"attributeMap",new WeakMap),O(this,"removes",[]),O(this,"mapRemoves",[]),O(this,"movedMap",{}),O(this,"addedSet",new Set),O(this,"movedSet",new Set),O(this,"droppedSet",new Set),O(this,"mutationCb"),O(this,"blockClass"),O(this,"blockSelector"),O(this,"maskTextClass"),O(this,"maskTextSelector"),O(this,"inlineStylesheet"),O(this,"maskInputOptions"),O(this,"maskTextFn"),O(this,"maskInputFn"),O(this,"keepIframeSrcFn"),O(this,"recordCanvas"),O(this,"inlineImages"),O(this,"slimDOMOptions"),O(this,"dataURLOptions"),O(this,"doc"),O(this,"mirror"),O(this,"iframeManager"),O(this,"stylesheetManager"),O(this,"shadowDomManager"),O(this,"canvasManager"),O(this,"processedNodeManager"),O(this,"unattachedDoc"),O(this,"processMutations",e=>{e.forEach(this.processMutation),this.emit()}),O(this,"emit",()=>{if(this.frozen||this.locked)return;let e=[],n=new Set,i=new tc,s=a(h=>{let f=h,p=zi;for(;p===zi;)f=f&&f.nextSibling,p=f&&this.mirror.getId(f);return p},"getNextId"),l=a(h=>{if(!h.parentNode||!Qf(h)||h.parentNode.tagName==="TEXTAREA")return;let f=Wi(h.parentNode)?this.mirror.getId(Zf(h)):this.mirror.getId(h.parentNode),p=s(h);if(f===-1||p===-1)return i.addNode(h);let g=$r(h,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:a(y=>{Gi(y,this.mirror)&&this.iframeManager.addIframe(y),Xf(y,this.mirror)&&this.stylesheetManager.trackLinkElement(y),lr(h)&&this.shadowDomManager.addShadowRoot(h.shadowRoot,this.doc)},"onSerialize"),onIframeLoad:a((y,S)=>{this.iframeManager.attachIframe(y,S),this.shadowDomManager.observeAttachShadow(y)},"onIframeLoad"),onStylesheetLoad:a((y,S)=>{this.stylesheetManager.attachLinkElement(y,S)},"onStylesheetLoad")});g&&(e.push({parentId:f,nextId:p,node:g}),n.add(g.id))},"pushAdd");for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let h of this.movedSet)hf(this.removes,h,this.mirror)&&!this.movedSet.has(h.parentNode)||l(h);for(let h of this.addedSet)!ff(this.droppedSet,h)&&!hf(this.removes,h,this.mirror)||ff(this.movedSet,h)?l(h):this.droppedSet.add(h);let c=null;for(;i.length;){let h=null;if(c){let f=this.mirror.getId(c.value.parentNode),p=s(c.value);f!==-1&&p!==-1&&(h=c)}if(!h){let f=i.tail;for(;f;){let p=f;if(f=f.previous,p){let g=this.mirror.getId(p.value.parentNode);if(s(p.value)===-1)continue;if(g!==-1){h=p;break}else{let S=p.value;if(S.parentNode&&S.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let w=S.parentNode.host;if(this.mirror.getId(w)!==-1){h=p;break}}}}}}if(!h){for(;i.head;)i.removeNode(i.head.value);break}c=h.previous,i.removeNode(h.value),l(h.value)}let u={texts:this.texts.map(h=>{let f=h.node;return f.parentNode&&f.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(f.parentNode),{id:this.mirror.getId(f),value:h.value}}).filter(h=>!n.has(h.id)).filter(h=>this.mirror.has(h.id)),attributes:this.attributes.map(h=>{let{attributes:f}=h;if(typeof f.style=="string"){let p=JSON.stringify(h.styleDiff),g=JSON.stringify(h._unchangedStyles);p.length<f.style.length&&(p+g).split("var(").length===f.style.split("var(").length&&(f.style=h.styleDiff)}return{id:this.mirror.getId(h.node),attributes:f}}).filter(h=>!n.has(h.id)).filter(h=>this.mirror.has(h.id)),removes:this.removes,adds:e};!u.texts.length&&!u.attributes.length&&!u.removes.length&&!u.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(u))}),O(this,"genTextAreaValueMutation",e=>{let n=this.attributeMap.get(e);n||(n={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(n),this.attributeMap.set(e,n)),n.attributes.value=Array.from(e.childNodes,i=>i.textContent||"").join("")}),O(this,"processMutation",e=>{if(!Xl(e.target,this.mirror,this.slimDOMOptions))switch(e.type){case"characterData":{let n=e.target.textContent;!yt(e.target,this.blockClass,this.blockSelector,!1)&&n!==e.oldValue&&this.texts.push({value:Hf(e.target,this.maskTextClass,this.maskTextSelector,!0)&&n?this.maskTextFn?this.maskTextFn(n,zf(e.target)):n.replace(/[\S]/g,"*"):n,node:e.target});break}case"attributes":{let n=e.target,i=e.attributeName,s=e.target.getAttribute(i);if(i==="value"){let c=wc(n);s=bc({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:c,value:s,maskInputFn:this.maskInputFn})}if(yt(e.target,this.blockClass,this.blockSelector,!1)||s===e.oldValue)return;let l=this.attributeMap.get(e.target);if(n.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!n.contentDocument)i="rr_src";else return;if(l||(l={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(l),this.attributeMap.set(e.target,l)),i==="type"&&n.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!Pf(n.tagName,i)&&(l.attributes[i]=Ff(this.doc,Bn(n.tagName),Bn(i),s),i==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}let c=this.unattachedDoc.createElement("span");e.oldValue&&c.setAttribute("style",e.oldValue);for(let u of Array.from(n.style)){let h=n.style.getPropertyValue(u),f=n.style.getPropertyPriority(u);h!==c.style.getPropertyValue(u)||f!==c.style.getPropertyPriority(u)?f===""?l.styleDiff[u]=h:l.styleDiff[u]=[h,f]:l._unchangedStyles[u]=[h,f]}for(let u of Array.from(c.style))n.style.getPropertyValue(u)===""&&(l.styleDiff[u]=!1)}break}case"childList":{if(yt(e.target,this.blockClass,this.blockSelector,!0))return;if(e.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(e.target);return}e.addedNodes.forEach(n=>this.genAdds(n,e.target)),e.removedNodes.forEach(n=>{let i=this.mirror.getId(n),s=Wi(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);yt(e.target,this.blockClass,this.blockSelector,!1)||Xl(n,this.mirror,this.slimDOMOptions)||!dT(n,this.mirror)||(this.addedSet.has(n)?(rc(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(e.target)&&i===-1||qf(e.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[df(i,s)]?rc(this.movedSet,n):this.removes.push({parentId:s,id:i,isShadow:Wi(e.target)&&Vi(e.target)?!0:void 0})),this.mapRemoves.push(n))});break}}}),O(this,"genAdds",(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(Xl(e,this.mirror,this.slimDOMOptions))return;this.movedSet.add(e);let i=null;n&&this.mirror.hasNode(n)&&(i=this.mirror.getId(n)),i&&i!==-1&&(this.movedMap[df(this.mirror.getId(e),i)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);yt(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(i=>this.genAdds(i)),lr(e)&&e.shadowRoot.childNodes.forEach(i=>{this.processedNodeManager.add(i,this),this.genAdds(i,e)}))}})}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}};function rc(t,e){t.delete(e),e.childNodes.forEach(n=>rc(t,n))}a(rc,"deepDelete");function hf(t,e,n){return t.length===0?!1:gT(t,e,n)}a(hf,"isParentRemoved");function gT(t,e,n){let i=e.parentNode;for(;i;){let s=n.getId(i);if(t.some(l=>l.id===s))return!0;i=i.parentNode}return!1}a(gT,"_isParentRemoved");function ff(t,e){return t.size===0?!1:Jf(t,e)}a(ff,"isAncestorInSet");function Jf(t,e){let{parentNode:n}=e;return n?t.has(n)?!0:Jf(t,n):!1}a(Jf,"_isAncestorInSet");var Ui;function yT(t){Ui=t}a(yT,"registerErrorHandler");function ET(){Ui=void 0}a(ET,"unregisterErrorHandler");var Me=a(t=>Ui?a((...n)=>{try{return t(...n)}catch(i){if(Ui&&Ui(i)===!0)return;throw i}},"rrwebWrapped"):t,"callbackWrapper"),cr=[];function Ki(t){try{if("composedPath"in t){let e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}a(Ki,"getEventTarget");function em(t,e){var n,i;let s=new nc;cr.push(s),s.init(t);let l=window.MutationObserver||window.__rrMutationObserver,c=(i=(n=window?.Zone)==null?void 0:n.__symbol__)==null?void 0:i.call(n,"MutationObserver");c&&window[c]&&(l=window[c]);let u=new l(Me(s.processMutations.bind(s)));return u.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),u}a(em,"initMutationObserver");function vT({mousemoveCb:t,sampling:e,doc:n,mirror:i}){if(e.mousemove===!1)return()=>{};let s=typeof e.mousemove=="number"?e.mousemove:50,l=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500,c=[],u,h=qi(Me(g=>{let y=Date.now()-u;t(c.map(S=>(S.timeOffset-=y,S)),g),c=[],u=null}),l),f=Me(qi(Me(g=>{let y=Ki(g),{clientX:S,clientY:w}=ec(g)?g.changedTouches[0]:g;u||(u=vs()),c.push({x:S,y:w,id:i.getId(y),timeOffset:vs()-u}),h(typeof DragEvent<"u"&&g instanceof DragEvent?H.Drag:g instanceof MouseEvent?H.MouseMove:H.TouchMove)}),s,{trailing:!1})),p=[gt("mousemove",f,n),gt("touchmove",f,n),gt("drag",f,n)];return Me(()=>{p.forEach(g=>g())})}a(vT,"initMoveObserver");function ST({mouseInteractionCb:t,doc:e,mirror:n,blockClass:i,blockSelector:s,sampling:l}){if(l.mouseInteraction===!1)return()=>{};let c=l.mouseInteraction===!0||l.mouseInteraction===void 0?{}:l.mouseInteraction,u=[],h=null,f=a(p=>g=>{let y=Ki(g);if(yt(y,i,s,!0))return;let S=null,w=p;if("pointerType"in g){switch(g.pointerType){case"mouse":S=En.Mouse;break;case"touch":S=En.Touch;break;case"pen":S=En.Pen;break}S===En.Touch?ie[p]===ie.MouseDown?w="TouchStart":ie[p]===ie.MouseUp&&(w="TouchEnd"):En.Pen}else ec(g)&&(S=En.Touch);S!==null?(h=S,(w.startsWith("Touch")&&S===En.Touch||w.startsWith("Mouse")&&S===En.Mouse)&&(S=null)):ie[p]===ie.Click&&(S=h,h=null);let M=ec(g)?g.changedTouches[0]:g;if(!M)return;let T=n.getId(y),{clientX:C,clientY:N}=M;Me(t)({type:ie[w],id:T,x:C,y:N,...S!==null&&{pointerType:S}})},"getHandler");return Object.keys(ie).filter(p=>Number.isNaN(Number(p))&&!p.endsWith("_Departed")&&c[p]!==!1).forEach(p=>{let g=Bn(p),y=f(p);if(window.PointerEvent)switch(ie[p]){case ie.MouseDown:case ie.MouseUp:g=g.replace("mouse","pointer");break;case ie.TouchStart:case ie.TouchEnd:return}u.push(gt(g,y,e))}),Me(()=>{u.forEach(p=>p())})}a(ST,"initMouseInteractionObserver");function tm({scrollCb:t,doc:e,mirror:n,blockClass:i,blockSelector:s,sampling:l}){let c=Me(qi(Me(u=>{let h=Ki(u);if(!h||yt(h,i,s,!0))return;let f=n.getId(h);if(h===e&&e.defaultView){let p=Gf(e.defaultView);t({id:f,x:p.left,y:p.top})}else t({id:f,x:h.scrollLeft,y:h.scrollTop})}),l.scroll||100));return gt("scroll",c,e)}a(tm,"initScrollObserver");function bT({viewportResizeCb:t},{win:e}){let n=-1,i=-1,s=Me(qi(Me(()=>{let l=Uf(),c=$f();(n!==l||i!==c)&&(t({width:Number(c),height:Number(l)}),n=l,i=c)}),200));return gt("resize",s,e)}a(bT,"initViewportResizeObserver");var wT=["INPUT","TEXTAREA","SELECT"],mf=new WeakMap;function MT({inputCb:t,doc:e,mirror:n,blockClass:i,blockSelector:s,ignoreClass:l,ignoreSelector:c,maskInputOptions:u,maskInputFn:h,sampling:f,userTriggeredOnInput:p}){function g(N){let A=Ki(N),k=N.isTrusted,z=A&&A.tagName;if(A&&z==="OPTION"&&(A=A.parentElement),!A||!z||wT.indexOf(z)<0||yt(A,i,s,!0)||A.classList.contains(l)||c&&A.matches(c))return;let q=A.value,oe=!1,$=wc(A)||"";$==="radio"||$==="checkbox"?oe=A.checked:(u[z.toLowerCase()]||u[$])&&(q=bc({element:A,maskInputOptions:u,tagName:z,type:$,value:q,maskInputFn:h})),y(A,p?{text:q,isChecked:oe,userTriggered:k}:{text:q,isChecked:oe});let Z=A.name;$==="radio"&&Z&&oe&&e.querySelectorAll(`input[type="radio"][name="${Z}"]`).forEach(de=>{if(de!==A){let G=de.value;y(de,p?{text:G,isChecked:!oe,userTriggered:!1}:{text:G,isChecked:!oe})}})}a(g,"eventHandler");function y(N,A){let k=mf.get(N);if(!k||k.text!==A.text||k.isChecked!==A.isChecked){mf.set(N,A);let z=n.getId(N);Me(t)({...A,id:z})}}a(y,"cbWithDedup");let w=(f.input==="last"?["change"]:["input","change"]).map(N=>gt(N,Me(g),e)),M=e.defaultView;if(!M)return()=>{w.forEach(N=>N())};let T=M.Object.getOwnPropertyDescriptor(M.HTMLInputElement.prototype,"value"),C=[[M.HTMLInputElement.prototype,"value"],[M.HTMLInputElement.prototype,"checked"],[M.HTMLSelectElement.prototype,"value"],[M.HTMLTextAreaElement.prototype,"value"],[M.HTMLSelectElement.prototype,"selectedIndex"],[M.HTMLOptionElement.prototype,"selected"]];return T&&T.set&&w.push(...C.map(N=>_s(N[0],N[1],{set(){Me(g)({target:this,isTrusted:!1})}},!1,M))),Me(()=>{w.forEach(N=>N())})}a(MT,"initInputObserver");function bs(t){let e=[];function n(i,s){if(hs("CSSGroupingRule")&&i.parentRule instanceof CSSGroupingRule||hs("CSSMediaRule")&&i.parentRule instanceof CSSMediaRule||hs("CSSSupportsRule")&&i.parentRule instanceof CSSSupportsRule||hs("CSSConditionRule")&&i.parentRule instanceof CSSConditionRule){let c=Array.from(i.parentRule.cssRules).indexOf(i);s.unshift(c)}else if(i.parentStyleSheet){let c=Array.from(i.parentStyleSheet.cssRules).indexOf(i);s.unshift(c)}return s}return a(n,"recurse"),n(t,e)}a(bs,"getNestedCSSRulePositions");function Hn(t,e,n){let i,s;return t?(t.ownerNode?i=e.getId(t.ownerNode):s=n.getId(t),{styleId:s,id:i}):{}}a(Hn,"getIdAndStyleId");function TT({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};let s=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:Me((p,g,y)=>{let[S,w]=y,{id:M,styleId:T}=Hn(g,e,n.styleMirror);return(M&&M!==-1||T&&T!==-1)&&t({id:M,styleId:T,adds:[{rule:S,index:w}]}),p.apply(g,y)})});let l=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(l,{apply:Me((p,g,y)=>{let[S]=y,{id:w,styleId:M}=Hn(g,e,n.styleMirror);return(w&&w!==-1||M&&M!==-1)&&t({id:w,styleId:M,removes:[{index:S}]}),p.apply(g,y)})});let c;i.CSSStyleSheet.prototype.replace&&(c=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=new Proxy(c,{apply:Me((p,g,y)=>{let[S]=y,{id:w,styleId:M}=Hn(g,e,n.styleMirror);return(w&&w!==-1||M&&M!==-1)&&t({id:w,styleId:M,replace:S}),p.apply(g,y)})}));let u;i.CSSStyleSheet.prototype.replaceSync&&(u=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=new Proxy(u,{apply:Me((p,g,y)=>{let[S]=y,{id:w,styleId:M}=Hn(g,e,n.styleMirror);return(w&&w!==-1||M&&M!==-1)&&t({id:w,styleId:M,replaceSync:S}),p.apply(g,y)})}));let h={};fs("CSSGroupingRule")?h.CSSGroupingRule=i.CSSGroupingRule:(fs("CSSMediaRule")&&(h.CSSMediaRule=i.CSSMediaRule),fs("CSSConditionRule")&&(h.CSSConditionRule=i.CSSConditionRule),fs("CSSSupportsRule")&&(h.CSSSupportsRule=i.CSSSupportsRule));let f={};return Object.entries(h).forEach(([p,g])=>{f[p]={insertRule:g.prototype.insertRule,deleteRule:g.prototype.deleteRule},g.prototype.insertRule=new Proxy(f[p].insertRule,{apply:Me((y,S,w)=>{let[M,T]=w,{id:C,styleId:N}=Hn(S.parentStyleSheet,e,n.styleMirror);return(C&&C!==-1||N&&N!==-1)&&t({id:C,styleId:N,adds:[{rule:M,index:[...bs(S),T||0]}]}),y.apply(S,w)})}),g.prototype.deleteRule=new Proxy(f[p].deleteRule,{apply:Me((y,S,w)=>{let[M]=w,{id:T,styleId:C}=Hn(S.parentStyleSheet,e,n.styleMirror);return(T&&T!==-1||C&&C!==-1)&&t({id:T,styleId:C,removes:[{index:[...bs(S),M]}]}),y.apply(S,w)})})}),Me(()=>{i.CSSStyleSheet.prototype.insertRule=s,i.CSSStyleSheet.prototype.deleteRule=l,c&&(i.CSSStyleSheet.prototype.replace=c),u&&(i.CSSStyleSheet.prototype.replaceSync=u),Object.entries(h).forEach(([p,g])=>{g.prototype.insertRule=f[p].insertRule,g.prototype.deleteRule=f[p].deleteRule})})}a(TT,"initStyleSheetObserver");function nm({mirror:t,stylesheetManager:e},n){var i,s,l;let c=null;n.nodeName==="#document"?c=t.getId(n):c=t.getId(n.host);let u=n.nodeName==="#document"?(i=n.defaultView)==null?void 0:i.Document:(l=(s=n.ownerDocument)==null?void 0:s.defaultView)==null?void 0:l.ShadowRoot,h=u?.prototype?Object.getOwnPropertyDescriptor(u?.prototype,"adoptedStyleSheets"):void 0;return c===null||c===-1||!u||!h?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:h.configurable,enumerable:h.enumerable,get(){var f;return(f=h.get)==null?void 0:f.call(this)},set(f){var p;let g=(p=h.set)==null?void 0:p.call(this,f);if(c!==null&&c!==-1)try{e.adoptStyleSheets(f,c)}catch{}return g}}),Me(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:h.configurable,enumerable:h.enumerable,get:h.get,set:h.set})}))}a(nm,"initAdoptedStyleSheetObserver");function xT({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:i},{win:s}){let l=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(l,{apply:Me((u,h,f)=>{var p;let[g,y,S]=f;if(n.has(g))return l.apply(h,[g,y,S]);let{id:w,styleId:M}=Hn((p=h.parentRule)==null?void 0:p.parentStyleSheet,e,i.styleMirror);return(w&&w!==-1||M&&M!==-1)&&t({id:w,styleId:M,set:{property:g,value:y,priority:S},index:bs(h.parentRule)}),u.apply(h,f)})});let c=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(c,{apply:Me((u,h,f)=>{var p;let[g]=f;if(n.has(g))return c.apply(h,[g]);let{id:y,styleId:S}=Hn((p=h.parentRule)==null?void 0:p.parentStyleSheet,e,i.styleMirror);return(y&&y!==-1||S&&S!==-1)&&t({id:y,styleId:S,remove:{property:g},index:bs(h.parentRule)}),u.apply(h,f)})}),Me(()=>{s.CSSStyleDeclaration.prototype.setProperty=l,s.CSSStyleDeclaration.prototype.removeProperty=c})}a(xT,"initStyleDeclarationObserver");function CT({mediaInteractionCb:t,blockClass:e,blockSelector:n,mirror:i,sampling:s,doc:l}){let c=Me(h=>qi(Me(f=>{let p=Ki(f);if(!p||yt(p,e,n,!0))return;let{currentTime:g,volume:y,muted:S,playbackRate:w,loop:M}=p;t({type:h,id:i.getId(p),currentTime:g,volume:y,muted:S,playbackRate:w,loop:M})}),s.media||500)),u=[gt("play",c(Wn.Play),l),gt("pause",c(Wn.Pause),l),gt("seeked",c(Wn.Seeked),l),gt("volumechange",c(Wn.VolumeChange),l),gt("ratechange",c(Wn.RateChange),l)];return Me(()=>{u.forEach(h=>h())})}a(CT,"initMediaInteractionObserver");function IT({fontCb:t,doc:e}){let n=e.defaultView;if(!n)return()=>{};let i=[],s=new WeakMap,l=n.FontFace;n.FontFace=a(function(h,f,p){let g=new l(h,f,p);return s.set(g,{family:h,buffer:typeof f!="string",descriptors:p,fontSource:typeof f=="string"?f:JSON.stringify(Array.from(new Uint8Array(f)))}),g},"FontFace2");let c=Xr(e.fonts,"add",function(u){return function(h){return setTimeout(Me(()=>{let f=s.get(h);f&&(t(f),s.delete(h))}),0),u.apply(this,[h])}});return i.push(()=>{n.FontFace=l}),i.push(c),Me(()=>{i.forEach(u=>u())})}a(IT,"initFontObserver");function AT(t){let{doc:e,mirror:n,blockClass:i,blockSelector:s,selectionCb:l}=t,c=!0,u=Me(()=>{let h=e.getSelection();if(!h||c&&h?.isCollapsed)return;c=h.isCollapsed||!1;let f=[],p=h.rangeCount||0;for(let g=0;g<p;g++){let y=h.getRangeAt(g),{startContainer:S,startOffset:w,endContainer:M,endOffset:T}=y;yt(S,i,s,!0)||yt(M,i,s,!0)||f.push({start:n.getId(S),startOffset:w,end:n.getId(M),endOffset:T})}l({ranges:f})});return u(),gt("selectionchange",u)}a(AT,"initSelectionObserver");function RT({doc:t,customElementCb:e}){let n=t.defaultView;return!n||!n.customElements?()=>{}:Xr(n.customElements,"define",function(s){return function(l,c,u){try{e({define:{name:l}})}catch{console.warn(`Custom element callback failed for ${l}`)}return s.apply(this,[l,c,u])}})}a(RT,"initCustomElementObserver");function LT(t,e){let{mutationCb:n,mousemoveCb:i,mouseInteractionCb:s,scrollCb:l,viewportResizeCb:c,inputCb:u,mediaInteractionCb:h,styleSheetRuleCb:f,styleDeclarationCb:p,canvasMutationCb:g,fontCb:y,selectionCb:S,customElementCb:w}=t;t.mutationCb=(...M)=>{e.mutation&&e.mutation(...M),n(...M)},t.mousemoveCb=(...M)=>{e.mousemove&&e.mousemove(...M),i(...M)},t.mouseInteractionCb=(...M)=>{e.mouseInteraction&&e.mouseInteraction(...M),s(...M)},t.scrollCb=(...M)=>{e.scroll&&e.scroll(...M),l(...M)},t.viewportResizeCb=(...M)=>{e.viewportResize&&e.viewportResize(...M),c(...M)},t.inputCb=(...M)=>{e.input&&e.input(...M),u(...M)},t.mediaInteractionCb=(...M)=>{e.mediaInteaction&&e.mediaInteaction(...M),h(...M)},t.styleSheetRuleCb=(...M)=>{e.styleSheetRule&&e.styleSheetRule(...M),f(...M)},t.styleDeclarationCb=(...M)=>{e.styleDeclaration&&e.styleDeclaration(...M),p(...M)},t.canvasMutationCb=(...M)=>{e.canvasMutation&&e.canvasMutation(...M),g(...M)},t.fontCb=(...M)=>{e.font&&e.font(...M),y(...M)},t.selectionCb=(...M)=>{e.selection&&e.selection(...M),S(...M)},t.customElementCb=(...M)=>{e.customElement&&e.customElement(...M),w(...M)}}a(LT,"mergeHooks");function NT(t,e={}){let n=t.doc.defaultView;if(!n)return()=>{};LT(t,e);let i;t.recordDOM&&(i=em(t,t.doc));let s=vT(t),l=ST(t),c=tm(t),u=bT(t,{win:n}),h=MT(t),f=CT(t),p=a(()=>{},"styleSheetObserver"),g=a(()=>{},"adoptedStyleSheetObserver"),y=a(()=>{},"styleDeclarationObserver"),S=a(()=>{},"fontObserver");t.recordDOM&&(p=TT(t,{win:n}),g=nm(t,t.doc),y=xT(t,{win:n}),t.collectFonts&&(S=IT(t)));let w=AT(t),M=RT(t),T=[];for(let C of t.plugins)T.push(C.observer(C.callback,n,C.options));return Me(()=>{cr.forEach(C=>C.reset()),i?.disconnect(),s(),l(),c(),u(),h(),f(),p(),g(),y(),S(),w(),M(),T.forEach(C=>C())})}a(NT,"initObservers");function hs(t){return typeof window[t]<"u"}a(hs,"hasNestedCSSRule");function fs(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}a(fs,"canMonkeyPatchNestedCSSRule");var ws=class{static{a(this,"CrossOriginIframeMirror")}constructor(e){O(this,"iframeIdToRemoteIdMap",new WeakMap),O(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=e}getId(e,n,i,s){let l=i||this.getIdToRemoteIdMap(e),c=s||this.getRemoteIdToIdMap(e),u=l.get(n);return u||(u=this.generateIdFn(),l.set(n,u),c.set(u,n)),u}getIds(e,n){let i=this.getIdToRemoteIdMap(e),s=this.getRemoteIdToIdMap(e);return n.map(l=>this.getId(e,l,i,s))}getRemoteId(e,n,i){let s=i||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;let l=s.get(n);return l||-1}getRemoteIds(e,n){let i=this.getRemoteIdToIdMap(e);return n.map(s=>this.getRemoteId(e,s,i))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}},ic=class{static{a(this,"IframeManager")}constructor(e){O(this,"iframes",new WeakMap),O(this,"crossOriginIframeMap",new WeakMap),O(this,"crossOriginIframeMirror",new ws(kf)),O(this,"crossOriginIframeStyleMirror"),O(this,"crossOriginIframeRootIdMap",new WeakMap),O(this,"mirror"),O(this,"mutationCb"),O(this,"wrappedEmit"),O(this,"loadListener"),O(this,"stylesheetManager"),O(this,"recordCrossOriginIframes"),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ws(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var i,s;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&((i=e.contentWindow)==null||i.addEventListener("message",this.handleMessage.bind(this))),(s=this.loadListener)==null||s.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){let n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;let s=this.crossOriginIframeMap.get(e.source);if(!s)return;let l=this.transformCrossOriginEvent(s,n.data.event);l&&this.wrappedEmit(l,n.data.isCheckout)}transformCrossOriginEvent(e,n){var i;switch(n.type){case U.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);let s=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,s),this.patchRootIdOnNode(n.data.node,s),{timestamp:n.timestamp,type:U.IncrementalSnapshot,data:{source:H.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case U.Meta:case U.Load:case U.DomContentLoaded:return!1;case U.Plugin:return n;case U.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case U.IncrementalSnapshot:switch(n.data.source){case H.Mutation:return n.data.adds.forEach(s=>{this.replaceIds(s,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(s.node,e);let l=this.crossOriginIframeRootIdMap.get(e);l&&this.patchRootIdOnNode(s.node,l)}),n.data.removes.forEach(s=>{this.replaceIds(s,e,["parentId","id"])}),n.data.attributes.forEach(s=>{this.replaceIds(s,e,["id"])}),n.data.texts.forEach(s=>{this.replaceIds(s,e,["id"])}),n;case H.Drag:case H.TouchMove:case H.MouseMove:return n.data.positions.forEach(s=>{this.replaceIds(s,e,["id"])}),n;case H.ViewportResize:return!1;case H.MediaInteraction:case H.MouseInteraction:case H.Scroll:case H.CanvasMutation:case H.Input:return this.replaceIds(n.data,e,["id"]),n;case H.StyleSheetRule:case H.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case H.Font:return n;case H.Selection:return n.data.ranges.forEach(s=>{this.replaceIds(s,e,["start","end"])}),n;case H.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(i=n.data.styles)==null||i.forEach(s=>{this.replaceStyleIds(s,e,["styleId"])}),n}}return!1}replace(e,n,i,s){for(let l of s)!Array.isArray(n[l])&&typeof n[l]!="number"||(Array.isArray(n[l])?n[l]=e.getIds(i,n[l]):n[l]=e.getId(i,n[l]));return n}replaceIds(e,n,i){return this.replace(this.crossOriginIframeMirror,e,n,i)}replaceStyleIds(e,n,i){return this.replace(this.crossOriginIframeStyleMirror,e,n,i)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(i=>{this.replaceIdOnNode(i,n)})}patchRootIdOnNode(e,n){e.type!==ce.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(i=>{this.patchRootIdOnNode(i,n)})}},oc=class{static{a(this,"ShadowDomManager")}constructor(e){O(this,"shadowDoms",new WeakSet),O(this,"mutationCb"),O(this,"scrollCb"),O(this,"bypassOptions"),O(this,"mirror"),O(this,"restoreHandlers",[]),this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!Vi(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let i=em({...this.bypassOptions,doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push(()=>i.disconnect()),this.restoreHandlers.push(tm({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(nm({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){let i=this;this.restoreHandlers.push(Xr(e.prototype,"attachShadow",function(s){return function(l){let c=s.call(this,l);return this.shadowRoot&&Qf(this)&&i.addShadowRoot(this.shadowRoot,n),c}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}},zr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hi=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Fi=0;Fi<zr.length;Fi++)Hi[zr.charCodeAt(Fi)]=Fi;var Fi,DT=a(function(t){var e=new Uint8Array(t),n,i=e.length,s="";for(n=0;n<i;n+=3)s+=zr[e[n]>>2],s+=zr[(e[n]&3)<<4|e[n+1]>>4],s+=zr[(e[n+1]&15)<<2|e[n+2]>>6],s+=zr[e[n+2]&63];return i%3===2?s=s.substring(0,s.length-1)+"=":i%3===1&&(s=s.substring(0,s.length-2)+"=="),s},"encode"),_T=a(function(t){var e=t.length*.75,n=t.length,i,s=0,l,c,u,h;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var f=new ArrayBuffer(e),p=new Uint8Array(f);for(i=0;i<n;i+=4)l=Hi[t.charCodeAt(i)],c=Hi[t.charCodeAt(i+1)],u=Hi[t.charCodeAt(i+2)],h=Hi[t.charCodeAt(i+3)],p[s++]=l<<2|c>>4,p[s++]=(c&15)<<4|u>>2,p[s++]=(u&3)<<6|h&63;return f},"decode"),pf=new Map;function OT(t,e){let n=pf.get(t);return n||(n=new Map,pf.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}a(OT,"variableListFor$1");var rm=a((t,e,n)=>{if(!t||!(om(t,e)||typeof t=="object"))return;let i=t.constructor.name,s=OT(n,i),l=s.indexOf(t);return l===-1&&(l=s.length,s.push(t)),l},"saveWebGLVar");function ms(t,e,n){if(t instanceof Array)return t.map(i=>ms(i,e,n));if(t===null)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){let i=t.constructor.name,s=DT(t);return{rr_type:i,base64:s}}else{if(t instanceof DataView)return{rr_type:t.constructor.name,args:[ms(t.buffer,e,n),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){let i=t.constructor.name,{src:s}=t;return{rr_type:i,src:s}}else if(t instanceof HTMLCanvasElement){let i="HTMLImageElement",s=t.toDataURL();return{rr_type:i,src:s}}else{if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[ms(t.data,e,n),t.width,t.height]};if(om(t,e)||typeof t=="object"){let i=t.constructor.name,s=rm(t,e,n);return{rr_type:i,index:s}}}}return t}a(ms,"serializeArg");var im=a((t,e,n)=>t.map(i=>ms(i,e,n)),"serializeArgs"),om=a((t,e)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(s=>typeof e[s]=="function").find(s=>t instanceof e[s]),"isInstanceOfWebGLObject");function kT(t,e,n,i){let s=[],l=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(let c of l)try{if(typeof e.CanvasRenderingContext2D.prototype[c]!="function")continue;let u=Xr(e.CanvasRenderingContext2D.prototype,c,function(h){return function(...f){return yt(this.canvas,n,i,!0)||setTimeout(()=>{let p=im(f,e,this);t(this.canvas,{type:vn["2D"],property:c,args:p})},0),h.apply(this,f)}});s.push(u)}catch{let u=_s(e.CanvasRenderingContext2D.prototype,c,{set(h){t(this.canvas,{type:vn["2D"],property:c,args:[h],setter:!0})}});s.push(u)}return()=>{s.forEach(c=>c())}}a(kT,"initCanvas2DMutationObserver");function FT(t){return t==="experimental-webgl"?"webgl":t}a(FT,"getNormalizedContextName");function gf(t,e,n,i){let s=[];try{let l=Xr(t.HTMLCanvasElement.prototype,"getContext",function(c){return function(u,...h){if(!yt(this,e,n,!0)){let f=FT(u);if("__context"in this||(this.__context=f),i&&["webgl","webgl2"].includes(f))if(h[0]&&typeof h[0]=="object"){let p=h[0];p.preserveDrawingBuffer||(p.preserveDrawingBuffer=!0)}else h.splice(0,1,{preserveDrawingBuffer:!0})}return c.apply(this,[u,...h])}});s.push(l)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach(l=>l())}}a(gf,"initCanvasContextObserver");function yf(t,e,n,i,s,l,c){let u=[],h=Object.getOwnPropertyNames(t);for(let f of h)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(f))try{if(typeof t[f]!="function")continue;let p=Xr(t,f,function(g){return function(...y){let S=g.apply(this,y);if(rm(S,c,this),"tagName"in this.canvas&&!yt(this.canvas,i,s,!0)){let w=im(y,c,this),M={type:e,property:f,args:w};n(this.canvas,M)}return S}});u.push(p)}catch{let p=_s(t,f,{set(g){n(this.canvas,{type:e,property:f,args:[g],setter:!0})}});u.push(p)}return u}a(yf,"patchGLPrototype");function PT(t,e,n,i,s){let l=[];return l.push(...yf(e.WebGLRenderingContext.prototype,vn.WebGL,t,n,i,s,e)),typeof e.WebGL2RenderingContext<"u"&&l.push(...yf(e.WebGL2RenderingContext.prototype,vn.WebGL2,t,n,i,s,e)),()=>{l.forEach(c=>c())}}a(PT,"initCanvasWebGLMutationObserver");var sm="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK",HT=a(t=>Uint8Array.from(atob(t),e=>e.charCodeAt(0)),"decodeBase64"),Ef=typeof window<"u"&&window.Blob&&new Blob([HT(sm)],{type:"text/javascript;charset=utf-8"});function WT(t){let e;try{if(e=Ef&&(window.URL||window.webkitURL).createObjectURL(Ef),!e)throw"";let n=new Worker(e,{name:t?.name});return n.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(e)}),n}catch{return new Worker("data:text/javascript;base64,"+sm,{name:t?.name})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}a(WT,"WorkerWrapper");var sc=class{static{a(this,"CanvasManager")}constructor(e){O(this,"pendingCanvasMutations",new Map),O(this,"rafStamps",{latestId:0,invokeId:null}),O(this,"mirror"),O(this,"mutationCb"),O(this,"resetObservers"),O(this,"frozen",!1),O(this,"locked",!1),O(this,"processMutation",(h,f)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(h)||this.pendingCanvasMutations.set(h,[]),this.pendingCanvasMutations.get(h).push(f)});let{sampling:n="all",win:i,blockClass:s,blockSelector:l,recordCanvas:c,dataURLOptions:u}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,c&&n==="all"&&this.initCanvasMutationObserver(i,s,l),c&&typeof n=="number"&&this.initCanvasFPSObserver(n,i,s,l,{dataURLOptions:u})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,n,i,s,l){let c=gf(n,i,s,!0),u=new Map,h=new WT;h.onmessage=w=>{let{id:M}=w.data;if(u.set(M,!1),!("base64"in w.data))return;let{base64:T,type:C,width:N,height:A}=w.data;this.mutationCb({id:M,type:vn["2D"],commands:[{property:"clearRect",args:[0,0,N,A]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:T}],type:C}]},0,0]}]})};let f=1e3/e,p=0,g,y=a(()=>{let w=[];return n.document.querySelectorAll("canvas").forEach(M=>{yt(M,i,s,!0)||w.push(M)}),w},"getCanvas"),S=a(w=>{if(p&&w-p<f){g=requestAnimationFrame(S);return}p=w,y().forEach(async M=>{var T;let C=this.mirror.getId(M);if(u.get(C)||M.width===0||M.height===0)return;if(u.set(C,!0),["webgl","webgl2"].includes(M.__context)){let A=M.getContext(M.__context);((T=A?.getContextAttributes())==null?void 0:T.preserveDrawingBuffer)===!1&&A.clear(A.COLOR_BUFFER_BIT)}let N=await createImageBitmap(M);h.postMessage({id:C,bitmap:N,width:M.width,height:M.height,dataURLOptions:l.dataURLOptions},[N])}),g=requestAnimationFrame(S)},"takeCanvasSnapshots");g=requestAnimationFrame(S),this.resetObservers=()=>{c(),cancelAnimationFrame(g)}}initCanvasMutationObserver(e,n,i){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let s=gf(e,n,i,!1),l=kT(this.processMutation.bind(this),e,n,i),c=PT(this.processMutation.bind(this),e,n,i,this.mirror);this.resetObservers=()=>{s(),l(),c()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=a(n=>{this.rafStamps.latestId=n,requestAnimationFrame(e)},"setLatestRAFTimestamp");requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,n)=>{let i=this.mirror.getId(n);this.flushPendingCanvasMutationFor(n,i)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,n){if(this.frozen||this.locked)return;let i=this.pendingCanvasMutations.get(e);if(!i||n===-1)return;let s=i.map(c=>{let{type:u,...h}=c;return h}),{type:l}=i[0];this.mutationCb({id:n,type:l,commands:s}),this.pendingCanvasMutations.delete(e)}},ac=class{static{a(this,"StylesheetManager")}constructor(e){O(this,"trackedLinkElements",new WeakSet),O(this,"mutationCb"),O(this,"adoptedStyleSheetCb"),O(this,"styleMirror",new Ss),this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;let i={id:n,styleIds:[]},s=[];for(let l of e){let c;this.styleMirror.has(l)?c=this.styleMirror.getId(l):(c=this.styleMirror.add(l),s.push({styleId:c,rules:Array.from(l.rules||CSSRule,(u,h)=>({rule:Df(u),index:h}))})),i.styleIds.push(c)}s.length>0&&(i.styles=s),this.adoptedStyleSheetCb(i)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}},lc=class{static{a(this,"ProcessedNodeManager")}constructor(){O(this,"nodeMap",new WeakMap),O(this,"active",!1)}inOtherBuffer(e,n){let i=this.nodeMap.get(e);return i&&Array.from(i).some(s=>s!==n)}add(e,n){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}destroy(){}},je,ps,jl,Ms=!1;try{if(Array.from([1],t=>t*2)[0]!==2){let t=document.createElement("iframe");document.body.appendChild(t),Array.from=((Qh=t.contentWindow)==null?void 0:Qh.Array.from)||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}var zt=_f();function qt(t={}){let{emit:e,checkoutEveryNms:n,checkoutEveryNth:i,blockClass:s="rr-block",blockSelector:l=null,ignoreClass:c="rr-ignore",ignoreSelector:u=null,maskTextClass:h="rr-mask",maskTextSelector:f=null,inlineStylesheet:p=!0,maskAllInputs:g,maskInputOptions:y,slimDOMOptions:S,maskInputFn:w,maskTextFn:M,hooks:T,packFn:C,sampling:N={},dataURLOptions:A={},mousemoveWait:k,recordDOM:z=!0,recordCanvas:q=!1,recordCrossOriginIframes:oe=!1,recordAfter:$=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:Z=!1,collectFonts:de=!1,inlineImages:G=!1,plugins:B,keepIframeSrcFn:X=a(()=>!1,"keepIframeSrcFn"),ignoreCSSAttributes:j=new Set([]),errorHandler:Q}=t;yT(Q);let ne=oe?window.parent===window:!0,Ne=!1;if(!ne)try{window.parent.document&&(Ne=!1)}catch{Ne=!0}if(ne&&!e)throw new Error("emit function is required");if(!ne&&!Ne)return()=>{};k!==void 0&&N.mousemove===void 0&&(N.mousemove=k),zt.reset();let Ue=g===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:y!==void 0?y:{password:!0},$e=S===!0||S==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:S==="all",headMetaDescKeywords:S==="all",headTitleMutations:S==="all"}:S||{};Yf();let Ht,ge=0,Y=a(xe=>{for(let qe of B||[])qe.eventProcessor&&(xe=qe.eventProcessor(xe));return C&&!Ne&&(xe=C(xe)),xe},"eventProcessor");je=a((xe,qe)=>{var De;let We=xe;if(We.timestamp=vs(),(De=cr[0])!=null&&De.isFrozen()&&We.type!==U.FullSnapshot&&!(We.type===U.IncrementalSnapshot&&We.data.source===H.Mutation)&&cr.forEach(Je=>Je.unfreeze()),ne)e?.(Y(We),qe);else if(Ne){let Je={type:"rrweb",event:Y(We),origin:window.location.origin,isCheckout:qe};window.parent.postMessage(Je,"*")}if(We.type===U.FullSnapshot)Ht=We,ge=0;else if(We.type===U.IncrementalSnapshot){if(We.data.source===H.Mutation&&We.data.isAttachIframe)return;ge++;let Je=i&&ge>=i,Ie=n&&We.timestamp-Ht.timestamp>n;(Je||Ie)&&ps(!0)}},"wrappedEmit");let W=a(xe=>{je({type:U.IncrementalSnapshot,data:{source:H.Mutation,...xe}})},"wrappedMutationEmit"),te=a(xe=>je({type:U.IncrementalSnapshot,data:{source:H.Scroll,...xe}}),"wrappedScrollEmit"),Te=a(xe=>je({type:U.IncrementalSnapshot,data:{source:H.CanvasMutation,...xe}}),"wrappedCanvasMutationEmit"),Re=a(xe=>je({type:U.IncrementalSnapshot,data:{source:H.AdoptedStyleSheet,...xe}}),"wrappedAdoptedStyleSheetEmit"),ze=new ac({mutationCb:W,adoptedStyleSheetCb:Re}),et=new ic({mirror:zt,mutationCb:W,stylesheetManager:ze,recordCrossOriginIframes:oe,wrappedEmit:je});for(let xe of B||[])xe.getMirror&&xe.getMirror({nodeMirror:zt,crossOriginIframeMirror:et.crossOriginIframeMirror,crossOriginIframeStyleMirror:et.crossOriginIframeStyleMirror});let Yt=new lc;jl=new sc({recordCanvas:q,mutationCb:Te,win:window,blockClass:s,blockSelector:l,mirror:zt,sampling:N.canvas,dataURLOptions:A});let an=new oc({mutationCb:W,scrollCb:te,bypassOptions:{blockClass:s,blockSelector:l,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskInputOptions:Ue,dataURLOptions:A,maskTextFn:M,maskInputFn:w,recordCanvas:q,inlineImages:G,sampling:N,slimDOMOptions:$e,iframeManager:et,stylesheetManager:ze,canvasManager:jl,keepIframeSrcFn:X,processedNodeManager:Yt},mirror:zt});ps=a((xe=!1)=>{if(!z)return;je({type:U.Meta,data:{href:window.location.href,width:$f(),height:Uf()}},xe),ze.reset(),an.init(),cr.forEach(De=>De.lock());let qe=nT(document,{mirror:zt,blockClass:s,blockSelector:l,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskAllInputs:Ue,maskTextFn:M,slimDOM:$e,dataURLOptions:A,recordCanvas:q,inlineImages:G,onSerialize:a(De=>{Gi(De,zt)&&et.addIframe(De),Xf(De,zt)&&ze.trackLinkElement(De),lr(De)&&an.addShadowRoot(De.shadowRoot,document)},"onSerialize"),onIframeLoad:a((De,We)=>{et.attachIframe(De,We),an.observeAttachShadow(De)},"onIframeLoad"),onStylesheetLoad:a((De,We)=>{ze.attachLinkElement(De,We)},"onStylesheetLoad"),keepIframeSrcFn:X});if(!qe)return console.warn("Failed to snapshot the document");je({type:U.FullSnapshot,data:{node:qe,initialOffset:Gf(window)}},xe),cr.forEach(De=>De.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&ze.adoptStyleSheets(document.adoptedStyleSheets,zt.getId(document))},"takeFullSnapshot");try{let xe=[],qe=a(We=>{var Je;return Me(NT)({mutationCb:W,mousemoveCb:a((Ie,ai)=>je({type:U.IncrementalSnapshot,data:{source:ai,positions:Ie}}),"mousemoveCb"),mouseInteractionCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.MouseInteraction,...Ie}}),"mouseInteractionCb"),scrollCb:te,viewportResizeCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.ViewportResize,...Ie}}),"viewportResizeCb"),inputCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.Input,...Ie}}),"inputCb"),mediaInteractionCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.MediaInteraction,...Ie}}),"mediaInteractionCb"),styleSheetRuleCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.StyleSheetRule,...Ie}}),"styleSheetRuleCb"),styleDeclarationCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.StyleDeclaration,...Ie}}),"styleDeclarationCb"),canvasMutationCb:Te,fontCb:a(Ie=>je({type:U.IncrementalSnapshot,data:{source:H.Font,...Ie}}),"fontCb"),selectionCb:a(Ie=>{je({type:U.IncrementalSnapshot,data:{source:H.Selection,...Ie}})},"selectionCb"),customElementCb:a(Ie=>{je({type:U.IncrementalSnapshot,data:{source:H.CustomElement,...Ie}})},"customElementCb"),blockClass:s,ignoreClass:c,ignoreSelector:u,maskTextClass:h,maskTextSelector:f,maskInputOptions:Ue,inlineStylesheet:p,sampling:N,recordDOM:z,recordCanvas:q,inlineImages:G,userTriggeredOnInput:Z,collectFonts:de,doc:We,maskInputFn:w,maskTextFn:M,keepIframeSrcFn:X,blockSelector:l,slimDOMOptions:$e,dataURLOptions:A,mirror:zt,iframeManager:et,stylesheetManager:ze,shadowDomManager:an,processedNodeManager:Yt,canvasManager:jl,ignoreCSSAttributes:j,plugins:((Je=B?.filter(Ie=>Ie.observer))==null?void 0:Je.map(Ie=>({observer:Ie.observer,options:Ie.options,callback:a(ai=>je({type:U.Plugin,data:{plugin:Ie.name,payload:ai}}),"callback")})))||[]},T)},"observe");et.addLoadListener(We=>{try{xe.push(qe(We.contentDocument))}catch(Je){console.warn(Je)}});let De=a(()=>{ps(),xe.push(qe(document)),Ms=!0},"init");return document.readyState==="interactive"||document.readyState==="complete"?De():(xe.push(gt("DOMContentLoaded",()=>{je({type:U.DomContentLoaded,data:{}}),$==="DOMContentLoaded"&&De()})),xe.push(gt("load",()=>{je({type:U.Load,data:{}}),$==="load"&&De()},window))),()=>{xe.forEach(We=>We()),Yt.destroy(),Ms=!1,ET()}}catch(xe){console.warn(xe)}}a(qt,"record");qt.addCustomEvent=(t,e)=>{if(!Ms)throw new Error("please add custom event after start recording");je({type:U.Custom,data:{tag:t,payload:e}})};qt.freezePage=()=>{cr.forEach(t=>t.freeze())};qt.takeFullSnapshot=t=>{if(!Ms)throw new Error("please take full snapshot after start recording");ps(t)};qt.mirror=zt;var VT=Object.defineProperty,BT=a((t,e,n)=>e in t?VT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"__defNormalProp2"),ee=a((t,e,n)=>(BT(t,typeof e!="symbol"?e+"":e,n),n),"__publicField2"),GT=Object.defineProperty,UT=a((t,e,n)=>e in t?GT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"__defNormalProp22"),vf=a((t,e,n)=>(UT(t,typeof e!="symbol"?e+"":e,n),n),"__publicField22"),we=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(we||{}),$T=class{static{a(this,"Mirror2")}constructor(){vf(this,"idNodeMap",new Map),vf(this,"nodeMetaMap",new WeakMap)}getId(e){var n;return e?((n=this.getMeta(e))==null?void 0:n.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){let i=n.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,n)}replace(e,n){let i=this.getNode(e);if(i){let s=this.nodeMetaMap.get(i);s&&this.nodeMetaMap.set(n,s)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function zT(){return new $T}a(zT,"createMirror$1");function qT(t){let e={},n=/;(?![^(]*\))/g,i=/:(.+)/,s=/\/\*.*?\*\//g;return t.replace(s,"").split(n).forEach(function(l){if(l){let c=l.split(i);c.length>1&&(e[cc(c[0].trim())]=c[1].trim())}}),e}a(qT,"parseCSSText");function Sf(t){let e=[];for(let n in t){let i=t[n];if(typeof i!="string")continue;let s=jT(n);e.push(`${s}: ${i};`)}return e.join(" ")}a(Sf,"toCSSText");var YT=/-([a-z])/g,KT=/^--[a-zA-Z0-9-]+$/,cc=a(t=>KT.test(t)?t:t.replace(YT,(e,n)=>n?n.toUpperCase():""),"camelize"),XT=/\B([A-Z])/g,jT=a(t=>t.replace(XT,"-$1").toLowerCase(),"hyphenate"),Gn=class t{static{a(this,"BaseRRNode")}constructor(...e){ee(this,"parentElement",null),ee(this,"parentNode",null),ee(this,"ownerDocument"),ee(this,"firstChild",null),ee(this,"lastChild",null),ee(this,"previousSibling",null),ee(this,"nextSibling",null),ee(this,"ELEMENT_NODE",1),ee(this,"TEXT_NODE",3),ee(this,"nodeType"),ee(this,"nodeName"),ee(this,"RRNodeType")}get childNodes(){let e=[],n=this.firstChild;for(;n;)e.push(n),n=n.nextSibling;return e}contains(e){if(e instanceof t){if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0}else return!1;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}},uc=class t extends Gn{static{a(this,"BaseRRDocument")}constructor(...e){super(e),ee(this,"nodeType",9),ee(this,"nodeName","#document"),ee(this,"compatMode","CSS1Compat"),ee(this,"RRNodeType",we.Document),ee(this,"textContent",null),this.ownerDocument=this}get documentElement(){return this.childNodes.find(e=>e.RRNodeType===we.Element&&e.tagName==="HTML")||null}get body(){var e;return((e=this.documentElement)==null?void 0:e.childNodes.find(n=>n.RRNodeType===we.Element&&n.tagName==="BODY"))||null}get head(){var e;return((e=this.documentElement)==null?void 0:e.childNodes.find(n=>n.RRNodeType===we.Element&&n.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(e){let n=e.RRNodeType;if((n===we.Element||n===we.DocumentType)&&this.childNodes.some(s=>s.RRNodeType===n))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${n===we.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let i=Mc(this,e);return i.parentElement=null,i}insertBefore(e,n){let i=e.RRNodeType;if((i===we.Element||i===we.DocumentType)&&this.childNodes.some(l=>l.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===we.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let s=am(this,e,n);return s.parentElement=null,s}removeChild(e){return lm(this,e)}open(){this.firstChild=null,this.lastChild=null}close(){}write(e){let n;if(e==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?n="-//W3C//DTD XHTML 1.0 Transitional//EN":e==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(n="-//W3C//DTD HTML 4.0 Transitional//EN"),n){let i=this.createDocumentType("html",n,"");this.open(),this.appendChild(i)}}createDocument(e,n,i){return new t}createDocumentType(e,n,i){let s=new Ts(e,n,i);return s.ownerDocument=this,s}createElement(e){let n=new Yi(e);return n.ownerDocument=this,n}createElementNS(e,n){return this.createElement(n)}createTextNode(e){let n=new xs(e);return n.ownerDocument=this,n}createComment(e){let n=new Cs(e);return n.ownerDocument=this,n}createCDATASection(e){let n=new Is(e);return n.ownerDocument=this,n}toString(){return"RRDocument"}},Ts=class extends Gn{static{a(this,"BaseRRDocumentType")}constructor(e,n,i){super(),ee(this,"nodeType",10),ee(this,"RRNodeType",we.DocumentType),ee(this,"name"),ee(this,"publicId"),ee(this,"systemId"),ee(this,"textContent",null),this.name=e,this.publicId=n,this.systemId=i,this.nodeName=e}toString(){return"RRDocumentType"}},Yi=class extends Gn{static{a(this,"BaseRRElement")}constructor(e){super(),ee(this,"nodeType",1),ee(this,"RRNodeType",we.Element),ee(this,"tagName"),ee(this,"attributes",{}),ee(this,"shadowRoot",null),ee(this,"scrollLeft"),ee(this,"scrollTop"),this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let e="";return this.childNodes.forEach(n=>e+=n.textContent),e}set textContent(e){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(e))}get classList(){return new hc(this.attributes.class,e=>{this.attributes.class=e})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let e=this.attributes.style?qT(this.attributes.style):{},n=/\B([A-Z])/g;return e.setProperty=(i,s,l)=>{if(n.test(i))return;let c=cc(i);s?e[c]=s:delete e[c],l==="important"&&(e[c]+=" !important"),this.attributes.style=Sf(e)},e.removeProperty=i=>{if(n.test(i))return"";let s=cc(i),l=e[s]||"";return delete e[s],this.attributes.style=Sf(e),l},e}getAttribute(e){return this.attributes[e]||null}setAttribute(e,n){this.attributes[e]=n}setAttributeNS(e,n,i){this.setAttribute(n,i)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return Mc(this,e)}insertBefore(e,n){return am(this,e,n)}removeChild(e){return lm(this,e)}attachShadow(e){let n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(e){return!0}toString(){let e="";for(let n in this.attributes)e+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${e}`}},dc=class extends Yi{static{a(this,"BaseRRMediaElement")}constructor(){super(...arguments),ee(this,"currentTime"),ee(this,"volume"),ee(this,"paused"),ee(this,"muted"),ee(this,"playbackRate"),ee(this,"loop")}attachShadow(e){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}},xs=class extends Gn{static{a(this,"BaseRRText")}constructor(e){super(),ee(this,"nodeType",3),ee(this,"nodeName","#text"),ee(this,"RRNodeType",we.Text),ee(this,"data"),this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRText text=${JSON.stringify(this.data)}`}},Cs=class extends Gn{static{a(this,"BaseRRComment")}constructor(e){super(),ee(this,"nodeType",8),ee(this,"nodeName","#comment"),ee(this,"RRNodeType",we.Comment),ee(this,"data"),this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRComment text=${JSON.stringify(this.data)}`}},Is=class extends Gn{static{a(this,"BaseRRCDATASection")}constructor(e){super(),ee(this,"nodeName","#cdata-section"),ee(this,"nodeType",4),ee(this,"RRNodeType",we.CDATA),ee(this,"data"),this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}},hc=class{static{a(this,"ClassList")}constructor(e,n){if(ee(this,"onChange"),ee(this,"classes",[]),ee(this,"add",(...i)=>{for(let s of i){let l=String(s);this.classes.indexOf(l)>=0||this.classes.push(l)}this.onChange&&this.onChange(this.classes.join(" "))}),ee(this,"remove",(...i)=>{this.classes=this.classes.filter(s=>i.indexOf(s)===-1),this.onChange&&this.onChange(this.classes.join(" "))}),e){let i=e.trim().split(/\s+/);this.classes.push(...i)}this.onChange=n}};function Mc(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.lastChild?(t.lastChild.nextSibling=e,e.previousSibling=t.lastChild):(t.firstChild=e,e.previousSibling=null),t.lastChild=e,e.nextSibling=null,e.parentNode=t,e.parentElement=t,e.ownerDocument=t.ownerDocument,e}a(Mc,"appendChild");function am(t,e,n){if(!n)return Mc(t,e);if(n.parentNode!==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return e===n||(e.parentNode&&e.parentNode.removeChild(e),e.previousSibling=n.previousSibling,n.previousSibling=e,e.nextSibling=n,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,e.parentElement=t,e.parentNode=t,e.ownerDocument=t.ownerDocument),e}a(am,"insertBefore");function lm(t,e){if(e.parentNode!==t)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:t.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:t.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e.parentElement=null,e.parentNode=null,e}a(lm,"removeChild");var Rt=(t=>(t[t.PLACEHOLDER=0]="PLACEHOLDER",t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE",t))(Rt||{}),fc={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},ZT={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},tn=null;function As(t,e,n,i=e.mirror||e.ownerDocument.mirror){t=QT(t,e,n,i),cm(t,e,n,i),JT(t,e,n)}a(As,"diff");function QT(t,e,n,i){var s;if(n.afterAppend&&!tn&&(tn=new WeakSet,setTimeout(()=>{tn=null},0)),!Tc(t,e)){let l=Rs(e,n.mirror,i);(s=t.parentNode)==null||s.replaceChild(l,t),t=l}switch(e.RRNodeType){case we.Document:{if(!Br(t,e,n.mirror,i)){let l=i.getMeta(e);l&&(n.mirror.removeNodeFromMap(t),t.close(),t.open(),n.mirror.add(t,l),tn?.add(t))}break}case we.Element:{let l=t,c=e;switch(c.tagName){case"IFRAME":{let u=t.contentDocument;if(!u)break;As(u,e.contentDocument,n,i);break}}c.shadowRoot&&(l.shadowRoot||l.attachShadow({mode:"open"}),cm(l.shadowRoot,c.shadowRoot,n,i)),ex(l,c,i);break}}return t}a(QT,"diffBeforeUpdatingChildren");function JT(t,e,n){var i;switch(e.RRNodeType){case we.Document:{let s=e.scrollData;s&&n.applyScroll(s,!0);break}case we.Element:{let s=t,l=e;switch(l.scrollData&&n.applyScroll(l.scrollData,!0),l.inputData&&n.applyInput(l.inputData),l.tagName){case"AUDIO":case"VIDEO":{let c=t,u=l;u.paused!==void 0&&(u.paused?c.pause():c.play()),u.muted!==void 0&&(c.muted=u.muted),u.volume!==void 0&&(c.volume=u.volume),u.currentTime!==void 0&&(c.currentTime=u.currentTime),u.playbackRate!==void 0&&(c.playbackRate=u.playbackRate),u.loop!==void 0&&(c.loop=u.loop);break}case"CANVAS":{let c=e;if(c.rr_dataURL!==null){let u=document.createElement("img");u.onload=()=>{let h=s.getContext("2d");h&&h.drawImage(u,0,0,u.width,u.height)},u.src=c.rr_dataURL}c.canvasMutations.forEach(u=>n.applyCanvas(u.event,u.mutation,t));break}case"STYLE":{let c=s.sheet;c&&e.rules.forEach(u=>n.applyStyleSheetMutation(u,c));break}}break}case we.Text:case we.Comment:case we.CDATA:{t.textContent!==e.data&&(t.textContent=e.data);break}}tn?.has(t)&&(tn.delete(t),(i=n.afterAppend)==null||i.call(n,t,n.mirror.getId(t)))}a(JT,"diffAfterUpdatingChildren");function ex(t,e,n){let i=t.attributes,s=e.attributes;for(let l in s){let c=s[l],u=n.getMeta(e);if(u?.isSVG&&fc[l])t.setAttributeNS(fc[l],l,c);else if(e.tagName==="CANVAS"&&l==="rr_dataURL"){let h=document.createElement("img");h.src=c,h.onload=()=>{let f=t.getContext("2d");f&&f.drawImage(h,0,0,h.width,h.height)}}else{if(e.tagName==="IFRAME"&&l==="srcdoc")continue;t.setAttribute(l,c)}}for(let{name:l}of Array.from(i))l in s||t.removeAttribute(l);e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.scrollTop&&(t.scrollTop=e.scrollTop)}a(ex,"diffProps");function cm(t,e,n,i){let s=Array.from(t.childNodes),l=e.childNodes;if(s.length===0&&l.length===0)return;let c=0,u=s.length-1,h=0,f=l.length-1,p=s[c],g=s[u],y=l[h],S=l[f],w,M;for(;c<=u&&h<=f;)if(p===void 0)p=s[++c];else if(g===void 0)g=s[--u];else if(Br(p,y,n.mirror,i))p=s[++c],y=l[++h];else if(Br(g,S,n.mirror,i))g=s[--u],S=l[--f];else if(Br(p,S,n.mirror,i)){try{t.insertBefore(p,g.nextSibling)}catch(N){console.warn(N)}p=s[++c],S=l[--f]}else if(Br(g,y,n.mirror,i)){try{t.insertBefore(g,p)}catch(N){console.warn(N)}g=s[--u],y=l[++h]}else{if(!w){w={};for(let A=c;A<=u;A++){let k=s[A];k&&n.mirror.hasNode(k)&&(w[n.mirror.getId(k)]=A)}}M=w[i.getId(y)];let N=s[M];if(M!==void 0&&N&&Br(N,y,n.mirror,i)){try{t.insertBefore(N,p)}catch(A){console.warn(A)}s[M]=void 0}else{let A=Rs(y,n.mirror,i);t.nodeName==="#document"&&p&&(A.nodeType===A.DOCUMENT_TYPE_NODE&&p.nodeType===p.DOCUMENT_TYPE_NODE||A.nodeType===A.ELEMENT_NODE&&p.nodeType===p.ELEMENT_NODE)&&(t.removeChild(p),n.mirror.removeNodeFromMap(p),p=s[++c]);try{t.insertBefore(A,p||null)}catch(k){console.warn(k)}}y=l[++h]}if(c>u){let N=l[f+1],A=null;for(N&&(A=n.mirror.getNode(i.getId(N)));h<=f;++h){let k=Rs(l[h],n.mirror,i);try{t.insertBefore(k,A)}catch(z){console.warn(z)}}}else if(h>f)for(;c<=u;c++){let N=s[c];if(!(!N||N.parentNode!==t))try{t.removeChild(N),n.mirror.removeNodeFromMap(N)}catch(A){console.warn(A)}}let T=t.firstChild,C=e.firstChild;for(;T!==null&&C!==null;)As(T,C,n,i),T=T.nextSibling,C=C.nextSibling}a(cm,"diffChildren");function Rs(t,e,n){let i=n.getId(t),s=n.getMeta(t),l=null;if(i>-1&&(l=e.getNode(i)),l!==null&&Tc(l,t))return l;switch(t.RRNodeType){case we.Document:l=new Document;break;case we.DocumentType:l=document.implementation.createDocumentType(t.name,t.publicId,t.systemId);break;case we.Element:{let c=t.tagName.toLowerCase();c=ZT[c]||c,s&&"isSVG"in s&&s?.isSVG?l=document.createElementNS(fc.svg,c):l=document.createElement(t.tagName);break}case we.Text:l=document.createTextNode(t.data);break;case we.Comment:l=document.createComment(t.data);break;case we.CDATA:l=document.createCDATASection(t.data);break}s&&e.add(l,{...s});try{tn?.add(l)}catch{}return l}a(Rs,"createOrGetNode");function Tc(t,e){return t.nodeType!==e.nodeType?!1:t.nodeType!==t.ELEMENT_NODE||t.tagName.toUpperCase()===e.tagName}a(Tc,"sameNodeType");function Br(t,e,n,i){let s=n.getId(t),l=i.getId(e);return s===-1||s!==l?!1:Tc(t,e)}a(Br,"nodeMatching");var Yr=class t extends uc{static{a(this,"RRDocument")}constructor(e){super(),ee(this,"UNSERIALIZED_STARTING_ID",-2),ee(this,"_unserializedId",this.UNSERIALIZED_STARTING_ID),ee(this,"mirror",ax()),ee(this,"scrollData",null),e&&(this.mirror=e)}get unserializedId(){return this._unserializedId--}createDocument(e,n,i){return new t}createDocumentType(e,n,i){let s=new tx(e,n,i);return s.ownerDocument=this,s}createElement(e){let n=e.toUpperCase(),i;switch(n){case"AUDIO":case"VIDEO":i=new mc(n);break;case"IFRAME":i=new yc(n,this.mirror);break;case"CANVAS":i=new pc(n);break;case"STYLE":i=new gc(n);break;default:i=new Kr(n);break}return i.ownerDocument=this,i}createComment(e){let n=new rx(e);return n.ownerDocument=this,n}createCDATASection(e){let n=new ix(e);return n.ownerDocument=this,n}createTextNode(e){let n=new nx(e);return n.ownerDocument=this,n}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}},tx=Ts,Kr=class extends Yi{static{a(this,"RRElement")}constructor(){super(...arguments),ee(this,"inputData",null),ee(this,"scrollData",null)}},mc=class extends dc{static{a(this,"RRMediaElement")}},pc=class extends Kr{static{a(this,"RRCanvasElement")}constructor(){super(...arguments),ee(this,"rr_dataURL",null),ee(this,"canvasMutations",[])}getContext(){return null}},gc=class extends Kr{static{a(this,"RRStyleElement")}constructor(){super(...arguments),ee(this,"rules",[])}},yc=class extends Kr{static{a(this,"RRIFrameElement")}constructor(e,n){super(e),ee(this,"contentDocument",new Yr),this.contentDocument.mirror=n}},nx=xs,rx=Cs,ix=Is;function ox(t){return t instanceof HTMLFormElement?"FORM":t.tagName.toUpperCase()}a(ox,"getValidTagName");function um(t,e,n,i){let s;switch(t.nodeType){case Rt.DOCUMENT_NODE:i&&i.nodeName==="IFRAME"?s=i.contentDocument:(s=e,s.compatMode=t.compatMode);break;case Rt.DOCUMENT_TYPE_NODE:{let c=t;s=e.createDocumentType(c.name,c.publicId,c.systemId);break}case Rt.ELEMENT_NODE:{let c=t,u=ox(c);s=e.createElement(u);let h=s;for(let{name:f,value:p}of Array.from(c.attributes))h.attributes[f]=p;c.scrollLeft&&(h.scrollLeft=c.scrollLeft),c.scrollTop&&(h.scrollTop=c.scrollTop);break}case Rt.TEXT_NODE:s=e.createTextNode(t.textContent||"");break;case Rt.CDATA_SECTION_NODE:s=e.createCDATASection(t.data);break;case Rt.COMMENT_NODE:s=e.createComment(t.textContent||"");break;case Rt.DOCUMENT_FRAGMENT_NODE:s=i.attachShadow({mode:"open"});break;default:return null}let l=n.getMeta(t);return e instanceof Yr&&(l||(l=dm(s,e.unserializedId),n.add(t,l)),e.mirror.add(s,{...l})),s}a(um,"buildFromNode");function sx(t,e=zT(),n=new Yr){function i(s,l){let c=um(s,n,e,l);if(c!==null)if(l?.nodeName!=="IFRAME"&&s.nodeType!==Rt.DOCUMENT_FRAGMENT_NODE&&(l?.appendChild(c),c.parentNode=l,c.parentElement=l),s.nodeName==="IFRAME"){let u=s.contentDocument;u&&i(u,c)}else(s.nodeType===Rt.DOCUMENT_NODE||s.nodeType===Rt.ELEMENT_NODE||s.nodeType===Rt.DOCUMENT_FRAGMENT_NODE)&&(s.nodeType===Rt.ELEMENT_NODE&&s.shadowRoot&&i(s.shadowRoot,c),s.childNodes.forEach(u=>i(u,c)))}return a(i,"walk2"),i(t,null),n}a(sx,"buildFromDom");function ax(){return new Ec}a(ax,"createMirror");var Ec=class{static{a(this,"Mirror22")}constructor(){ee(this,"idNodeMap",new Map),ee(this,"nodeMetaMap",new WeakMap)}getId(e){var n;return e?((n=this.getMeta(e))==null?void 0:n.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){let i=n.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,n)}replace(e,n){let i=this.getNode(e);if(i){let s=this.nodeMetaMap.get(i);s&&this.nodeMetaMap.set(n,s)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function dm(t,e){switch(t.RRNodeType){case we.Document:return{id:e,type:t.RRNodeType,childNodes:[]};case we.DocumentType:{let n=t;return{id:e,type:t.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case we.Element:return{id:e,type:t.RRNodeType,tagName:t.tagName.toLowerCase(),attributes:{},childNodes:[]};case we.Text:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case we.Comment:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case we.CDATA:return{id:e,type:t.RRNodeType,textContent:""}}}a(dm,"getDefaultSN");function hm(t){return{all:t=t||new Map,on:a(function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},"on"),off:a(function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},"off"),emit:a(function(e,n){var i=t.get(e);i&&i.slice().map(function(s){s(n)}),(i=t.get("*"))&&i.slice().map(function(s){s(e,n)})},"emit")}}a(hm,"mitt$1");var lx=Object.freeze(Object.defineProperty({__proto__:null,default:hm},Symbol.toStringTag,{value:"Module"}));function cx(t=window,e=document){if("scrollBehavior"in e.documentElement.style&&t.__forceSmoothScrollPolyfill__!==!0)return;let n=t.HTMLElement||t.Element,i=468,s={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:n.prototype.scroll||h,scrollIntoView:n.prototype.scrollIntoView},l=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now;function c(C){let N=["MSIE ","Trident/","Edge/"];return new RegExp(N.join("|")).test(C)}a(c,"isMicrosoftBrowser");let u=c(t.navigator.userAgent)?1:0;function h(C,N){this.scrollLeft=C,this.scrollTop=N}a(h,"scrollElement");function f(C){return .5*(1-Math.cos(Math.PI*C))}a(f,"ease");function p(C){if(C===null||typeof C!="object"||C.behavior===void 0||C.behavior==="auto"||C.behavior==="instant")return!0;if(typeof C=="object"&&C.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+C.behavior+" is not a valid value for enumeration ScrollBehavior.")}a(p,"shouldBailOut");function g(C,N){if(N==="Y")return C.clientHeight+u<C.scrollHeight;if(N==="X")return C.clientWidth+u<C.scrollWidth}a(g,"hasScrollableSpace");function y(C,N){let A=t.getComputedStyle(C,null)["overflow"+N];return A==="auto"||A==="scroll"}a(y,"canOverflow");function S(C){let N=g(C,"Y")&&y(C,"Y"),A=g(C,"X")&&y(C,"X");return N||A}a(S,"isScrollable");function w(C){for(;C!==e.body&&S(C)===!1;)C=C.parentNode||C.host;return C}a(w,"findScrollableParent");function M(C){let N=l(),A,k,z,q=(N-C.startTime)/i;q=q>1?1:q,A=f(q),k=C.startX+(C.x-C.startX)*A,z=C.startY+(C.y-C.startY)*A,C.method.call(C.scrollable,k,z),(k!==C.x||z!==C.y)&&t.requestAnimationFrame(M.bind(t,C))}a(M,"step");function T(C,N,A){let k,z,q,oe,$=l();C===e.body?(k=t,z=t.scrollX||t.pageXOffset,q=t.scrollY||t.pageYOffset,oe=s.scroll):(k=C,z=C.scrollLeft,q=C.scrollTop,oe=h),M({scrollable:k,method:oe,startTime:$,startX:z,startY:q,x:N,y:A})}a(T,"smoothScroll"),t.scroll=t.scrollTo=function(){if(arguments[0]!==void 0){if(p(arguments[0])===!0){s.scroll.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:t.scrollY||t.pageYOffset);return}T.call(t,e.body,arguments[0].left!==void 0?~~arguments[0].left:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:t.scrollY||t.pageYOffset)}},t.scrollBy=function(){if(arguments[0]!==void 0){if(p(arguments[0])){s.scrollBy.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}T.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(p(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");s.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}let C=arguments[0].left,N=arguments[0].top;T.call(this,this,typeof C>"u"?this.scrollLeft:~~C,typeof N>"u"?this.scrollTop:~~N)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(p(arguments[0])===!0){s.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(p(arguments[0])===!0){s.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}let C=w(this),N=C.getBoundingClientRect(),A=this.getBoundingClientRect();C!==e.body?(T.call(this,C,C.scrollLeft+A.left-N.left,C.scrollTop+A.top-N.top),t.getComputedStyle(C).position!=="fixed"&&t.scrollBy({left:N.left,top:N.top,behavior:"smooth"})):t.scrollBy({left:A.left,top:A.top,behavior:"smooth"})}}a(cx,"polyfill");var vc=class{static{a(this,"Timer")}constructor(e=[],n){O(this,"timeOffset",0),O(this,"speed"),O(this,"actions"),O(this,"raf",null),O(this,"lastTimestamp"),this.actions=e,this.speed=n.speed}addAction(e){let n=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{let i=this.findActionIndex(e);this.actions.splice(i,0,e)}n&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){let e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){let n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return this.raf!==null}findActionIndex(e){let n=0,i=this.actions.length-1;for(;n<=i;){let s=Math.floor((n+i)/2);if(this.actions[s].delay<e.delay)n=s+1;else if(this.actions[s].delay>e.delay)i=s-1;else return s+1}return n}};function bf(t,e){if(t.type===U.IncrementalSnapshot&&t.data.source===H.MouseMove&&t.data.positions&&t.data.positions.length){let n=t.data.positions[0].timeOffset,i=t.timestamp+n;return t.delay=i-e,i-e}return t.delay=t.timestamp-e,t.delay}a(bf,"addDelay");function wf(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i,s,l=n.call(t),c=[];try{for(;(e===void 0||e-- >0)&&!(i=l.next()).done;)c.push(i.value)}catch(u){s={error:u}}finally{try{i&&!i.done&&(n=l.return)&&n.call(l)}finally{if(s)throw s.error}}return c}a(wf,"t");var qr;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(qr||(qr={}));var fm={type:"xstate.init"};function Zl(t){return t===void 0?[]:[].concat(t)}a(Zl,"r");function Gr(t){return{type:"xstate.assign",assignment:t}}a(Gr,"o");function Mf(t,e){return typeof(t=typeof t=="string"&&e&&e[t]?e[t]:t)=="string"?{type:t}:typeof t=="function"?{type:t.name,exec:t}:t}a(Mf,"i");function Ls(t){return function(e){return t===e}}a(Ls,"a");function mm(t){return typeof t=="string"?{type:t}:t}a(mm,"u");function Tf(t,e){return{value:t,context:e,actions:[],changed:!1,matches:Ls(t)}}a(Tf,"c");function xf(t,e,n){var i=e,s=!1;return[t.filter(function(l){if(l.type==="xstate.assign"){s=!0;var c=Object.assign({},i);return typeof l.assignment=="function"?c=l.assignment(i,n):Object.keys(l.assignment).forEach(function(u){c[u]=typeof l.assignment[u]=="function"?l.assignment[u](i,n):l.assignment[u]}),i=c,!1}return!0}),i,s]}a(xf,"f");function pm(t,e){e===void 0&&(e={});var n=wf(xf(Zl(t.states[t.initial].entry).map(function(c){return Mf(c,e.actions)}),t.context,fm),2),i=n[0],s=n[1],l={config:t,_options:e,initialState:{value:t.initial,actions:i,context:s,matches:Ls(t.initial)},transition:a(function(c,u){var h,f,p=typeof c=="string"?{value:c,context:t.context}:c,g=p.value,y=p.context,S=mm(u),w=t.states[g];if(w.on){var M=Zl(w.on[S.type]);try{for(var T=function(Ne){var Ue=typeof Symbol=="function"&&Symbol.iterator,$e=Ue&&Ne[Ue],Ht=0;if($e)return $e.call(Ne);if(Ne&&typeof Ne.length=="number")return{next:a(function(){return Ne&&Ht>=Ne.length&&(Ne=void 0),{value:Ne&&Ne[Ht++],done:!Ne}},"next")};throw new TypeError(Ue?"Object is not iterable.":"Symbol.iterator is not defined.")}(M),C=T.next();!C.done;C=T.next()){var N=C.value;if(N===void 0)return Tf(g,y);var A=typeof N=="string"?{target:N}:N,k=A.target,z=A.actions,q=z===void 0?[]:z,oe=A.cond,$=oe===void 0?function(){return!0}:oe,Z=k===void 0,de=k??g,G=t.states[de];if($(y,S)){var B=wf(xf((Z?Zl(q):[].concat(w.exit,q,G.entry).filter(function(Ne){return Ne})).map(function(Ne){return Mf(Ne,l._options.actions)}),y,S),3),X=B[0],j=B[1],Q=B[2],ne=k??g;return{value:ne,context:j,actions:X,changed:k!==g||X.length>0||Q,matches:Ls(ne)}}}}catch(Ne){h={error:Ne}}finally{try{C&&!C.done&&(f=T.return)&&f.call(T)}finally{if(h)throw h.error}}}return Tf(g,y)},"transition")};return l}a(pm,"s");var Cf=a(function(t,e){return t.actions.forEach(function(n){var i=n.exec;return i&&i(t.context,e)})},"l");function gm(t){var e=t.initialState,n=qr.NotStarted,i=new Set,s={_machine:t,send:a(function(l){n===qr.Running&&(e=t.transition(e,l),Cf(e,mm(l)),i.forEach(function(c){return c(e)}))},"send"),subscribe:a(function(l){return i.add(l),l(e),{unsubscribe:a(function(){return i.delete(l)},"unsubscribe")}},"subscribe"),start:a(function(l){if(l){var c=typeof l=="object"?l:{context:t.config.context,value:l};e={value:c.value,actions:[],context:c.context,matches:Ls(c.value)}}return n=qr.Running,Cf(e,fm),s},"start"),stop:a(function(){return n=qr.Stopped,i.clear(),s},"stop"),get state(){return e},get status(){return n}};return s}a(gm,"v");function ux(t,e){for(let n=t.length-1;n>=0;n--){let i=t[n];if(i.type===U.Meta&&i.timestamp<=e)return t.slice(n)}return t}a(ux,"discardPriorSnapshots");function dx(t,{getCastFn:e,applyEventsSynchronously:n,emitter:i}){let s=pm({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Gr({lastPlayedEvent:a((l,c)=>c.type==="CAST_EVENT"?c.payload.event:l.lastPlayedEvent,"lastPlayedEvent")}),recordTimeOffset:Gr((l,c)=>{let u=l.timeOffset;return"payload"in c&&"timeOffset"in c.payload&&(u=c.payload.timeOffset),{...l,timeOffset:u,baselineTime:l.events[0].timestamp+u}}),play(l){var c;let{timer:u,events:h,baselineTime:f,lastPlayedEvent:p}=l;u.clear();for(let w of h)bf(w,f);let g=ux(h,f),y=p?.timestamp;p?.type===U.IncrementalSnapshot&&p.data.source===H.MouseMove&&(y=p.timestamp+((c=p.data.positions[0])==null?void 0:c.timeOffset)),f<(y||0)&&i.emit(Se.PlayBack);let S=new Array;for(let w of g)if(!(y&&y<f&&(w.timestamp<=y||w===p)))if(w.timestamp<f)S.push(w);else{let M=e(w,!1);u.addAction({doAction:a(()=>{M()},"doAction"),delay:w.delay})}n(S),i.emit(Se.Flush),u.start()},pause(l){l.timer.clear()},resetLastPlayedEvent:Gr(l=>({...l,lastPlayedEvent:null})),startLive:Gr({baselineTime:a((l,c)=>(l.timer.start(),c.type==="TO_LIVE"&&c.payload.baselineTime?c.payload.baselineTime:Date.now()),"baselineTime")}),addEvent:Gr((l,c)=>{let{baselineTime:u,timer:h,events:f}=l;if(c.type==="ADD_EVENT"){let{event:p}=c.payload;bf(p,u);let g=f.length-1;if(!f[g]||f[g].timestamp<=p.timestamp)f.push(p);else{let w=-1,M=0;for(;M<=g;){let T=Math.floor((M+g)/2);f[T].timestamp<=p.timestamp?M=T+1:g=T-1}w===-1&&(w=M),f.splice(w,0,p)}let y=p.timestamp<u,S=e(p,y);y?S():h.isActive()&&h.addAction({doAction:a(()=>{S()},"doAction"),delay:p.delay})}return{...l,events:f}})}});return gm(s)}a(dx,"createPlayerService");function hx(t){let e=pm({id:"speed",context:t,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:a((n,i)=>{"payload"in i&&n.timer.setSpeed(i.payload.speed)},"setSpeed"),recordSpeed:Gr({normalSpeed:a(n=>n.timer.speed,"normalSpeed")}),restoreSpeed:a(n=>{n.timer.setSpeed(n.normalSpeed)},"restoreSpeed")}});return gm(e)}a(hx,"createSpeedService");var fx=a(t=>[`.${t} { background: currentColor }`,"noscript { display: none !important; }"],"rules"),If=new Map;function ym(t,e){let n=If.get(t);return n||(n=new Map,If.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}a(ym,"variableListFor");function Vn(t,e,n){return async i=>{if(i&&typeof i=="object"&&"rr_type"in i)if(n&&(n.isUnchanged=!1),i.rr_type==="ImageBitmap"&&"args"in i){let s=await Vn(t,e,n)(i.args);return await createImageBitmap.apply(null,s)}else if("index"in i){if(n||e===null)return i;let{rr_type:s,index:l}=i;return ym(e,s)[l]}else if("args"in i){let{rr_type:s,args:l}=i,c=window[s];return new c(...await Promise.all(l.map(Vn(t,e,n))))}else{if("base64"in i)return _T(i.base64);if("src"in i){let s=t.get(i.src);if(s)return s;{let l=new Image;return l.src=i.src,t.set(i.src,l),l}}else if("data"in i&&i.rr_type==="Blob"){let s=await Promise.all(i.data.map(Vn(t,e,n)));return new Blob(s,{type:i.type})}}else if(Array.isArray(i))return await Promise.all(i.map(Vn(t,e,n)));return i}}a(Vn,"deserializeArg");function mx(t,e){try{return e===vn.WebGL?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}catch{return null}}a(mx,"getContext");var px=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function gx(t,e){if(!e?.constructor)return;let{name:n}=e.constructor;if(!px.includes(n))return;let i=ym(t,n);i.includes(e)||i.push(e)}a(gx,"saveToWebGLVarMap");async function yx({mutation:t,target:e,type:n,imageMap:i,errorHandler:s}){try{let l=mx(e,n);if(!l)return;if(t.setter){l[t.property]=t.args[0];return}let c=l[t.property],u=await Promise.all(t.args.map(Vn(i,l))),h=c.apply(l,u);gx(l,h);let f=!1}catch(l){s(t,l)}}a(yx,"webglMutation");async function Ex({event:t,mutations:e,target:n,imageMap:i,errorHandler:s}){let l=n.getContext("2d");if(!l){s(e[0],new Error("Canvas context is null"));return}let c=e.map(async h=>Promise.all(h.args.map(Vn(i,l))));(await Promise.all(c)).forEach((h,f)=>{let p=e[f];try{if(p.setter){l[p.property]=p.args[0];return}let g=l[p.property];p.property==="drawImage"&&typeof p.args[0]=="string"?(i.get(t),g.apply(l,p.args)):g.apply(l,h)}catch(g){s(p,g)}})}a(Ex,"canvasMutation$1");async function Af({event:t,mutation:e,target:n,imageMap:i,canvasEventMap:s,errorHandler:l}){try{let c=s.get(t)||e,u="commands"in c?c.commands:[c];if([vn.WebGL,vn.WebGL2].includes(e.type)){for(let h=0;h<u.length;h++){let f=u[h];await yx({mutation:f,type:e.type,target:n,imageMap:i,errorHandler:l})}return}await Ex({event:t,mutations:u,target:n,imageMap:i,errorHandler:l})}catch(c){l(e,c)}}a(Af,"canvasMutation");var Sc=class{static{a(this,"MediaManager")}constructor(e){O(this,"mediaMap",new Map),O(this,"warn"),O(this,"service"),O(this,"speedService"),O(this,"emitter"),O(this,"getCurrentTime"),O(this,"metadataCallbackMap",new Map),this.warn=e.warn,this.service=e.service,this.speedService=e.speedService,this.emitter=e.emitter,this.getCurrentTime=e.getCurrentTime,this.emitter.on(Se.Start,this.start.bind(this)),this.emitter.on(Se.SkipStart,this.start.bind(this)),this.emitter.on(Se.Pause,this.pause.bind(this)),this.emitter.on(Se.Finish,this.pause.bind(this)),this.speedService.subscribe(()=>{this.syncAllMediaElements()})}syncAllMediaElements(e={pause:!1}){this.mediaMap.forEach((n,i)=>{this.syncTargetWithState(i),e.pause&&i.pause()})}start(){this.syncAllMediaElements()}pause(){this.syncAllMediaElements({pause:!0})}seekTo({time:e,target:n,mediaState:i}){if(i.isPlaying){let l=(e-i.lastInteractionTimeOffset)/1e3*i.playbackRate,c="duration"in n&&n.duration;if(Number.isNaN(c)){this.waitForMetadata(n);return}let u=i.currentTimeAtLastInteraction+l;n.loop&&c!==!1&&(u=u%c),n.currentTime=u}else n.pause(),n.currentTime=i.currentTimeAtLastInteraction}waitForMetadata(e){if(this.metadataCallbackMap.has(e)||!("addEventListener"in e))return;let n=a(()=>{this.metadataCallbackMap.delete(e);let i=this.mediaMap.get(e);i&&this.seekTo({time:this.getCurrentTime(),target:e,mediaState:i})},"onLoadedMetadata");this.metadataCallbackMap.set(e,n),e.addEventListener("loadedmetadata",n,{once:!0})}getMediaStateFromMutation({target:e,timeOffset:n,mutation:i}){let s=this.mediaMap.get(e),{type:l,playbackRate:c,currentTime:u,muted:h,volume:f,loop:p}=i;return{isPlaying:l===Wn.Play||l!==Wn.Pause&&(s?.isPlaying||e.getAttribute("autoplay")!==null),currentTimeAtLastInteraction:u??s?.currentTimeAtLastInteraction??0,lastInteractionTimeOffset:n,playbackRate:c??s?.playbackRate??1,volume:f??s?.volume??1,muted:h??s?.muted??e.getAttribute("muted")===null,loop:p??s?.loop??e.getAttribute("loop")===null}}syncTargetWithState(e){let n=this.mediaMap.get(e);if(!n)return;let{muted:i,loop:s,volume:l,isPlaying:c}=n,u=this.service.state.matches("paused"),h=n.playbackRate*this.speedService.state.context.timer.speed;try{this.seekTo({time:this.getCurrentTime(),target:e,mediaState:n}),e.volume!==l&&(e.volume=l),e.muted=i,e.loop=s,e.playbackRate!==h&&(e.playbackRate=h),c&&!u?e.play():e.pause()}catch(f){this.warn(`Failed to replay media interactions: ${f.message||f}`)}}addMediaElements(e,n,i){if(!["AUDIO","VIDEO"].includes(e.nodeName))return;let s=e,l=i.getMeta(s);if(!l||!("attributes"in l))return;let c=this.service.state.matches("paused"),u=l.attributes,h=!1;u.rr_mediaState?h=u.rr_mediaState==="played":h=s.getAttribute("autoplay")!==null,h&&c&&s.pause();let f=1;typeof u.rr_mediaPlaybackRate=="number"&&(f=u.rr_mediaPlaybackRate);let p=!1;typeof u.rr_mediaMuted=="boolean"?p=u.rr_mediaMuted:p=s.getAttribute("muted")!==null;let g=!1;typeof u.rr_mediaLoop=="boolean"?g=u.rr_mediaLoop:g=s.getAttribute("loop")!==null;let y=1;typeof u.rr_mediaVolume=="number"&&(y=u.rr_mediaVolume);let S=0;typeof u.rr_mediaCurrentTime=="number"&&(S=u.rr_mediaCurrentTime),this.mediaMap.set(s,{isPlaying:h,currentTimeAtLastInteraction:S,lastInteractionTimeOffset:n,playbackRate:f,volume:y,muted:p,loop:g}),this.syncTargetWithState(s)}mediaMutation({target:e,timeOffset:n,mutation:i}){this.mediaMap.set(e,this.getMediaStateFromMutation({target:e,timeOffset:n,mutation:i})),this.syncTargetWithState(e)}isSupportedMediaElement(e){return["AUDIO","VIDEO"].includes(e.nodeName)}reset(){this.mediaMap.clear()}},vx=5*1e3,Sx=hm||lx,Rf="[replayer]",Ql={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Lf(t){return t.type==U.IncrementalSnapshot&&(t.data.source==H.TouchMove||t.data.source==H.MouseInteraction&&t.data.type==ie.TouchStart)}a(Lf,"indicatesTouchDevice");var Ns=class{static{a(this,"Replayer")}constructor(e,n){if(O(this,"wrapper"),O(this,"iframe"),O(this,"service"),O(this,"speedService"),O(this,"config"),O(this,"usingVirtualDom",!1),O(this,"virtualDom",new Yr),O(this,"mouse"),O(this,"mouseTail",null),O(this,"tailPositions",[]),O(this,"emitter",Sx()),O(this,"nextUserInteractionEvent"),O(this,"legacy_missingNodeRetryMap",{}),O(this,"cache",af()),O(this,"imageMap",new Map),O(this,"canvasEventMap",new Map),O(this,"mirror",_f()),O(this,"styleMirror",new Ss),O(this,"mediaManager"),O(this,"firstFullSnapshot",null),O(this,"newDocumentQueue",[]),O(this,"mousePos",null),O(this,"touchActive",null),O(this,"lastMouseDownEvent",null),O(this,"lastHoveredRootNode"),O(this,"lastSelectionData",null),O(this,"constructedStyleMutations",[]),O(this,"adoptedStyleSheets",[]),O(this,"handleResize",u=>{this.iframe.style.display="inherit";for(let h of[this.mouseTail,this.iframe])h&&(h.setAttribute("width",String(u.width)),h.setAttribute("height",String(u.height)))}),O(this,"applyEventsSynchronously",u=>{for(let h of u){switch(h.type){case U.DomContentLoaded:case U.Load:case U.Custom:continue;case U.FullSnapshot:case U.Meta:case U.Plugin:case U.IncrementalSnapshot:break}this.getCastFn(h,!0)()}}),O(this,"getCastFn",(u,h=!1)=>{let f;switch(u.type){case U.DomContentLoaded:case U.Load:break;case U.Custom:f=a(()=>{this.emitter.emit(Se.CustomEvent,u)},"castFn");break;case U.Meta:f=a(()=>this.emitter.emit(Se.Resize,{width:u.data.width,height:u.data.height}),"castFn");break;case U.FullSnapshot:f=a(()=>{var g;if(this.firstFullSnapshot){if(this.firstFullSnapshot===u){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.mediaManager.reset(),this.styleMirror.reset(),this.rebuildFullSnapshot(u,h),(g=this.iframe.contentWindow)==null||g.scrollTo(u.data.initialOffset)},"castFn");break;case U.IncrementalSnapshot:f=a(()=>{if(this.applyIncremental(u,h),!h&&(u===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let g of this.service.state.context.events)if(!(g.timestamp<=u.timestamp)&&this.isUserInteraction(g)){g.delay-u.delay>this.config.inactivePeriodThreshold*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=g);break}if(this.nextUserInteractionEvent){let g=this.nextUserInteractionEvent.delay-u.delay,y={speed:Math.min(Math.round(g/vx),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:y}),this.emitter.emit(Se.SkipStart,y)}}},"castFn");break}return a(()=>{f&&f();for(let y of this.config.plugins||[])y.handler&&y.handler(u,h,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:u}});let g=this.service.state.context.events.length-1;if(!this.config.liveMode&&u===this.service.state.context.events[g]){let y=a(()=>{g<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(Se.Finish))},"finish"),S=50;u.type===U.IncrementalSnapshot&&u.data.source===H.MouseMove&&u.data.positions.length&&(S+=Math.max(0,-u.data.positions[0].timeOffset)),setTimeout(y,S)}this.emitter.emit(Se.EventCast,u)},"wrappedCastFn")}),!n?.liveMode&&e.length<2)throw new Error("Replayer need at least 2 events.");let i={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,inactivePeriodThreshold:10*1e3,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Ql,useVirtualDom:!0,logger:console};this.config=Object.assign({},i,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(Se.Resize,this.handleResize),this.setupDom();for(let u of this.config.plugins||[])u.getMirror&&u.getMirror({nodeMirror:this.mirror});this.emitter.on(Se.Flush,()=>{if(this.usingVirtualDom){let u={mirror:this.mirror,applyCanvas:a((h,f,p)=>{Af({event:h,mutation:f,target:p,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},"applyCanvas"),applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:a((h,f)=>{h.source===H.StyleSheetRule?this.applyStyleSheetRule(h,f):h.source===H.StyleDeclaration&&this.applyStyleDeclaration(h,f)},"applyStyleSheetMutation"),afterAppend:a((h,f)=>{for(let p of this.config.plugins||[])p.onBuild&&p.onBuild(h,{id:f,replayer:this})},"afterAppend")};if(this.iframe.contentDocument)try{As(this.iframe.contentDocument,this.virtualDom,u,this.virtualDom.mirror)}catch(h){console.warn(h)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let h in this.legacy_missingNodeRetryMap)try{let f=this.legacy_missingNodeRetryMap[h],p=Rs(f.node,this.mirror,this.virtualDom.mirror);As(p,f.node,u,this.virtualDom.mirror),f.node=p}catch(f){this.warn(f)}this.constructedStyleMutations.forEach(h=>{this.applyStyleSheetMutation(h)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(h=>{this.applyAdoptedStyleSheet(h)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){let[u,h]=this.lastMouseDownEvent;u.dispatchEvent(h)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(Se.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset()});let s=new vc([],{speed:this.config.speed});this.service=dx({events:e.map(u=>n&&n.unpackFn?n.unpackFn(u):u).sort((u,h)=>u.timestamp-h.timestamp),timer:s,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(u=>{this.emitter.emit(Se.StateChange,{player:u})}),this.speedService=hx({normalSpeed:-1,timer:s}),this.speedService.start(),this.speedService.subscribe(u=>{this.emitter.emit(Se.StateChange,{speed:u})}),this.mediaManager=new Sc({warn:this.warn.bind(this),service:this.service,speedService:this.speedService,emitter:this.emitter,getCurrentTime:this.getCurrentTime.bind(this)});let l=this.service.state.context.events.find(u=>u.type===U.Meta),c=this.service.state.context.events.find(u=>u.type===U.FullSnapshot);if(l){let{width:u,height:h}=l.data;setTimeout(()=>{this.emitter.emit(Se.Resize,{width:u,height:h})},0)}c&&setTimeout(()=>{var u;this.firstFullSnapshot||(this.firstFullSnapshot=c,this.rebuildFullSnapshot(c),(u=this.iframe.contentWindow)==null||u.scrollTo(c.data.initialOffset))},1),this.service.state.context.events.find(Lf)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,n){return this.emitter.on(e,n),this}off(e,n){return this.emitter.off(e,n),this}setConfig(e){Object.keys(e).forEach(n=>{e[n],this.config[n]=e[n]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){let e=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:n.timestamp,totalTime:n.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:n}=this.service.state.context;return e-n[0].timestamp}getMirror(){return this.mirror}play(e=0){var n,i;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(i=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||i.classList.remove("rrweb-paused"),this.emitter.emit(Se.Start)}pause(e){var n,i;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(i=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||i.classList.add("rrweb-paused"),this.emitter.emit(Se.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(Se.Resume)}destroy(){this.pause(),this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset(),this.config.root.removeChild(this.wrapper),this.emitter.emit(Se.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let n=this.config.unpackFn?this.config.unpackFn(e):e;Lf(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=af()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(cx(this.iframe.contentWindow,this.iframe.contentDocument),Yf(this.iframe.contentWindow))}rebuildFullSnapshot(e,n=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let i=[],s=a((u,h)=>{if(this.collectIframeAndAttachDocument(i,u),this.mediaManager.isSupportedMediaElement(u)){let{events:f}=this.service.state.context;this.mediaManager.addMediaElements(u,e.timestamp-f[0].timestamp,this.mirror)}for(let f of this.config.plugins||[])f.onBuild&&f.onBuild(u,{id:h,replayer:this})},"afterAppend");this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),uT(e.data.node,{doc:this.iframe.contentDocument,afterAppend:s,cache:this.cache,mirror:this.mirror}),s(this.iframe.contentDocument,e.data.node.id);for(let{mutationInQueue:u,builtNode:h}of i)this.attachDocumentToIframe(u,h),this.newDocumentQueue=this.newDocumentQueue.filter(f=>f!==u);let{documentElement:l,head:c}=this.iframe.contentDocument;this.insertStyleRules(l,c),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(Se.FullsnapshotRebuilded,e),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,n){var i;let s=fx(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&s.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let l=this.virtualDom.createElement("style");this.virtualDom.mirror.add(l,dm(l,this.virtualDom.unserializedId)),e.insertBefore(l,n),l.rules.push({source:H.StyleSheetRule,adds:s.map((c,u)=>({rule:c,index:u}))})}else{let l=document.createElement("style");e.insertBefore(l,n);for(let c=0;c<s.length;c++)(i=l.sheet)==null||i.insertRule(s[c],c)}}attachDocumentToIframe(e,n){let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,s=[],l=a((c,u)=>{this.collectIframeAndAttachDocument(s,c);let h=i.getMeta(c);if(h?.type===ce.Element&&h?.tagName.toUpperCase()==="HTML"){let{documentElement:f,head:p}=n.contentDocument;this.insertStyleRules(f,p)}if(!this.usingVirtualDom)for(let f of this.config.plugins||[])f.onBuild&&f.onBuild(c,{id:u,replayer:this})},"afterAppend");Bi(e.node,{doc:n.contentDocument,mirror:i,hackCss:!0,skipChild:!1,afterAppend:l,cache:this.cache}),l(n.contentDocument,e.node.id);for(let{mutationInQueue:c,builtNode:u}of s)this.attachDocumentToIframe(c,u),this.newDocumentQueue=this.newDocumentQueue.filter(h=>h!==c)}collectIframeAndAttachDocument(e,n){if(Gi(n,this.mirror)){let i=this.newDocumentQueue.find(s=>s.parentId===this.mirror.getId(n));i&&e.push({mutationInQueue:i,builtNode:n})}}waitForStylesheetLoad(){var e;let n=(e=this.iframe.contentDocument)==null?void 0:e.head;if(n){let i=new Set,s,l=this.service.state,c=a(()=>{l=this.service.state},"stateHandler");this.emitter.on(Se.Start,c),this.emitter.on(Se.Pause,c);let u=a(()=>{this.emitter.off(Se.Start,c),this.emitter.off(Se.Pause,c)},"unsubscribe");n.querySelectorAll('link[rel="stylesheet"]').forEach(h=>{h.sheet||(i.add(h),h.addEventListener("load",()=>{i.delete(h),i.size===0&&s!==-1&&(l.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(Se.LoadStylesheetEnd),s&&clearTimeout(s),u())}))}),i.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(Se.LoadStylesheetStart),s=setTimeout(()=>{l.matches("playing")&&this.play(this.getCurrentTime()),s=-1,u()},this.config.loadTimeout))}}async preloadAllImages(){let e=[];for(let n of this.service.state.context.events)n.type===U.IncrementalSnapshot&&n.data.source===H.CanvasMutation&&(e.push(this.deserializeAndPreloadCanvasEvents(n.data,n)),("commands"in n.data?n.data.commands:[n.data]).forEach(s=>{this.preloadImages(s,n)}));return Promise.all(e)}preloadImages(e,n){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(n)){let i=document.createElement("canvas"),s=i.getContext("2d"),l=s?.createImageData(i.width,i.height);s?.putImageData(l,0,0)}}async deserializeAndPreloadCanvasEvents(e,n){if(!this.canvasEventMap.has(n)){let i={isUnchanged:!0};if("commands"in e){let s=await Promise.all(e.commands.map(async l=>{let c=await Promise.all(l.args.map(Vn(this.imageMap,null,i)));return{...l,args:c}}));i.isUnchanged===!1&&this.canvasEventMap.set(n,{...e,commands:s})}else{let s=await Promise.all(e.args.map(Vn(this.imageMap,null,i)));i.isUnchanged===!1&&this.canvasEventMap.set(n,{...e,args:s})}}}applyIncremental(e,n){var i,s,l;let{data:c}=e;switch(c.source){case H.Mutation:{try{this.applyMutation(c,n)}catch(u){this.warn(`Exception in mutation ${u.message||u}`,c)}break}case H.Drag:case H.TouchMove:case H.MouseMove:if(n){let u=c.positions[c.positions.length-1];this.mousePos={x:u.x,y:u.y,id:u.id,debugData:c}}else c.positions.forEach(u=>{let h={doAction:a(()=>{this.moveAndHover(u.x,u.y,u.id,n,c)},"doAction"),delay:u.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(h)}),this.timer.addAction({doAction(){},delay:e.delay-((i=c.positions[0])==null?void 0:i.timeOffset)});break;case H.MouseInteraction:{if(c.id===-1)break;let u=new Event(Bn(ie[c.type])),h=this.mirror.getNode(c.id);if(!h)return this.debugNodeNotFound(c,c.id);this.emitter.emit(Se.MouseInteraction,{type:c.type,target:h});let{triggerFocus:f}=this.config;switch(c.type){case ie.Blur:"blur"in h&&h.blur();break;case ie.Focus:f&&h.focus&&h.focus({preventScroll:!0});break;case ie.Click:case ie.TouchStart:case ie.TouchEnd:case ie.MouseDown:case ie.MouseUp:n?(c.type===ie.TouchStart?this.touchActive=!0:c.type===ie.TouchEnd&&(this.touchActive=!1),c.type===ie.MouseDown?this.lastMouseDownEvent=[h,u]:c.type===ie.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:c.x||0,y:c.y||0,id:c.id,debugData:c}):(c.type===ie.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(c.x||0,c.y||0,c.id,n,c),c.type===ie.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):c.type===ie.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):c.type===ie.TouchEnd?this.mouse.classList.remove("touch-active"):h.dispatchEvent(u));break;case ie.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:h.dispatchEvent(u)}break}case H.Scroll:{if(c.id===-1)break;if(this.usingVirtualDom){let u=this.virtualDom.mirror.getNode(c.id);if(!u)return this.debugNodeNotFound(c,c.id);u.scrollData=c;break}this.applyScroll(c,n);break}case H.ViewportResize:this.emitter.emit(Se.Resize,{width:c.width,height:c.height});break;case H.Input:{if(c.id===-1)break;if(this.usingVirtualDom){let u=this.virtualDom.mirror.getNode(c.id);if(!u)return this.debugNodeNotFound(c,c.id);u.inputData=c;break}this.applyInput(c);break}case H.MediaInteraction:{let u=this.usingVirtualDom?this.virtualDom.mirror.getNode(c.id):this.mirror.getNode(c.id);if(!u)return this.debugNodeNotFound(c,c.id);let h=u,{events:f}=this.service.state.context;this.mediaManager.mediaMutation({target:h,timeOffset:e.timestamp-f[0].timestamp,mutation:c});break}case H.StyleSheetRule:case H.StyleDeclaration:{this.usingVirtualDom?c.styleId?this.constructedStyleMutations.push(c):c.id&&((s=this.virtualDom.mirror.getNode(c.id))==null||s.rules.push(c)):this.applyStyleSheetMutation(c);break}case H.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let u=this.virtualDom.mirror.getNode(c.id);if(!u)return this.debugNodeNotFound(c,c.id);u.canvasMutations.push({event:e,mutation:c})}else{let u=this.mirror.getNode(c.id);if(!u)return this.debugNodeNotFound(c,c.id);Af({event:e,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case H.Font:{try{let u=new FontFace(c.family,c.buffer?new Uint8Array(JSON.parse(c.fontSource)):c.fontSource,c.descriptors);(l=this.iframe.contentDocument)==null||l.fonts.add(u)}catch(u){this.warn(u)}break}case H.Selection:{if(n){this.lastSelectionData=c;break}this.applySelection(c);break}case H.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(c):this.applyAdoptedStyleSheet(c);break}}}applyMutation(e,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,sx(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let f in this.legacy_missingNodeRetryMap)try{let p=this.legacy_missingNodeRetryMap[f],g=um(p.node,this.virtualDom,this.mirror);g&&(p.node=g)}catch(p){this.warn(p)}let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter(f=>i.getNode(f.id)?!0:(this.warnNodeNotFound(e,f.id),!1)),e.removes.forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return;let y=i.getNode(f.parentId);if(!y)return this.warnNodeNotFound(e,f.parentId);if(f.isShadow&&lr(y)&&(y=y.shadowRoot),i.removeNodeFromMap(g),y)try{y.removeChild(g),this.usingVirtualDom&&g.nodeName==="#text"&&y.nodeName==="STYLE"&&((p=y.rules)==null?void 0:p.length)>0&&(y.rules=[])}catch(S){if(S instanceof DOMException)this.warn("parent could not remove child in mutation",y,g,e);else throw S}});let s={...this.legacy_missingNodeRetryMap},l=[],c=a(f=>{let p=null;return f.nextId&&(p=i.getNode(f.nextId)),f.nextId!==null&&f.nextId!==void 0&&f.nextId!==-1&&!p},"nextNotInDOM"),u=a(f=>{var p,g;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let y=i.getNode(f.parentId);if(!y)return f.node.type===ce.Document?this.newDocumentQueue.push(f):l.push(f);f.node.isShadow&&(lr(y)||y.attachShadow({mode:"open"}),y=y.shadowRoot);let S=null,w=null;if(f.previousId&&(S=i.getNode(f.previousId)),f.nextId&&(w=i.getNode(f.nextId)),c(f))return l.push(f);if(f.node.rootId&&!i.getNode(f.node.rootId))return;let M=f.node.rootId?i.getNode(f.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Gi(y,i)){this.attachDocumentToIframe(f,y);return}let T=a((A,k)=>{if(!this.usingVirtualDom)for(let z of this.config.plugins||[])z.onBuild&&z.onBuild(A,{id:k,replayer:this})},"afterAppend"),C=Bi(f.node,{doc:M,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:T});if(f.previousId===-1||f.nextId===-1){s[f.node.id]={node:C,mutation:f};return}let N=i.getMeta(y);if(N&&N.type===ce.Element&&N.tagName==="textarea"&&f.node.type===ce.Text){let A=Array.isArray(y.childNodes)?y.childNodes:Array.from(y.childNodes);for(let k of A)k.nodeType===y.TEXT_NODE&&y.removeChild(k)}else if(N?.type===ce.Document){let A=y;f.node.type===ce.DocumentType&&((p=A.childNodes[0])==null?void 0:p.nodeType)===Node.DOCUMENT_TYPE_NODE&&A.removeChild(A.childNodes[0]),C.nodeName==="HTML"&&A.documentElement&&A.removeChild(A.documentElement)}if(S&&S.nextSibling&&S.nextSibling.parentNode?y.insertBefore(C,S.nextSibling):w&&w.parentNode?y.contains(w)?y.insertBefore(C,w):y.insertBefore(C,null):y.appendChild(C),T(C,f.node.id),this.usingVirtualDom&&C.nodeName==="#text"&&y.nodeName==="STYLE"&&((g=y.rules)==null?void 0:g.length)>0&&(y.rules=[]),Gi(C,this.mirror)){let A=this.mirror.getId(C),k=this.newDocumentQueue.find(z=>z.parentId===A);k&&(this.attachDocumentToIframe(k,C),this.newDocumentQueue=this.newDocumentQueue.filter(z=>z!==k))}(f.previousId||f.nextId)&&this.legacy_resolveMissingNode(s,y,C,f)},"appendNode");e.adds.forEach(f=>{u(f)});let h=Date.now();for(;l.length;){let f=hT(l);if(l.length=0,Date.now()-h>500){this.warn("Timeout in the loop, please check the resolve tree data:",f);break}for(let p of f)i.getNode(p.value.parentId)?Kf(p,y=>{u(y)}):this.debug("Drop resolve tree since there is no parent for the root node.",p)}Object.keys(s).length&&Object.assign(this.legacy_missingNodeRetryMap,s),fT(e.texts).forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return e.removes.find(y=>y.id===f.id)?void 0:this.warnNodeNotFound(e,f.id);if(g.textContent=f.value,this.usingVirtualDom){let y=g.parentNode;((p=y?.rules)==null?void 0:p.length)>0&&(y.rules=[])}}),e.attributes.forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return e.removes.find(y=>y.id===f.id)?void 0:this.warnNodeNotFound(e,f.id);for(let y in f.attributes)if(typeof y=="string"){let S=f.attributes[y];if(S===null)g.removeAttribute(y);else if(typeof S=="string")try{if(y==="_cssText"&&(g.nodeName==="LINK"||g.nodeName==="STYLE"))try{let w=i.getMeta(g);Object.assign(w.attributes,f.attributes);let M=Bi(w,{doc:g.ownerDocument,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache}),T=g.nextSibling,C=g.parentNode;if(M&&C){C.removeChild(g),C.insertBefore(M,T),i.replace(f.id,M);break}}catch{}if(y==="value"&&g.nodeName==="TEXTAREA"){let w=g;w.childNodes.forEach(T=>w.removeChild(T));let M=(p=g.ownerDocument)==null?void 0:p.createTextNode(S);M&&w.appendChild(M)}else g.setAttribute(y,S)}catch(w){this.warn("An error occurred may due to the checkout feature.",w)}else if(y==="style"){let w=S,M=g;for(let T in w)if(w[T]===!1)M.style.removeProperty(T);else if(w[T]instanceof Array){let C=w[T];M.style.setProperty(T,C[0],C[1])}else{let C=w[T];M.style.setProperty(T,C)}}}})}applyScroll(e,n){var i,s;let l=this.mirror.getNode(e.id);if(!l)return this.debugNodeNotFound(e,e.id);let c=this.mirror.getMeta(l);if(l===this.iframe.contentDocument)(i=this.iframe.contentWindow)==null||i.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else if(c?.type===ce.Document)(s=l.defaultView)==null||s.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else try{l.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(e){let n=this.mirror.getNode(e.id);if(!n)return this.debugNodeNotFound(e,e.id);try{n.checked=e.isChecked,n.value=e.text}catch{}}applySelection(e){try{let n=new Set,i=e.ranges.map(({start:s,startOffset:l,end:c,endOffset:u})=>{let h=this.mirror.getNode(s),f=this.mirror.getNode(c);if(!h||!f)return;let p=new Range;p.setStart(h,l),p.setEnd(f,u);let g=h.ownerDocument,y=g?.getSelection();return y&&n.add(y),{range:p,selection:y}});n.forEach(s=>s.removeAllRanges()),i.forEach(s=>{var l;return s&&((l=s.selection)==null?void 0:l.addRange(s.range))})}catch{}}applyStyleSheetMutation(e){var n;let i=null;e.styleId?i=this.styleMirror.getStyle(e.styleId):e.id&&(i=((n=this.mirror.getNode(e.id))==null?void 0:n.sheet)||null),i&&(e.source===H.StyleSheetRule?this.applyStyleSheetRule(e,i):e.source===H.StyleDeclaration&&this.applyStyleDeclaration(e,i))}applyStyleSheetRule(e,n){var i,s,l,c;if((i=e.adds)==null||i.forEach(({rule:u,index:h})=>{try{if(Array.isArray(h)){let{positions:f,index:p}=cf(h);Pi(n.cssRules,f).insertRule(u,p)}else{let f=h===void 0?void 0:Math.min(h,n.cssRules.length);n?.insertRule(u,f)}}catch{}}),(s=e.removes)==null||s.forEach(({index:u})=>{try{if(Array.isArray(u)){let{positions:h,index:f}=cf(u);Pi(n.cssRules,h).deleteRule(f||0)}else n?.deleteRule(u)}catch{}}),e.replace)try{(l=n.replace)==null||l.call(n,e.replace)}catch{}if(e.replaceSync)try{(c=n.replaceSync)==null||c.call(n,e.replaceSync)}catch{}}applyStyleDeclaration(e,n){e.set&&Pi(n.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&Pi(n.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var n;let i=this.mirror.getNode(e.id);if(!i)return;(n=e.styles)==null||n.forEach(u=>{var h;let f=null,p=null;if(lr(i)?p=((h=i.ownerDocument)==null?void 0:h.defaultView)||null:i.nodeName==="#document"&&(p=i.defaultView),!!p)try{f=new p.CSSStyleSheet,this.styleMirror.add(f,u.styleId),this.applyStyleSheetRule({source:H.StyleSheetRule,adds:u.rules},f)}catch{}});let s=10,l=0,c=a((u,h)=>{let f=h.map(p=>this.styleMirror.getStyle(p)).filter(p=>p!==null);lr(u)?u.shadowRoot.adoptedStyleSheets=f:u.nodeName==="#document"&&(u.adoptedStyleSheets=f),f.length!==h.length&&l<s&&(setTimeout(()=>c(u,h),0+100*l),l++)},"adoptStyleSheets");c(i,e.styleIds)}legacy_resolveMissingNode(e,n,i,s){let{previousId:l,nextId:c}=s,u=l&&e[l],h=c&&e[c];if(u){let{node:f,mutation:p}=u;n.insertBefore(f,i),delete e[p.node.id],delete this.legacy_missingNodeRetryMap[p.node.id],(p.previousId||p.nextId)&&this.legacy_resolveMissingNode(e,n,f,p)}if(h){let{node:f,mutation:p}=h;n.insertBefore(f,i.nextSibling),delete e[p.node.id],delete this.legacy_missingNodeRetryMap[p.node.id],(p.previousId||p.nextId)&&this.legacy_resolveMissingNode(e,n,f,p)}}moveAndHover(e,n,i,s,l){let c=this.mirror.getNode(i);if(!c)return this.debugNodeNotFound(l,i);let u=jf(c,this.iframe),h=e*u.absoluteScale+u.x,f=n*u.absoluteScale+u.y;this.mouse.style.left=`${h}px`,this.mouse.style.top=`${f}px`,s||this.drawMouseTail({x:h,y:f}),this.hoverElements(c)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:n,lineWidth:i,strokeStyle:s,duration:l}=this.config.mouseTail===!0?Ql:Object.assign({},Ql,this.config.mouseTail),c=a(()=>{if(!this.mouseTail)return;let u=this.mouseTail.getContext("2d");!u||!this.tailPositions.length||(u.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),u.beginPath(),u.lineWidth=i,u.lineCap=n,u.strokeStyle=s,u.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(h=>u.lineTo(h.x,h.y)),u.stroke())},"draw");this.tailPositions.push(e),c(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(u=>u!==e),c()},l/this.speedService.state.context.timer.speed)}hoverElements(e){var n;(n=this.lastHoveredRootNode||this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(s=>{s.classList.remove(":hover")}),this.lastHoveredRootNode=e.getRootNode();let i=e;for(;i;)i.classList&&i.classList.add(":hover"),i=i.parentElement}isUserInteraction(e){return e.type!==U.IncrementalSnapshot?!1:e.data.source>H.Mutation&&e.data.source<=H.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(Se.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,n){this.warn(`Node with id '${n}' not found. `,e)}warnCanvasMutationFailed(e,n){this.warn("Has error on canvas update",n,"canvas mutation:",e)}debugNodeNotFound(e,n){this.debug(`Node with id '${n}' not found. `,e)}warn(...e){this.config.showWarning&&this.config.logger.warn(Rf,...e)}debug(...e){this.config.showDebug&&this.config.logger.log(Rf,...e)}},{addCustomEvent:tR}=qt,{freezePage:nR}=qt;var Un=class{static{a(this,"EventHandlersBase")}setSessionReplayer(e){}skipEvents(e){}preCastEvent(e){}async preEvent(e){}postEvent(e,n){return n}handleMeta(e,n){}handleViewportResize(e){}handleMutation(e,n){}handleInput(e,n){}handleClick(e,n){}handleDblClick(e,n){}handleMouseDown(e,n){}handleMouseUp(e,n){}handleMouseMove(e,n){}handleFocus(e,n){}handleBlur(e,n){}handleContentEditableInput(e,n){}handleKeyStroke(e,n){}handleURLChange(e,n){}handleNativeDialog(e,n){}handleRecordAssertion(e,n){}};var vm=Rr(_i());var Os=class extends Un{constructor({sessionMirror:n,elementSelector:i}){super();this.numberOfRetries=3;this.currentHref=void 0;this.previousMousePositionsNodeSelectors={};this.hasUndefinedFocusNode=!1;this.lastMouseUpTime=0;this.lastMouseDownExtract=void 0;this.allInteractableElementsMetadata={mouseMove:void 0,mouseDown:void 0};this.currentEventIndex=-1;this.enableRecordingAvailableInteractableElements=!0;this.useTextInputFastForward=!0;this.getBoundingBox=a(n=>{let i=sr(this.sessionMirror.getNodeById(n),this.appSpecificRules.appSpecificInteractableElementsSelectors);if(i)return i?.getBoundingClientRect()},"getBoundingBox");this.isPointWithinBoundingBox=a((n,i,s)=>n>=s.left&&n<=s.right&&i>=s.top&&i<=s.bottom,"isPointWithinBoundingBox");this.isPointWithinNodeBoundingBox=a((n,i,s)=>{let l=this.getBoundingBox(n);return l?i>=l.left&&i<=l.right&&s>=l.top&&s<=l.bottom:!1},"isPointWithinNodeBoundingBox");this.elementSelector=i,this.sessionMirror=n}static{a(this,"SessionDigesterEventHandlers")}setEvents(n){this.events=n}setConfiguration({enableRecordingAvailableInteractableElements:n,useTextInputFastForward:i=!0}){this.enableRecordingAvailableInteractableElements=n,this.useTextInputFastForward=i}setAppRules(n){this.appSpecificRules=n}skipEvents(n){this.currentEventIndex+=n.length}async preEvent(n){++this.currentEventIndex}async postEvent(n,i){return i&&(!i.availableInteractableElementsAtStart&&this.enableRecordingAvailableInteractableElements&&n.type===U.IncrementalSnapshot&&(n.data.source===H.MouseInteraction||n.data.source===H.Input||n.data.source===H.MediaInteraction)&&(i.availableInteractableElementsAtStart=await this.getInteractableElementsMetadata()),i)}handleMeta(n){if(n.href!==this.currentHref)return this.currentHref=n.href,{eventCode:"navigation",url:n.href}}getNextUserTriggeredInputEvent(n){for(let i=this.currentEventIndex+1;i<this.events.length;++i){let s=this.events[i];if(s.type===U.IncrementalSnapshot&&s.data.source===H.Input&&s.data.userTriggered)return s;if(s.timestamp>n)return}}async handleInput(n,i){if(!n.userTriggered)return;let s=await this.getNodeById(n.id),l=this.getInputEventCode(s,n);if(l==="input"&&this.useTextInputFastForward){this.textInputFastForwardInitialSelector||(this.textInputFastForwardInitialSelector=await this.elementSelector.getSelector(s));let u={eventCode:l,...this.textInputFastForwardInitialSelector};return await a(async()=>{let f=this.getNextUserTriggeredInputEvent(i.timestamp+2e3);if(f){let p=f.data,g=await this.getNodeById(p.id);return g!==s?!1:this.getInputEventCode(g,p)==="input"}return!1},"isNextInputEventForSameNode")()||(this.textInputFastForwardInitialSelector=void 0),u}let c=await this.elementSelector.getSelector(s);return{eventCode:l,...c}}async handleMouseMove(n){if(this.previousMousePositions=n.positions,this.previousMousePositionsNodeSelectors={},this.isLastMouseMoveEventBeforeMouseDownOrUndefinedFocus()){this.previousMousePositionsNodeSelectors={};let i={};for(let s of this.previousMousePositions){let l=s.id;if(i[l])continue;i[l]=!0;let c=await this.getNodeById(l);try{this.previousMousePositionsNodeSelectors[l]=await this.elementSelector.getSelector(c)}catch(u){console.warn("error with extracting selector for node during previousMousePositionsNodeSelectors mapping",c,u)}}this.allInteractableElementsMetadata.mouseMove=await this.getInteractableElementsMetadata()}}isLastMouseMoveEventBeforeMouseDownOrUndefinedFocus(){for(let n=this.currentEventIndex+1;n<this.events.length;++n){let i=this.events[n];if(i.type===U.IncrementalSnapshot)switch(i.data.source){case H.MouseMove:return!1;case H.MouseInteraction:switch(i.data.type){case ie.Click:case ie.MouseDown:return!0;case ie.Focus:return i.data.id===-1}}}return!1}async handleMouseDown(n){let i=await this.getNodeById(n.id);try{this.lastMouseDownExtract={node:i,selector:await this.elementSelector.getSelector(i)},this.allInteractableElementsMetadata.mouseDown=await this.getInteractableElementsMetadata()}catch(s){console.warn("error with extracting selector for node during handleMouseDown",i,s)}this.previousMouseDownData=n}async handleMouseUp(n,i){this.lastMouseUpTime=i.timestamp}isLastMouseDownValidForClick(n){return!!this.lastMouseDownExtract&&n-this.lastMouseUpTime<10}invalidateLastMouseDown(){this.lastMouseUpTime=0,this.lastMouseDownExtract=void 0,this.allInteractableElementsMetadata.mouseDown=void 0}async handleFocus(n){this.hasUndefinedFocusNode=n.id===-1}async handleClick(n,i){if(n.x===void 0||n.y===void 0)return;let s=this.isLastMouseDownValidForClick(i.timestamp),c=await a(async()=>{if(s)return{...this.lastMouseDownExtract.selector,playwrightSelectorForSnapshot:(await this.elementSelector.getSelector(this.lastMouseDownExtract.node,{extractEsraMetadata:!1}))?.playwrightSelector,availableInteractableElementsAtStart:this.allInteractableElementsMetadata.mouseDown};let u=this.getNodeIdForClick(n,i),h=await this.getNodeById(u);return this.previousMousePositionsNodeSelectors[u]?{...this.previousMousePositionsNodeSelectors[u],playwrightSelectorForSnapshot:(await this.elementSelector.getSelector(h,{extractEsraMetadata:!1}))?.playwrightSelector,availableInteractableElementsAtStart:this.allInteractableElementsMetadata.mouseMove}:this.elementSelector.getSelector(h)},"getSelector")();return this.invalidateLastMouseDown(),{eventCode:"click",...c}}getNextMouseMoveEvent(){for(let n=this.currentEventIndex+1;n<this.events.length;++n){let i=this.events[n];if(i.type===U.IncrementalSnapshot&&i.data.source===H.MouseMove)return i}}getNodeIdForClick(n,i){if(this.hasUndefinedFocusNode&&this.previousMouseDownData&&this.previousMouseDownData.id!==n.id){let s=a(()=>{let g=this.getNextMouseMoveEvent();if(g){let S=[...g.data.positions].reverse().find(w=>g.timestamp+w.timeOffset<i.timestamp);if(S)return S.id}},"findByNextMousePosition"),l=a(()=>{if(this.previousMousePositions){let g=[...this.previousMousePositions].reverse().find(y=>!0);if(g)return g.id}},"findByPreviousMousePosition"),c=a(()=>{try{let g=this.sessionMirror.getNodeById(n.id),y=Array.from(On(g)).filter(w=>window.getComputedStyle(w).pointerEvents==="none"),S=[];if(y.length){y.forEach(M=>{let T=M,C=T.getAttribute("style");S.push(C),T.setAttribute("style",C+";pointer-events:auto !important")});let w=document.querySelector("iframe").contentDocument.elementFromPoint(n.x,n.y);if(y.forEach((M,T)=>{M.setAttribute("style",S[T])}),w){let M=this.sessionMirror.getMeta(w);if(M)return M.id}}}catch(g){console.warn("element from point calc error",g)}},"findByElementFromPoint"),u={next:s(),previous:l(),point:c(),original:n.id},h=u.next||u.previous||n.id,f=a(()=>{if(h===u.point)return!1;let g=this.sessionMirror.getNodeById(h);return this.isPointWithinBoundingBox(n.x,n.y,g.getBoundingClientRect())},"isElementFromPointContainedInCandidate");return u.point&&f()?u.point:h}return n.id}async getNodeById(n,{retriesLeft:i=this.numberOfRetries,useCompoundInteractableDetection:s=!0}={}){if(!i)return console.error("no node"),null;let l=this.sessionMirror.getNodeById(n);return l?s?sr(l,this.appSpecificRules.appSpecificInteractableElementsSelectors):l:(await(0,vm.default)(100*(this.numberOfRetries-i+1)),this.getNodeById(n,{retriesLeft:i-1,useCompoundInteractableDetection:s}))}getInputEventCode(n,i){switch(n.getAttribute("type")){case"checkbox":case"radio":return i.isChecked?"check":"uncheck";case"text":default:return"input"}}async getInteractableElementsMetadata(){if(!this.enableRecordingAvailableInteractableElements)return[];let i=document.querySelector("iframe").contentWindow.document;console.log("Getting all interactable elements...");let s=$t(i,this.appSpecificRules);console.log(`Got ${s.length} interactable elements`),console.log("Extracting ESRA metadata for all interactable elements...");let l=new mt(i),c=await Promise.all(s.map(async u=>({esraMetadata:l.extract(u).toMetadata()})));return console.log("Done processing all interactable elements..."),c}};var ks=class{constructor({eventHandlers:e}){this.filter={only:[],exclude:[]};this.preCastEvent=a(async e=>this.handlers.preCastEvent(e),"preCastEvent");this.processEvent=a(async(e,n=!0)=>{await this.handlers.preEvent(e);let i=n?await this.handleEvent(e):void 0,s=await this.handlers.postEvent(e,i);return this.handlers.controlledReturn?this.handlers.getReturnValue():s},"processEvent");this.skipEvents=a(async e=>this.handlers.skipEvents(e),"skipEvents");this.shouldProcess=a(e=>{let{only:n,exclude:i}=this.filter,s=a(l=>e.type===U.Custom&&e.data.tag==="filter"?!0:l.type!==e.type?!1:e.type===U.Custom?l.tag===e.data.tag:e.type===U.IncrementalSnapshot?e.data.source===l.source:!0,"matchFilter");return!(n.length>0&&!n.some(s)||i.length>0&&i.some(s))},"shouldProcess");this.handlers=e}static{a(this,"EventProcessor")}setHandlers(e){this.handlers=e}async handleEvent(e){if(this.shouldProcess(e))switch(e.type){case U.Meta:return this.handlers.handleMeta(e.data,e);case U.IncrementalSnapshot:switch(e.data.source){case H.ViewportResize:return this.handlers.handleViewportResize(e.data,e);case H.Mutation:return this.handlers.handleMutation(e.data,e);case H.Input:return this.handlers.handleInput(e.data,e);case H.MouseInteraction:return this.handleMouseInteraction(e.data,e);case H.MouseMove:return this.handlers.handleMouseMove(e.data,e);default:break}break;case U.Custom:switch(e.data.tag){case"contenteditable-input":return this.handlers.handleContentEditableInput(e.data.payload,e);case"key-stroke":return this.handlers.handleKeyStroke(e.data.payload,e);case"url-change":return this.handlers.handleURLChange(e.data.payload,e);case"native-dialog-event":return this.handlers.handleNativeDialog(e.data.payload,e);case"assertion":return this.handlers.handleRecordAssertion(e.data.payload,e);case"filter":this.handleFilterEvent(e.data.payload)}break;default:break}}async handleMouseInteraction(e,n){switch(e.type){case ie.Click:return this.handlers.handleClick(e,n);case ie.DblClick:return this.handlers.handleDblClick(e,n);case ie.MouseDown:return this.handlers.handleMouseDown(e,n);case ie.MouseUp:return this.handlers.handleMouseUp(e,n);case ie.Focus:return this.handlers.handleFocus(e,n);case ie.Blur:return this.handlers.handleBlur(e,n);default:break}}handleFilterEvent(e){this.filter.exclude=e.filter.exclude,this.filter.only=e.filter.only}};var Ic=Rr(_i());var Fs=class{constructor(){this._replayingState="Paused";this.listeners=[]}static{a(this,"ReplayerListenersManager")}set replayingState(e){this._replayingState=e,this.notifyListeners()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(n=>n!==e)}async wrapWithLoadingState(e,n="Paused"){return this.replayingState="Processing",new Promise((i,s)=>{requestAnimationFrame(()=>{setTimeout(()=>{e().then(l=>{i(l)}).catch(l=>{s(l)}).finally(()=>{this.replayingState=n})},0)})})}notifyListeners(){this.listeners.forEach(e=>e(this._replayingState))}};var wx={[U.DomContentLoaded]:"DomContentLoaded",[U.Load]:"Load",[U.FullSnapshot]:"FullSnapshot",[U.IncrementalSnapshot]:"IncrementalSnapshot",[U.Meta]:"Meta",[U.Custom]:"Custom",[U.Plugin]:"Plugin"},Mx={[H.Mutation]:"Mutation",[H.MouseMove]:"MouseMove",[H.MouseInteraction]:"MouseInteraction",[H.Scroll]:"Scroll",[H.ViewportResize]:"ViewportResize",[H.Input]:"Input",[H.TouchMove]:"TouchMove",[H.MediaInteraction]:"MediaInteraction",[H.StyleSheetRule]:"StyleSheetRule",[H.CanvasMutation]:"CanvasMutation",[H.Font]:"Font",[H.Log]:"Log",[H.Drag]:"Drag",[H.StyleDeclaration]:"StyleDeclaration"},Tx={[ie.MouseUp]:"MouseUp",[ie.MouseDown]:"MouseDown",[ie.Click]:"Click",[ie.ContextMenu]:"ContextMenu",[ie.DblClick]:"DblClick",[ie.Focus]:"Focus",[ie.Blur]:"Blur",[ie.TouchStart]:"TouchStart",[ie.TouchMove_Departed]:"TouchMove_Departed",[ie.TouchEnd]:"TouchEnd"},Cc=a(t=>({...t,type:wx[t.type],data:{...t.data,source:t.type===U.IncrementalSnapshot?Mx[t.data.source]??t.data.source:t.data.source,type:t.data.source===H.MouseInteraction?Tx[t.data.type]:t.data.type}}),"stringifyEvent"),ur=a((t,{includeBlur:e=!0,includeFocus:n=!0}={})=>{switch(t.type){case U.Meta:return!1;case U.IncrementalSnapshot:switch(t.data.source){case H.Input:return t.data.userTriggered;case H.MouseInteraction:return!(!e&&t.data.type===ie.Blur||!n&&t.data.type===ie.Focus);case H.MouseMove:case H.Drag:case H.Selection:return!0;default:return!1}case U.Custom:switch(t.data.tag){case"contenteditable-input":return!0;default:return!1}default:return!1}},"isActionEvent");var Sm=a(t=>{t.querySelectorAll("a, button, input").forEach(e=>{e.addEventListener("click",n=>n.preventDefault()),e.addEventListener("keydown",n=>n.preventDefault())})},"disableInteractiveElements");var xx=!0,jr=class{constructor(e={}){this.interactionEventsTimestamps=[];this.initialEventsBuffer=[];this.config={enableInteract:!1};this.eventSubscribers={};this.newRRWebSeekMode=!1;this.timer=null;this.animationFrameStepHandler={wait:a(e=>requestAnimationFrame(e),"wait"),cancel:a(e=>cancelAnimationFrame(e),"cancel")};this.timeoutStepHandler={wait:a(e=>setTimeout(e,10),"wait"),cancel:a(e=>clearTimeout(e),"cancel")};this.stop=a(()=>{try{this.replayer&&this.replayer.destroy()}catch(e){console.warn("Error destroying replayer",e)}},"stop");this.getNodeById=a(e=>this.replayer.getMirror().getNode(e),"getNodeById");this.getMeta=a(e=>this.replayer?.getMirror()?.getMeta(e),"getMeta");this.getLastInteractionEventTimestamp=a(e=>this.interactionEventsTimestamps.sort((n,i)=>n-i).reverse().find(n=>n<=e),"getLastInteractionEventTimestamp");this.config={...this.config,...e},this.replayerListenersManager=new Fs,window.addEventListener("message",async n=>{try{let{data:i}=n;i.type==="setNewRRWebSeekMode"&&this.setNewRRWebSeekMode(i.payload)}catch{}})}static{a(this,"SessionReplayer")}makeReplayerConfig(){let e={mouseTail:!1,pauseAnimation:!1,speed:360,triggerFocus:!0,UNSAFE_replayCanvas:!0,liveMode:!0,showDebug:!1,skipInactive:!0};return this.config.root&&(e.root=this.config.root),e}makeReplayer(e=[],{baselineTime:n=Date.now()}={}){if(this.replayer=new Ns(e,this.makeReplayerConfig()),this.config.enableInteract?this.replayer.enableInteract():this.replayer?.disableInteract(),this.config.onlyLive?this.replayer.startLive(n):this.replayer.play(),xx&&this.setupDebugMode(),Object.values(Se).forEach(i=>{this.replayer.on(i,s=>{this.notifySubscribers(i,s)})}),this.disableInteractiveElements(),this.newRRWebSeekMode){let i=this.getReplayerContext().timer;this.timerAddAction=i.addAction.bind(i),i.addAction=s=>(s.delay=0,this.timerAddAction(s))}}isConnected(){return!!this.replayer}subscribeTo(e,n,i){n.forEach(s=>{this.eventSubscribers[s]||(this.eventSubscribers[s]={}),this.eventSubscribers[s][e]=i})}unsubscribeFrom(e){Object.keys(this.eventSubscribers).forEach(n=>{this.eventSubscribers[n][e]&&delete this.eventSubscribers[n][e]})}notifySubscribers(e,n){Object.values(this.eventSubscribers[e]??{}).forEach(i=>{try{i(n)}catch(s){console.error("[notifyEventCastSubscribers] Error in event cast subscriber",s)}})}setNewRRWebSeekMode(e){this.newRRWebSeekMode=e}getFirstEventTimestamp(){return this.replayer.getMetaData().startTime}getLastEventTimestamp(){return this.replayer.getMetaData().endTime}getCurrentTimestamp(){try{return this.replayer.getCurrentTime()+this.getFirstEventTimestamp()}catch{return 0}}getIframeDocument(){return this.replayer.iframe.contentDocument}start(e,n=[]){}async fastForward(e){if(!this.replayer)if(this.config.onlyLive)this.makeReplayer([],{baselineTime:e[0].timestamp});else if(this.initialEventsBuffer.push(...e),this.initialEventsBuffer.length>=2)this.makeReplayer(this.initialEventsBuffer);else return;let n=0,i=new Promise(s=>{this.subscribeTo("fastForward",[Se.EventCast],l=>{n++,n===e.length&&(this.unsubscribeFrom("fastForward"),s())})});for(let s of e)s.type===U.FullSnapshot&&(this.lastSnapshot=s),this.replayer.addEvent(s),ur(s,{includeBlur:!1,includeFocus:!1})&&this.interactionEventsTimestamps.push(s.timestamp);return i}monitorTime(e,n,i=this.animationFrameStepHandler){let s=a(()=>{this.timer&&(i.cancel(this.timer),this.timer=null)},"stopTimer");s();let l=a(()=>{let c=this.replayer.getCurrentTime();if(e&&c>=e){n(),s();return}else console.log(`[SessionReplayer] monitoring time, current: ${c}; target: ${e}...`);let u=this.replayer.getMetaData();c<u.totalTime&&(this.timer=i.wait(l))},"update");this.timer=i.wait(l)}async seek(e,n=!0){return new Promise(i=>{if(this.newRRWebSeekMode)this.subscribeTo("seek",[Se.EventCast],s=>{if(s.timestamp>=e){if(this.unsubscribeFrom("seek"),n){this.replayer.pause(),requestAnimationFrame(()=>{this.getReplayerContext().timer.clear(),i()});return}i()}}),this.replayer.play();else{let s=e-this.getFirstEventTimestamp();this.monitorTime(s,()=>{n&&this.replayer.pause(),i()}),this.replayer.play(s)}})}async goLive(){await this.replayerListenersManager.wrapWithLoadingState(async()=>{await this.seek(this.getLastEventTimestamp(),!1),await(0,Ic.default)(1e3)})}async goBack(e,{sleepAfter:n=100,beforeTimestamp:i=!1,includeAllMatchingTimestamps:s=!1}={}){await this.replayerListenersManager.wrapWithLoadingState(async()=>{await this.seek(e,!0),n&&await(0,Ic.default)(n)})}getReplayerContext(){return this.replayer.service.state.context}setupDebugMode(){window.__chkreplayer={events:a(()=>this.getReplayerContext().events,"events"),stringifyEvents:a(()=>this.getReplayerContext().events.map(Cc),"stringifyEvents"),stringifyActionEvents:a(()=>this.getReplayerContext().events.filter(e=>ur(e)).map(Cc),"stringifyActionEvents"),back:a(e=>this.goBack(e),"back"),live:a(()=>this.goLive(),"live"),currentTime:a(()=>this.replayer.getCurrentTime(),"currentTime"),getReplayer:a(()=>this.replayer,"getReplayer"),getThis:a(()=>this,"getThis")}}disableInteractiveElements(){let e=this.replayer.iframe.contentDocument||this.replayer.iframe.contentWindow.document;new MutationObserver(()=>Sm(e)).observe(e,{childList:!0,subtree:!0})}};var Zr=class{static{a(this,"Streamer")}constructor(e={}){this.sessionReplayer=new jr(e),this.eventProcessor=new ks({eventHandlers:new Un})}setEventHandlers(e){e.setSessionReplayer(this.sessionReplayer),this.eventHandlers=e,this.eventProcessor.setHandlers(this.eventHandlers)}start(e){this.sessionReplayer.start(e)}async handleEvent(e){return await this.eventProcessor.preCastEvent(e),await this.sessionReplayer.fastForward([e]),await this.eventProcessor.processEvent(e)}handleEvents(e){return this.skipEvents(e)}async skipEvents(e){await this.eventProcessor.skipEvents(e),await this.sessionReplayer.fastForward(e)}stop(){this.sessionReplayer.stop()}};var Ps=class extends Zr{constructor(){super({enableInteract:!0});this.elementSelector=new Hr;this.setEventHandlers(new Os({sessionMirror:this.sessionReplayer,elementSelector:this.elementSelector}))}static{a(this,"ChecksumSessionDigester")}setConfiguration({enableRecordingAvailableInteractableElements:n,useTextInputFastForward:i}){this.eventHandlers.setConfiguration({enableRecordingAvailableInteractableElements:n,useTextInputFastForward:i})}setEvents(n){this.eventHandlers.setEvents(n)}setOptions(n){this.elementSelector.setOptions({defaultExtractReducedHtmlAndSelector:n.extractReducedHTML,defaultInspectInteractableElements:n.inspectInteractables,defaultExtractEsraMetadata:n.extractESRAMetadata})}setAppRules(n){this.appSpecificRules=n,this.elementSelector.setAppRules(n),this.eventHandlers.setAppRules(n)}async handleEvent(n){return await super.handleEvent(n)}};var Hs=class{constructor(e){this.attributes={};this.classes={};if(typeof e=="object")for(let n in e)this[n]=e[n];else if(typeof e=="string"){let n=JSON.parse(e);for(let i in n)this[i]=n[i]}}static{a(this,"ESRAElementMetadata")}serialize(){return JSON.stringify(this)}};var Mm=Rr(wm());var Ac=class{constructor(){this.weightsSum=0;this.config={attributes:{qualification:{globalUniquenessThreshold:.99,tagUniquenessThreshold:.99},decisionWeight:this.makeWeight(2/5)},classes:{qualification:{globalUniquenessThreshold:.99,tagUniquenessThreshold:.99},decisionWeight:this.makeWeight(2/5)},tagName:{decisionWeight:this.makeWeight(3/5)},style:{inlineWeight:.6,computedWeight:.4,decisionWeight:this.makeWeight(2/5)},innerText:{decisionWeight:this.makeWeight(3/5),qualification:{exactMatchMax:20,containsMatchMax:10,maxLength:256,minLength:1},ignoreSimilarityScoreBelow:.6},innerFeatures:{decisionWeight:this.makeWeight(4/5)},visualVicinity:{decisionWeight:this.makeWeight(1/5)},structuralVicinity:{decisionWeight:this.makeWeight(1/5)}}}static{a(this,"ESRASimilarityConfigClass")}makeWeight(e){return this.weightsSum+=e,e}get(){return this.config}weight(e){return e/this.weightsSum}},He=new Ac;var Vs=class{constructor(e){this.qualifiedAttributes=[];this.qualifiedAttributesMap={};this.qualifiedClasses=[];this.unqualifiedClasses=[];this.qualifiedInnerText=void 0;this.visualVicinityComparable=[];this.structuralVicinityComparable=[];this.innerFeaturesComparable=[];this.rank=a(e=>{if(this.isDealBreaker(e))return{score:0,scores:{}};let n=this.tagSimilarity(e),i=this.attributesSimilarity(e),s=this.classSimilarity(e),l=this.styleSimilarity(e),c=this.innerTextSimilarity(e),u=this.innerFeaturesSimilarity(e),h=this.visualVicinitySimilarity(e),f=this.structuralVicinitySimilarity(e),p=this.svgsSimilarity(e),g={tagScore:n,attributesScore:i,classesScore:s,styleScore:l,innerTextScore:c,innerFeaturesScore:u,visualVicinityScore:h,structuralVicinityScore:f,svgsScore:p},y={tagScore:He.weight(He.get().tagName.decisionWeight)*n,attributesScore:He.weight(He.get().attributes.decisionWeight)*i,classesScore:He.weight(He.get().classes.decisionWeight)*s,innerTextScore:He.weight(He.get().innerText.decisionWeight)*c,innerFeaturesScore:He.weight(He.get().innerFeatures.decisionWeight)*u,styleScore:He.weight(He.get().style.decisionWeight)*l,visualVicinityScore:He.weight(He.get().visualVicinity.decisionWeight)*h,structuralVicinityScore:He.weight(He.get().structuralVicinity.decisionWeight)*f};return{score:Object.values(y).reduce((w,M)=>w+M,0),scores:g}},"rank");this.targetElementESRAMetadata=e,this.setQualifiedAttributes(),this.setQualifiedClasses(),this.setQualifiedInnerText(),this.setVisualVicinityComparable(),this.setStructuralVicinityComparable(),this.setInnerFeaturesComparable()}static{a(this,"ESRASimilarity")}getQualifiedAttributes(){return this.qualifiedAttributes}getQualifiedClasses(){return this.qualifiedClasses}getQualifiedInnerText(){return this.qualifiedInnerText}setQualifiedAttributes(){let e=this.targetElementESRAMetadata.attributes,{qualifiedAttributes:n,qualifiedAttributesMap:i}=this.makeQualifiedAttributes(e);this.qualifiedAttributes=n,this.qualifiedAttributesMap=i}makeQualifiedAttributes(e,n){let i=Object.keys(e).filter(l=>{switch(n){case"input":if(l==="value")return!1;break}let c=e[l];for(let u in c)u.endsWith("Uniqenuess")&&(c[u.replace("Uniqenuess","Uniqueness")]=c[u]);return c.globalUniqueness>He.get().attributes.qualification.globalUniquenessThreshold||c.tagUniqueness>He.get().attributes.qualification.tagUniquenessThreshold}),s=i.reduce((l,c)=>(l[c]=e[c].value,l),{});return{qualifiedAttributes:i,qualifiedAttributesMap:s}}setQualifiedClasses(){this.qualifiedClasses=this.makeQualifiedClasses(this.targetElementESRAMetadata.classes),this.unqualifiedClasses=Object.keys(this.targetElementESRAMetadata.classes).filter(e=>!this.qualifiedClasses.includes(e))}isValidClass(e){return/^[A-Za-z_-][0-9A-Za-z_-]*$/.test(e)}makeQualifiedClasses(e){return Object.keys(e).filter(n=>{let i=e[n];return!this.isValidClass(n)||n.startsWith("jss")||n.startsWith("css-")||n===":hover"?!1:i.globalUniqueness>He.get().classes.qualification.globalUniquenessThreshold||i.tagUniqueness>He.get().classes.qualification.tagUniquenessThreshold})}setQualifiedInnerText(){this.qualifiedInnerText=this.makeQualifiedInnerText(this.targetElementESRAMetadata.innerText)}makeQualifiedInnerText(e){return e&&e.content?.length<=He.get().innerText.qualification.maxLength&&e.content?.length>=He.get().innerText.qualification.minLength?e:null}makeBasicElementPropertiesComparable(e){return e.reduce((n,i)=>{let s=i.position?`${i.tag}.${i.position.slice(0,2).join(",")}`:i.tag,l=`${s}+${i.relativePosition}`,c=this.makeQualifiedClasses(i.classes).map(p=>`${s}.${p}`),u=[];this.makeQualifiedAttributes(i.attributes).qualifiedAttributes.forEach(p=>{u.push(`${s}[${p}]`),u.push(`${s}[${p}]=${i.attributes[p].value}`)});let h=i.feature?this.makeInnerFeaturesComparable([i.feature],{customTag:s,includeTag:!1,featureTypeWhiteList:[6]}):[],f=[...n,s,l,...c,...u,...h];return i.text&&(f.push(`${s}<>`),f.push(`${s}<${i.text}>`)),i.distance&&(f.push(`${s}->${i.distance}`),f.push(`${s}->[]${this.getDistanceRange(i.distance)}`)),f},[])}getDistanceRange(e){let n=[10,20,30,40,50,60,70,80,90,100];for(let i of n)if(e<i)return i;return n[n.length-1]}setVisualVicinityComparable(){this.visualVicinityComparable=this.makeVisualVicinityComparable(this.targetElementESRAMetadata.visualVicinity)}makeVisualVicinityComparable(e){return this.makeBasicElementPropertiesComparable(e)}setStructuralVicinityComparable(){this.structuralVicinityComparable=this.makeStructuralVicinityComparable(this.targetElementESRAMetadata.structuralVicinity)}makeStructuralVicinityComparable(e){return this.makeBasicElementPropertiesComparable(e)}makeInnerFeaturesComparable(e,{customTag:n=void 0,includeTag:i=!0,featureTypeWhiteList:s=void 0}={}){return e.reduce((l,c)=>{if(s&&!s.includes(c.type)||c.isHidden)return l;let u=n??c.tag,h=i?[...l,u]:l;switch(c.type){case 3:h.push(`${u}[type=${c.buttonType}]`);break;case 4:c.inputType&&h.push(`${u}[type=${c.inputType}]`),c.placeholder&&h.push(`${u}[placeholder=${c.placeholder}]`);break;case 6:c.components.forEach(f=>{let p=[];for(let g in f.attributes)p.push(`[${g}=${f.attributes[g]}]`);h.push(`${u}${p.join("")}`)});break}return"text"in c&&c.text&&(h.push(`${u}<>`),h.push(`${u}<${c.text}>`)),h},[])}setInnerFeaturesComparable(){this.innerFeaturesComparable=this.makeInnerFeaturesComparable(this.targetElementESRAMetadata.innerFeatures)}isDealBreaker(e){if(this.targetElementESRAMetadata.tag==="input"&&e.tag==="input"){let n=a(l=>l.type?l.type.value:"text","getType"),i=n(this.targetElementESRAMetadata.attributes),s=n(e.attributes);if(i!==s)return!0}return!1}tagSimilarity(e){return e.tag===this.targetElementESRAMetadata.tag?1:0}attributesSimilarity(e){let n=a(s=>[...this.keyValueObjectToArray(s),...Object.keys(s)],"makeJaccardParam"),{qualifiedAttributesMap:i}=this.makeQualifiedAttributes(e.attributes);return this.jaccard(n(this.qualifiedAttributesMap),n(i))}indicativeAttributesSimilarity(e){return this.qualifiedAttributesMap.placehoder&&e.attributes.placehoder&&this.qualifiedAttributesMap.placehoder===e.attributes.placehoder.value?1:0}classSimilarity(e){return this.jaccard(this.qualifiedClasses,this.makeQualifiedClasses(e.classes))}innerTextSimilarity(e){if(!this.targetElementESRAMetadata.innerText&&!e.innerText)return 1;let n=this.makeQualifiedInnerText(e.innerText);if(!this.qualifiedInnerText||!n)return 0;if(this.qualifiedInnerText.content===n.content)return 1;Object.values({email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,url:/^(http|https):\/\/[^ "]+$/}).forEach(l=>{if(l.test(this.qualifiedInnerText.content)&&l.test(n.content))return .5});try{return new Date(this.qualifiedInnerText.content),new Date(n.content),.5}catch{}let s=a(l=>l.replace(/\d/g,"d").replace(/[a-zA-Z]/g,"s"),"template");return s(this.qualifiedInnerText.content)===s(n.content)?.5:0}innerFeaturesSimilarity(e){return this.jaccard(this.innerFeaturesComparable,this.makeInnerFeaturesComparable(e.innerFeatures))}visualVicinitySimilarity(e){return this.jaccard(this.visualVicinityComparable,this.makeVisualVicinityComparable(e.visualVicinity))}structuralVicinitySimilarity(e){return this.jaccard(this.structuralVicinityComparable,this.makeStructuralVicinityComparable(e.structuralVicinity))}styleSimilarity(e){let n=a(l=>[...this.keyValueObjectToArray(l),...Object.keys(l)],"makeJaccardParam"),i=this.jaccard(n(this.targetElementESRAMetadata.style.inline??{}),n(e.style.inline??{})),s=this.jaccard(n(this.targetElementESRAMetadata.style.computed??{}),n(e.style.computed??{}));return i*He.get().style.inlineWeight+s*He.get().style.computedWeight}svgsSimilarity(e){return!this.targetElementESRAMetadata.svgs&&!e.svgs||this.targetElementESRAMetadata.svgs&&e.svgs&&JSON.stringify(this.targetElementESRAMetadata.svgs)===JSON.stringify(e.svgs)?1:0}keyValueObjectToArray(e,n="=",i=void 0){let s=a(l=>i?i(e,l):e[l],"getValue");return Object.keys(e).map(l=>`${l}${n}${s(l)}`)}jaccard(e,n){return Array.isArray(e)&&Array.isArray(n)&&!e.length&&!n.length?1:(0,Mm.jaccard)(e,n)}};var $n=class extends Error{static{a(this,"TimeoutError")}constructor(){super("Timeout")}};var hr=class t{constructor(e,n){this.POSITIONING_SATISFACTORY_SCORE=1;this.targetElementStaticData={};this.qualifiedAttributes=[];this.qualifiedAttributesMap={};this.qualifiedClasses=[];this.candidateQueries=[];this.candidates=[];this.uniqueCandidates=[];this.queryCandidates=[];this.interactableCandidates=[];this.rankedCandidates=[];this.filteredAndSortedRankedCandidates=[];this.finalCandidates=[];this.weightsSum=0;this.config={innerText:{dropIfMoreThanNCandidates:5},innerFeatures:{mandatoryPercentage:.6,mandatoryMax:6},results:{scorePercentile:.75,epsilon:.01}};this.getSelectionResultForCandidate=a(e=>{let n=wt.getInstance("getElementSelectionResult",{log:!1}),i=n.get();if(i||(i=new Map,n.set(i)),i.has(e))return i.get(e);this.checkTimeout();let s=this.extractMetadata(e),{score:l,scores:c}=this.similarity.rank(s),u={score:l,candidate:e,scores:c,esraMetadata:s};return i.set(e,u),n.set(i),u},"getSelectionResultForCandidate");this.targetElementESRAMetadata=e,this.targetElementStaticData=n||e.staticMetadata,this.similarity=new Vs(this.targetElementESRAMetadata),this.esraMetadataExtractor=new mt(document)}static{a(this,"ESRASelector")}makeWeight(e){return this.weightsSum+=e,e}getWeight(e){return e/this.weightsSum}extractMetadata(e){return new Hs(this.esraMetadataExtractor.extract(e).toMetadata())}getLastSelectionLogs(e=5){if(!this.candidates?.length)return{};let n=new XMLSerializer,i=a((c,u=50)=>c.slice(0,u).map(h=>({score:h.score,metadata:h.metadata,element:n.serializeToString(h.candidate).substring(0,200)})),"printCandidates"),s=this.rankedCandidates[Math.min(this.rankedCandidates.length-1,e)].score,l=a(c=>i(c,e).filter(u=>u.score>=s),"filterByScore");return{candidatesQuery:this.candidateQueries.filter(c=>!!c.length).join(","),totalUniqueCandidates:this.uniqueCandidates.length,topRankingCandidates:i(this.rankedCandidates,e),topRemovedCandidates:{hidden:l(this.removedCandidates.hidden),staticData:l(this.removedCandidates.static)}}}selectByPositioning(){let e=this.targetElementESRAMetadata.positioning;if(window.innerWidth!==e.viewport.size.width||window.innerHeight!==e.viewport.size.height)return;let n=document.elementFromPoint(e.viewport.element.left*window.innerWidth,e.viewport.element.top*window.innerHeight),i=this.extractMetadata(n),{score:s}=this.similarity.rank(i);return s>=this.POSITIONING_SATISFACTORY_SCORE?{candidate:n,score:s,esraMetadata:i}:void 0}collectCandidates(){this.setQualifiedAttributesQueries(),this.setQualifiedClassesQueries(),this.setInnerFeaturesQueries(),this.candidates=[];let e=this.candidateQueries.filter(n=>!!n.length).join(",");this.queryCandidates=[],e.length&&(this.queryCandidates=pe(e)),this.interactableCandidates=[],this.elementsFiltering!==0&&(this.interactableCandidates=$t())}select(){console.log("selecting elements, filtering: ",Ii[this.elementsFiltering]);let e=a(l=>{switch(l){case 0:return this.queryCandidates;case 1:return this.intersectElements(this.queryCandidates,this.interactableCandidates);case 2:return this.interactableCandidates;case 3:return this.queryCandidates.concat(this.interactableCandidates)}},"filterElements");for(;this.candidates=e(this.elementsFiltering),!(this.candidates.length||this.elementsFiltering===3);)console.log(`no candidates found, expanding selection to ${Ii[this.elementsFiltering+1]}`),this.elementsFiltering++;console.log("# of query/interactable/total candidates:",this.queryCandidates.length,this.interactableCandidates.length,this.candidates.length),this.candidates.push(...this.getInnerTextCandidates()),this.candidates.length||this.candidates.push(...this.getTagCandidates()),this.uniqueCandidates=this.candidates.filter((l,c,u)=>u.indexOf(l)===c);let n=t.limitChildren;n?.length&&(n=n.map(l=>({...l,parent:document.querySelector(l.selector)})),this.uniqueCandidates=this.uniqueCandidates.filter(l=>{for(var c of n)if(c.parent&&this.isDescendant(c.parent,l)&&c.limit--<=0)return!1;return!0})),this.checkTimeout(),this.rankedCandidates=this.uniqueCandidates.filter(l=>l instanceof Dr(l).HTMLElement||l instanceof Dr(l).SVGElement).map(this.getSelectionResultForCandidate).sort((l,c)=>c.score-l.score),this.removedCandidates={hidden:[],static:[]},this.filteredAndSortedRankedCandidates=this.rankedCandidates.filter(l=>{let{isHidden:c,clickOffset:u}=this.isHidden(l.candidate);return c===!0?(this.removedCandidates.hidden.push(l),!1):(u&&(l.clickOffset=u),ts(this.targetElementStaticData)&&!kh(this.formatStaticCandidates(l.esraMetadata.staticCandidates),this.targetElementStaticData)?(l.metadata=JSON.stringify(l.esraMetadata.staticCandidates),this.removedCandidates.static.push(l),!1):!0)}),this.checkTimeout(),this.removedCandidates.hidden.slice().reverse().forEach((l,c,u)=>{l.candidate.tagName==="INPUT"&&this.filteredAndSortedRankedCandidates.find(h=>h.score>.1&&h.candidate.contains(l.candidate))&&(this.removedCandidates.hidden.splice(u.length-1-c,1),this.filteredAndSortedRankedCandidates.push(l))}),this.filteredAndSortedRankedCandidates=this.filteredAndSortedRankedCandidates.sort((l,c)=>c.score-l.score);let i=this.filteredAndSortedRankedCandidates.length*(1-this.config.results.scorePercentile);this.finalCandidates=[];let s=null;for(let l=0;l<this.filteredAndSortedRankedCandidates.length;++l){let c=this.filteredAndSortedRankedCandidates[l];if(l>=i&&(!s||s.score-c.score>this.config.results.epsilon))break;s=c,this.finalCandidates.push(c)}return this.finalCandidates}intersectElements(e,n){let i=a((u,{useElementSize:h=!1}={})=>{let f=new Set;return u.forEach(p=>{let g=2,y=p;for(;y&&g-- >0&&(f.add(y),!(h&&Math.abs(y.parentElement.clientWidth-y.clientWidth)>y.clientWidth*.3&&Math.abs(y.parentElement.clientHeight-y.clientHeight)>y.clientHeight*.3));)y=y.parentElement}),f},"normalize"),s=i(e),l=i(n),c=new Set;return s.forEach(u=>{l.has(u)&&c.add(u)}),Array.from(c)}checkTimeout(){if(t.timeout&&Date.now()-this.processStartTime>t.timeout)throw new $n}selectOne({elementsFiltering:e=1,minSelectionScore:n=.3}={}){try{if(this.elementsFiltering=e,this.processStartTime=Date.now(),this.targetElementESRAMetadata.tag==="html"){let s=document.querySelector("html");return{candidate:s,score:1,esraMetadata:this.extractMetadata(s)}}let i=this.selectByPositioning();if(i)return console.log("Found element by positioning"),i;for(this.collectCandidates();;){let s=this.select();if(!s.length)break;let{score:l}=s[0];if(l<n&&this.elementsFiltering!==3){this.elementsFiltering++,console.log(`Best matching element is below threshold (${l}/${n}), expanding selection to ${Ii[this.elementsFiltering]}`);continue}return s[0]}}catch(i){i instanceof $n?console.error("ESRA selection timeout"):console.error("ESRA selection error",i)}return{candidate:void 0,score:0,esraMetadata:void 0}}getFinalCandidates(){return this.finalCandidates}setQualifiedAttributesQueries(){this.candidateQueries.push(this.similarity.getQualifiedAttributes().map(e=>`[${e}="${this.targetElementESRAMetadata.attributes[e].value}"]`).join(","))}setQualifiedClassesQueries(e=[]){this.candidateQueries.push(this.similarity.getQualifiedClasses().map(n=>`.${n}`).join(","))}setInnerFeaturesQueries(){let e=Fh(this.targetElementESRAMetadata.innerFeatures,this.config).map(n=>`*${n}`);this.candidateQueries.push(...e)}getInnerTextCandidates(){let e=this.similarity.getQualifiedInnerText();if(!e)return[];let n=Hh(e.content);return n.length>this.config.innerText.dropIfMoreThanNCandidates?[]:n}getTagCandidates(){return pe(this.targetElementESRAMetadata.tag)}isDescendant(e,n){return e.contains(n)}formatStaticCandidates(e){let n={};return Object.keys(e).forEach(i=>{n[i]=e[i]}),n}isHidden(e){return ut(e,{useCache:!0})}};var Tm=a(t=>{let e=a(l=>l&&(l instanceof HTMLInputElement&&/|text|email|number|password|search|tel|url/.test(l.type||"")||l instanceof HTMLTextAreaElement)?!(l.disabled||l.readOnly):!1,"isEditableInputOrTextArea"),n=a((l,c)=>{t({key:l,eventTarget:c})},"sendKeyEvent"),i=a(l=>(l.ctrlKey?"ctrl ":"")+(l.altKey?"alt ":"")+(l.shiftKey?"shift ":"")+(l.metaKey?"meta ":"")+l.key,"formatKeyProperties"),s=a(l=>{try{if(e(l.target))return;n(i(l),l.target)}catch{}},"onKeyUp");window.addEventListener("keyup",l=>{s(l)})},"startKeyboardObserver");var Bs=class t{constructor(e=document,n){this.target=e;this.onEvent=n;this.monitoredTextElements=[];this.inputEnabledSelectors=["[contenteditable=true]"].join(",");this.iframeObservers=[];this.monitorInputEnabledElement=a(e=>{e.addEventListener("input",n=>{this.onEvent({text:n.target?.innerText,eventTarget:n.target})})},"monitorInputEnabledElement")}static{a(this,"ContendEditableObserver")}startObserver(){this.startIframesObserver(),this.observer=new MutationObserver(e=>{e.forEach(n=>{n.addedNodes.forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE&&i.nodeType===Node.ELEMENT_NODE){let s=i;s.matches(this.inputEnabledSelectors)||s.isContentEditable?this.monitorInputEnabledElement(s):Array.from(pe("*",s)).filter(l=>l.matches&&l.matches(this.inputEnabledSelectors)||l.isContentEditable).forEach(this.monitorInputEnabledElement)}})})}),this.observer.observe(this.target,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.startInputMonitoring()}startIframesObserver(){setInterval(()=>{pe("iframe",this.target).forEach(n=>{if(this.iframeObservers.find(c=>c.iframe===n))return;let i=a(c=>{if(c.iframe.contentWindow)try{c.observer=new t(c.iframe.contentWindow.document,this.onEvent),c.observer.startObserver()}catch{}},"observeIframe"),s=n,l={iframe:s,observer:null};this.iframeObservers.push(l),s.contentWindow?i(l):s.addEventListener("load",()=>{i(l)})})},500)}startInputMonitoring(){this.monitoredTextElements=pe(this.inputEnabledSelectors,this.target),this.monitoredTextElements.forEach(this.monitorInputEnabledElement)}};var Gs=class{constructor(e){this.onEvent=e;this.onURLChange=a(()=>{setTimeout(()=>{let e=window.location.href;if(e!==this.currentURL){this.currentURL=e;try{this.onEvent({url:e})}catch{}}})},"onURLChange")}static{a(this,"URLObserver")}start(){window.addEventListener("popstate",i=>{this.onURLChange()}),window.addEventListener("locationchange",i=>{this.onURLChange()}),window.addEventListener("hashchange",i=>{this.onURLChange()});let e=window.history.pushState;window.history.pushState=(...i)=>(this.onURLChange(),e.apply(window.history,i));let n=window.history.replaceState;window.history.replaceState=(...i)=>(this.onURLChange(),n.apply(window.history,i))}};var zn={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")},Z1={defaultMerge:zn.defaultMerge};function Cx(t,e){return e}a(Cx,"defaultMetaDataUpdater");function Ix(t,e){return t.filter(n=>n!==void 0)}a(Ix,"defaultFilterValues");var xm;(function(t){t[t.NOT=0]="NOT",t[t.RECORD=1]="RECORD",t[t.ARRAY=2]="ARRAY",t[t.SET=3]="SET",t[t.MAP=4]="MAP",t[t.OTHER=5]="OTHER"})(xm||(xm={}));function Cm(t){return typeof t!="object"||t===null?0:Array.isArray(t)?2:Lx(t)?1:t instanceof Set?3:t instanceof Map?4:5}a(Cm,"getObjectType");function Ax(t){let e=new Set;for(let n of t)for(let i of[...Object.keys(n),...Object.getOwnPropertySymbols(n)])e.add(i);return e}a(Ax,"getKeys");function Rx(t,e){return typeof t=="object"&&Object.prototype.propertyIsEnumerable.call(t,e)}a(Rx,"objectHasProperty");function Am(t){let e=0,n=t[0]?.[Symbol.iterator]();return{[Symbol.iterator](){return{next(){do{if(n===void 0)return{done:!0,value:void 0};let i=n.next();if(i.done===!0){e+=1,n=t[e]?.[Symbol.iterator]();continue}return{done:!1,value:i.value}}while(!0)}}}}}a(Am,"getIterableOfIterables");var Im=["[object Object]","[object Module]"];function Lx(t){if(!Im.includes(Object.prototype.toString.call(t)))return!1;let{constructor:e}=t;if(e===void 0)return!0;let n=e.prototype;return!(n===null||typeof n!="object"||!Im.includes(Object.prototype.toString.call(n))||!n.hasOwnProperty("isPrototypeOf"))}a(Lx,"isRecord");function Nx(t,e,n){let i={};for(let s of Ax(t)){let l=[];for(let h of t)Rx(h,s)&&l.push(h[s]);if(l.length===0)continue;let c=e.metaDataUpdater(n,{key:s,parents:t}),u=Lm(l,e,c);u!==zn.skip&&(s==="__proto__"?Object.defineProperty(i,s,{value:u,configurable:!0,enumerable:!0,writable:!0}):i[s]=u)}return i}a(Nx,"mergeRecords$1");function Dx(t){return t.flat()}a(Dx,"mergeArrays$1");function _x(t){return new Set(Am(t))}a(_x,"mergeSets$1");function Ox(t){return new Map(Am(t))}a(Ox,"mergeMaps$1");function kx(t){return t.at(-1)}a(kx,"mergeOthers$1");var Us={mergeRecords:Nx,mergeArrays:Dx,mergeSets:_x,mergeMaps:Ox,mergeOthers:kx};function Rm(...t){return Fx({})(...t)}a(Rm,"deepmerge");function Fx(t,e){let n=Px(t,i);function i(...s){return Lm(s,n,e)}return a(i,"customizedDeepmerge"),i}a(Fx,"deepmergeCustom");function Px(t,e){return{defaultMergeFunctions:Us,mergeFunctions:{...Us,...Object.fromEntries(Object.entries(t).filter(([n,i])=>Object.hasOwn(Us,n)).map(([n,i])=>i===!1?[n,Us.mergeOthers]:[n,i]))},metaDataUpdater:t.metaDataUpdater??Cx,deepmerge:e,useImplicitDefaultMerging:t.enableImplicitDefaultMerging??!1,filterValues:t.filterValues===!1?void 0:t.filterValues??Ix,actions:zn}}a(Px,"getUtils");function Lm(t,e,n){let i=e.filterValues?.(t,n)??t;if(i.length===0)return;if(i.length===1)return Rc(i,e,n);let s=Cm(i[0]);if(s!==0&&s!==5){for(let l=1;l<i.length;l++)if(Cm(i[l])!==s)return Rc(i,e,n)}switch(s){case 1:return Hx(i,e,n);case 2:return Wx(i,e,n);case 3:return Vx(i,e,n);case 4:return Bx(i,e,n);default:return Rc(i,e,n)}}a(Lm,"mergeUnknowns");function Hx(t,e,n){let i=e.mergeFunctions.mergeRecords(t,e,n);return i===zn.defaultMerge||e.useImplicitDefaultMerging&&i===void 0&&e.mergeFunctions.mergeRecords!==e.defaultMergeFunctions.mergeRecords?e.defaultMergeFunctions.mergeRecords(t,e,n):i}a(Hx,"mergeRecords");function Wx(t,e,n){let i=e.mergeFunctions.mergeArrays(t,e,n);return i===zn.defaultMerge||e.useImplicitDefaultMerging&&i===void 0&&e.mergeFunctions.mergeArrays!==e.defaultMergeFunctions.mergeArrays?e.defaultMergeFunctions.mergeArrays(t):i}a(Wx,"mergeArrays");function Vx(t,e,n){let i=e.mergeFunctions.mergeSets(t,e,n);return i===zn.defaultMerge||e.useImplicitDefaultMerging&&i===void 0&&e.mergeFunctions.mergeSets!==e.defaultMergeFunctions.mergeSets?e.defaultMergeFunctions.mergeSets(t):i}a(Vx,"mergeSets");function Bx(t,e,n){let i=e.mergeFunctions.mergeMaps(t,e,n);return i===zn.defaultMerge||e.useImplicitDefaultMerging&&i===void 0&&e.mergeFunctions.mergeMaps!==e.defaultMergeFunctions.mergeMaps?e.defaultMergeFunctions.mergeMaps(t):i}a(Bx,"mergeMaps");function Rc(t,e,n){let i=e.mergeFunctions.mergeOthers(t,e,n);return i===zn.defaultMerge||e.useImplicitDefaultMerging&&i===void 0&&e.mergeFunctions.mergeOthers!==e.defaultMergeFunctions.mergeOthers?e.defaultMergeFunctions.mergeOthers(t):i}a(Rc,"mergeOthers");var Gx={sampling:{mousemove:!1},userTriggeredOnInput:!0,maskInputOptions:{password:!1}},$s=class{constructor(e,n={}){this.eventHandler=e;this.options=n;this.logNativeMutationObserver=!1;this.stopRRWebRecording=a(()=>{},"stopRRWebRecording");this.start=a(()=>{console.log("starting with options",this.options),this.stopRRWebRecording=qt({...this.options,emit:this.eventHandler}),this.logNativeMutationObserver&&this.selfObserve(),this.startURLObserver(),this.startKeyboardObserver(),this.startContentEditableObserver()},"start");this.stop=a(()=>{this.stopRRWebRecording()},"stop");this.startURLObserver=a(()=>{this.urlObserver=new Gs(({url:e})=>{let n={url:e};this.addCustomEvent("url-change",n)}),this.urlObserver.start()},"startURLObserver");this.startContentEditableObserver=a(()=>{this.contentEditableObserver=new Bs(document,({text:e,eventTarget:n})=>{let i={text:e,id:this.tryGetMetaFromEventTarget(n)?.id};this.addCustomEvent("contenteditable-input",i)}),this.contentEditableObserver.startObserver()},"startContentEditableObserver");this.startKeyboardObserver=a(()=>{Tm(({key:e,eventTarget:n})=>{let i={key:e,id:this.tryGetMetaFromEventTarget(n)?.id};this.addCustomEvent("key-stroke",i)})},"startKeyboardObserver");this.addCustomEvent=a((e,n)=>{qt.addCustomEvent(e,n)},"addCustomEvent");this.tryGetMetaFromEventTarget=a(e=>{try{return this.getMeta(e)}catch{}},"tryGetMetaFromEventTarget");this.selfObserve=a(()=>{let e=document.getElementsByTagName("body"),n={attributes:!0,childList:!0,subtree:!0},i=a((l,c)=>{for(let u of l)u.type==="childList"?console.log("A child node has been added or removed.",u):u.type==="attributes"&&console.log(`The ${u.attributeName} attribute was modified.`,u)},"callback");new MutationObserver(i).observe(e[0],n)},"selfObserve");this.getNodeById=a(e=>qt.mirror.getNode(e),"getNodeById");this.getMeta=a(e=>qt.mirror.getMeta(e),"getMeta");this.eventHandler=e,this.options=Rm(Gx,n)}static{a(this,"SessionRecorder")}};var Nm=["aria-label","aria-labelledby","label","title","alt"];function _m(t){return t._debugSource?.fileName?t._debugSource?.fileName:""}a(_m,"getComponentpath");function Dm(t,e){if(t==="Unknown"||typeof t!="string"||t[0]!==t[0].toUpperCase()||e.type.$$typeof===Symbol.for("react.context")||e.type.$$typeof===Symbol.for("react.forward_ref")||e.type.$$typeof===Symbol.for("react.memo")||e.type.$$typeof===Symbol.for("react.profiler")||e.type.$$typeof===Symbol.for("react.suspense"))return!1;let n=_m(e);return!(/.*\/node_modules\//.test(n)||t===n||/^(?!.*src).*$/.test(n))}a(Dm,"isComponentAllowed");function Lc(t,e={}){if(!t)return["",{}];let n=t.type,i=n?n.name||n:"Unknown",s="";if(Dm(i,t)){s+=`<${i}>`;let l=_m(t);e[i]=l}if(t.child){let[l,c]=Lc(t.child,e);s+=l,e={...e,...c}}if(Dm(i,t)&&(s+=`</${i}>`),t.sibling){let[l,c]=Lc(t.sibling,e);s+=l,e={...e,...c}}return[s,e]}a(Lc,"traverseReactTree");function Om(t){let e=t._reactRootContainer?._internalRoot.current;return e||console.log("No react tree in element",t),Lc(e)}a(Om,"getReactTree");var Jr=class t{static{a(this,"FrontendLogger")}static{this.overriddenMethods=["log","warn","error"]}static{this.original={}}static removePrefix(){this.overriddenMethods.forEach(e=>{t.original[e]&&(console[e]=t.original[e])})}static setPrefix(e){this.overriddenMethods.forEach(n=>{t.original[n]||(t.original[n]=console[n]),console[n]=(...i)=>{i.unshift(e),t.original[n].apply(console,i)}})}};var zs=class{constructor(e=s=>s.map(l=>l.target),n={childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0},i={collectElement:!0}){this.filterElements=e;this.observeOptions=n;this.options=i;this.mutationEventListeners=[]}static{a(this,"MutationDetector")}addEventListener(e,n){this.mutationEventListeners.push({selector:e,listener:n})}startListening(){this.elements=[],this.observer=new MutationObserver(e=>{this.options.collectElement&&(this.elements=[...this.elements,...this.filterElements(e)]),this.mutationEventListeners.length&&e.forEach(n=>{n.addedNodes.forEach(i=>{if(i.nodeType!==Node.ELEMENT_NODE)return;let s=i;this.mutationEventListeners.forEach(l=>{s.matches(l.selector)?l.listener(s):s.querySelectorAll(l.selector).forEach(c=>{l.listener(c)})})})})}),this.observer.observe(document.body,this.observeOptions)}stopListening(){return this.observer.disconnect(),this.elements}};function km(t){let e=t.filter(i=>i.addedNodes.length>0).reduce((i,s)=>[...i,...s.addedNodes],[]),n=t.filter(i=>i.type==="attributes"&&i.attributeName==="style"&&i.target instanceof HTMLElement&&/display\s*:\s*none/.test(i.oldValue)&&Jo(i.target).visible).map(i=>i.target);return[...e,...n]}a(km,"poppingElementsFilter");var ei;function Fm(t){ei=!1;let e=Pm(t);return ei?e:null}a(Fm,"getElementCaptionKey");var Pm=a(t=>{let e=a(l=>{if(!(l.tagName.toLowerCase()in Qo))return l.tagName.toLowerCase();let c=Qo[l.tagName.toLowerCase()].map(u=>`${u}:${l.getAttribute(u)}`).join(",");return c?(ei=!0,`SVG:${c}`):l.tagName.toLowerCase()},"getSVGKey"),n=a(l=>{ei=!0;let c=i(l);return`IMG:${l.src}`+(c!==l.tagName.toLowerCase()?`(${c})`:"")},"getIMGKey"),i=a(l=>{let c=window.getComputedStyle(l).backgroundImage;if(c&&c!=="none"){let u=c.match(/url\("(.+)"\)/);if(u)return ei=!0,`BGIMG:${l.tagName.toLowerCase()+u[1]}`}for(let u of["::before","::after"]){let h=window.getComputedStyle(l,u).content.replace(/['"]/g,""),f=window.getComputedStyle(l,u).fontFamily;if(h!=="none"&&h!==""){ei=!0;let p=h.charCodeAt(0).toString(16).padStart(4,"0");return`FONT:${l.tagName.toLowerCase()+f+p}`}}return l.tagName.toLowerCase()},"getElementKey");if(!t||t.nodeType===Node.TEXT_NODE||!t.tagName)return;let s=t instanceof SVGElement?e(t):t instanceof HTMLImageElement?n(t):i(t);if(t.childNodes.length>0){let l=Array.from(t.childNodes).map(Pm).filter(Boolean).join("+");l&&l.length>0&&(s+="("+l+")")}return s},"walk");function Ux(t,e){let n=new Set;for(;t;)n.add(t),t=t.parentNode;for(;e;){if(n.has(e))return e;e=e.parentNode}return null}a(Ux,"findCommonAncestor");function Nc(t,e){let n=Ux(t,e),i=0,s;if(!n)return 99999;for(s=t;s&&s!==n;)i++,s=s.parentNode;for(s=e;s&&s!==n;)i++,s=s.parentNode;return i}a(Nc,"distanceBetweenNodes");var Dc=class{constructor(){this.lastHighlights=[]}static{a(this,"ElementHighlighter")}clearHighlights(){this.lastHighlights.length&&(this.lastHighlights.forEach(e=>e.remove()),this.lastHighlights=[])}highlightElement(e,{highlightStyle:n={},textStyle:i={},mousePosition:s,text:l,textType:c="static",textPosition:u="overlap",textWidthType:h="rect",clear:f=!0,shouldFlipHighlightTextOutsideViewport:p=!0,pointerEvents:g,classNames:y=[],renderDocument:S,scroll:w=!1}={}){if(f&&this.clearHighlights(),!e)return;let M={left:0,top:0,right:0,bottom:0},T=1,C=1;if(S!==e.ownerDocument){let Z=e.ownerDocument.defaultView?.frameElement;for(;Z&&Z.contentDocument!==S;){let de=Z.getBoundingClientRect(),G=this.getScaleFromStyles(Z);T*=G.scaleX,C*=G.scaleY,M.left+=de.left,M.top+=de.top,Z=Z.ownerDocument.defaultView?.frameElement}}let N=S??e.ownerDocument,A=Fl(e),k=e.getBoundingClientRect(),z={top:k.top*C+M.top,left:k.left*T+M.left};if(!A){let Z=N.defaultView?.scrollX||0,de=N.defaultView?.scrollY||0;z.left+=Z,z.top+=de}let q=N.createElement("div");if(q.style.outline="2px dashed rgba(255,0,0,.75)",q.style.position=A?"fixed":"absolute",q.style.left=z.left+"px",q.style.top=z.top+"px",q.style.width=k.width*T+"px",q.style.height=k.height*C+"px",q.style.pointerEvents=g??"none",q.style.zIndex="2147483647",q.className=["checksum-dom-cache-ignore",...y].join(" "),this.mergeStyle(q,n),s){let Z=N.createElement("div");if(Z.style.position="absolute",Z.style.left=+s.x-16+"px",Z.style.top=+s.y-16+"px",Z.style.color="#004DFF",Z.className=["checksum-dom-cache-ignore","mouse-cross",...y].join(" "),Z.style.zIndex="2147483648",!N.head.querySelector("style[role=mouse-location]")){var oe=N.head.appendChild(N.createElement("style"));oe.setAttribute("role","mouse-location"),oe.innerHTML=".mouse-cross:before, .mouse-cross:after {position: absolute;left: 15px;content: ' ';height: 33px;width: 3px;background-color: #004DFF;}.mouse-cross:before {transform: rotate(0deg);}.mouse-cross:after {transform: rotate(-90deg);}"}N.body.appendChild(Z),this.lastHighlights.push(Z)}let $=N.createElement("div");l&&($.className=["checksum-dom-cache-ignore",...y].join(" "),$.innerText=l,$.style.fontSize="12px",$.style.width=h==="rect"?`${k.width}px`:"auto",$.style.background="#000000a1",$.style.color="white",$.style.padding="5px",$.style.position="absolute",$.style.pointerEvents="none",$.style.userSelect="none",u==="above"?$.style.bottom=`${k.height}px`:u==="below"&&($.style.top=`${k.height}px`),this.mergeStyle($,i),q.appendChild($),q.style.pointerEvents=g??"none",c==="hover"&&($.style.display="none",q.addEventListener("mouseover",()=>{$.style.display="block"}),q.addEventListener("mouseout",()=>{$.style.display="none"}))),N.body.appendChild(q),u==="above"&&Pl($)>0?($.style.bottom="initial",$.style.top=`${k.height}px`):u==="below"&&Hl($)>0&&($.style.top="initial",$.style.bottom=`${k.height}px`),this.lastHighlights.push(q),p&&this.flipHighlightTextPositionOutsideViewport($,u,k.height),w&&new st(e).scrollIntoView()}getScaleFromStyles(e){let n=window.getComputedStyle(e),i=n.transform;if(i.startsWith("matrix")){let s=parseFloat(i.split(",")[0].replace("matrix(",""))||1,l=parseFloat(i.split(",")[3])||1;return{scaleX:s,scaleY:l}}else if(n.scale){let s=parseFloat(n.scale)||1,l=parseFloat(n.scale)||1;return{scaleX:s,scaleY:l}}return{scaleX:1,scaleY:1}}mergeStyle(e,n){for(let i in n)e.style[i]=n[i]}flipHighlightTextPositionOutsideViewport(e,n,i){n==="above"&&Pl(e)>0?(e.style.bottom="initial",e.style.top=`${i}px`):n==="below"&&Hl(e)>0&&(e.style.top="initial",e.style.bottom=`${i}px`)}},Sn=new Dc;function qs(t,e){return typeof t!="string"?Hm(t):`${JSON.stringify(t)}${e?"s":"i"}`}a(qs,"escapeForTextSelector");function Ys(t,e=!1){return typeof t!="string"?Hm(t):`"${t.replace(/\\/g,"\\\\").replace(/["]/g,'\\"')}"${e?"s":"i"}`}a(Ys,"escapeForAttributeSelector");function Hm(t){return t.unicode||t.unicodeSets?String(t):String(t).replace(/(^|[^\\])(\\\\)*(["'`])/g,"$1$2\\$3").replace(/>>/g,"\\>\\>")}a(Hm,"escapeRegexForSelector");var $x=10,ni=$x/2;var zx=100,qx=120,Yx=140,Kx=160,Xx=180,jx=200;var NL=zx+ni,DL=qx+ni,_L=Yx+ni,OL=Kx+ni,kL=Xx+ni,FL=jx+ni;function ti(t){let e={full:"",immediate:[]};if(!Zx(t)){let n="";if(t instanceof HTMLInputElement&&(t.type==="submit"||t.type==="button"))e={full:t.value,immediate:[t.value]};else{for(let i=t.firstChild;i;i=i.nextSibling)i.nodeType===Node.TEXT_NODE?(e.full+=i.nodeValue||"",n+=i.nodeValue||""):(n&&e.immediate.push(n),n="",i.nodeType===Node.ELEMENT_NODE&&(e.full+=ti(i).full));n&&e.immediate.push(n),t.shadowRoot&&(e.full+=ti(t.shadowRoot).full)}}return e}a(ti,"elementText");function Ks(t){return t.replace(/\u200b/g,"").trim().replace(/\s+/g," ")}a(Ks,"normalizeWhiteSpace");function Zx(t){let e=t.ownerDocument;return t.nodeName==="SCRIPT"||t.nodeName==="NOSCRIPT"||t.nodeName==="STYLE"||e.head&&e.head.contains(t)}a(Zx,"shouldSkipForTextMatching");function Qi(t){return t.trim().replace(/([!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1")}a(Qi,"escapeSelector");function bn(t){let e=t.ownerDocument.defaultView;return e!==window&&!e.playwright&&(e.playwright=window.playwright),e.playwright}a(bn,"getElementWindowPlaywright");var Xs=["role","aria-label","aria-labelledby","aria-checked","checked","placeholder","title","alt","id","data-testid","data-test-id","data-test","class","id","style","href","src","path","type"];function ri(t){return typeof t=="object"&&t!==null&&t.nodeType===Node.ELEMENT_NODE}a(ri,"isElement");var fr={NONE:"",DESCENDANT:" ",CHILD:" > "},Fe={id:"id",class:"class",tag:"tag",attribute:"attribute",nthchild:"nthchild",nthoftype:"nthoftype"};function Wm(t,e){return Object.values(t).includes(e)}a(Wm,"isEnumValue");var Qx="CssSelectorGenerator";function ii(t="unknown problem",...e){console.warn(`${Qx}: ${t}`,...e)}a(ii,"showWarning");var Jx={selectors:[Fe.id,Fe.class,Fe.tag,Fe.attribute],includeTag:!1,whitelist:[],blacklist:[],combineWithinSelector:!0,combineBetweenSelectors:!0,root:null,maxCombinations:Number.POSITIVE_INFINITY,maxCandidates:Number.POSITIVE_INFINITY};function eC(t){return Array.isArray(t)?t.filter(e=>Wm(Fe,e)):[]}a(eC,"sanitizeSelectorTypes");function _c(t){return t instanceof RegExp}a(_c,"isRegExp");function tC(t){return["string","function"].includes(typeof t)||_c(t)}a(tC,"isCssSelectorMatch");function Vm(t){return Array.isArray(t)?t.filter(tC):[]}a(Vm,"sanitizeCssSelectorMatchList");function nC(t){return t instanceof Node}a(nC,"isNode");function Bm(t){let e=[Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE];return nC(t)&&e.includes(t.nodeType)}a(Bm,"isParentNode");function Oc(t,e){if(Bm(t))return t.contains(e)||ii("element root mismatch","Provided root does not contain the element. This will most likely result in producing a fallback selector using element's real root node. If you plan to use the selector using provided root (e.g. `root.querySelector`), it will not work as intended."),t;let n=e.getRootNode({composed:!1});return Bm(n)?(n!==document&&ii("shadow root inferred","You did not provide a root and the element is a child of Shadow DOM. This will produce a selector using ShadowRoot as a root. If you plan to use the selector using document as a root (e.g. `document.querySelector`), it will not work as intended."),n):Ji(e)}a(Oc,"sanitizeRoot");function Gm(t){return typeof t=="number"?t:Number.POSITIVE_INFINITY}a(Gm,"sanitizeMaxNumber");function Um(t,e={}){let n=Object.assign(Object.assign({},Jx),e);return{selectors:eC(n.selectors),whitelist:Vm(n.whitelist),blacklist:Vm(n.blacklist),root:Oc(n.root,t),combineWithinSelector:!!n.combineWithinSelector,combineBetweenSelectors:!!n.combineBetweenSelectors,includeTag:!!n.includeTag,maxCombinations:Gm(n.maxCombinations),maxCandidates:Gm(n.maxCandidates)}}a(Um,"sanitizeOptions");function rn(t=[]){let[e=[],...n]=t;return n.length===0?e:n.reduce((i,s)=>i.filter(l=>s.includes(l)),e)}a(rn,"getIntersection");function js(t){return[].concat(...t)}a(js,"flattenArray");function rC(t){return t.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".+")}a(rC,"wildcardToRegExp");function eo(t){let e=t.map(n=>{if(_c(n))return i=>n.test(i);if(typeof n=="function")return i=>{let s=n(i);return typeof s!="boolean"?(ii("pattern matcher function invalid","Provided pattern matching function does not return boolean. It's result will be ignored.",n),!1):s};if(typeof n=="string"){let i=new RegExp("^"+rC(n)+"$");return s=>i.test(s)}return ii("pattern matcher invalid","Pattern matching only accepts strings, regular expressions and/or functions. This item is invalid and will be ignored.",n),()=>!1});return n=>e.some(i=>i(n))}a(eo,"createPatternMatcher");function oi(t,e,n){let i=Array.from(Oc(n,t[0]).querySelectorAll(e));return i.length===t.length&&t.every(s=>i.includes(s))}a(oi,"testSelector");function kc(t,e){e=e??Ji(t);let n=[],i=t;for(;ri(i)&&i!==e;)n.push(i),i=i.parentElement;return n}a(kc,"getElementParents");function $m(t,e){return rn(t.map(n=>kc(n,e)))}a($m,"getParents");function Ji(t){return t.ownerDocument.querySelector(":root")}a(Ji,"getRootNode");var Zs=", ",zm=new RegExp(["^$","\\s"].join("|")),qm=new RegExp(["^$"].join("|")),Qs=[Fe.nthoftype,Fe.tag,Fe.id,Fe.class,Fe.attribute,Fe.nthchild];var iC=eo(["class","id","ng-*"]);function oC({name:t}){return`[${t}]`}a(oC,"attributeNodeToSimplifiedSelector");function sC({name:t,value:e}){return`[${t}='${e}']`}a(sC,"attributeNodeToSelector");function aC({nodeName:t,nodeValue:e},n){let i=n.tagName.toLowerCase();return["input","option"].includes(i)&&t==="value"||t==="src"&&e?.startsWith("data:")?!1:!iC(t)}a(aC,"isValidAttributeNode");function lC({nodeName:t,nodeValue:e}){return{name:wn(t),value:wn(e??void 0)}}a(lC,"sanitizeAttributeData");function Fc(t){let e=Array.from(t.attributes).filter(n=>aC(n,t)).map(lC);return[...e.map(oC),...e.map(sC)]}a(Fc,"getElementAttributeSelectors");function Ym(t){let e=t.map(Fc);return rn(e)}a(Ym,"getAttributeSelectors");function Pc(t){var e;return((e=t.getAttribute("class"))!==null&&e!==void 0?e:"").trim().split(/\s+/).filter(n=>!qm.test(n)).map(n=>`.${wn(n)}`)}a(Pc,"getElementClassSelectors");function Km(t){let e=t.map(Pc);return rn(e)}a(Km,"getClassSelectors");function Hc(t){var e;let n=(e=t.getAttribute("id"))!==null&&e!==void 0?e:"",i=`#${wn(n)}`,s=t.getRootNode({composed:!1});return!zm.test(n)&&oi([t],i,s)?[i]:[]}a(Hc,"getElementIdSelectors");function Xm(t){return t.length===0||t.length>1?[]:Hc(t[0])}a(Xm,"getIdSelector");function Wc(t){let e=t.parentNode;if(e){let i=Array.from(e.childNodes).filter(ri).indexOf(t);if(i>-1)return[`:nth-child(${String(i+1)})`]}return[]}a(Wc,"getElementNthChildSelector");function jm(t){return rn(t.map(Wc))}a(jm,"getNthChildSelector");function Vc(t){return[wn(t.tagName.toLowerCase())]}a(Vc,"getElementTagSelectors");function Js(t){let e=[...new Set(js(t.map(Vc)))];return e.length===0||e.length>1?[]:[e[0]]}a(Js,"getTagSelector");function Bc(t){let e=Js([t])[0],n=t.parentElement;if(n){let s=Array.from(n.children).filter(l=>l.tagName.toLowerCase()===e).indexOf(t);if(s>-1)return[`${e}:nth-of-type(${String(s+1)})`]}return[]}a(Bc,"getElementNthOfTypeSelector");function Zm(t){return rn(t.map(Bc))}a(Zm,"getNthOfTypeSelector");function*cC(t=[],{maxResults:e=Number.POSITIVE_INFINITY}={}){let n=0,i=Gc(1);for(;i.length<=t.length&&n<e;)n+=1,yield i.map(l=>t[l]),i=uC(i,t.length-1)}a(cC,"powerSetGenerator");function Uc(t=[],{maxResults:e=Number.POSITIVE_INFINITY}={}){return Array.from(cC(t,{maxResults:e}))}a(Uc,"getPowerSet");function uC(t=[],e=0){let n=t.length;if(n===0)return[];let i=[...t];i[n-1]+=1;for(let s=n-1;s>=0;s--)if(i[s]>e){if(s===0)return Gc(n+1);i[s-1]++,i[s]=i[s-1]+1}return i[n-1]>e?Gc(n+1):i}a(uC,"bumpOffsets");function Gc(t=1){return Array.from(Array(t).keys())}a(Gc,"generateOffsets");function Qm(t={}){let e=[];return Object.entries(t).forEach(([n,i])=>{e=i.flatMap(s=>e.length===0?[{[n]:s}]:e.map(l=>Object.assign(Object.assign({},l),{[n]:s})))}),e}a(Qm,"getCartesianProduct");var dC="3a".toUpperCase(),hC=/[ !"#$%&'()\[\]{|}<>*+,./;=?@^`~\\]/;function wn(t=""){return CSS?CSS.escape(t):fC(t)}a(wn,"sanitizeSelectorItem");function fC(t=""){return t.split("").map(e=>e===":"?`\\${dC} `:hC.test(e)?`\\${e}`:escape(e).replace(/%/g,"\\")).join("")}a(fC,"legacySanitizeSelectorItem");var mC={tag:Js,id:Xm,class:Km,attribute:Ym,nthchild:jm,nthoftype:Zm},pC={tag:Vc,id:Hc,class:Pc,attribute:Fc,nthchild:Wc,nthoftype:Bc};function Jm(t,e){return pC[e](t)}a(Jm,"getElementSelectorsByType");function gC(t,e){let n=mC[e];return n(t)}a(gC,"getSelectorsByType");function yC(t=[],e,n){return t.filter(i=>n(i)||!e(i))}a(yC,"filterSelectors");function EC(t=[],e){return t.sort((n,i)=>{let s=e(n),l=e(i);return s&&!l?-1:!s&&l?1:0})}a(EC,"orderSelectors");function vC(t,e,n){let i=SC(t,n),s=TC(i,n),l=js(s);return[...new Set(l)]}a(vC,"getAllSelectors");function SC(t,e){let{blacklist:n,whitelist:i,combineWithinSelector:s,maxCombinations:l}=e,c=eo(n),u=eo(i),h=a((f,p)=>{let g=gC(t,p),y=yC(g,c,u),S=EC(y,u);return f[p]=s?Uc(S,{maxResults:l}):S.map(w=>[w]),f},"reducer");return bC(e).reduce(h,{})}a(SC,"getSelectorsList");function bC(t){let{selectors:e,includeTag:n}=t,i=[...e];return n&&!i.includes("tag")&&i.push("tag"),i}a(bC,"getSelectorsToGet");function wC(t){return t.includes(Fe.tag)||t.includes(Fe.nthoftype)?[...t]:[...t,Fe.tag]}a(wC,"addTagTypeIfNeeded");function MC(t){let{selectors:e,combineBetweenSelectors:n,includeTag:i,maxCandidates:s}=t,l=n?Uc(e,{maxResults:s}):e.map(c=>[c]);return i?l.map(wC):l}a(MC,"combineSelectorTypes");function TC(t,e){return MC(e).map(n=>xC(n,t)).filter(n=>n.length>0)}a(TC,"getTypeCombinations");function xC(t,e){let n={};return t.forEach(s=>{let l=e[s];l&&l.length>0&&(n[s]=l)}),Qm(n).map(IC)}a(xC,"constructSelectors");function CC(t,e){return e[t]?e[t].join(""):""}a(CC,"constructSelectorType");function IC(t={}){let e=[...Qs];return t[Fe.tag]&&t[Fe.nthoftype]&&e.splice(e.indexOf(Fe.tag),1),e.map(n=>CC(n,t)).join("")}a(IC,"constructSelector");function AC(t,e){return[...t.map(n=>e+fr.DESCENDANT+n),...t.map(n=>e+fr.CHILD+n)]}a(AC,"generateCandidateCombinations");function RC(t,e){return e===""?t:AC(t,e)}a(RC,"generateCandidates");function LC(t,e,n="",i){let s=vC(t,e,i),l=RC(s,n);for(let c of l)if(oi(t,c,e))return c;return null}a(LC,"getSelectorWithinRoot");function ep(t,e,n="",i){if(t.length===0)return null;let s=[t.length>1?t:[],...$m(t,e).map(l=>[l])];for(let l of s){let c=LC(l,e,n,i);if(c)return{foundElements:l,selector:c}}return null}a(ep,"getClosestIdentifiableParent");function tp(t){(t instanceof NodeList||t instanceof HTMLCollection)&&(t=Array.from(t));let e=(Array.isArray(t)?t:[t]).filter(ri);return[...new Set(e)]}a(tp,"sanitizeSelectorNeedle");function NC(t){return{value:t,include:!1}}a(NC,"createElementSelectorData");function np(t,e,n=fr.NONE){let i={};return e.forEach(s=>{Reflect.set(i,s,Jm(t,s).map(NC))}),{element:t,operator:n,selectors:i}}a(np,"createElementData");function rp({selectors:t,operator:e}){let n=[...Qs];t[Fe.tag]&&t[Fe.nthoftype]&&(n=n.filter(s=>s!==Fe.tag));let i="";return n.forEach(s=>{var l;((l=t[s])!==null&&l!==void 0?l:[]).forEach(({value:u,include:h})=>{h&&(i+=u)})}),e+i}a(rp,"constructElementSelector");function DC(t){return[":root",...kc(t).reverse().map(i=>{let s=np(i,[Fe.nthchild],fr.CHILD);return s.selectors.nthchild.forEach(l=>{l.include=!0}),s}).map(rp)].join("")}a(DC,"getElementFallbackSelector");function ip(t){return t.map(DC).join(Zs)}a(ip,"getFallbackSelector");function $c(t,e={}){var n;let i=tp(t),s=Um(i[0],e),l=(n=s.root)!==null&&n!==void 0?n:Ji(i[0]),c="",u=l;function h(){return ep(i,u,c,s)}a(h,"updateIdentifiableParent");let f=h();for(;f;){let{foundElements:p,selector:g}=f;if(oi(i,g,l))return g;u=p[0],c=g,f=h()}return i.length>1?i.map(p=>$c(p,s)).join(Zs):ip(i)}a($c,"getCssSelector");var to=a(t=>new Promise(e=>setTimeout(e,t)),"awaitSleep"),op=a(async(t,e=1e3,n)=>{if(e===null)return t;let i="guard-timed-out",s=a(async()=>(await to(e+1e3),i),"guard"),l=await Promise.race([t,s()]);if(typeof l=="string"&&l===i)throw typeof n=="function"?new Error(n()):new Error(n??"guardReturnTimedOut");return l},"guardReturn");var _C=!1,Yn=class t{constructor(e){this.locators=[];this.elements=[];this.locators=e}static{a(this,"LocatorChain")}hasDuplicateFilters(){let e=this.locators.map(n=>n.options?.hasText).filter(n=>n);return e.length!==new Set(e).size}cloneAndAddCandidate(e){return new t([e,...this.locators.slice()])}toLocatorCandidate(){return{selector:this.getSelector(),locator:this.getLocator()}}getSelector(){return this.locators.map(e=>e.selector).join(" >> ")}getLocator(){return this.locators.map(e=>e.locator).join(".")}},Kn=class t{constructor(e=document){this.rootNode=e;this.MAX_TESTING_SELECTORS=50;this.MAX_SINGLE_ELEMENT_SELECTORS=5;this.MAX_PROCESSING_TIME=15e3;this.MAX_MULTICANDIDATE_PROCESSING=5}static{a(this,"PlaywrightCustomLocatorGenerator")}async generate(e,n=[],i={}){let{isPartOfListItem:s,isForContextElement:l,useTextContent:c,addCSSSelectorGenerator:u,expandCSSKeyElements:h,bruteForceMode:f}={isPartOfListItem:!1,isForContextElement:!1,useTextContent:!0,addCSSSelectorGenerator:!0,expandCSSKeyElements:!0,bruteForceMode:!1,...i};if(Be(e,"HTMLOptionElement")&&e.closest("select"))return this.generate(e.closest("select"),n,{isPartOfListItem:s});this.targetElement=e,this.startTimestamp=Date.now();let p=[];for(n=n.filter(y=>Array.from(document.querySelectorAll(y.selector)).includes(y.element)),h&&this.expandCSSKeyFeatures(e,n);e&&e!==this.rootNode;){await to(0);let y=this.getAllLocators(e,n,{useTextContent:c,bruteForceMode:f}),S=[],w=a(async M=>{if(!M.hasDuplicateFilters())try{await to(0);let{elements:T}=this.getLocatorBase(e).locator(M.getSelector());T?.some(C=>C===this.targetElement)&&(M.elements=T.filter(C=>qn(C)||C.constructor.name===this.targetElement.constructor.name),S.push(M))}catch(T){console.log(T,M.getSelector())}},"testCandidate");if(p.length)for(let M of y)for(let T of p)await w(T.cloneAndAddCandidate(M));else for(let M of y)await w(new Yn([M]));if(S.length===0&&p.length===0){let M=e.tagName.toLowerCase();p.push(new Yn([{selector:M,locator:this.getSelectorLocator(M),elements:this.getLocatorBase(e).locator(e.tagName.toLowerCase()).elements.filter(T=>qn(T))}]))}if(p.push(...S),l)return p.map(M=>M.toLocatorCandidate());if(p.length>this.MAX_TESTING_SELECTORS||p.filter(M=>M.elements.length===1).length>this.MAX_SINGLE_ELEMENT_SELECTORS||this.checkTimeout(!1))break;e=e.parentElement}if(s){let y=this.filterListItemsSelectors(p);if(y?.length)return y.map(S=>({...S.toLocatorCandidate(),isListSelector:!0}))}let g=[];try{for(let y of p)this.checkTimeout(),g.push(...y.elements.length===1?[y]:await this.reduceMultiCandidates(y))}catch(y){y instanceof $n&&console.warn("[PlaywrightCustomLocatorGenerator] Timeout error")}if(!g?.length&&(console.log("no single element selector found"),!h))return this.generate(e,n,{isPartOfListItem:s,isForContextElement:l,useTextContent:c,addCSSSelectorGenerator:!0,expandCSSKeyElements:!0});if(u){let y=await this.addCSSSelectorGenerator();y&&g.unshift(y)}if(this.rootNode===document&&c){let{selector:y,locator:S}=await new pt().getSelectorAndLocator(this.targetElement);g.unshift(new Yn([{selector:y,locator:S}]))}return g=g.concat(await this.addOptionalParentSelector(c,u,h)),Array.from(new Map(g.map(y=>[y.toLocatorCandidate().selector,y.toLocatorCandidate()])).values())}testSelector(e,n,i,s=!0){let l=bn(n).selector(n),c=this.getLocatorBase(n).locator(l);console.log("Locator result",c);let u=a(f=>s&&(f.elements.length!==1||n!==f.element)?!1:!!f.elements.includes(n),"testResult");if(!u(c))return{valid:!1};let h={};if(i?.locatorWithVars?.length)try{let p=new Function(`{ return function(element) { ${i.variablesCode}; return this.getLocatorBase(element).locator(\`${i.locatorWithVars}\`); } }`)().call(this,n);if(console.log("Locator with vars result",p),!u(p))return{valid:!1};h={selectorWithVars:l,locatorWithVars:i.locatorWithVars}}catch(f){return console.error("Error testing selector with variables",f.message),{valid:!1}}return{valid:!0,selector:l,locator:e,...h}}async addCSSSelectorGenerator(){try{let e=this.rootNode===document?{}:{root:this.rootNode},n=await op(new Promise(i=>{let s=$c(this.targetElement,e);i(s)}),2e3);if(n.length<50)return new Yn([{selector:n,locator:`locator('${n}')`}])}catch(e){console.error("Error getting CSS selector",e)}}async addOptionalParentSelector(e,n,i){try{let s=bn(this.targetElement),l=s.locator(s.selector(this.targetElement)).element;if(l!==this.targetElement&&l?.contains(this.targetElement))return(await this.generate(l,[],{isPartOfListItem:!1,isForContextElement:!1,useTextContent:e,addCSSSelectorGenerator:n,expandCSSKeyElements:i})).map(({selector:c,locator:u})=>new Yn([{selector:c,locator:u}]))}finally{return[]}}expandCSSKeyFeatures(e,n,i=4){try{let s=[];for(;e&&e!==this.rootNode&&s.length<i&&e!==document.documentElement;)Array.from(e.attributes).filter(({name:c,value:u})=>u.length<30&&!Xs.includes(c)).forEach(c=>{try{if(s.length>i-1)return;let u=`[${c.name}${c.value?`="${c.value}"`:""}]`;try{if(!e.parentElement||e.parentElement.querySelectorAll(u).length>1)return}catch{console.warn(`Error checking selector - ${u}, continuing`);return}if(!n.some(h=>h.selector.includes(u))&&this.getLocatorBase(e).locator(u).element===e){let h={element:e,selector:u};n.push(h),s.push(h)}}catch(u){console.warn("Error processing css key feature",{name:c.name,value:c.value},u)}}),e=e.parentElement;s.length}catch(s){console.error("Error extracting CSS key features",s)}}async generateArbitraryItemListSelector(e,n=[]){console.log("generateArbitraryItemListSelector",e);try{let i=en(document.body,{nodeRepetitionsThreshold:5});if(!i?.length)throw new Error("No templates found in the page");let s=i.find(y=>y.element.contains(e));if(!s)throw new Error("No template found for target element");console.log("Found template for target element",s);let l=await new t().generate(s.element,n,{isPartOfListItem:!1,isForContextElement:!1,useTextContent:!1});console.log("baseCustomSelectors",l);let c=l[0].selector,u=this.getSelectorLocator(c,s.element);console.log("Randomly selected baseSelector",c);let h=a(()=>{let y=[],S=new mr,w=e;for(;w&&w!==s.element;){let M="",T=!1,C=!1,N=!1;for(;!M.length;)M=S.getSelectorPart(w,{useClasses:C,useId:T,useTag:N}),T?(C=!0,N=!0):T=!0;y.push({selector:M,element:w}),w=w.parentElement}return y},"getCSSFeatures"),f=h();console.log("cssFeatures",f);let p=(await new t(s.element).generate(e,h(),{isPartOfListItem:!0,isForContextElement:!1,useTextContent:!1})).map(y=>({...y,elements:[]})),g=p.filter(y=>(y.elements=this.getLocatorBase(e).locator(c).locator(y.selector).elements,y.elements.length>Math.ceil(s.element.children.length*.7)));return console.log("elementSelectors",p),g.map(({selector:y,locator:S})=>({selector:`${c} >> ${y}`,locator:`${u}.${S}`}))}catch(i){console.error("[findGenericItemListSelector] error",i)}}filterListItemsSelectors(e){try{let n=en(document.body,{nodeRepetitionsThreshold:5});if(!n?.length)throw new Error("No templates found in the page");return e.filter(i=>{if(i.elements.length<2)return!1;let s=new mr().getSmallestCommonRoot(i.elements);return!(!n.some(l=>l.element===s)||Array.from(s.children).some(l=>{i.elements.filter(c=>l.contains(c)).length>1}))})}catch(n){console.error("[filterListItemsSelectors] error",n.message)}}getLocatorBase(e){let n=bn(e);return this.rootNode===document||this.rootNode.nodeType===9?n:n.locator(n.selector(this.rootNode))}getSelectorLocator(e,n){return bn(n??this.targetElement).asLocator("javascript",e)}async reduceMultiCandidates(e){await to(0);let{elements:n}=e,i=e.getSelector().split(" >> "),s=[],l=this.getLocatorBase(this.targetElement),c=a(p=>{try{return s.push(new Yn([{selector:p,locator:this.getSelectorLocator(p)}])),s.length>=this.MAX_MULTICANDIDATE_PROCESSING}catch(g){return console.error(g),!1}},"addCandidateWithSelector"),u=a(p=>e.getSelector()+(i[i.length-1]===this.targetElement.tagName.toLowerCase()?p:` >> internal:and=${OC(this.targetElement.tagName.toLowerCase()+p)}`),"addCSSFilterToLocator"),h=a(p=>l.locator(p).elements.length===1?c(p):!1,"addIfSingularAndCheckLimit");if(n.length<5){let p=n.indexOf(this.targetElement);p!==-1&&c(e.getSelector()+` >> nth=${p}`)}let f=this.targetElement.parentElement;if(n.every(p=>p.parentElement===f&&p.tagName===this.targetElement.tagName)){let p=Array.from(f.children).indexOf(this.targetElement);if(p!==-1){let g=u(`:nth-child(${p+1})`);h(g)&&c(g)}}for(let p of Array.from(this.targetElement.classList).filter(g=>!Jt.includes(g))){let g=u(`.${Qi(p)}`);try{if(h(g))return s}catch(y){console.error(y)}}for(let p of Array.from(this.targetElement.attributes).filter(g=>!Xs.includes(g.name))){let g=u(`[${p.name}`+(p.value?`="${p.value}"]`:"]"));try{if(h(g))return s}catch(y){console.error(y)}}return s}getAllLocators(e,n,i={}){i={exact:!0,useTextContent:!0,...i};let s=[this.getByRoleLocator(e,i),i.useTextContent?this.getByTextLocator(e,i):null,this.getByLabelLocator(e,i),this.getByPlaceholderLocator(e,i),this.getByTitleLocator(e,i),this.getByAltLocator(e,i),this.getTestIdLocator(e,i),...e===this.targetElement?[this.getInnerFeaturesLocator(e)]:[],...n.filter(l=>l.element===e).map(l=>({selector:l.selector,locator:this.getSelectorLocator(l.selector)}))].filter(l=>l);return!s.length&&i.bruteForceMode?s.concat(this.findUniqueCSSLocatorForElement(e)):s}findUniqueCSSLocatorForElement(e,n=5){let i=[],s=a(l=>(i.push([{selector:l,locator:`locator('${l}')`}]),i.length>=n),"addCandidate");for(let l of Array.from(e.attributes).filter(({name:c,value:u})=>u.length<30&&!Xs.includes(c)))try{let c=`[${l.name}${l.value?`="${l.value}"`:""}]`;if(e.ownerDocument.querySelectorAll(c).length===1&&s(c))return i}catch{}for(let l of Array.from(e.classList).filter(c=>!Jt.includes(c)))try{let c=`.${Qi(l)}`;if(e.ownerDocument.querySelectorAll(c).length===1&&s(c))return i}catch{}return i}getInnerFeaturesLocator(e){let n=e.tagName.toLowerCase();if(!qn(e)||["html","body","div"].includes(n))return;let i=new yn().extract(e).filter(l=>!l.isRoot).slice(0,4).map(l=>_r(l).pop());if(i.length<2)return;let s=n+i.map(l=>`:has(${l})`).join("");return{selector:s,locator:this.getSelectorLocator(s)}}getByRoleLocator(e,n={}){try{if(!qn(e))throw new Error("Provided element is not an HTMLElement");let i={},s={button:"button",input:a(S=>S.type==="checkbox"?"checkbox":S.type==="radio"?"radio":"textbox","input"),select:"listbox",a:"link",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",li:"listitem",option:"option",textarea:"textbox",table:"table",tr:"row",th:"columnheader",td:"cell",img:"img"},l=e.tagName.toLowerCase(),c=e.getAttribute("role")||(s[l]instanceof Function?s[l](e):s[l]);if(!c)return;let u=[];if(c==="heading"&&!e.hasAttribute("aria-level")){let S=parseInt(l.charAt(1),10);u.push(["level",String(S)])}(c==="checkbox"||c==="radio")&&u.push(["checked",String(e.getAttribute("aria-checked")??e.getAttribute("checked")??"false")]);let h=a(()=>{let S=a(A=>this.limitTextLength(this.normalize(A),n.exact),"normalize"),w={text:"",exact:!1},M=e.getAttribute("aria-label")??e.getAttribute("aria-labelledby")??e.getAttribute("title");if(M)return S(M);let T=ti(e),C=Ks(T.full);if(!C?.length)return w;let N=S(C);return i.hasText=N.text,N},"getAccessibleName"),{text:f,exact:p}=h();f&&f.length>0&&f.length<30&&u.push(["name",Ys(f,p)]);let g=a(()=>{let S=`internal:role=${c}${u.map(([w,M])=>`[${w}=${M}]`).join("")}`;return{locator:this.getSelectorLocator(S),selector:S,options:i}},"getSelection"),y=g();if(f?.length&&p&&!this.getLocatorBase(e).locator(y.selector).elements.includes(e)){let S=u.find(w=>w[0]==="name");S&&(S[1]=Ys(f,!1),y=g())}return y}catch(i){console.error("Error getting role locator",i.message)}}getByTextLocator(e,n={}){try{if(!qn(e))return;let i=Ks(ti(e).full);if(!i?.length||i.length>100)return;let s={};if(Array.from(e.children).filter(u=>qn(u)).some(u=>Ks(ti(u).full)===i)){s.hasText=i;let u=`${e.tagName.toLowerCase()} >> internal:has-text=${qs(i,!1)}`;return{selector:u,locator:this.getSelectorLocator(u),options:s}}let l=a(u=>{let f="internal:text="+qs(i,u);return{selector:f,locator:this.getSelectorLocator(f),options:s}},"getSelection"),c=l(n.exact);return n.exact&&!this.getLocatorBase(e).locator(c.selector).elements.includes(e)&&(c=l(!1)),c}catch{}}getByLabelLocator(e,n={}){try{if(!qn(e)||!["input","textarea","select"].includes(e.tagName.toLowerCase()))return;let i=a(u=>({selector:`internal:label=${qs(u,n.exact)}`,locator:`getByLabel('${u}')`}),"respond"),s=e.getAttribute("aria-label");if(s)return i(s);let l=e.getAttribute("aria-labelledby");if(l){let u=document.getElementById(l);if(u){let h=u.innerText.trim();if(h)return i(h)}}let c=e.getAttribute("id");if(c){let u=document.querySelector(`label[for="${c}"]`);if(u){let h=u.innerText.trim();if(h)return i(h)}}}catch{}}getByPlaceholderLocator(e,n={}){if(["input","textarea"].includes(e.tagName?.toLowerCase()))return this.getByAttributeLocator(e,"placeholder",n)}getByTitleLocator(e,n={}){return this.getByAttributeLocator(e,"title",n)}getByAltLocator(e,n={}){return this.getByAttributeLocator(e,"alt",n)}getTestIdLocator(e,n={}){for(let i of["data-testid","data-test-id","data-test"])if(e.getAttribute(i))return this.getByAttributeLocator(e,i,{...n,locatorName:"getByTestId"})}getByAttributeLocator(e,n,i={}){try{if(!qn(e))return;let s=e.getAttribute(n);if(s)return{selector:`internal:attr=[${n}=${Ys(s,i.exact)}]`,locator:(i.locatorName??`getBy${n.charAt(0).toUpperCase()+n.slice(1)}`)+`('${s}')`}}catch{}}normalize(e){return e.replace(/\n/g,"").replace(/[ \t]+/g," ").trim()}limitTextLength(e,n=!0,i=30){for(;e?.length>30&&e.length<100&&e.includes(" ");)e=e.split(" ").slice(0,-1).join(" "),n=!1;return{text:e,exact:n}}checkTimeout(e=!0){if(_C)return!1;if(this.MAX_PROCESSING_TIME&&Date.now()-this.startTimestamp>this.MAX_PROCESSING_TIME){if(e)throw new $n;return!0}}};function OC(t,e=!1){return`"${t.replace(/\\/g,"\\\\").replace(/["]/g,'\\"')}"`}a(OC,"escapeForAndLocator");function qn(t){return Be(t,"HTMLElement")}a(qn,"isInstanceOfHTMLElement");function sp(t=document,e){try{let i=function(c){let u=c.nodeName.toLowerCase(),h=!1;if(["name","label","aria-label","data-testid","role"].forEach(f=>{c.hasAttribute(f)&&(u+=`[@${f}="${c.getAttribute(f)}"]`,h=!0)}),!h){let f=1,p=c.previousSibling;for(;p;)p.nodeType===Node.ELEMENT_NODE&&p.nodeName===c.nodeName&&f++,p=p.previousSibling;f>1&&(u+=`[${f}]`)}return u};var n=i;if(a(i,"getNodeIdentifier"),!t||!e||!t.contains(e))throw new Error("Child is not a descendant of the given element.");let s=[],l=e;for(;l!==t;)l.nodeType===Node.ELEMENT_NODE&&s.unshift(i(l)),l=l.parentElement;return s.join("/")}catch(i){console.error("Failed to get relative xpath",i);return}}a(sp,"getRelativeXPath");function ap(t,e){return[new XPathEvaluator().evaluate(e,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue].filter(s=>s instanceof HTMLElement)}a(ap,"findElementsByXPath");var mr=class{constructor(e){this.htmlReducer=e;this.BASE_MAX_COMPONENTS_FOR_SELECTOR_COMBINATION=13;this.MAX_SELECTORS_PER_CONTEXT_ELEMENT=10;this.innerFeaturesExtractor=new yn;this.innerTextExtractor=new kr}static{a(this,"CompoundSelector")}filter(e,{isPartOfListItem:n=!1}={}){e.forEach(u=>{u.element=this.htmlReducer.getElementForChecksumId(u.selection.checksumid)});let i=e.splice(e.findIndex(u=>u.isTarget),1)[0],s=e.filter(u=>!!u.element&&!u.element.contains(i.element)&&!i.element.contains(u.element)&&!e.some(h=>h!==u&&(h.element===u.element||h.element.contains(u.element)))).concat(i);if(console.log(`filtered context elements, ${e.length+1} > ${s.length}`),!n)return s;let l=en(document.body,{nodeRepetitionsThreshold:4});if(!l?.length)return[];let c=l.find(u=>u.element.contains(i.element));return c?(console.log("Found template for target element",c),s.filter(u=>c.element.contains(u.element))):[]}async generate(e,{isPartOfListItem:n=!1}={}){let i=e.filter(c=>c.isTarget)[0];if(e=this.filter(e,{isPartOfListItem:n}),e.length<2)throw new Error("Not enough elements found for the given checksum ids");if(!i?.element)throw new Error("Target element not found");let s=this.getSmallestCommonRoot(e.map(c=>c.element));if(!s)throw new Error("No common root found for the given elements");return this.extractFeaturesMetadata(e),{targetSelection:{xpath:sp(s,i.element),cssSelectors:this.generateAllContextualSelectors(s,i.element).filter(c=>c&&c.trim().length>0),playwrightSelectors:await new Kn(s).generate(i.element,[],{addCSSSelectorGenerator:!1,expandCSSKeyElements:!1}),featuresMetadata:i.featuresMetadata},contextElements:e}}async select(e,n){e.forEach(l=>{if(l.find(c=>!c||!c.isConnected))throw new Error("One or more context elements are not connected to the DOM")});let i=a((l,c)=>{try{return l.selector(c)}catch{let h=c.ownerDocument.defaultView.parent?.document?.defaultView?.playwright;if(h)try{return h.selector(c)}catch{return}return}},"getElementSelector"),s=this.getSmallestCommonParents(e).map(this.calculateElementSize).sort((l,c)=>l.size-c.size).map(l=>l.element);return n?s.map(l=>{let c=bn(l),{element:u}=c.locator(i(c,l)).locator(n);return u?i(c,u):null}).filter(l=>l):s.map(l=>{let c=bn(l);if(!c){console.warn("Failed getting playwright for element",l);return}return i(c,l)}).filter(l=>l)}async selectFromMetadata(e){let{contextElements:n}=e;n.forEach(s=>this.getSelectorCandidatesForContextElement(s));let i=ns(n.map(s=>s.candidatesSelectors.map((l,c)=>c)));for(let s of i){n.forEach((c,u)=>c.selector=c.candidatesSelectors[s[u]]);let l=this.getSmallestCommonParentsFromMetadata(n).map(this.calculateElementSize).sort((c,u)=>c.size-u.size).map(c=>c.element);for(let c of l){let u=this.generateTargetSelectotionHistogram(c,e.targetSelection);if(u.size>0)return Array.from(u.keys()).slice(0,20).map(f=>bn(f).generateSelectorAndLocator(f))}}}generateTargetSelectotionHistogram(e,n){let i=new Map,s=a(l=>{l.filter(c=>c instanceof HTMLElement).forEach(c=>{i.set(c,(i.get(c)||0)+1)})},"addElementstoHistogram");if(n.xpath)try{s(ap(e,n.xpath))}catch{}return n.cssSelectors.forEach(l=>{try{s(pe(l,e))}catch{}}),new Map([...i.entries()].sort((l,c)=>c[1]-l[1]))}calculateElementSize(e){let n=e.getBoundingClientRect();return{element:e,size:n.width*n.height}}buildSelectorForContextElement(e,{useTag:n=!0,useInnerFeatures:i=!0,useClasses:s=!0,useAttributes:l=!0}){let c=n?e.featuresMetadata.tag:"";s&&e.featuresMetadata.classes.length&&(c+="."+e.featuresMetadata.classes.map(u=>u.trim().replace(/([!\"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1")).join(".")),l&&(c+=Object.entries(e.featuresMetadata.attributes).map(([u,h])=>`[${u}="${h}"]`).join("")),i&&(c+=e.featuresMetadata.innerFeatures.filter(u=>!u.isRoot).map(u=>`:has(${_r(u)})`).join("")),e.selector=c}getSelectorCandidatesForContextElement(e){let n=this.buildSelectorsCombination(e.featuresMetadata);e.candidatesSelectors=[];for(let i=0;i<n.length&&e.candidatesSelectors.length<this.MAX_SELECTORS_PER_CONTEXT_ELEMENT;i++)document.querySelector(n[i])&&e.candidatesSelectors.push(n[i])}buildSelectorsCombination(e){let n=this.BASE_MAX_COMPONENTS_FOR_SELECTOR_COMBINATION,i=a(y=>{let S=[[]];for(let w=0;w<y.length;w++){let M=S.length;for(let T=0;T<M;T++)S.push(S[T].concat(y[w]))}return S},"getCombinations"),s=a(y=>y.trim().replace(/([!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1"),"escapeSelector"),l=e.tag,c=e.innerFeatures.filter(y=>!y.isRoot).map(y=>`:has(${_r(y)})`).slice(0,4),u=e.classes.map(y=>`.${s(y)}`),h=Object.entries(e.attributes).map(([y,S])=>`[${y}="${s(S)}"]`),f=a(()=>c.length+1+u.length+h.length>n,"exceedsMaxLength");for(;f()&&(u.pop(),!!f());)h.pop();let p=i([...u,...h,...c]),g=p.map(y=>[l,...y]);return p.push(...g),p.map(y=>y.join("")).filter(y=>y).sort((y,S)=>S.length-y.length)}extractFeaturesMetadata(e){e.forEach(n=>{n.featuresMetadata={id:n.element.getAttribute("id")??void 0,tag:n.element.tagName.toLowerCase(),innerText:this.innerTextExtractor.extract(n.element),innerFeatures:this.innerFeaturesExtractor.extract(n.element),classes:Array.from(n.element.classList).filter(i=>!Jt.includes(i))||[],attributes:Array.from(n.element.attributes).reduce((i,s)=>(["class","style","id"].includes(s.name)||(i[s.name]=s.value),i),{})}})}generateAllContextualSelectors(e,n){let i=[],s=[!0,!1];for(let c of s)for(let u of s)for(let h of s)i.push({useId:c,useClasses:u,useTag:h});let l=i.map(c=>this.createContextualSelector(e,n,c)).filter(c=>c).filter(c=>{try{let u=pe(c,e);return u.length===1&&u[0]===n}catch{return!1}});return[...new Set(l)]}createContextualSelector(e,n,{useId:i=!1,useClasses:s=!0,useTag:l=!0}){if(!e||!n)return null;let c=[],u=n;for(;u&&u!==e;)c.unshift(this.getSelectorPart(u,{useId:i,useClasses:s,useTag:l})),u=u.parentElement;return u?c.join(" ").trim():null}getSelectorPart(e,{useId:n=!1,useClasses:i=!0,useTag:s=!0}){if(n&&e.id&&e.id.match(/^\D/))return`#${e.id}`;let l=s?e.tagName.toLowerCase():"";if(i&&e.className){let c=e.className.trim().split(/\s+/).filter(u=>!Jt.includes(u)).map(Qi).join(".");c.length>0&&(l+="."+c)}return["name","label","aria-label","data-testid","role"].forEach(c=>{e.hasAttribute(c)&&(l+=`[${c}="${e.getAttribute(c)}"]`)}),l.trim()}getSmallestCommonRoot(e){let n=a(s=>{let l=[];for(;s;)l.push(s),s=s.parentElement;return l},"getAncestors"),i=n(e[0]);for(let s=1;s<e.length;s++){let l=n(e[s]);i=i.filter(c=>l.includes(c))}return i.length>0?i[0]:null}getSmallestCommonParentsFromMetadata(e){let n=e.map(i=>{try{let s=pe(i.selector);return i.selection.type==="content"?s.filter(l=>l.textContent===i.selection.value):s}catch{return[]}});return n.some(i=>i.length===0)?[]:this.getSmallestCommonParents(n)}getSmallestCommonParents(e){let n=new Set;ns(e).forEach(l=>{let c=this.getSmallestCommonRoot(l);c&&n.add(c)});let s=Array.from(n);return s.filter(l=>!s.some(c=>l!==c&&l.contains(c)))}};var ea=class{constructor(){this.MAX_SNIPPET_SIZE=12e3;this.MAX_LIONTAIL_SIZE=6e3;this.MAX_ATTRIBUTE_SIZE=100}static{a(this,"ParentChainReducer")}async reduce(e,n={useLionTail:!0,useChecksumIds:!0}){if(console.log("[ParentChainReducer] will reduce",e),!Be(e,"HTMLElement")&&!Be(e,"SVGElement"))throw new Error("Element is not an HTMLElement");return{reducedHTML:this.getAncestorsHTMLSnippet(e,n)}}getElementForChecksumId(e){return this.elementsInSimplifiedDomByChecksumId[e]}getAncestorsHTMLSnippet(e,{useLionTail:n=!0,useChecksumIds:i=!0}={}){this.elementsInSimplifiedDomByChecksumId={};let s=this.MAX_LIONTAIL_SIZE,l=this.MAX_ATTRIBUTE_SIZE,c=[],u=e;e.setAttribute("checksum-selected","true");try{for(;u;)c.push(u),u.parentNode&&u.parentNode instanceof ShadowRoot?u=u.parentNode.host:u=u.parentElement;c.reverse();let h=a(y=>{for(let S=y.attributes.length-1;S>=0;S--){let w=y.attributes[S];w.name.length+w.value.length>l&&y.removeAttribute(w.name)}return y},"normalizeNode"),f,p=new Fr;do{f=c[0].cloneNode(!1);let y=f,S=Ri(f);for(let w=1;w<c.length;w++){if(n){let T=Ri(c[w]).length;if(T<=s&&S.length+T<=this.MAX_SNIPPET_SIZE){let C=this.deepCloneNode(c[w],i?p:void 0);y.appendChild(C);break}}let M=h(c[w].cloneNode(c[w]===e));if(i){let T=p.getAndIncrement();M.setAttribute("checksumid",T),this.elementsInSimplifiedDomByChecksumId[T]=c[w]}y.appendChild(M),y=M}s=Math.max(s-10,0),l=Math.max(l-10,0)}while(f.outerHTML.length>this.MAX_SNIPPET_SIZE&&l>0);return this.filterNodeClasses(f),Ri(f,{limitAttributeLength:!0})}catch(h){console.error("Error while getting ancestors HTML snippet",h)}finally{e.removeAttribute("checksum-selected")}}deepCloneNode(e,n){let i=e.cloneNode(!1),s=[e],l=[i];for(;s.length;){let c=s.shift(),u=l.shift();for(let h=0;h<c.childNodes.length;h++){let f=c.childNodes[h],p=f.cloneNode(!1);if(u.appendChild(p),n&&Be(f,"HTMLElement")){let g=n.getAndIncrement();p.setAttribute("checksumid",g),this.elementsInSimplifiedDomByChecksumId[g]=f}s.push(f),l.push(p)}}return i}filterNodeClasses(e){let n=a(i=>{if("classList"in i){let s=i,l=s.classList;for(let c=0;c<l.length;c++){let u=l[c];Jt.includes(u)&&s.classList.remove(u)}for(let c=0;c<s.children.length;c++)n(s.children[c])}},"filterClasses");n(e)}};var ta=class{static{a(this,"FilesObserver")}constructor(e){this.fileInputsWithListeners=new Set,this.filesMap={},this.observer=null,this.sessionMirror=e}async getFilesByRrwebId(e){let n=this.filesMap[e]??[];try{let i=await Promise.all(n.map(async s=>({data:await kC(s),fileName:s.name})));return this.filesMap[e]=[],i}catch{console.log("Error while parsing files to base 64")}}init(){console.log("Starting observation..."),console.log(this.sessionMirror),this.observeDOMChanges(),window.addEventListener("unload",this.cleanup.bind(this))}handleFileChange(e){console.log("handleFileChange",this.sessionMirror);let n=e.target,i=Array.from(n.files||[]),s=this.sessionMirror.getMeta(n);this.filesMap[s.id]=i,console.log(`Files updated for ID: ${s.id}`,i)}addFileInputListeners(e){e.forEach(n=>{this.fileInputsWithListeners.has(n)||(n.addEventListener("change",this.handleFileChange.bind(this)),this.fileInputsWithListeners.add(n))})}observeDOMChanges(){let e=window.document,n=e.querySelectorAll('input[type="file"]');this.addFileInputListeners(n);let i=a(()=>{this.observer=new MutationObserver(l=>{l.forEach(c=>{if(c.type==="childList"){let u=c.target.querySelectorAll('input[type="file"]');this.addFileInputListeners(u)}})}),this.observer.observe(e.body,{childList:!0,subtree:!0})},"onBodyReady"),s=new MutationObserver(function(){e.body&&(s.disconnect(),i())});s.observe(e.documentElement,{childList:!0,subtree:!0})}cleanup(){console.log("Cleaning up files observer..."),this.observer&&this.observer.disconnect(),this.fileInputsWithListeners.forEach(e=>{e.removeEventListener("change",this.handleFileChange)}),this.fileInputsWithListeners.clear(),this.filesMap={}}},kC=a(t=>new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>{i.result?e(i.result.toString()):n(new Error("File reading failed"))},i.onerror=()=>{n(new Error("File reading failed"))},i.readAsDataURL(t)}),"convertFileToBase64");var na=class{constructor(e){this.sessionRecorder=e}static{a(this,"NativeDialogObserver")}init(){this.overrideDialog("alert"),this.overrideDialog("confirm"),this.overrideDialog("prompt")}overrideDialog(e){let n=window[e].bind(window);window[e]=i=>{let s=n(i),l=this.determineDialogAction(s,e);return this.sessionRecorder.addCustomEvent("native-dialog-event",{dialogType:e,dialogMessage:i,dialogResult:s,dialogAction:l}),s}}determineDialogAction(e,n){if(n==="alert")return"native_accept";if(n==="confirm")return e?"native_accept":"native_dismiss";if(n==="prompt")return e?"native_accept":"native_dismiss"}};var si=class t{constructor({rootDocument:e=document,getRenderDocument:n=a(c=>{},"getRenderDocument"),defaultView:i,topLevelInspector:s,rootDocumentForSelectorGenerator:l}={}){this.wasHoveredElementSelected=!1;this.selected=[];this.singleSelection=!0;this.subDocumentInspector=null;this.listening=!1;this.locatorCache=zc.getInstance();this.onMouseOut=a(e=>{Sn.clearHighlights()},"onMouseOut");this.onMouseOver=a(async e=>{let n=e.composedPath()[0];if("getRootNode"in n){let s=n.getRootNode();if(s!==this.rootDocument){this.handleSubDocument(s,this.defaultView);return}}if(Be(n,"HTMLIFrameElement")){this.handleSubDocument(n.contentDocument,n.contentDocument.defaultView);return}if(this.subDocumentInspector&&this.stopSubDocumentInspector(!0),!Be(n,"HTMLElement"))return;let i=n;if(!(i===this.hoveredElement||i.matches(".element-inspector-ignore"))){Sn.clearHighlights(),this.hoveredElement&&this.hoveredElement.removeEventListener("click",this.onClick,{capture:!0});try{let{locator:s,selector:l,parentFramesSelectors:c,locatorRrwebId:u}=await this.getInspectedElementSelection(i,this.rootDocumentForSelectorGenerator);if(Sn.highlightElement(i,{text:s.replace("frameLocator('iframe').",""),textPosition:"below",textWidthType:"auto",pointerEvents:"none",classNames:["element-inspector-ignore"],renderDocument:this.getRenderDocument(this.defaultView)}),u){let h=window.checksum.timeMachine.sessionReplayer.getNodeById(u);h&&Sn.highlightElement(h,{clear:!1,pointerEvents:"none",classNames:["element-inspector-ignore"],renderDocument:this.getRenderDocument(this.defaultView)})}this.hoveredElement=i,this.hoveredElementSelection={locator:s,selector:l,parentFramesSelectors:c},this.wasHoveredElementSelected=!1,n.addEventListener("click",this.onClick,{capture:!0})}catch(s){console.error("Error inspecting element",s.message)}}},"onMouseOver");this.onClick=a(async e=>{e.stopPropagation(),e.preventDefault(),!this.wasHoveredElementSelected&&(this.wasHoveredElementSelected=!0,this.selected.push(this.hoveredElementSelection),this.singleSelection&&(this.topLevelInspector?this.topLevelInspector.stop():this.stop()),window.parent.postMessage({type:"inspector-selection",data:this.selected.at(this.selected.length-1)},"*"))},"onClick");this.handleSubDocument=a((e,n)=>{if(this.subDocumentInspector){if(this.subDocumentInspector.rootDocument===e)return!0;this.stopSubDocumentInspector(!0)}return this.subDocumentInspector=new t({rootDocument:e,defaultView:n,topLevelInspector:this.topLevelInspector??this,getRenderDocument:this.getRenderDocument}),this.subDocumentInspector.start({singleSelection:this.singleSelection,timestamp:this.currentTimestamp}),!0},"handleSubDocument");this.stopSubDocumentInspector=a(e=>{this.subDocumentInspector&&(this.subDocumentInspector.stop(e),this.subDocumentInspector=null)},"stopSubDocumentInspector");this.rootDocument=e,this.topLevelInspector=s,this.getRenderDocument=n,this.defaultView=i??this.getDefaultView(),this.playwrightElementSelectorGenerator=new pt,this.rootDocumentForSelectorGenerator=l??this.getDefaultView().document}static{a(this,"ElementInspector")}getDefaultView(){let n=document.querySelector(".replayer-wrapper > iframe")?.contentDocument||null;return!n&&this.rootDocument.nodeType===Node.DOCUMENT_NODE&&(n=this.rootDocument),n||(n=document),n.defaultView}start({singleSelection:e,timestamp:n}={singleSelection:!0}){this.singleSelection=e,this.locatorCache.setTimestamp(n),this.currentTimestamp=n,this.stop(),this.cleanSelection(),this.rootDocument.addEventListener("mouseover",this.onMouseOver),this.rootDocument.addEventListener("mouseout",this.onMouseOut),this.listening=!0}stop(e=!1){this.listening&&(this.listening=!1,this.subDocumentInspector&&this.stopSubDocumentInspector(e),Sn.clearHighlights(),this.hoveredElement&&this.hoveredElement.removeEventListener("click",this.onClick,{capture:!0}),this.currentTimestamp=void 0,this.hoveredElement=null,this.wasHoveredElementSelected=!1,this.rootDocument.removeEventListener("mouseover",this.onMouseOver),e&&this.cleanSelection())}cleanSelection(){this.subDocumentInspector&&this.subDocumentInspector.cleanSelection(),this.selected=[]}consumeSelections(){if(this.subDocumentInspector)return this.subDocumentInspector.consumeSelections();let e=this.selected;return this.cleanSelection(),e}async getInspectedElementSelection(e,n){let i=this.locatorCache.getCachedLocatorForElement(e);if(!i){let{locator:s,selector:l,parentFramesSelectors:c}=await this.playwrightElementSelectorGenerator.getSelectorAndLocator(e,{rootDocument:n,ignoredIframesSelectors:[".replayer-wrapper > iframe"]}).catch(f=>({locator:"",selector:"",parentFramesSelectors:[]})),u=await this.playwrightElementSelectorGenerator.selector(l,c).catch(()=>e),h=u!==e?lp(u):void 0;i={locator:s,selector:l,parentFramesSelectors:c,locatorRrwebId:h},this.locatorCache.setCachedLocatorForElement(e,i)}return i}},zc=class t{constructor(){this.locatorCache=new Map}static{a(this,"InspectedElementCache")}static getInstance(){return t.instance||(t.instance=new t),t.instance}setTimestamp(e){this.currentTimestamp=e}getCachedLocatorForElement(e){try{return this.currentTimestamp?this.locatorCache.get(this.getKeyForElement(e)):void 0}catch{return}}setCachedLocatorForElement(e,n){this.currentTimestamp&&this.locatorCache.set(this.getKeyForElement(e),n)}getKeyForElement(e){let n=lp(e);if(!n)throw new Error("Can't find rrwebId for element");return`${n}_${this.currentTimestamp}`}};function lp(t){return window.checksum.timeMachine.sessionReplayer.getMeta(t)?.id}a(lp,"getNodeRrwebId");var qc=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Yc(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on".concat(e),n)}a(Yc,"addEvent");function no(t,e,n,i){t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on".concat(e),n)}a(no,"removeEvent");function dp(t,e){let n=e.slice(0,e.length-1);for(let i=0;i<n.length;i++)n[i]=t[n[i].toLowerCase()];return n}a(dp,"getMods");function hp(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");let e=t.split(","),n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}a(hp,"getKeys");function FC(t,e){let n=t.length>=e.length?t:e,i=t.length>=e.length?e:t,s=!0;for(let l=0;l<n.length;l++)i.indexOf(n[l])===-1&&(s=!1);return s}a(FC,"compareArray");var io={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":qc?173:189,"=":qc?61:187,";":qc?59:186,"'":222,"[":219,"]":221,"\\":220},sn={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},ia={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},at={16:!1,18:!1,17:!1,91:!1},Ke={};for(let t=1;t<20;t++)io["f".concat(t)]=111+t;var Ge=[],ro=null,fp="all",Mn=new Map,so=a(t=>io[t.toLowerCase()]||sn[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),"code"),PC=a(t=>Object.keys(io).find(e=>io[e]===t),"getKey"),HC=a(t=>Object.keys(sn).find(e=>sn[e]===t),"getModifier");function mp(t){fp=t||"all"}a(mp,"setScope");function oo(){return fp||"all"}a(oo,"getScope");function WC(){return Ge.slice(0)}a(WC,"getPressedKeyCodes");function VC(){return Ge.map(t=>PC(t)||HC(t)||String.fromCharCode(t))}a(VC,"getPressedKeyString");function BC(){let t=[];return Object.keys(Ke).forEach(e=>{Ke[e].forEach(n=>{let{key:i,scope:s,mods:l,shortcut:c}=n;t.push({scope:s,shortcut:c,mods:l,keys:i.split("+").map(u=>so(u))})})}),t}a(BC,"getAllKeyCodes");function GC(t){let e=t.target||t.srcElement,{tagName:n}=e,i=!0,s=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(s||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(i=!1),i}a(GC,"filter");function UC(t){return typeof t=="string"&&(t=so(t)),Ge.indexOf(t)!==-1}a(UC,"isPressed");function $C(t,e){let n,i;t||(t=oo());for(let s in Ke)if(Object.prototype.hasOwnProperty.call(Ke,s))for(n=Ke[s],i=0;i<n.length;)n[i].scope===t?n.splice(i,1).forEach(c=>{let{element:u}=c;return Xc(u)}):i++;oo()===t&&mp(e||"all")}a($C,"deleteScope");function zC(t){let e=t.keyCode||t.which||t.charCode,n=Ge.indexOf(e);if(n>=0&&Ge.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&Ge.splice(0,Ge.length),(e===93||e===224)&&(e=91),e in at){at[e]=!1;for(let i in sn)sn[i]===e&&(on[i]=!1)}}a(zC,"clearModifier");function pp(t){if(typeof t>"u")Object.keys(Ke).forEach(s=>{Array.isArray(Ke[s])&&Ke[s].forEach(l=>ra(l)),delete Ke[s]}),Xc(null);else if(Array.isArray(t))t.forEach(s=>{s.key&&ra(s)});else if(typeof t=="object")t.key&&ra(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];let[s,l]=n;typeof s=="function"&&(l=s,s=""),ra({key:t,scope:s,method:l,splitKey:"+"})}}a(pp,"unbind");var ra=a(t=>{let{key:e,scope:n,method:i,splitKey:s="+"}=t;hp(e).forEach(c=>{let u=c.split(s),h=u.length,f=u[h-1],p=f==="*"?"*":so(f);if(!Ke[p])return;n||(n=oo());let g=h>1?dp(sn,u):[],y=[];Ke[p]=Ke[p].filter(S=>{let M=(i?S.method===i:!0)&&S.scope===n&&FC(S.mods,g);return M&&y.push(S.element),!M}),y.forEach(S=>Xc(S))})},"eachUnbind");function cp(t,e,n,i){if(e.element!==i)return;let s;if(e.scope===n||e.scope==="all"){s=e.mods.length>0;for(let l in at)Object.prototype.hasOwnProperty.call(at,l)&&(!at[l]&&e.mods.indexOf(+l)>-1||at[l]&&e.mods.indexOf(+l)===-1)&&(s=!1);(e.mods.length===0&&!at[16]&&!at[18]&&!at[17]&&!at[91]||s||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(Ge),e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}a(cp,"eventHandler");function up(t,e){let n=Ke["*"],i=t.keyCode||t.which||t.charCode;if(!on.filter.call(this,t))return;if((i===93||i===224)&&(i=91),Ge.indexOf(i)===-1&&i!==229&&Ge.push(i),["metaKey","ctrlKey","altKey","shiftKey"].forEach(u=>{let h=ia[u];t[u]&&Ge.indexOf(h)===-1?Ge.push(h):!t[u]&&Ge.indexOf(h)>-1?Ge.splice(Ge.indexOf(h),1):u==="metaKey"&&t[u]&&(Ge=Ge.filter(f=>f in ia||f===i))}),i in at){at[i]=!0;for(let u in sn)sn[u]===i&&(on[u]=!0);if(!n)return}for(let u in at)Object.prototype.hasOwnProperty.call(at,u)&&(at[u]=t[ia[u]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(Ge.indexOf(17)===-1&&Ge.push(17),Ge.indexOf(18)===-1&&Ge.push(18),at[17]=!0,at[18]=!0);let s=oo();if(n)for(let u=0;u<n.length;u++)n[u].scope===s&&(t.type==="keydown"&&n[u].keydown||t.type==="keyup"&&n[u].keyup)&&cp(t,n[u],s,e);if(!(i in Ke))return;let l=Ke[i],c=l.length;for(let u=0;u<c;u++)if((t.type==="keydown"&&l[u].keydown||t.type==="keyup"&&l[u].keyup)&&l[u].key){let h=l[u],{splitKey:f}=h,p=h.key.split(f),g=[];for(let y=0;y<p.length;y++)g.push(so(p[y]));g.sort().join("")===Ge.sort().join("")&&cp(t,h,s,e)}}a(up,"dispatch");function on(t,e,n){Ge=[];let i=hp(t),s=[],l="all",c=document,u=0,h=!1,f=!0,p="+",g=!1,y=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(l=e.scope),e.element&&(c=e.element),e.keyup&&(h=e.keyup),e.keydown!==void 0&&(f=e.keydown),e.capture!==void 0&&(g=e.capture),typeof e.splitKey=="string"&&(p=e.splitKey),e.single===!0&&(y=!0)),typeof e=="string"&&(l=e),y&&pp(t,l);u<i.length;u++)t=i[u].split(p),s=[],t.length>1&&(s=dp(sn,t)),t=t[t.length-1],t=t==="*"?"*":so(t),t in Ke||(Ke[t]=[]),Ke[t].push({keyup:h,keydown:f,scope:l,mods:s,shortcut:i[u],method:n,key:i[u],splitKey:p,element:c});if(typeof c<"u"&&window){if(!Mn.has(c)){let S=a(function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return up(M,c)},"keydownListener"),w=a(function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;up(M,c),zC(M)},"keyupListenr");Mn.set(c,{keydownListener:S,keyupListenr:w,capture:g}),Yc(c,"keydown",S,g),Yc(c,"keyup",w,g)}if(!ro){let S=a(()=>{Ge=[]},"listener");ro={listener:S,capture:g},Yc(window,"focus",S,g)}}}a(on,"hotkeys");function qC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(Ke).forEach(n=>{Ke[n].filter(s=>s.scope===e&&s.shortcut===t).forEach(s=>{s&&s.method&&s.method()})})}a(qC,"trigger");function Xc(t){let e=Object.values(Ke).flat();if(e.findIndex(i=>{let{element:s}=i;return s===t})<0){let{keydownListener:i,keyupListenr:s,capture:l}=Mn.get(t)||{};i&&s&&(no(t,"keyup",s,l),no(t,"keydown",i,l),Mn.delete(t))}if((e.length<=0||Mn.size<=0)&&(Object.keys(Mn).forEach(s=>{let{keydownListener:l,keyupListenr:c,capture:u}=Mn.get(s)||{};l&&c&&(no(s,"keyup",c,u),no(s,"keydown",l,u),Mn.delete(s))}),Mn.clear(),Object.keys(Ke).forEach(s=>delete Ke[s]),ro)){let{listener:s,capture:l}=ro;no(window,"focus",s,l),ro=null}}a(Xc,"removeKeyEvent");var Kc={getPressedKeyString:VC,setScope:mp,getScope:oo,deleteScope:$C,getPressedKeyCodes:WC,getAllKeyCodes:BC,isPressed:UC,filter:GC,trigger:qC,unbind:pp,keyMap:io,modifier:sn,modifierMap:ia};for(let t in Kc)Object.prototype.hasOwnProperty.call(Kc,t)&&(on[t]=Kc[t]);if(typeof window<"u"){let t=window.hotkeys;on.noConflict=e=>(e&&window.hotkeys===on&&(window.hotkeys=t),on),window.hotkeys=on}var oa=class{constructor(){this.boundShortcuts=[]}static{a(this,"KeybindingsManager")}addKeybinding(e){let n=e.key.toLowerCase();if(this.boundShortcuts.includes(n))return;this.boundShortcuts.push(n),on(n,{capture:!0,keydown:!0},s=>{s.preventDefault(),e.callback(s)})}};var sa=class{constructor(e){this.keybindingsManager=new oa;this.createHandler=a(e=>({handlerFunc:a(n=>{try{e.handlerFunc(n)}finally{this.stopObserver()}},"handlerFunc"),handlerType:e.handlerType}),"createHandler");this.toHaveTextHandler=a(()=>e=>{let n=e?.data?.data,i=window.prompt(`Please enter the expected text for the element:
${n.locator}`);i!==null&&this.sessionRecorder.addCustomEvent("assertion",{matcher:`toHaveText("${i}")`,locator:n.locator})},"toHaveTextHandler");this.toBeVisibleHandler=a(()=>e=>{let n=e?.data?.data;this.sessionRecorder.addCustomEvent("assertion",{matcher:"toBeVisible()",locator:n.locator})},"toBeVisibleHandler");this.sessionRecorder=e}static{a(this,"AssertionsObserver")}init(){this.keybindingsManager.addKeybinding({key:"ctrl+\u2318+a",callback:a(()=>this.toggleObserver({handlerFunc:this.toHaveTextHandler(),handlerType:"toHaveText"}),"callback")}),this.keybindingsManager.addKeybinding({key:"ctrl+\u2318+s",callback:a(()=>this.toggleObserver({handlerFunc:this.toBeVisibleHandler(),handlerType:"toBeVisible"}),"callback")}),this.keybindingsManager.addKeybinding({key:"esc",callback:a(e=>{this.activeHandler&&(e.stopPropagation(),this.cleanUpHandler())},"callback")})}toggleObserver(e){if(this.activeHandler){this.cleanUpHandler();return}let n=this.createHandler(e);this.activeHandler=n,this.startObserver(),window.addEventListener("message",n.handlerFunc,{once:!0})}cleanUpHandler(){this.activeHandler&&(window.removeEventListener("message",this.activeHandler.handlerFunc),this.stopObserver(),this.activeHandler=null)}isInspectorActive(){return!!this.elementInspector}enableEventsFilter(){this.sessionRecorder.addCustomEvent("filter",{filter:{only:[{type:U.Custom,tag:"assertion"}],exclude:[]}})}disableEventsFilter(){this.sessionRecorder.addCustomEvent("filter",{filter:{only:[],exclude:[]}})}startObserver(){this.elementInspector=new si({rootDocument:window.document}),this.elementInspector.start(),this.enableEventsFilter()}stopObserver(){this.isInspectorActive()&&(this.elementInspector.stop(),this.elementInspector=null,this.disableEventsFilter(),this.cleanUpHandler())}};var YC="$checksum",aa=class{constructor(){this.testIdCounter=0;this.initialized=!1;Jr.setPrefix(YC),this.elementSelector=new pt,this.htmlReducer=new Pr,this.parentChainReducer=new ea,this.compoundSelector=new mr(this.htmlReducer)}static{a(this,"ChecksumTestGenerator")}getCompoundSelector(){return this.compoundSelector}betterTemplatizr(e){return en(e)}async buildCustomPlaywrightSelectors(e,n=[],i={},s=document){typeof e=="string"&&(e=this.htmlReducer.getElementForChecksumId(e));let l=n.map(c=>({...c,element:this.parentChainReducer.getElementForChecksumId(c.checksumId)})).filter(({element:c})=>!!c);return await new Kn(s).generate(e,l,{isPartOfListItem:!1,isForContextElement:!1,addCSSSelectorGenerator:!0,expandCSSKeyElements:!0,...i})}async buildArbitraryListItem(e){return typeof e=="string"&&(e=this.htmlReducer.getElementForChecksumId(e)),new Kn().generateArbitraryItemListSelector(e)}testElementSelector(e,n,i,s=!0){let l=typeof n=="string"?this.htmlReducer.getElementForChecksumId(n):n;return l?new Kn().testSelector(e,l,i,s):(console.error("Element not found",n),{valid:!1,error:"Element not found"})}async getParentChainHTML(e,n=!0,i=!0){return typeof e=="string"&&(e=this.htmlReducer.getElementForChecksumId(e)),(await this.parentChainReducer.reduce(e,{useLionTail:n,useChecksumIds:i})).reducedHTML}init(e,n={},{sessionRecorder:i=!0,filesObserver:s=!1,assertionsObserver:l=!1,nativeDialogObserver:c=!1}={}){this.appSpecificRules=e,this.config=n,!this.initialized&&(this.initialized=!0,i&&(this.sessionMirror=new $s((u,h)=>{u.isCheckout=h,window.checksumSendBroadcastMessage?.("rrweb",[u]),this.lastRrwebEventTimestamp=u.timestamp},n.recordOptions)),s&&(this.filesObserver=new ta(this.sessionMirror),this.filesObserver.init()),l&&(this.assertionsObserver=new sa(this.sessionMirror),this.assertionsObserver.init()),c&&(this.nativeDialogObserver=new na(this.sessionMirror),this.nativeDialogObserver.init()),this.sessionMirror&&(this.sessionMirror.start(),this.htmlReducer.setSessionRecorder(this.sessionMirror)),hr.limitChildren=this.appSpecificRules?.esraSelectionRules?.limitChildren??[],hr.timeout=this.config.esraTimeout,this.config.showFrontendLogs?Jr.removePrefix():this.config.logPrefix?.length&&Jr.setPrefix(this.config.logPrefix))}getElementSelector(){return this.elementSelector}getLastSelectionLogs(){return this.currentESRASelector?this.currentESRASelector.getLastSelectionLogs():{}}getBestMatchingElementSimilarityScore(e){return this.currentESRASelector=new hr(e),this.currentESRASelector.selectOne().score}async extractESRAMetadata(e){return new mt(document).extract(e).toMetadata()}async select(e,n){return await this.elementSelector.selector(e,n)}async getSelectionDataForSelector(e,n){try{let i=await this.elementSelector.selector(e,n);if(!i)return console.warn("could not find element for selector: "+e),null;let{locator:s}=await this.elementSelector.getSelectorAndLocator(i,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),l=await this.extractESRAMetadata(i);return{generatedLocator:s,esraMetadata:l,selector:e,parentFramesSelectors:n}}catch(i){console.log("getMetadataForSelector exception",i);return}}async getMatchingElementSelectionData(e,{minSelectionScore:n,cachedSelector:i,staticMetadata:s}={minSelectionScore:.3},l=!1){try{let c,u,h;if(i&&(console.log("Trying to locate using cached selector",i),c=await this.elementSelector.selector(i)),!c){console.log("Trying to locate using ESRA",e),ts(s)&&console.log("and static data",s),this.currentESRASelector=new hr(e,s);let p=this.currentESRASelector.selectOne({minSelectionScore:n});p.score>=n?(c=p.candidate,u=p.score,h=p.clickOffset):console.log("Best matching element was below threshold",p)}if(console.log(c?[`Located with score ${u}`,c]:"Element not located"),!c)return;l&&new st(c).scrollIntoView(),this.highlightElement(c);let f=await this.makeMatchingElementSelectionData(c,u);return h&&(f.clickOffset=h),f}catch(c){console.log("getMatchingElementSelectionData exception",c);return}}getAllInteractableElementsForLastSelectQuery(){let e=this.currentESRASelector.getFinalCandidates();return Promise.all(e.map(async n=>({esraMetadata:n.esraMetadata,selectionData:await this.makeMatchingElementSelectionData(n.candidate,n.score)})))}async getInteractableElementsRaw(){return $t()}async getInteractableElements(){let e=$t(),n=new mt(document);return Promise.all(e.map(async i=>{let s=n.extract(i).toMetadata(),l=await this.makeMatchingElementSelectionData(i);return{esraMetadata:s,selectionData:l}}))}getCurrentESRASelector(){return this.currentESRASelector}startFlashingElementsDetection(){return this.htmlReducer.startFlashingElementsDetection()}async reduceHTML(e={},n={},i=document){let s=await this.htmlReducer.reduce(i,{...this.appSpecificRules,...e},n);if(this.lastRrwebEventTimestamp&&(s.lastRRwebEvent={timestamp:this.lastRrwebEventTimestamp}),n.extractESRAForInterpretationRequiredElements){console.log("Extracting ESRA for interpretation required elements...");let l=this.htmlReducer.getInteractableElementsInReducedHTML();s.elementsForNodeInterpretation=l.reduce((c,{checksumId:u,element:h})=>{if(!(h instanceof HTMLElement)||h.innerText?.trim().length)return c;let p=new mt(document).extract(h).toMetadata();return[...c,{checksumId:u,esraMetadata:p}]},[]),console.log("Done with ESRA extraction for interpretation required elements")}return s}getMoreItemsForTemplate(e,n={}){return this.htmlReducer.getMoreElementsFromTemplate(e,{...this.appSpecificRules,...n})}displayInterpretationForElements(e){this.clearHighlights(),this.htmlReducer.getInteractableElements().forEach(({checksumId:i,element:s})=>{let l=e[i];if(l){if(!s.isConnected){console.log(`Element ${i} is not connected to the DOM, skipping display`);return}this.highlightElement(s,{text:l,textType:"hover",clear:!1,textStyle:{width:"120px"}})}})}async overlayInteractableElementsWithChecksumId({reduceBeforeRender:e=!1,mode:n="full",textPosition:i=n==="tag"?"above":void 0,shouldFlipHighlightTextOutsideViewport:s=!0,scrollIntoView:l=!1,checksumId:c}={}){this.clearHighlights(),e&&await this.reduceHTML();let u=a((f,p,g)=>{if(!p.isConnected){console.log(`Element ${f} is not connected to the DOM, skipping display`);return}let{width:y,height:S}=p.getBoundingClientRect();if(y<=0||S<=0)return;function w(N){switch(n){case"tag":return{background:N,width:"initial",left:"-2px",border:`3px dashed ${N}`,"font-weight":"bold"};case"full":return{background:"black",height:"100%"}}}a(w,"getTextStyleByMode");function M(N){let A=["red","gold","green","steelBlue","orange","hotPink","darkViolet","brown"];return N?A[N%A.length]:"red"}a(M,"getColor");let T=M(g);function C(){switch(n){case"tag":return{outline:`3px dashed ${T}`};case"full":return{outline:"none"};case"selected":return{outline:"6px dashed red",opacity:"0.7"}}}a(C,"getHighlightStyle"),this.highlightElement(p,{text:f,clear:!1,highlightStyle:C(),...i?{textPosition:i}:{},textStyle:w(T),shouldFlipHighlightTextOutsideViewport:s})},"overlayElement");if(n==="selected"&&c){let f=await this.getElementForChecksumId(c);u(null,f,0);return}this.htmlReducer.getInteractableElementsInReducedHTML().filter(f=>!ut(f.element,{...Kl,scrollIntoView:l}).isHidden).forEach(({checksumId:f,element:p},g)=>{u(f,p,g)})}async getElementForChecksumId(e){return this.htmlReducer.getElementForChecksumId(e)}async getSelectorForChecksumId(e){let n=await this.htmlReducer.getSelectorForChecksumId(e),{element:i,innerText:s,...l}=n;return l}hasInnerTextByChecksumId(e){return this.htmlReducer.hasInnerTextByChecksumId(e)}async getSelectorByPosition(e,n){let i=document.elementFromPoint(e,n),{selector:s,locator:l,parentFramesSelectors:c}=await this.elementSelector.getSelectorAndLocator(i);return{selector:s,locator:l,parentFramesSelectors:c}}isInput(e){let n=pe(e);if(n.length)return["input","textarea"].includes(n[0].tagName.toLowerCase())}querySelectorExtended(e){return pe(e)}getReactTree(e){return Om(e)}isHidden(e,n){return ut(e,n)}showGrid(){this.removeGrid();let e=document.createElement("style");e.id="checksum_grid_style",e.innerHTML=`
                  .checksum_grid {
                        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAJ1JREFUaEPtksEJgDAUxX73H1oRxAECkSrppacXaNI1M8f84Kz7Idf95XP0kM3yVWSzIFORikgG+lqSWIytCFYnDSsiicXYimB10rAikliMrQhWJw0rIonF2IpgddKwIpJYjK0IVicNKyKJxdiKYHXSsCKSWIytCFYnDSsiicXYimB10rAikliMrQhWJw0rIonF2IpgddLwKSLx38Oej8ZiASoSUGMAAAAASUVORK5CYII=");
                        background-repeat: repeat;
                        background-size: 20px;
                        background-position: 0px 0px;
                        position: absolute;
                        top: 0;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        height: 100%;
                        z-index: 1000;
                  }
`,document.body.prepend(e);let n=document.createElement("div");n.classList.add("checksum_grid"),document.body.prepend(n)}removeGrid(){let e=document.querySelector("#checksum_grid_style");e&&e.remove();let n=document.querySelector(".checksum_grid");n&&n.remove()}clearHighlights(){Sn.clearHighlights()}highlightElement(e,n={}){this.config.skipElementHighlighting||Sn.highlightElement(e,n)}async getInspectedElementSelectionResultByRRwebId(e,n={ignoredIframesSelectors:[],fromTimeMachine:!1}){let s=await(n.fromTimeMachine?window.checksum.timeMachine.sessionReplayer:this.sessionMirror).getNodeById(e);if(s)return await this.elementSelector.getSelectorAndLocator(s,{ignoredIframesSelectors:n.ignoredIframesSelectors})}getNodeSelector(e){return new Hr().getSelector(e)}startListeningForHTMLChanges(){this.mutationDetector&&this.mutationDetector.stopListening(),this.mutationDetector=new zs(km),this.mutationDetector.startListening()}stopListeningForHTMLChanges(e){let n=this.mutationDetector.stopListening();switch(e){default:return n.map(i=>(i.innerText??i.textContent)?.trim())}}scrollScrollableElement(e,n,i){let s=this.sessionMirror.getNodeById(e);return!s||!(s instanceof Element)?{result:!1,error:"Element not found"}:st.scrollScrollableElement(s,n,i)}extractViewportHTML(){let e=document.documentElement,n={},i=a(c=>{let h=a(()=>c instanceof Element?c:Zt(c),"getElement")();if(!h)return!1;let f=h.getBoundingClientRect();return f.top<window.innerHeight&&f.bottom>0&&f.left<window.innerWidth&&f.right>0},"isInViewport"),s=a(c=>{let u=i(c),h=[];if(On(c).forEach(p=>{let g=s(p);g&&h.push(g)}),!u&&h.length===0)return null;let f=c.cloneNode(!1);if(c instanceof Element){let{canScrollX:p,canScrollY:g,progressX:y,progressY:S}=st.getScrollData(c),w=f,M=p||g,T={};p&&(w.setAttribute("data-scrollable-x","true"),w.setAttribute("data-scrollable-x-progress",y.toString()),T.x=y),g&&(w.setAttribute("data-scrollable-y","true"),w.setAttribute("data-scrollable-y-progress",S.toString()),T.y=S);let C=null;try{let{id:N}=this.sessionMirror.getMeta(c);N&&(w.setAttribute("rrwebId",N.toString()),C=N)}catch(N){console.error("Error adding rrwebId",c,N)}C&&M&&(n[C]=T)}return h.forEach(p=>{f.appendChild(p)}),f},"copyVisibleElements");return{html:s(e).outerHTML,scrollableElements:n}}async generateLocatorByRrwebId(e){let n=await this.sessionMirror.getNodeById(e);if(!n)return;let{locator:i}=await this.elementSelector.getSelectorAndLocator(n);return i}async scrollElementIntoViewByRrwebId(e){let n=await this.sessionMirror.getNodeById(e);return n?(new st(n).scrollIntoView(),!0):!1}async scrollIntoViewAndHighlight(e){let n=await this.elementSelector.selector(e);n&&(n.scrollIntoView(),this.highlightElement(n))}async recordScrollPosition(e){let n=await this.getElementForChecksumId(e);if(!n)return;let i=new st(n);i.getScrollableParentsPositions(),n._checksumScrollHelper=i}async restoreScrollPosition(e){let n=await this.getElementForChecksumId(e);!n||!("_checksumScrollHelper"in n)||(n._checksumScrollHelper.restore(),delete n._checksumScrollHelper)}async getElementCaptioningKeyForChecksumId(e){let n=this.htmlReducer.getElementForChecksumId(e);if(!n){console.warn(`Element with checksumId ${e} not found`);return}return Fm(n)}determineClosestNode(e,n,i){return Nc(e,i)-Nc(n,i)}addForceIncludeElement(e,n){this.htmlReducer.addForceIncludeElement({element:e,checksumid:n})}shouldCaptionElement(e,{recursive:n}={recursive:!0}){let i=this.htmlReducer.getElementForChecksumId(e);if(!i)return!1;let s=Nm,l=a(f=>{let p=f.parentElement;if(!p||p.nodeType!==Node.ELEMENT_NODE)return!1;let{width:g,height:y}=p.getBoundingClientRect(),{width:S,height:w}=f.getBoundingClientRect();return Math.abs(g-S)<15&&Math.abs(y-w)<15},"shouldCheckParent"),c=!1,u=i,h=a(()=>(c?u=u?.parentElement:c=!0,u),"getNextParent");for(;;){let f=h();if(s.some(p=>f.getAttribute(p))||f.querySelectorAll("[checksuminteractable]").length>0||s.filter(p=>f.querySelectorAll(`[${p}]`)).length===1)return!1;if(!n||!l(f))break}return!0}async makeMatchingElementSelectionData(e,n,i){try{let s=this.setAndGetTestId(e),l=this.getVisibleParent(e),c=this.setAndGetTestId(l),u=this.getElementAtCenterOfElement(e),h=this.setAndGetTestId(u),f={element:s,visibleElement:c===s?void 0:c,atPointElement:h===s||h===c?void 0:h},p=await this.elementSelector.getSelectorAndLocator(e,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),g=await this.elementSelector.getSelectorAndLocator(u,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),y=await this.elementSelector.getSelectorAndLocator(l,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),S={element:p?.selector,visibleElement:y?.selector,atPointElement:g?.selector},w={element:p?.parentFramesSelectors,visibleElement:y?.parentFramesSelectors,atPointElement:g?.parentFramesSelectors},M=a(k=>({tag:k.tagName.toLowerCase()}),"makeElementData"),T={element:M(e),visibleElement:f.visibleElement?M(l):void 0,atPointElement:f.atPointElement?M(u):void 0},C=a(async k=>k===e&&i?i:new mt(document).extract(k).toMetadata(),"makeESRAMetadata"),N={element:await C(e),visibleElement:f.visibleElement?await C(l):void 0,atPointElement:f.atPointElement?await C(u):void 0},A=p?.locator;return{testIds:f,selectors:S,parentFramesSelectors:w,elementData:T,score:n,esraMetadata:N,generatedLocator:A}}catch(s){return console.log("[makeMatchingElementSelectionData] exception",s),{testIds:{element:void 0},selectors:{element:void 0},parentFramesSelectors:{element:void 0},elementData:{element:void 0},esraMetadata:{element:void 0},generatedLocator:void 0}}}getElementAtCenterOfElement(e){let{x:n,y:i}=e.getBoundingClientRect(),s=e.ownerDocument.elementFromPoint(n,i);return s instanceof HTMLElement?s:void 0}setAndGetTestId(e){if(!e)return;let n=e.getAttribute("data-checksum-testid");if(n)return n;let i=(this.testIdCounter++).toString();return e.setAttribute("data-checksum-testid",i),i}getVisibleParent(e){return!(e instanceof HTMLElement)||e.offsetParent!==null?e:this.getVisibleParent(Zt(e))}};var la=class{constructor(e){this.timeMachine=e;this.seekbarMin=Date.now();this.seekbarMax=Date.now();this.listeningToTimeMachine=!1}static{a(this,"TimeMachineSeeker")}open(){let e=document.getElementById("time-machine-seekbar");e&&e.remove(),this.seekbarMax=Date.now(),console.log("Creating seekbar with min/max timestamp",this.seekbarMin,this.seekbarMax),console.log("Current timestamp",this.timeMachine.getCurrentTimestamp());let n=0,i=1,s=.001,l=document.createElement("div");l.id="time-machine-seekbar",l.style.position="absolute",l.style.width="90%",l.style.bottom="0",l.style.background="white",l.style.opacity="0.75",l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.style.padding="10px",l.style.margin="0 20px",l.style.gap="10px";let c=document.createElement("input");c.type="range",c.min=n.toString(),c.max=i.toString(),c.step=s.toString(),c.value=c.max,c.style.flexGrow="1";let u=document.createElement("span");u.textContent=this.formatTimestamp(this.seekbarMax);let h=document.createElement("button");h.textContent="Refresh",h.addEventListener("click",()=>{this.open()}),l.appendChild(c),l.appendChild(u),l.appendChild(h),c.addEventListener("input",()=>{let f=parseFloat(c.value),p=this.getTimestamp(f);console.log("Seeking to timestamp",p),u.textContent=this.formatTimestamp(p),this.timeMachine.goBack(p)}),document.body.appendChild(l),this.addTMListeners()}getTimestamp(e){let n=Math.round(this.seekbarMin+e*(this.seekbarMax-this.seekbarMin));return n>this.seekbarMax?this.seekbarMax:n<this.seekbarMin?this.seekbarMin:n}formatTimestamp(e){let n=Math.max(0,Math.floor((e-this.seekbarMin)/1e3)),i=Math.floor(n/60),s=n%60;return`${String(i).padStart(2,"0")}:${String(s).padStart(2,"0")}`}addTMListeners(){this.listeningToTimeMachine||(this.listeningToTimeMachine=!0,this.timeMachine.sessionReplayer.replayerListenersManager?.addListener(e=>{e==="Processing"?this.showTimeMachineLoading():this.hideTimeMachineLoading()}))}showTimeMachineLoading(){let e=document.createElement("div");e.id="time-machine-loading",e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.background="black",e.style.opacity="0.65",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center";let n=document.createElement("div");n.style.color="white",n.style.fontSize="20px",n.style.cursor="pointer",n.textContent="Loading (if stuck, click here)...",n.addEventListener("click",()=>{this.hideTimeMachineLoading()}),e.appendChild(n),document.body.appendChild(e)}hideTimeMachineLoading(){let e=document.getElementById("time-machine-loading");e&&e.remove()}};var ca=class extends Zr{constructor(){super({enableInteract:!0});this.shouldHandleEvents=!0;this.name="timeMachine"}static{a(this,"TimeMachine")}setEventHandlers(n,i=!0){this.shouldHandleEvents=i,super.setEventHandlers(n)}async handleEvents(n){try{n=n.filter(i=>i.timestamp>=(this.lastSeenTimestamp?this.lastSeenTimestamp:0)),n.length&&(this.lastSeenTimestamp=n[n.length-1].timestamp);for(let i of n)await this.eventProcessor.processEvent(i,this.shouldHandleEvents),await this.skipEvents([i])}catch(i){console.error(i)}}setShouldHandleEvents(n){this.shouldHandleEvents=n}async goBack(n,i={}){return n?this.sessionReplayer.goBack(n):this.goLive()}getElementByRRwebId(n){return this.sessionReplayer.getNodeById(n)}goLive(){return this.sessionReplayer.goLive()}getCurrentTimestamp(){return this.sessionReplayer.getCurrentTimestamp()}getFirstEventTimestamp(){return this.sessionReplayer.getFirstEventTimestamp()}setNewRRWebSeekMode(n){this.sessionReplayer.setNewRRWebSeekMode(n)}subscribeToEventCast(n,i,s){this.sessionReplayer.subscribeTo(n,i,s)}isConnected(){return this.sessionReplayer.isConnected()}unsubscribeFromEventCast(n){this.sessionReplayer.unsubscribeFrom(n)}openSeekbar(){this.seeker||(this.seeker=new la(this)),this.seeker.open()}};var gp=a(({locator:t,parentFramesSelectors:e=[]})=>e.reverse().reduce((n,i)=>`frameLocator('${i}').${n}`,t),"getNestedFramesSelection");var yp=Rr(_i());var ua=class{constructor(){this.esraExtractors=[];this.playwrightSelector=new pt}static{a(this,"TimeMachineElementSelection")}async getSelector(e,{extractPlaywrightSelector:n=!0,extractEsraMetadata:i=!0,rootDocument:s=document}={}){if(!e)return null;let l={};if(i)try{console.log("extracting ESRA metadata...");let c=this.getESRAExtractor(e).extract(e);l.esraMetadata=c.toMetadata(),console.log("ESRA metadata extraction complete")}catch(c){console.error("Failed to extract ESRA metadata",c)}if(n){let{selector:c,locator:u,parentFramesSelectors:h}=await this.playwrightSelector.getSelectorAndLocator(e,{ignoredIframesSelectors:[".replayer-wrapper > iframe"],rootDocument:s,flags:{originFlag:"timemachine"}});l.playwrightSelector=c,l.playwrightLocator=u,l.playwrightParentFramesSelectors=h}return l}getESRAExtractor(e){let n=e.ownerDocument;if(!n)throw console.warn("Node does not have an owner document",e),new Error("Node does not have an owner document");let i=this.esraExtractors.find(l=>l.isSameDocument(n));if(i)return i;let s=new mt(n);return this.esraExtractors.push(s),s}};var da=class t{static{a(this,"SequenceMatcher")}findSequence(e,n,i){for(let s=0;s<=e.length-n.length;s++){let l=this.findMatch(s,e,n,i);if(l!==null)return l}return null}findMatch(e,n,i,s){let l={},c=[];for(let u=0;u<i.length;u++){let h=n[e+u],f=i[u];if(!this.matchItem(f,h,l,s??h))return null;c.push(h)}return{items:c,token_values:l}}matchItem(e,n,i,s){if(Array.isArray(e)&&Array.isArray(n))return this.matchArray(e,n,i,s);if(typeof e=="object"&&e!==null&&typeof n=="object"&&n!==null){for(let l in e){let c=e[l],u=n[l];if(typeof c=="string"&&c.startsWith("$")){if(i[c]===void 0)i[c]={value:u,item:s};else if(i[c].value!==u)return!1}else if(typeof c=="object"&&c!==null){if(!this.matchItem(c,u,i,s))return!1}else if(c!==u)return!1}return!0}else return e===n}matchArray(e,n,i,s){for(let l=0;l<=n.length-e.length;l++){let c=n.slice(l,l+e.length),u=this.findSequence(c,e,s);if(u){for(let h in u.token_values)if(i[h]===void 0)i[h]={value:u.token_values[h].value,item:s};else if(i[h].value!==u.token_values[h].value)return!1;return!0}}return!1}runExample(){let e=[{x:"banana",id:"1gf3",class:"fruit",index:"3",details:{a:1,b:2,nested:{key:"value1"}},arr:[{a:3,b:2},{a:1,b:2}]},{y:"apple",id:"4gs2",class:"fruit",parentIndex:"3",index:"7",details:{a:1,b:2,nested:{key:"value1"}}}],n=[{class:"$1",index:"$2",details:{a:1,b:"$3",nested:{key:"$4"}},arr:[{a:1,b:"$5"}]},{class:"$1",parentIndex:"$2",details:{a:1,b:"$3",nested:{key:"$4"}}}],s=new t().findSequence(e,n);console.log(s)}};var KC=!1,ha=class extends Un{constructor(n){super();this.onStep=n;this.events=[];this.previousEvent=null;this.steps=[];this.lastInteractionEventIndex=0;this.sequences=[];this.sequenceMatcher=new da;this.inputFilter=void 0;this.clickFilter=void 0;this.releasePendingInputAction=a(()=>{this.log("releasePendingInputAction",this.inputFilter),clearTimeout(this.inputFilter.timeout),this.addStep({step:this.inputFilter.action,type:"action"}),this.inputFilter=void 0},"releasePendingInputAction");this.lastMouseDown=void 0;this.hasUndefinedFocus=!1;this.releasePendingClickActions=a((n=!0)=>{this.log("releasePendingClickActions",Date.now(),{addInteractions:n},this.clickFilter),this.clickFilter&&clearTimeout(this.clickFilter.timeout),n&&this.clickFilter.actions.forEach(i=>this.addStep({step:i,type:"action"})),this.clickFilter=void 0},"releasePendingClickActions");this.dragAndDropSequence={events:[{type:U.IncrementalSnapshot,data:{source:H.MouseInteraction,type:ie.MouseDown}},{type:U.IncrementalSnapshot,data:{source:H.Mutation,adds:[{parentId:"$dropzoneId",node:{id:"$draggableId"}}],removes:[{id:"$draggableId"}]}}],handler:a(async({token_values:{$dropzoneId:n,$draggableId:i},items:s})=>{let l=i.value,{selector:c}=await this.getNodeAndSelector(l,{timestamp:i.item.timestamp,revert:!1});if(!c)return;let u=n.value,{selector:h}=await this.getNodeAndSelector(u,{timestamp:n.item.timestamp});if(h)return console.log("Drag and drop",c.playwrightLocator,h.playwrightLocator),[this.makePageAction("drag_and_drop",s[0],c,{dropTarget:{selector:h.playwrightSelector,locator:h.playwrightLocator,parentFramesSelectors:h.playwrightParentFramesSelectors,esraMetadata:h.esraMetadata,rrwebId:u}})]},"handler")};this.maxNumberOfGetNodeRetries=3;this.elementSelector=new ua,this.buildSequences()}static{a(this,"VisualTestGenerationTimeMachineEventHandlers")}log(...n){KC&&console.log(...n)}setSessionReplayer(){let n=window.parent.document.createElement("div");n.classList.add("live-tm"),n.style.display="none",window.parent.document.body.appendChild(n),this.sessionReplayer=new jr({enableInteract:!1,root:n,onlyLive:!0}),this.sessionReplayer.start({firstEventTimestamp:Date.now()})}getSteps(n=0){return this.steps.slice(n)}async preEvent(n){this.inputFilter&&ur(n)&&!this.isConsecutiveInputEvent(n)&&this.releasePendingInputAction(),this.clickFilter&&ur(n)&&await this.isConsecutiveCheckboxInputEvent(n)&&this.releasePendingClickActions(!1),this.clickFilter&&ur(n)&&!this.isConsecutiveMouseInteractionEvent(n)&&this.releasePendingClickActions(),this.events.push(n)}async postEvent(n,i,s=!0){this.sessionReplayer.fastForward([n]),this.previousEvent=n}async handleInput(n,i,s=!1){if(this.inputFilter){this.inputFilter.action.fillValue=n.text,this.inputFilter.timeout=this.setInputWaitTimeout();return}if(!n.userTriggered)return;let{node:l,selector:c}=await this.getNodeAndSelector(n.id);if(!l||!c)return;let u=this.makePageAction(this.getInputEventCode(l,n),i,c);if(u.rrwebId=n.id,u.eventCode==="input"){u.timestamp=this.previousEvent?.timestamp??i.timestamp,u.fillValue=n.text,this.inputFilter={action:u,nodeId:n.id,contenteditable:s,timeout:this.setInputWaitTimeout()};return}u.eventCode==="selectoption"&&(u.fillValue=n.text),u.eventCode==="upload_files"&&(u.files=[],u.files.push(n.text.split("\\").pop())),this.addStep({step:u,type:"action"})}isConsecutiveInputEvent(n){return this.inputFilter?this.inputFilter.contenteditable?n.type===U.Custom&&n.data.tag==="contenteditable-input"&&n.data.payload.id===this.inputFilter.nodeId:n.type===U.IncrementalSnapshot&&n.data.source===H.Input&&n.data.id===this.inputFilter.nodeId&&!!n.data.userTriggered:!1}setInputWaitTimeout(){return this.inputFilter?.timeout&&clearTimeout(this.inputFilter.timeout),setTimeout(this.releasePendingInputAction,1e3)}handleContentEditableInput(n,i){this.handleInput({userTriggered:!0,id:n.id,text:n.text,isChecked:!1,source:H.Input},i,!0)}handleNativeDialog(n,i){try{let{dialogAction:s,dialogType:l,dialogResult:c,dialogMessage:u}=n,h={dialogResult:c,dialogType:l,dialogMessage:u},f=this.makePageAction(s,i,{},{nativeDialog:h});this.addStep({step:f,type:"action"})}catch(s){console.error("handleNativeDialog",s)}}handleRecordAssertion(n,i){this.addStep({step:this.makeAssertion(n,i),type:"assertion"})}handleKeyStroke(n,i){}async handleMouseDown(n,i){let{selector:s}=await this.getNodeAndSelector(n.id);this.lastMouseDown={selector:s,data:n,event:i}}handleFocus(n,i){this.hasUndefinedFocus=n.id===-1}async handleClick(n,i){try{if(n.x===void 0||n.y===void 0)return;if(this.lastMouseDown&&this.lastMouseDown.data.id!==n.id&&this.hasUndefinedFocus){let c=this.makePageAction("click",this.lastMouseDown.event,this.lastMouseDown.selector);this.addStep({step:c,type:"action"});return}let{selector:s}=await this.getNodeAndSelector(n.id);if(!s)return;let l=this.makePageAction("click",i,s);if(this.log("handleClick",Date.now(),l),this.clickFilter){this.log("handleClick","adding to filter"),this.clickFilter.actions.push(l);return}this.clickFilter={actions:[l],nodeId:n.id,timeout:this.setClickWaitTimeout()}}finally{this.hasUndefinedFocus=!1,this.lastMouseDown=void 0}}isConsecutiveMouseInteractionEvent(n){return this.clickFilter?n.type===U.IncrementalSnapshot&&n.data.source===H.MouseInteraction&&n.data.id===this.clickFilter.nodeId:!1}async isConsecutiveCheckboxInputEvent(n){if(!this.clickFilter)return!1;let i=a(async s=>{let{node:l}=await this.getNodeAndSelector(this.clickFilter.nodeId);return["check","uncheck"].includes(this.getInputEventCode(l,s))},"isCheckboxInput");return n.type===U.IncrementalSnapshot&&n.data.source===H.Input&&n.data.userTriggered&&n.data.id===this.clickFilter.nodeId&&await i(n.data)}setClickWaitTimeout(){return this.clickFilter?.timeout&&clearTimeout(this.clickFilter.timeout),this.log("setClickWaitTimeout",Date.now()),setTimeout(this.releasePendingClickActions,600)}async handleDblClick(n,i){if(n.x===void 0||n.y===void 0)return;let{selector:s}=await this.getNodeAndSelector(n.id),l=this.makePageAction("double_click",i,s);this.log("handleDblClick",l),this.addStep({step:l,type:"action"}),this.releasePendingClickActions(!1)}buildSequences(){this.sequences.push(this.dragAndDropSequence)}async performSequenceSearch(){let n=this.events.slice(this.lastInteractionEventIndex);for(let i of this.sequences){let s=this.sequenceMatcher.findSequence(n,i.events);if(s){let l=await i.handler(s);l&&l.forEach(c=>this.addStep({step:c,type:"action"}))}}await this.sessionReplayer.goLive()}addStep(n){n.type==="action"&&!n.step.id&&(n.step.id=Date.now().toString()),this.steps.push(n),this.lastInteractionEventIndex=this.events.length,this.log("addStep",n),this.onStep?.(n)}makeAssertion(n,i){return{matcher:n.matcher,locator:n.locator,thought:n.thought,timestamp:i.timestamp,id:n?.id||Date.now().toString()}}makePageAction(n,i,s,l={}){return console.log("making action with ts",i.timestamp,Date.now()-i.timestamp),{eventCode:n,selector:s.playwrightSelector,locator:gp({locator:s.playwrightLocator,parentFramesSelectors:s.playwrightParentFramesSelectors}),esraMetadata:s.esraMetadata,pageId:void 0,timestamp:i.timestamp,id:l?.id||Date.now().toString(),rrwebId:i.data?.id,...l,parentFramesSelectors:[]}}async getNodeById(n,{retriesLeft:i=this.maxNumberOfGetNodeRetries,useCompoundInteractableDetection:s=!0}={}){if(!i)return console.error("no node"),null;let l=this.sessionReplayer.getNodeById(n);return l?s?sr(l,[]):l:(await(0,yp.default)(100*(this.maxNumberOfGetNodeRetries-i+1)),this.getNodeById(n,{retriesLeft:i-1,useCompoundInteractableDetection:s}))}getInputEventCode(n,i){if(n.tagName.toLowerCase()==="select")return"selectoption";switch(n.getAttribute("type")){case"file":return"upload_files";case"checkbox":case"radio":return i.isChecked?"check":"uncheck";case"text":default:return"input"}}async getNodeAndSelector(n,{timestamp:i,revert:s=!0}={}){i&&await this.sessionReplayer.goBack(i);let l=await this.getNodeById(n);if(!l)return{};let c=await this.elementSelector.getSelector(l,{extractEsraMetadata:!1,rootDocument:this.sessionReplayer.getIframeDocument()});return c?(i&&s&&await this.sessionReplayer.goLive(),{node:l,selector:c}):{node:l}}};var fa=class{constructor(e){this.timeMachine=e;this.sendRecordedSteps=!1;this.onNewRecordedStep=a(e=>{this.sendRecordedSteps&&window.parent.postMessage({type:"new-recorded-step",data:[e]})},"onNewRecordedStep");this.eventHandlers=new ha(this.onNewRecordedStep)}static{a(this,"VisualTestGenerator")}init(){this.timeMachine.setEventHandlers(this.eventHandlers,!0)}setSendRecordedSteps(e){this.sendRecordedSteps=e}startInspector({singleSelection:e=!0,rootDocument:n,timestamp:i}={}){this.stopInspector();let s=a(l=>l.top.document.querySelector("iframe.time-machine-iframe").contentDocument,"getRenderDocument");this.elementInspector=new si({rootDocument:n??this.getRRwebReplayerDocument(),getRenderDocument:s,rootDocumentForSelectorGenerator:this.getRRwebReplayerDocument()}),this.elementInspector.start({singleSelection:e,timestamp:i})}getRRwebReplayerDocument(){return document.querySelector(".replayer-wrapper > iframe").contentDocument}stopInspector(){this.elementInspector?.stop()}consumeSelections(){return this.elementInspector.consumeSelections()}};(function(){let t=Element.prototype.addEventListener;Element.prototype.addEventListener=function(e,n,i){t.call(this,e,n,i),this._checksum_eventListenerList||(this._checksum_eventListenerList={}),this._checksum_eventListenerList[e]||(this._checksum_eventListenerList[e]=[]),this._checksum_eventListenerList[e].push(n)}})();if(!window.checksum){let t=new aa,e=new Ps,n=new ca,i=new fa(n);window.checksum={testGenerator:t,sessionDigester:e,timeMachine:n,visualTestGenerator:i}}})();
/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

rrweb/dist/rrweb.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
