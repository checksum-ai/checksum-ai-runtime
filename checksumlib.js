(()=>{var Ib=Object.create;var Ts=Object.defineProperty;var Cb=Object.getOwnPropertyDescriptor;var Rb=Object.getOwnPropertyNames;var Ab=Object.getPrototypeOf,_b=Object.prototype.hasOwnProperty;var a=(n,e)=>Ts(n,"name",{value:e,configurable:!0});var Ms=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Nb=(n,e)=>{for(var t in e)Ts(n,t,{get:e[t],enumerable:!0})},Lb=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Rb(e))!_b.call(n,o)&&o!==t&&Ts(n,o,{get:()=>e[o],enumerable:!(i=Cb(e,o))||i.enumerable});return n};var di=(n,e,t)=>(t=n!=null?Ib(Ab(n)):{},Lb(e||!n||!n.__esModule?Ts(t,"default",{value:n,enumerable:!0}):t,n));var rh=Ms((Ds,fl)=>{(function(n,e){typeof Ds=="object"&&typeof fl=="object"?fl.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ds=="object"?Ds.resq=e():(n.window=n.window||{},n.window.resq=e())})(window,function(){return function(n){var e={};function t(i){if(e[i])return e[i].exports;var o=e[i]={i,l:!1,exports:{}};return n[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return a(t,"r"),t.m=n,t.c=e,t.d=function(i,o,l){t.o(i,o)||Object.defineProperty(i,o,{enumerable:!0,get:l})},t.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},t.t=function(i,o){if(1&o&&(i=t(i)),8&o||4&o&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(t.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),2&o&&typeof i!="string")for(var c in i)t.d(l,c,function(d){return i[d]}.bind(null,c));return l},t.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return t.d(o,"a",o),o},t.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},t.p="",t(t.s=16)}([function(n,e,t){"use strict";t.d(e,"a",function(){return O}),t.d(e,"d",function(){return Q}),t.d(e,"b",function(){return se}),t.d(e,"c",function(){return fe});var i=t(1),o=t.n(i),l=t(14),c=t.n(l),d=t(2),h=t.n(d),f=t(15),p=t.n(f);function g(V,B){var X=Object.keys(V);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(V);B&&(K=K.filter(function(z){return Object.getOwnPropertyDescriptor(V,z).enumerable})),X.push.apply(X,K)}return X}a(g,"l");var v=Array.isArray,b=Object.keys;function T(V){return typeof V=="function"}a(T,"x");function S(V){return V instanceof HTMLElement||V instanceof Text}a(S,"y");function C(V){return h()(V)==="object"&&!v(V)}a(C,"h");function x(V){if(!V||typeof V=="string")return V;var B=function(X){for(var K=1;K<arguments.length;K++){var z=arguments[K]!=null?arguments[K]:{};K%2?g(Object(z),!0).forEach(function(J){c()(X,J,z[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(X,Object.getOwnPropertyDescriptors(z)):g(Object(z)).forEach(function(J){Object.defineProperty(X,J,Object.getOwnPropertyDescriptor(z,J))})}return X}({},V);return delete B.children,B}a(x,"b");function _(V,B){var X=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return!(!v(V)||!v(B))&&(X?V.length===B.length&&!V.find(function(K){return!B.includes(K)}):V.some(function(K){return B.includes(K)}))}a(_,"v");function R(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=arguments.length>2&&arguments[2]!==void 0&&arguments[2],K=[];if(!b(V).length)return!0;if(B===null||!b(B).length)return!1;if(X)return p()(V,B);var z=b(V).filter(function(J){return b(B).includes(J)});return z.forEach(function(J){C(V[J])&&C(B[J])&&(K=K.concat(R(V[J],B[J]))),(V[J]===B[J]||_(V[J],B[J]))&&K.push(B)}),K.length>0&&K.filter(function(J){return J}).length===z.length}a(R,"_");function O(V){var B,X={children:[]};if(!V)return X;X.name=T(B=V.type)?B.displayName||B.name:B,X.props=x(V.memoizedProps),X.state=function(z){if(z){var J=z.baseState;return J||z}}(V.memoizedState);var K=V.child;if(K)for(X.children.push(K);K.sibling;)X.children.push(K.sibling),K=K.sibling;return X.children=X.children.map(function(z){return O(z)}),T(V.type)&&function(z){return z.children.length>1}(X)?(X.node=function(z){return z.children.map(function(J){return J.node}).filter(function(J){return!!J})}(X),X.isFragment=!0):X.node=function(z){return S(z.stateNode)?z.stateNode:z.child&&S(z.child.stateNode)?z.child.stateNode:null}(V),X}a(O,"m");function U(V){for(;V.length;){var B=V.shift();if(B.node)return B.node;B.children&&Array.isArray(B.children)&&V.push.apply(V,o()(B.children))}}a(U,"g");function Y(V,B){for(var X=[];V.length;){var K=V.shift().children;K&&Array.isArray(K)&&K.forEach(function(z){B(z)&&(!z.node&&Array.isArray(z.children)&&(z.node=U(z.children.concat([]))),X.push(z)),V.push(z)})}return X}a(Y,"O");function le(V,B){var X=function(K){if(K){var z=K.split("(");return z.length===1?K:z.find(function(J){return J.includes(")")}).replace(/\)*/g,"")}}(B);return new RegExp("^"+V.split("*").map(function(K){return K.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join(".+")+"$").test(X)}a(le,"w");function Q(V,B){var X=arguments.length>3?arguments[3]:void 0;return V.reduce(function(K,z){return K.concat(Y(K,X&&typeof X=="function"?X:function(J){return typeof J.name=="string"?le(z,J.name):J.name!==null&&h()(J.name)==="object"&&le(z,J.name.displayName)}))},[B])}a(Q,"j");function se(V,B,X){var K=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return T(X)?(console.warn("Functions are not supported as filter matchers"),[]):V.filter(function(z){return C(X)&&R(X,z[B],K)||v(X)&&_(X,z[B],K)||z[B]===X})}a(se,"M");function fe(V){if(V.hasOwnProperty("_reactRootContainer"))return V._reactRootContainer._internalRoot.current;var B=Object.keys(V).find(function(X){return X.startsWith("__reactInternalInstance")||X.startsWith("__reactFiber")||X.startsWith("__reactContainer")});return B?V[B]:void 0}a(fe,"P")},function(n,e,t){var i=t(17),o=t(18),l=t(19),c=t(20);n.exports=function(d){return i(d)||o(d)||l(d)||c()},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?(n.exports=t=a(function(o){return typeof o},"r"),n.exports.default=n.exports,n.exports.__esModule=!0):(n.exports=t=a(function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},"r"),n.exports.default=n.exports,n.exports.__esModule=!0),t(i)}a(t,"r"),n.exports=t,n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){function t(i){return n.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},n.exports.default=n.exports,n.exports.__esModule=!0,t(i)}a(t,"r"),n.exports=t,n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){function t(i,o){for(var l=0;l<o.length;l++){var c=o[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(i,c.key,c)}}a(t,"r"),n.exports=function(i,o,l){return o&&t(i.prototype,o),l&&t(i,l),i},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){function t(i,o){return n.exports=t=Object.setPrototypeOf||function(l,c){return l.__proto__=c,l},n.exports.default=n.exports,n.exports.__esModule=!0,t(i,o)}a(t,"r"),n.exports=t,n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){var i=t(6);n.exports=function(o,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(l&&l.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),l&&i(o,l)},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){var i=t(3),o=t(6),l=t(22),c=t(23);function d(h){var f=typeof Map=="function"?new Map:void 0;return n.exports=d=a(function(p){if(p===null||!l(p))return p;if(typeof p!="function")throw new TypeError("Super expression must either be null or a function");if(f!==void 0){if(f.has(p))return f.get(p);f.set(p,g)}function g(){return c(p,arguments,i(this).constructor)}return a(g,"e"),g.prototype=Object.create(p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),o(g,p)},"c"),n.exports.default=n.exports,n.exports.__esModule=!0,d(h)}a(d,"c"),n.exports=d,n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch{typeof window=="object"&&(t=window)}n.exports=t},function(n,e){n.exports=function(t,i){(i==null||i>t.length)&&(i=t.length);for(var o=0,l=new Array(i);o<i;o++)l[o]=t[o];return l},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){"use strict";(function(i){t.d(e,"a",function(){return l});var o=t(0);function l(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5e3,d=arguments.length>1?arguments[1]:void 0;if(i.isReactLoaded)return Promise.resolve("React already loaded");var h=a(function(){var f=document.createTreeWalker(document);if(d)return document.querySelector(d);for(;f.nextNode();)if(f.currentNode.hasOwnProperty("_reactRootContainer"))return f.currentNode},"o");return new Promise(function(f,p){var g=!1,v=null;a(function b(){var T=h();if(T&&(i.isReactLoaded=!0,i.rootReactElement=Object(o.c)(T),i.rootReactElement))return clearTimeout(v),f();g||setTimeout(b,200)},"e")(),v=setTimeout(function(){g=!0,p("Timed out")},c)})}a(l,"o")}).call(this,t(9))},function(n,e,t){"use strict";t.d(e,"a",function(){return U});var i=t(1),o=t.n(i),l=t(4),c=t.n(l),d=t(5),h=t.n(d),f=t(7),p=t.n(f),g=t(13),v=t.n(g),b=t(3),T=t.n(b),S=t(8),C=t.n(S),x=t(0);function _(Y){var le=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var Q,se=T()(Y);if(le){var fe=T()(this).constructor;Q=Reflect.construct(se,arguments,fe)}else Q=se.apply(this,arguments);return v()(this,Q)}}a(_,"v");var R=function(Y){p()(Q,Y);var le=_(Q);function Q(se){return c()(this,Q),se||(se=[]),le.call.apply(le,[this].concat(o()(se)))}return a(Q,"r"),h()(Q,[{key:"byProps",value:a(function(se){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},V=fe.exact,B=Object(x.b)(this,"props",se,V);return new Q(B)},"value")},{key:"byState",value:a(function(se){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},V=fe.exact,B=Object(x.b)(this,"state",se,V);return new Q(B)},"value")}]),Q}(C()(Array)),O=function(Y){p()(Q,Y);var le=_(Q);function Q(se,fe){var V;for(var B in c()(this,Q),(V=le.call(this,se))._nodes=fe,se)V[B]=se[B];return V}return a(Q,"r"),h()(Q,[{key:"byProps",value:a(function(se){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},V=fe.exact,B=Object(x.b)(this._nodes,"props",se,V)[0];return new Q(B,this._nodes)},"value")},{key:"byState",value:a(function(se){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{exact:!1},V=fe.exact,B=Object(x.b)(this._nodes,"state",se,V)[0];return new Q(B,this._nodes)},"value")}]),Q}(C()(Object)),U=function(){function Y(le,Q){c()(this,Y),this.selectors=le.split(" ").filter(function(se){return!!se}).map(function(se){return se.trim()}),this.rootComponent=Q,this.tree=Object(x.a)(this.rootComponent)}return a(Y,"t"),h()(Y,[{key:"find",value:a(function(){return this.nodes=new R(Object(x.d)(this.selectors,this.tree,!0)),new O(this.nodes[0],this.nodes)},"value")},{key:"findAll",value:a(function(){return new R(Object(x.d)(this.selectors,this.tree))},"value")}]),Y}()},function(n,e,t){var i=t(2).default,o=t(21);n.exports=function(l,c){return!c||i(c)!=="object"&&typeof c!="function"?o(l):c},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(t,i,o){return i in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o,t},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){"use strict";var i=Array.isArray,o=Object.keys,l=Object.prototype.hasOwnProperty;n.exports=a(function c(d,h){if(d===h)return!0;if(d&&h&&typeof d=="object"&&typeof h=="object"){var f,p,g,v=i(d),b=i(h);if(v&&b){if((p=d.length)!=h.length)return!1;for(f=p;f--!=0;)if(!c(d[f],h[f]))return!1;return!0}if(v!=b)return!1;var T=d instanceof Date,S=h instanceof Date;if(T!=S)return!1;if(T&&S)return d.getTime()==h.getTime();var C=d instanceof RegExp,x=h instanceof RegExp;if(C!=x)return!1;if(C&&x)return d.toString()==h.toString();var _=o(d);if((p=_.length)!==o(h).length)return!1;for(f=p;f--!=0;)if(!l.call(h,_[f]))return!1;for(f=p;f--!=0;)if(!c(d[g=_[f]],h[g]))return!1;return!0}return d!=d&&h!=h},"t")},function(n,e,t){"use strict";t.r(e),function(i){t.d(e,"resq$",function(){return h}),t.d(e,"resq$$",function(){return f});var o=t(12),l=t(11);t.d(e,"waitToLoadReact",function(){return l.a});var c=t(0);function d(p,g,v){if(!v&&!i.isReactLoaded)throw new Error("Could not find the root element of your application");var b=i.rootReactElement;if(v instanceof HTMLElement&&(b=Object(c.c)(v)),!b)throw new Error("Could not find instance of React in given element");return new o.a(p,b)[g]()}a(d,"i");function h(p,g){return d(p,"find",g)}a(h,"c");function f(p,g){return d(p,"findAll",g)}a(f,"f")}.call(this,t(9))},function(n,e,t){var i=t(10);n.exports=function(o){if(Array.isArray(o))return i(o)},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){var i=t(10);n.exports=function(o,l){if(o){if(typeof o=="string")return i(o,l);var c=Object.prototype.toString.call(o).slice(8,-1);return c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set"?Array.from(o):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i(o,l):void 0}},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(t){return Function.toString.call(t).indexOf("[native code]")!==-1},n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e,t){var i=t(6),o=t(24);function l(c,d,h){return o()?(n.exports=l=Reflect.construct,n.exports.default=n.exports,n.exports.__esModule=!0):(n.exports=l=a(function(f,p,g){var v=[null];v.push.apply(v,p);var b=new(Function.bind.apply(f,v));return g&&i(b,g.prototype),b},"u"),n.exports.default=n.exports,n.exports.__esModule=!0),l.apply(null,arguments)}a(l,"u"),n.exports=l,n.exports.default=n.exports,n.exports.__esModule=!0},function(n,e){n.exports=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}},n.exports.default=n.exports,n.exports.__esModule=!0}])})});var po=Ms((SR,Cf)=>{Cf.exports=n=>new Promise(e=>setTimeout(e,n))});var Nf=Ms((Wr,Ni)=>{(function(){var n,e="4.17.21",t=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,h="__lodash_placeholder__",f=1,p=2,g=4,v=1,b=2,T=1,S=2,C=4,x=8,_=16,R=32,O=64,U=128,Y=256,le=512,Q=30,se="...",fe=800,V=16,B=1,X=2,K=3,z=1/0,J=9007199254740991,ye=17976931348623157e292,nt=NaN,$e=4294967295,W=$e-1,P=$e>>>1,te=[["ary",U],["bind",T],["bindKey",S],["curry",x],["curryRight",_],["flip",le],["partial",R],["partialRight",O],["rearg",Y]],ee="[object Arguments]",Oe="[object Array]",ht="[object AsyncFunction]",Qe="[object Boolean]",ot="[object Date]",en="[object DOMException]",fn="[object Error]",tn="[object Function]",Te="[object GeneratorFunction]",Pe="[object Map]",Ce="[object Number]",ke="[object Null]",Ue="[object Object]",xe="[object Promise]",qr="[object Proxy]",zr="[object RegExp]",kt="[object Set]",jr="[object String]",Oi="[object Symbol]",qf="[object Undefined]",Xr="[object WeakMap]",zf="[object WeakSet]",Kr="[object ArrayBuffer]",sr="[object DataView]",Bo="[object Float32Array]",Wo="[object Float64Array]",Vo="[object Int8Array]",$o="[object Int16Array]",Uo="[object Int32Array]",Go="[object Uint8Array]",qo="[object Uint8ClampedArray]",zo="[object Uint16Array]",jo="[object Uint32Array]",jf=/\b__p \+= '';/g,Xf=/\b(__p \+=) '' \+/g,Kf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yc=/&(?:amp|lt|gt|quot|#39);/g,vc=/[&<>"']/g,Yf=RegExp(yc.source),Qf=RegExp(vc.source),Zf=/<%-([\s\S]+?)%>/g,Jf=/<%([\s\S]+?)%>/g,Ec=/<%=([\s\S]+?)%>/g,em=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tm=/^\w*$/,nm=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xo=/[\\^$.*+?()[\]{}|]/g,rm=RegExp(Xo.source),Ko=/^\s+/,im=/\s/,sm=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,om=/\{\n\/\* \[wrapped with (.+)\] \*/,am=/,? & /,lm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,cm=/[()=,{}\[\]\/\s]/,um=/\\(\\)?/g,dm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Sc=/\w*$/,hm=/^[-+]0x[0-9a-f]+$/i,fm=/^0b[01]+$/i,mm=/^\[object .+?Constructor\]$/,pm=/^0o[0-7]+$/i,gm=/^(?:0|[1-9]\d*)$/,ym=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=/($^)/,vm=/['\n\r\u2028\u2029\\]/g,Fi="\\ud800-\\udfff",Em="\\u0300-\\u036f",Sm="\\ufe20-\\ufe2f",bm="\\u20d0-\\u20ff",bc=Em+Sm+bm,wc="\\u2700-\\u27bf",Tc="a-z\\xdf-\\xf6\\xf8-\\xff",wm="\\xac\\xb1\\xd7\\xf7",Tm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mm="\\u2000-\\u206f",xm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Mc="A-Z\\xc0-\\xd6\\xd8-\\xde",xc="\\ufe0e\\ufe0f",Ic=wm+Tm+Mm+xm,Yo="['\u2019]",Im="["+Fi+"]",Cc="["+Ic+"]",Pi="["+bc+"]",Rc="\\d+",Cm="["+wc+"]",Ac="["+Tc+"]",_c="[^"+Fi+Ic+Rc+wc+Tc+Mc+"]",Qo="\\ud83c[\\udffb-\\udfff]",Rm="(?:"+Pi+"|"+Qo+")",Nc="[^"+Fi+"]",Zo="(?:\\ud83c[\\udde6-\\uddff]){2}",Jo="[\\ud800-\\udbff][\\udc00-\\udfff]",or="["+Mc+"]",Lc="\\u200d",Dc="(?:"+Ac+"|"+_c+")",Am="(?:"+or+"|"+_c+")",Oc="(?:"+Yo+"(?:d|ll|m|re|s|t|ve))?",kc="(?:"+Yo+"(?:D|LL|M|RE|S|T|VE))?",Fc=Rm+"?",Pc="["+xc+"]?",_m="(?:"+Lc+"(?:"+[Nc,Zo,Jo].join("|")+")"+Pc+Fc+")*",Nm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Lm="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hc=Pc+Fc+_m,Dm="(?:"+[Cm,Zo,Jo].join("|")+")"+Hc,Om="(?:"+[Nc+Pi+"?",Pi,Zo,Jo,Im].join("|")+")",km=RegExp(Yo,"g"),Fm=RegExp(Pi,"g"),ea=RegExp(Qo+"(?="+Qo+")|"+Om+Hc,"g"),Pm=RegExp([or+"?"+Ac+"+"+Oc+"(?="+[Cc,or,"$"].join("|")+")",Am+"+"+kc+"(?="+[Cc,or+Dc,"$"].join("|")+")",or+"?"+Dc+"+"+Oc,or+"+"+kc,Lm,Nm,Rc,Dm].join("|"),"g"),Hm=RegExp("["+Lc+Fi+bc+xc+"]"),Bm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Wm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Vm=-1,Le={};Le[Bo]=Le[Wo]=Le[Vo]=Le[$o]=Le[Uo]=Le[Go]=Le[qo]=Le[zo]=Le[jo]=!0,Le[ee]=Le[Oe]=Le[Kr]=Le[Qe]=Le[sr]=Le[ot]=Le[fn]=Le[tn]=Le[Pe]=Le[Ce]=Le[Ue]=Le[zr]=Le[kt]=Le[jr]=Le[Xr]=!1;var _e={};_e[ee]=_e[Oe]=_e[Kr]=_e[sr]=_e[Qe]=_e[ot]=_e[Bo]=_e[Wo]=_e[Vo]=_e[$o]=_e[Uo]=_e[Pe]=_e[Ce]=_e[Ue]=_e[zr]=_e[kt]=_e[jr]=_e[Oi]=_e[Go]=_e[qo]=_e[zo]=_e[jo]=!0,_e[fn]=_e[tn]=_e[Xr]=!1;var $m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Um={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},qm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zm=parseFloat,jm=parseInt,Bc=typeof global=="object"&&global&&global.Object===Object&&global,Xm=typeof self=="object"&&self&&self.Object===Object&&self,Ke=Bc||Xm||Function("return this")(),ta=typeof Wr=="object"&&Wr&&!Wr.nodeType&&Wr,On=ta&&typeof Ni=="object"&&Ni&&!Ni.nodeType&&Ni,Wc=On&&On.exports===ta,na=Wc&&Bc.process,Ct=function(){try{var A=On&&On.require&&On.require("util").types;return A||na&&na.binding&&na.binding("util")}catch{}}(),Vc=Ct&&Ct.isArrayBuffer,$c=Ct&&Ct.isDate,Uc=Ct&&Ct.isMap,Gc=Ct&&Ct.isRegExp,qc=Ct&&Ct.isSet,zc=Ct&&Ct.isTypedArray;function Et(A,D,L){switch(L.length){case 0:return A.call(D);case 1:return A.call(D,L[0]);case 2:return A.call(D,L[0],L[1]);case 3:return A.call(D,L[0],L[1],L[2])}return A.apply(D,L)}a(Et,"apply");function Km(A,D,L,j){for(var ce=-1,Me=A==null?0:A.length;++ce<Me;){var je=A[ce];D(j,je,L(je),A)}return j}a(Km,"arrayAggregator");function Rt(A,D){for(var L=-1,j=A==null?0:A.length;++L<j&&D(A[L],L,A)!==!1;);return A}a(Rt,"arrayEach");function Ym(A,D){for(var L=A==null?0:A.length;L--&&D(A[L],L,A)!==!1;);return A}a(Ym,"arrayEachRight");function jc(A,D){for(var L=-1,j=A==null?0:A.length;++L<j;)if(!D(A[L],L,A))return!1;return!0}a(jc,"arrayEvery");function mn(A,D){for(var L=-1,j=A==null?0:A.length,ce=0,Me=[];++L<j;){var je=A[L];D(je,L,A)&&(Me[ce++]=je)}return Me}a(mn,"arrayFilter");function Hi(A,D){var L=A==null?0:A.length;return!!L&&ar(A,D,0)>-1}a(Hi,"arrayIncludes");function ra(A,D,L){for(var j=-1,ce=A==null?0:A.length;++j<ce;)if(L(D,A[j]))return!0;return!1}a(ra,"arrayIncludesWith");function Fe(A,D){for(var L=-1,j=A==null?0:A.length,ce=Array(j);++L<j;)ce[L]=D(A[L],L,A);return ce}a(Fe,"arrayMap");function pn(A,D){for(var L=-1,j=D.length,ce=A.length;++L<j;)A[ce+L]=D[L];return A}a(pn,"arrayPush");function ia(A,D,L,j){var ce=-1,Me=A==null?0:A.length;for(j&&Me&&(L=A[++ce]);++ce<Me;)L=D(L,A[ce],ce,A);return L}a(ia,"arrayReduce");function Qm(A,D,L,j){var ce=A==null?0:A.length;for(j&&ce&&(L=A[--ce]);ce--;)L=D(L,A[ce],ce,A);return L}a(Qm,"arrayReduceRight");function sa(A,D){for(var L=-1,j=A==null?0:A.length;++L<j;)if(D(A[L],L,A))return!0;return!1}a(sa,"arraySome");var Zm=oa("length");function Jm(A){return A.split("")}a(Jm,"asciiToArray");function ep(A){return A.match(lm)||[]}a(ep,"asciiWords");function Xc(A,D,L){var j;return L(A,function(ce,Me,je){if(D(ce,Me,je))return j=Me,!1}),j}a(Xc,"baseFindKey");function Bi(A,D,L,j){for(var ce=A.length,Me=L+(j?1:-1);j?Me--:++Me<ce;)if(D(A[Me],Me,A))return Me;return-1}a(Bi,"baseFindIndex");function ar(A,D,L){return D===D?hp(A,D,L):Bi(A,Kc,L)}a(ar,"baseIndexOf");function tp(A,D,L,j){for(var ce=L-1,Me=A.length;++ce<Me;)if(j(A[ce],D))return ce;return-1}a(tp,"baseIndexOfWith");function Kc(A){return A!==A}a(Kc,"baseIsNaN");function Yc(A,D){var L=A==null?0:A.length;return L?la(A,D)/L:nt}a(Yc,"baseMean");function oa(A){return function(D){return D==null?n:D[A]}}a(oa,"baseProperty");function aa(A){return function(D){return A==null?n:A[D]}}a(aa,"basePropertyOf");function Qc(A,D,L,j,ce){return ce(A,function(Me,je,Ae){L=j?(j=!1,Me):D(L,Me,je,Ae)}),L}a(Qc,"baseReduce");function np(A,D){var L=A.length;for(A.sort(D);L--;)A[L]=A[L].value;return A}a(np,"baseSortBy");function la(A,D){for(var L,j=-1,ce=A.length;++j<ce;){var Me=D(A[j]);Me!==n&&(L=L===n?Me:L+Me)}return L}a(la,"baseSum");function ca(A,D){for(var L=-1,j=Array(A);++L<A;)j[L]=D(L);return j}a(ca,"baseTimes");function rp(A,D){return Fe(D,function(L){return[L,A[L]]})}a(rp,"baseToPairs");function Zc(A){return A&&A.slice(0,nu(A)+1).replace(Ko,"")}a(Zc,"baseTrim");function St(A){return function(D){return A(D)}}a(St,"baseUnary");function ua(A,D){return Fe(D,function(L){return A[L]})}a(ua,"baseValues");function Yr(A,D){return A.has(D)}a(Yr,"cacheHas");function Jc(A,D){for(var L=-1,j=A.length;++L<j&&ar(D,A[L],0)>-1;);return L}a(Jc,"charsStartIndex");function eu(A,D){for(var L=A.length;L--&&ar(D,A[L],0)>-1;);return L}a(eu,"charsEndIndex");function ip(A,D){for(var L=A.length,j=0;L--;)A[L]===D&&++j;return j}a(ip,"countHolders");var sp=aa($m),op=aa(Um);function ap(A){return"\\"+qm[A]}a(ap,"escapeStringChar");function lp(A,D){return A==null?n:A[D]}a(lp,"getValue");function lr(A){return Hm.test(A)}a(lr,"hasUnicode");function cp(A){return Bm.test(A)}a(cp,"hasUnicodeWord");function up(A){for(var D,L=[];!(D=A.next()).done;)L.push(D.value);return L}a(up,"iteratorToArray");function da(A){var D=-1,L=Array(A.size);return A.forEach(function(j,ce){L[++D]=[ce,j]}),L}a(da,"mapToArray");function tu(A,D){return function(L){return A(D(L))}}a(tu,"overArg");function gn(A,D){for(var L=-1,j=A.length,ce=0,Me=[];++L<j;){var je=A[L];(je===D||je===h)&&(A[L]=h,Me[ce++]=L)}return Me}a(gn,"replaceHolders");function Wi(A){var D=-1,L=Array(A.size);return A.forEach(function(j){L[++D]=j}),L}a(Wi,"setToArray");function dp(A){var D=-1,L=Array(A.size);return A.forEach(function(j){L[++D]=[j,j]}),L}a(dp,"setToPairs");function hp(A,D,L){for(var j=L-1,ce=A.length;++j<ce;)if(A[j]===D)return j;return-1}a(hp,"strictIndexOf");function fp(A,D,L){for(var j=L+1;j--;)if(A[j]===D)return j;return j}a(fp,"strictLastIndexOf");function cr(A){return lr(A)?pp(A):Zm(A)}a(cr,"stringSize");function Ft(A){return lr(A)?gp(A):Jm(A)}a(Ft,"stringToArray");function nu(A){for(var D=A.length;D--&&im.test(A.charAt(D)););return D}a(nu,"trimmedEndIndex");var mp=aa(Gm);function pp(A){for(var D=ea.lastIndex=0;ea.test(A);)++D;return D}a(pp,"unicodeSize");function gp(A){return A.match(ea)||[]}a(gp,"unicodeToArray");function yp(A){return A.match(Pm)||[]}a(yp,"unicodeWords");var vp=a(function A(D){D=D==null?Ke:yn.defaults(Ke.Object(),D,yn.pick(Ke,Wm));var L=D.Array,j=D.Date,ce=D.Error,Me=D.Function,je=D.Math,Ae=D.Object,ha=D.RegExp,Ep=D.String,At=D.TypeError,Vi=L.prototype,Sp=Me.prototype,ur=Ae.prototype,$i=D["__core-js_shared__"],Ui=Sp.toString,Re=ur.hasOwnProperty,bp=0,ru=function(){var r=/[^.]+$/.exec($i&&$i.keys&&$i.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Gi=ur.toString,wp=Ui.call(Ae),Tp=Ke._,Mp=ha("^"+Ui.call(Re).replace(Xo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qi=Wc?D.Buffer:n,vn=D.Symbol,zi=D.Uint8Array,iu=qi?qi.allocUnsafe:n,ji=tu(Ae.getPrototypeOf,Ae),su=Ae.create,ou=ur.propertyIsEnumerable,Xi=Vi.splice,au=vn?vn.isConcatSpreadable:n,Qr=vn?vn.iterator:n,kn=vn?vn.toStringTag:n,Ki=function(){try{var r=Wn(Ae,"defineProperty");return r({},"",{}),r}catch{}}(),xp=D.clearTimeout!==Ke.clearTimeout&&D.clearTimeout,Ip=j&&j.now!==Ke.Date.now&&j.now,Cp=D.setTimeout!==Ke.setTimeout&&D.setTimeout,Yi=je.ceil,Qi=je.floor,fa=Ae.getOwnPropertySymbols,Rp=qi?qi.isBuffer:n,lu=D.isFinite,Ap=Vi.join,_p=tu(Ae.keys,Ae),Xe=je.max,rt=je.min,Np=j.now,Lp=D.parseInt,cu=je.random,Dp=Vi.reverse,ma=Wn(D,"DataView"),Zr=Wn(D,"Map"),pa=Wn(D,"Promise"),dr=Wn(D,"Set"),Jr=Wn(D,"WeakMap"),ei=Wn(Ae,"create"),Zi=Jr&&new Jr,hr={},Op=Vn(ma),kp=Vn(Zr),Fp=Vn(pa),Pp=Vn(dr),Hp=Vn(Jr),Ji=vn?vn.prototype:n,ti=Ji?Ji.valueOf:n,uu=Ji?Ji.toString:n;function E(r){if(Be(r)&&!ue(r)&&!(r instanceof ve)){if(r instanceof _t)return r;if(Re.call(r,"__wrapped__"))return dd(r)}return new _t(r)}a(E,"lodash");var fr=function(){function r(){}return a(r,"object"),function(s){if(!He(s))return{};if(su)return su(s);r.prototype=s;var u=new r;return r.prototype=n,u}}();function es(){}a(es,"baseLodash");function _t(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=n}a(_t,"LodashWrapper"),E.templateSettings={escape:Zf,evaluate:Jf,interpolate:Ec,variable:"",imports:{_:E}},E.prototype=es.prototype,E.prototype.constructor=E,_t.prototype=fr(es.prototype),_t.prototype.constructor=_t;function ve(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=$e,this.__views__=[]}a(ve,"LazyWrapper");function Bp(){var r=new ve(this.__wrapped__);return r.__actions__=ft(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=ft(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=ft(this.__views__),r}a(Bp,"lazyClone");function Wp(){if(this.__filtered__){var r=new ve(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}a(Wp,"lazyReverse");function Vp(){var r=this.__wrapped__.value(),s=this.__dir__,u=ue(r),m=s<0,y=u?r.length:0,w=Jg(0,y,this.__views__),M=w.start,I=w.end,N=I-M,k=m?I:M-1,F=this.__iteratees__,H=F.length,q=0,Z=rt(N,this.__takeCount__);if(!u||!m&&y==N&&Z==N)return Ou(r,this.__actions__);var re=[];e:for(;N--&&q<Z;){k+=s;for(var he=-1,ie=r[k];++he<H;){var ge=F[he],be=ge.iteratee,Tt=ge.type,ct=be(ie);if(Tt==X)ie=ct;else if(!ct){if(Tt==B)continue e;break e}}re[q++]=ie}return re}a(Vp,"lazyValue"),ve.prototype=fr(es.prototype),ve.prototype.constructor=ve;function Fn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var m=r[s];this.set(m[0],m[1])}}a(Fn,"Hash");function $p(){this.__data__=ei?ei(null):{},this.size=0}a($p,"hashClear");function Up(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}a(Up,"hashDelete");function Gp(r){var s=this.__data__;if(ei){var u=s[r];return u===c?n:u}return Re.call(s,r)?s[r]:n}a(Gp,"hashGet");function qp(r){var s=this.__data__;return ei?s[r]!==n:Re.call(s,r)}a(qp,"hashHas");function zp(r,s){var u=this.__data__;return this.size+=this.has(r)?0:1,u[r]=ei&&s===n?c:s,this}a(zp,"hashSet"),Fn.prototype.clear=$p,Fn.prototype.delete=Up,Fn.prototype.get=Gp,Fn.prototype.has=qp,Fn.prototype.set=zp;function nn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var m=r[s];this.set(m[0],m[1])}}a(nn,"ListCache");function jp(){this.__data__=[],this.size=0}a(jp,"listCacheClear");function Xp(r){var s=this.__data__,u=ts(s,r);if(u<0)return!1;var m=s.length-1;return u==m?s.pop():Xi.call(s,u,1),--this.size,!0}a(Xp,"listCacheDelete");function Kp(r){var s=this.__data__,u=ts(s,r);return u<0?n:s[u][1]}a(Kp,"listCacheGet");function Yp(r){return ts(this.__data__,r)>-1}a(Yp,"listCacheHas");function Qp(r,s){var u=this.__data__,m=ts(u,r);return m<0?(++this.size,u.push([r,s])):u[m][1]=s,this}a(Qp,"listCacheSet"),nn.prototype.clear=jp,nn.prototype.delete=Xp,nn.prototype.get=Kp,nn.prototype.has=Yp,nn.prototype.set=Qp;function rn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var m=r[s];this.set(m[0],m[1])}}a(rn,"MapCache");function Zp(){this.size=0,this.__data__={hash:new Fn,map:new(Zr||nn),string:new Fn}}a(Zp,"mapCacheClear");function Jp(r){var s=fs(this,r).delete(r);return this.size-=s?1:0,s}a(Jp,"mapCacheDelete");function eg(r){return fs(this,r).get(r)}a(eg,"mapCacheGet");function tg(r){return fs(this,r).has(r)}a(tg,"mapCacheHas");function ng(r,s){var u=fs(this,r),m=u.size;return u.set(r,s),this.size+=u.size==m?0:1,this}a(ng,"mapCacheSet"),rn.prototype.clear=Zp,rn.prototype.delete=Jp,rn.prototype.get=eg,rn.prototype.has=tg,rn.prototype.set=ng;function Pn(r){var s=-1,u=r==null?0:r.length;for(this.__data__=new rn;++s<u;)this.add(r[s])}a(Pn,"SetCache");function rg(r){return this.__data__.set(r,c),this}a(rg,"setCacheAdd");function ig(r){return this.__data__.has(r)}a(ig,"setCacheHas"),Pn.prototype.add=Pn.prototype.push=rg,Pn.prototype.has=ig;function Pt(r){var s=this.__data__=new nn(r);this.size=s.size}a(Pt,"Stack");function sg(){this.__data__=new nn,this.size=0}a(sg,"stackClear");function og(r){var s=this.__data__,u=s.delete(r);return this.size=s.size,u}a(og,"stackDelete");function ag(r){return this.__data__.get(r)}a(ag,"stackGet");function lg(r){return this.__data__.has(r)}a(lg,"stackHas");function cg(r,s){var u=this.__data__;if(u instanceof nn){var m=u.__data__;if(!Zr||m.length<t-1)return m.push([r,s]),this.size=++u.size,this;u=this.__data__=new rn(m)}return u.set(r,s),this.size=u.size,this}a(cg,"stackSet"),Pt.prototype.clear=sg,Pt.prototype.delete=og,Pt.prototype.get=ag,Pt.prototype.has=lg,Pt.prototype.set=cg;function du(r,s){var u=ue(r),m=!u&&$n(r),y=!u&&!m&&Tn(r),w=!u&&!m&&!y&&yr(r),M=u||m||y||w,I=M?ca(r.length,Ep):[],N=I.length;for(var k in r)(s||Re.call(r,k))&&!(M&&(k=="length"||y&&(k=="offset"||k=="parent")||w&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||ln(k,N)))&&I.push(k);return I}a(du,"arrayLikeKeys");function hu(r){var s=r.length;return s?r[Ia(0,s-1)]:n}a(hu,"arraySample");function ug(r,s){return ms(ft(r),Hn(s,0,r.length))}a(ug,"arraySampleSize");function dg(r){return ms(ft(r))}a(dg,"arrayShuffle");function ga(r,s,u){(u!==n&&!Ht(r[s],u)||u===n&&!(s in r))&&sn(r,s,u)}a(ga,"assignMergeValue");function ni(r,s,u){var m=r[s];(!(Re.call(r,s)&&Ht(m,u))||u===n&&!(s in r))&&sn(r,s,u)}a(ni,"assignValue");function ts(r,s){for(var u=r.length;u--;)if(Ht(r[u][0],s))return u;return-1}a(ts,"assocIndexOf");function hg(r,s,u,m){return En(r,function(y,w,M){s(m,y,u(y),M)}),m}a(hg,"baseAggregator");function fu(r,s){return r&&zt(s,Ye(s),r)}a(fu,"baseAssign");function fg(r,s){return r&&zt(s,pt(s),r)}a(fg,"baseAssignIn");function sn(r,s,u){s=="__proto__"&&Ki?Ki(r,s,{configurable:!0,enumerable:!0,value:u,writable:!0}):r[s]=u}a(sn,"baseAssignValue");function ya(r,s){for(var u=-1,m=s.length,y=L(m),w=r==null;++u<m;)y[u]=w?n:Qa(r,s[u]);return y}a(ya,"baseAt");function Hn(r,s,u){return r===r&&(u!==n&&(r=r<=u?r:u),s!==n&&(r=r>=s?r:s)),r}a(Hn,"baseClamp");function Nt(r,s,u,m,y,w){var M,I=s&f,N=s&p,k=s&g;if(u&&(M=y?u(r,m,y,w):u(r)),M!==n)return M;if(!He(r))return r;var F=ue(r);if(F){if(M=ty(r),!I)return ft(r,M)}else{var H=it(r),q=H==tn||H==Te;if(Tn(r))return Pu(r,I);if(H==Ue||H==ee||q&&!y){if(M=N||q?{}:nd(r),!I)return N?Gg(r,fg(M,r)):Ug(r,fu(M,r))}else{if(!_e[H])return y?r:{};M=ny(r,H,I)}}w||(w=new Pt);var Z=w.get(r);if(Z)return Z;w.set(r,M),Nd(r)?r.forEach(function(ie){M.add(Nt(ie,s,u,ie,r,w))}):Ad(r)&&r.forEach(function(ie,ge){M.set(ge,Nt(ie,s,u,ge,r,w))});var re=k?N?Pa:Fa:N?pt:Ye,he=F?n:re(r);return Rt(he||r,function(ie,ge){he&&(ge=ie,ie=r[ge]),ni(M,ge,Nt(ie,s,u,ge,r,w))}),M}a(Nt,"baseClone");function mg(r){var s=Ye(r);return function(u){return mu(u,r,s)}}a(mg,"baseConforms");function mu(r,s,u){var m=u.length;if(r==null)return!m;for(r=Ae(r);m--;){var y=u[m],w=s[y],M=r[y];if(M===n&&!(y in r)||!w(M))return!1}return!0}a(mu,"baseConformsTo");function pu(r,s,u){if(typeof r!="function")throw new At(o);return ci(function(){r.apply(n,u)},s)}a(pu,"baseDelay");function ri(r,s,u,m){var y=-1,w=Hi,M=!0,I=r.length,N=[],k=s.length;if(!I)return N;u&&(s=Fe(s,St(u))),m?(w=ra,M=!1):s.length>=t&&(w=Yr,M=!1,s=new Pn(s));e:for(;++y<I;){var F=r[y],H=u==null?F:u(F);if(F=m||F!==0?F:0,M&&H===H){for(var q=k;q--;)if(s[q]===H)continue e;N.push(F)}else w(s,H,m)||N.push(F)}return N}a(ri,"baseDifference");var En=$u(qt),gu=$u(Ea,!0);function pg(r,s){var u=!0;return En(r,function(m,y,w){return u=!!s(m,y,w),u}),u}a(pg,"baseEvery");function ns(r,s,u){for(var m=-1,y=r.length;++m<y;){var w=r[m],M=s(w);if(M!=null&&(I===n?M===M&&!wt(M):u(M,I)))var I=M,N=w}return N}a(ns,"baseExtremum");function gg(r,s,u,m){var y=r.length;for(u=de(u),u<0&&(u=-u>y?0:y+u),m=m===n||m>y?y:de(m),m<0&&(m+=y),m=u>m?0:Dd(m);u<m;)r[u++]=s;return r}a(gg,"baseFill");function yu(r,s){var u=[];return En(r,function(m,y,w){s(m,y,w)&&u.push(m)}),u}a(yu,"baseFilter");function Ze(r,s,u,m,y){var w=-1,M=r.length;for(u||(u=iy),y||(y=[]);++w<M;){var I=r[w];s>0&&u(I)?s>1?Ze(I,s-1,u,m,y):pn(y,I):m||(y[y.length]=I)}return y}a(Ze,"baseFlatten");var va=Uu(),vu=Uu(!0);function qt(r,s){return r&&va(r,s,Ye)}a(qt,"baseForOwn");function Ea(r,s){return r&&vu(r,s,Ye)}a(Ea,"baseForOwnRight");function rs(r,s){return mn(s,function(u){return cn(r[u])})}a(rs,"baseFunctions");function Bn(r,s){s=bn(s,r);for(var u=0,m=s.length;r!=null&&u<m;)r=r[jt(s[u++])];return u&&u==m?r:n}a(Bn,"baseGet");function Eu(r,s,u){var m=s(r);return ue(r)?m:pn(m,u(r))}a(Eu,"baseGetAllKeys");function at(r){return r==null?r===n?qf:ke:kn&&kn in Ae(r)?Zg(r):dy(r)}a(at,"baseGetTag");function Sa(r,s){return r>s}a(Sa,"baseGt");function yg(r,s){return r!=null&&Re.call(r,s)}a(yg,"baseHas");function vg(r,s){return r!=null&&s in Ae(r)}a(vg,"baseHasIn");function Eg(r,s,u){return r>=rt(s,u)&&r<Xe(s,u)}a(Eg,"baseInRange");function ba(r,s,u){for(var m=u?ra:Hi,y=r[0].length,w=r.length,M=w,I=L(w),N=1/0,k=[];M--;){var F=r[M];M&&s&&(F=Fe(F,St(s))),N=rt(F.length,N),I[M]=!u&&(s||y>=120&&F.length>=120)?new Pn(M&&F):n}F=r[0];var H=-1,q=I[0];e:for(;++H<y&&k.length<N;){var Z=F[H],re=s?s(Z):Z;if(Z=u||Z!==0?Z:0,!(q?Yr(q,re):m(k,re,u))){for(M=w;--M;){var he=I[M];if(!(he?Yr(he,re):m(r[M],re,u)))continue e}q&&q.push(re),k.push(Z)}}return k}a(ba,"baseIntersection");function Sg(r,s,u,m){return qt(r,function(y,w,M){s(m,u(y),w,M)}),m}a(Sg,"baseInverter");function ii(r,s,u){s=bn(s,r),r=od(r,s);var m=r==null?r:r[jt(Dt(s))];return m==null?n:Et(m,r,u)}a(ii,"baseInvoke");function Su(r){return Be(r)&&at(r)==ee}a(Su,"baseIsArguments");function bg(r){return Be(r)&&at(r)==Kr}a(bg,"baseIsArrayBuffer");function wg(r){return Be(r)&&at(r)==ot}a(wg,"baseIsDate");function si(r,s,u,m,y){return r===s?!0:r==null||s==null||!Be(r)&&!Be(s)?r!==r&&s!==s:Tg(r,s,u,m,si,y)}a(si,"baseIsEqual");function Tg(r,s,u,m,y,w){var M=ue(r),I=ue(s),N=M?Oe:it(r),k=I?Oe:it(s);N=N==ee?Ue:N,k=k==ee?Ue:k;var F=N==Ue,H=k==Ue,q=N==k;if(q&&Tn(r)){if(!Tn(s))return!1;M=!0,F=!1}if(q&&!F)return w||(w=new Pt),M||yr(r)?Ju(r,s,u,m,y,w):Yg(r,s,N,u,m,y,w);if(!(u&v)){var Z=F&&Re.call(r,"__wrapped__"),re=H&&Re.call(s,"__wrapped__");if(Z||re){var he=Z?r.value():r,ie=re?s.value():s;return w||(w=new Pt),y(he,ie,u,m,w)}}return q?(w||(w=new Pt),Qg(r,s,u,m,y,w)):!1}a(Tg,"baseIsEqualDeep");function Mg(r){return Be(r)&&it(r)==Pe}a(Mg,"baseIsMap");function wa(r,s,u,m){var y=u.length,w=y,M=!m;if(r==null)return!w;for(r=Ae(r);y--;){var I=u[y];if(M&&I[2]?I[1]!==r[I[0]]:!(I[0]in r))return!1}for(;++y<w;){I=u[y];var N=I[0],k=r[N],F=I[1];if(M&&I[2]){if(k===n&&!(N in r))return!1}else{var H=new Pt;if(m)var q=m(k,F,N,r,s,H);if(!(q===n?si(F,k,v|b,m,H):q))return!1}}return!0}a(wa,"baseIsMatch");function bu(r){if(!He(r)||oy(r))return!1;var s=cn(r)?Mp:mm;return s.test(Vn(r))}a(bu,"baseIsNative");function xg(r){return Be(r)&&at(r)==zr}a(xg,"baseIsRegExp");function Ig(r){return Be(r)&&it(r)==kt}a(Ig,"baseIsSet");function Cg(r){return Be(r)&&Ss(r.length)&&!!Le[at(r)]}a(Cg,"baseIsTypedArray");function wu(r){return typeof r=="function"?r:r==null?gt:typeof r=="object"?ue(r)?xu(r[0],r[1]):Mu(r):Gd(r)}a(wu,"baseIteratee");function Ta(r){if(!li(r))return _p(r);var s=[];for(var u in Ae(r))Re.call(r,u)&&u!="constructor"&&s.push(u);return s}a(Ta,"baseKeys");function Rg(r){if(!He(r))return uy(r);var s=li(r),u=[];for(var m in r)m=="constructor"&&(s||!Re.call(r,m))||u.push(m);return u}a(Rg,"baseKeysIn");function Ma(r,s){return r<s}a(Ma,"baseLt");function Tu(r,s){var u=-1,m=mt(r)?L(r.length):[];return En(r,function(y,w,M){m[++u]=s(y,w,M)}),m}a(Tu,"baseMap");function Mu(r){var s=Ba(r);return s.length==1&&s[0][2]?id(s[0][0],s[0][1]):function(u){return u===r||wa(u,r,s)}}a(Mu,"baseMatches");function xu(r,s){return Va(r)&&rd(s)?id(jt(r),s):function(u){var m=Qa(u,r);return m===n&&m===s?Za(u,r):si(s,m,v|b)}}a(xu,"baseMatchesProperty");function is(r,s,u,m,y){r!==s&&va(s,function(w,M){if(y||(y=new Pt),He(w))Ag(r,s,M,u,is,m,y);else{var I=m?m(Ua(r,M),w,M+"",r,s,y):n;I===n&&(I=w),ga(r,M,I)}},pt)}a(is,"baseMerge");function Ag(r,s,u,m,y,w,M){var I=Ua(r,u),N=Ua(s,u),k=M.get(N);if(k){ga(r,u,k);return}var F=w?w(I,N,u+"",r,s,M):n,H=F===n;if(H){var q=ue(N),Z=!q&&Tn(N),re=!q&&!Z&&yr(N);F=N,q||Z||re?ue(I)?F=I:Ge(I)?F=ft(I):Z?(H=!1,F=Pu(N,!0)):re?(H=!1,F=Hu(N,!0)):F=[]:ui(N)||$n(N)?(F=I,$n(I)?F=Od(I):(!He(I)||cn(I))&&(F=nd(N))):H=!1}H&&(M.set(N,F),y(F,N,m,w,M),M.delete(N)),ga(r,u,F)}a(Ag,"baseMergeDeep");function Iu(r,s){var u=r.length;if(u)return s+=s<0?u:0,ln(s,u)?r[s]:n}a(Iu,"baseNth");function Cu(r,s,u){s.length?s=Fe(s,function(w){return ue(w)?function(M){return Bn(M,w.length===1?w[0]:w)}:w}):s=[gt];var m=-1;s=Fe(s,St(ne()));var y=Tu(r,function(w,M,I){var N=Fe(s,function(k){return k(w)});return{criteria:N,index:++m,value:w}});return np(y,function(w,M){return $g(w,M,u)})}a(Cu,"baseOrderBy");function _g(r,s){return Ru(r,s,function(u,m){return Za(r,m)})}a(_g,"basePick");function Ru(r,s,u){for(var m=-1,y=s.length,w={};++m<y;){var M=s[m],I=Bn(r,M);u(I,M)&&oi(w,bn(M,r),I)}return w}a(Ru,"basePickBy");function Ng(r){return function(s){return Bn(s,r)}}a(Ng,"basePropertyDeep");function xa(r,s,u,m){var y=m?tp:ar,w=-1,M=s.length,I=r;for(r===s&&(s=ft(s)),u&&(I=Fe(r,St(u)));++w<M;)for(var N=0,k=s[w],F=u?u(k):k;(N=y(I,F,N,m))>-1;)I!==r&&Xi.call(I,N,1),Xi.call(r,N,1);return r}a(xa,"basePullAll");function Au(r,s){for(var u=r?s.length:0,m=u-1;u--;){var y=s[u];if(u==m||y!==w){var w=y;ln(y)?Xi.call(r,y,1):Aa(r,y)}}return r}a(Au,"basePullAt");function Ia(r,s){return r+Qi(cu()*(s-r+1))}a(Ia,"baseRandom");function Lg(r,s,u,m){for(var y=-1,w=Xe(Yi((s-r)/(u||1)),0),M=L(w);w--;)M[m?w:++y]=r,r+=u;return M}a(Lg,"baseRange");function Ca(r,s){var u="";if(!r||s<1||s>J)return u;do s%2&&(u+=r),s=Qi(s/2),s&&(r+=r);while(s);return u}a(Ca,"baseRepeat");function me(r,s){return Ga(sd(r,s,gt),r+"")}a(me,"baseRest");function Dg(r){return hu(vr(r))}a(Dg,"baseSample");function Og(r,s){var u=vr(r);return ms(u,Hn(s,0,u.length))}a(Og,"baseSampleSize");function oi(r,s,u,m){if(!He(r))return r;s=bn(s,r);for(var y=-1,w=s.length,M=w-1,I=r;I!=null&&++y<w;){var N=jt(s[y]),k=u;if(N==="__proto__"||N==="constructor"||N==="prototype")return r;if(y!=M){var F=I[N];k=m?m(F,N,I):n,k===n&&(k=He(F)?F:ln(s[y+1])?[]:{})}ni(I,N,k),I=I[N]}return r}a(oi,"baseSet");var _u=Zi?function(r,s){return Zi.set(r,s),r}:gt,kg=Ki?function(r,s){return Ki(r,"toString",{configurable:!0,enumerable:!1,value:el(s),writable:!0})}:gt;function Fg(r){return ms(vr(r))}a(Fg,"baseShuffle");function Lt(r,s,u){var m=-1,y=r.length;s<0&&(s=-s>y?0:y+s),u=u>y?y:u,u<0&&(u+=y),y=s>u?0:u-s>>>0,s>>>=0;for(var w=L(y);++m<y;)w[m]=r[m+s];return w}a(Lt,"baseSlice");function Pg(r,s){var u;return En(r,function(m,y,w){return u=s(m,y,w),!u}),!!u}a(Pg,"baseSome");function ss(r,s,u){var m=0,y=r==null?m:r.length;if(typeof s=="number"&&s===s&&y<=P){for(;m<y;){var w=m+y>>>1,M=r[w];M!==null&&!wt(M)&&(u?M<=s:M<s)?m=w+1:y=w}return y}return Ra(r,s,gt,u)}a(ss,"baseSortedIndex");function Ra(r,s,u,m){var y=0,w=r==null?0:r.length;if(w===0)return 0;s=u(s);for(var M=s!==s,I=s===null,N=wt(s),k=s===n;y<w;){var F=Qi((y+w)/2),H=u(r[F]),q=H!==n,Z=H===null,re=H===H,he=wt(H);if(M)var ie=m||re;else k?ie=re&&(m||q):I?ie=re&&q&&(m||!Z):N?ie=re&&q&&!Z&&(m||!he):Z||he?ie=!1:ie=m?H<=s:H<s;ie?y=F+1:w=F}return rt(w,W)}a(Ra,"baseSortedIndexBy");function Nu(r,s){for(var u=-1,m=r.length,y=0,w=[];++u<m;){var M=r[u],I=s?s(M):M;if(!u||!Ht(I,N)){var N=I;w[y++]=M===0?0:M}}return w}a(Nu,"baseSortedUniq");function Lu(r){return typeof r=="number"?r:wt(r)?nt:+r}a(Lu,"baseToNumber");function bt(r){if(typeof r=="string")return r;if(ue(r))return Fe(r,bt)+"";if(wt(r))return uu?uu.call(r):"";var s=r+"";return s=="0"&&1/r==-z?"-0":s}a(bt,"baseToString");function Sn(r,s,u){var m=-1,y=Hi,w=r.length,M=!0,I=[],N=I;if(u)M=!1,y=ra;else if(w>=t){var k=s?null:Xg(r);if(k)return Wi(k);M=!1,y=Yr,N=new Pn}else N=s?[]:I;e:for(;++m<w;){var F=r[m],H=s?s(F):F;if(F=u||F!==0?F:0,M&&H===H){for(var q=N.length;q--;)if(N[q]===H)continue e;s&&N.push(H),I.push(F)}else y(N,H,u)||(N!==I&&N.push(H),I.push(F))}return I}a(Sn,"baseUniq");function Aa(r,s){return s=bn(s,r),r=od(r,s),r==null||delete r[jt(Dt(s))]}a(Aa,"baseUnset");function Du(r,s,u,m){return oi(r,s,u(Bn(r,s)),m)}a(Du,"baseUpdate");function os(r,s,u,m){for(var y=r.length,w=m?y:-1;(m?w--:++w<y)&&s(r[w],w,r););return u?Lt(r,m?0:w,m?w+1:y):Lt(r,m?w+1:0,m?y:w)}a(os,"baseWhile");function Ou(r,s){var u=r;return u instanceof ve&&(u=u.value()),ia(s,function(m,y){return y.func.apply(y.thisArg,pn([m],y.args))},u)}a(Ou,"baseWrapperValue");function _a(r,s,u){var m=r.length;if(m<2)return m?Sn(r[0]):[];for(var y=-1,w=L(m);++y<m;)for(var M=r[y],I=-1;++I<m;)I!=y&&(w[y]=ri(w[y]||M,r[I],s,u));return Sn(Ze(w,1),s,u)}a(_a,"baseXor");function ku(r,s,u){for(var m=-1,y=r.length,w=s.length,M={};++m<y;){var I=m<w?s[m]:n;u(M,r[m],I)}return M}a(ku,"baseZipObject");function Na(r){return Ge(r)?r:[]}a(Na,"castArrayLikeObject");function La(r){return typeof r=="function"?r:gt}a(La,"castFunction");function bn(r,s){return ue(r)?r:Va(r,s)?[r]:ud(Ie(r))}a(bn,"castPath");var Hg=me;function wn(r,s,u){var m=r.length;return u=u===n?m:u,!s&&u>=m?r:Lt(r,s,u)}a(wn,"castSlice");var Fu=xp||function(r){return Ke.clearTimeout(r)};function Pu(r,s){if(s)return r.slice();var u=r.length,m=iu?iu(u):new r.constructor(u);return r.copy(m),m}a(Pu,"cloneBuffer");function Da(r){var s=new r.constructor(r.byteLength);return new zi(s).set(new zi(r)),s}a(Da,"cloneArrayBuffer");function Bg(r,s){var u=s?Da(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.byteLength)}a(Bg,"cloneDataView");function Wg(r){var s=new r.constructor(r.source,Sc.exec(r));return s.lastIndex=r.lastIndex,s}a(Wg,"cloneRegExp");function Vg(r){return ti?Ae(ti.call(r)):{}}a(Vg,"cloneSymbol");function Hu(r,s){var u=s?Da(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.length)}a(Hu,"cloneTypedArray");function Bu(r,s){if(r!==s){var u=r!==n,m=r===null,y=r===r,w=wt(r),M=s!==n,I=s===null,N=s===s,k=wt(s);if(!I&&!k&&!w&&r>s||w&&M&&N&&!I&&!k||m&&M&&N||!u&&N||!y)return 1;if(!m&&!w&&!k&&r<s||k&&u&&y&&!m&&!w||I&&u&&y||!M&&y||!N)return-1}return 0}a(Bu,"compareAscending");function $g(r,s,u){for(var m=-1,y=r.criteria,w=s.criteria,M=y.length,I=u.length;++m<M;){var N=Bu(y[m],w[m]);if(N){if(m>=I)return N;var k=u[m];return N*(k=="desc"?-1:1)}}return r.index-s.index}a($g,"compareMultiple");function Wu(r,s,u,m){for(var y=-1,w=r.length,M=u.length,I=-1,N=s.length,k=Xe(w-M,0),F=L(N+k),H=!m;++I<N;)F[I]=s[I];for(;++y<M;)(H||y<w)&&(F[u[y]]=r[y]);for(;k--;)F[I++]=r[y++];return F}a(Wu,"composeArgs");function Vu(r,s,u,m){for(var y=-1,w=r.length,M=-1,I=u.length,N=-1,k=s.length,F=Xe(w-I,0),H=L(F+k),q=!m;++y<F;)H[y]=r[y];for(var Z=y;++N<k;)H[Z+N]=s[N];for(;++M<I;)(q||y<w)&&(H[Z+u[M]]=r[y++]);return H}a(Vu,"composeArgsRight");function ft(r,s){var u=-1,m=r.length;for(s||(s=L(m));++u<m;)s[u]=r[u];return s}a(ft,"copyArray");function zt(r,s,u,m){var y=!u;u||(u={});for(var w=-1,M=s.length;++w<M;){var I=s[w],N=m?m(u[I],r[I],I,u,r):n;N===n&&(N=r[I]),y?sn(u,I,N):ni(u,I,N)}return u}a(zt,"copyObject");function Ug(r,s){return zt(r,Wa(r),s)}a(Ug,"copySymbols");function Gg(r,s){return zt(r,ed(r),s)}a(Gg,"copySymbolsIn");function as(r,s){return function(u,m){var y=ue(u)?Km:hg,w=s?s():{};return y(u,r,ne(m,2),w)}}a(as,"createAggregator");function mr(r){return me(function(s,u){var m=-1,y=u.length,w=y>1?u[y-1]:n,M=y>2?u[2]:n;for(w=r.length>3&&typeof w=="function"?(y--,w):n,M&&lt(u[0],u[1],M)&&(w=y<3?n:w,y=1),s=Ae(s);++m<y;){var I=u[m];I&&r(s,I,m,w)}return s})}a(mr,"createAssigner");function $u(r,s){return function(u,m){if(u==null)return u;if(!mt(u))return r(u,m);for(var y=u.length,w=s?y:-1,M=Ae(u);(s?w--:++w<y)&&m(M[w],w,M)!==!1;);return u}}a($u,"createBaseEach");function Uu(r){return function(s,u,m){for(var y=-1,w=Ae(s),M=m(s),I=M.length;I--;){var N=M[r?I:++y];if(u(w[N],N,w)===!1)break}return s}}a(Uu,"createBaseFor");function qg(r,s,u){var m=s&T,y=ai(r);function w(){var M=this&&this!==Ke&&this instanceof w?y:r;return M.apply(m?u:this,arguments)}return a(w,"wrapper"),w}a(qg,"createBind");function Gu(r){return function(s){s=Ie(s);var u=lr(s)?Ft(s):n,m=u?u[0]:s.charAt(0),y=u?wn(u,1).join(""):s.slice(1);return m[r]()+y}}a(Gu,"createCaseFirst");function pr(r){return function(s){return ia($d(Vd(s).replace(km,"")),r,"")}}a(pr,"createCompounder");function ai(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var u=fr(r.prototype),m=r.apply(u,s);return He(m)?m:u}}a(ai,"createCtor");function zg(r,s,u){var m=ai(r);function y(){for(var w=arguments.length,M=L(w),I=w,N=gr(y);I--;)M[I]=arguments[I];var k=w<3&&M[0]!==N&&M[w-1]!==N?[]:gn(M,N);if(w-=k.length,w<u)return Ku(r,s,ls,y.placeholder,n,M,k,n,n,u-w);var F=this&&this!==Ke&&this instanceof y?m:r;return Et(F,this,M)}return a(y,"wrapper"),y}a(zg,"createCurry");function qu(r){return function(s,u,m){var y=Ae(s);if(!mt(s)){var w=ne(u,3);s=Ye(s),u=a(function(I){return w(y[I],I,y)},"predicate")}var M=r(s,u,m);return M>-1?y[w?s[M]:M]:n}}a(qu,"createFind");function zu(r){return an(function(s){var u=s.length,m=u,y=_t.prototype.thru;for(r&&s.reverse();m--;){var w=s[m];if(typeof w!="function")throw new At(o);if(y&&!M&&hs(w)=="wrapper")var M=new _t([],!0)}for(m=M?m:u;++m<u;){w=s[m];var I=hs(w),N=I=="wrapper"?Ha(w):n;N&&$a(N[0])&&N[1]==(U|x|R|Y)&&!N[4].length&&N[9]==1?M=M[hs(N[0])].apply(M,N[3]):M=w.length==1&&$a(w)?M[I]():M.thru(w)}return function(){var k=arguments,F=k[0];if(M&&k.length==1&&ue(F))return M.plant(F).value();for(var H=0,q=u?s[H].apply(this,k):F;++H<u;)q=s[H].call(this,q);return q}})}a(zu,"createFlow");function ls(r,s,u,m,y,w,M,I,N,k){var F=s&U,H=s&T,q=s&S,Z=s&(x|_),re=s&le,he=q?n:ai(r);function ie(){for(var ge=arguments.length,be=L(ge),Tt=ge;Tt--;)be[Tt]=arguments[Tt];if(Z)var ct=gr(ie),Mt=ip(be,ct);if(m&&(be=Wu(be,m,y,Z)),w&&(be=Vu(be,w,M,Z)),ge-=Mt,Z&&ge<k){var qe=gn(be,ct);return Ku(r,s,ls,ie.placeholder,u,be,qe,I,N,k-ge)}var Bt=H?u:this,dn=q?Bt[r]:r;return ge=be.length,I?be=hy(be,I):re&&ge>1&&be.reverse(),F&&N<ge&&(be.length=N),this&&this!==Ke&&this instanceof ie&&(dn=he||ai(dn)),dn.apply(Bt,be)}return a(ie,"wrapper"),ie}a(ls,"createHybrid");function ju(r,s){return function(u,m){return Sg(u,r,s(m),{})}}a(ju,"createInverter");function cs(r,s){return function(u,m){var y;if(u===n&&m===n)return s;if(u!==n&&(y=u),m!==n){if(y===n)return m;typeof u=="string"||typeof m=="string"?(u=bt(u),m=bt(m)):(u=Lu(u),m=Lu(m)),y=r(u,m)}return y}}a(cs,"createMathOperation");function Oa(r){return an(function(s){return s=Fe(s,St(ne())),me(function(u){var m=this;return r(s,function(y){return Et(y,m,u)})})})}a(Oa,"createOver");function us(r,s){s=s===n?" ":bt(s);var u=s.length;if(u<2)return u?Ca(s,r):s;var m=Ca(s,Yi(r/cr(s)));return lr(s)?wn(Ft(m),0,r).join(""):m.slice(0,r)}a(us,"createPadding");function jg(r,s,u,m){var y=s&T,w=ai(r);function M(){for(var I=-1,N=arguments.length,k=-1,F=m.length,H=L(F+N),q=this&&this!==Ke&&this instanceof M?w:r;++k<F;)H[k]=m[k];for(;N--;)H[k++]=arguments[++I];return Et(q,y?u:this,H)}return a(M,"wrapper"),M}a(jg,"createPartial");function Xu(r){return function(s,u,m){return m&&typeof m!="number"&&lt(s,u,m)&&(u=m=n),s=un(s),u===n?(u=s,s=0):u=un(u),m=m===n?s<u?1:-1:un(m),Lg(s,u,m,r)}}a(Xu,"createRange");function ds(r){return function(s,u){return typeof s=="string"&&typeof u=="string"||(s=Ot(s),u=Ot(u)),r(s,u)}}a(ds,"createRelationalOperation");function Ku(r,s,u,m,y,w,M,I,N,k){var F=s&x,H=F?M:n,q=F?n:M,Z=F?w:n,re=F?n:w;s|=F?R:O,s&=~(F?O:R),s&C||(s&=~(T|S));var he=[r,s,y,Z,H,re,q,I,N,k],ie=u.apply(n,he);return $a(r)&&ad(ie,he),ie.placeholder=m,ld(ie,r,s)}a(Ku,"createRecurry");function ka(r){var s=je[r];return function(u,m){if(u=Ot(u),m=m==null?0:rt(de(m),292),m&&lu(u)){var y=(Ie(u)+"e").split("e"),w=s(y[0]+"e"+(+y[1]+m));return y=(Ie(w)+"e").split("e"),+(y[0]+"e"+(+y[1]-m))}return s(u)}}a(ka,"createRound");var Xg=dr&&1/Wi(new dr([,-0]))[1]==z?function(r){return new dr(r)}:rl;function Yu(r){return function(s){var u=it(s);return u==Pe?da(s):u==kt?dp(s):rp(s,r(s))}}a(Yu,"createToPairs");function on(r,s,u,m,y,w,M,I){var N=s&S;if(!N&&typeof r!="function")throw new At(o);var k=m?m.length:0;if(k||(s&=~(R|O),m=y=n),M=M===n?M:Xe(de(M),0),I=I===n?I:de(I),k-=y?y.length:0,s&O){var F=m,H=y;m=y=n}var q=N?n:Ha(r),Z=[r,s,u,m,y,F,H,w,M,I];if(q&&cy(Z,q),r=Z[0],s=Z[1],u=Z[2],m=Z[3],y=Z[4],I=Z[9]=Z[9]===n?N?0:r.length:Xe(Z[9]-k,0),!I&&s&(x|_)&&(s&=~(x|_)),!s||s==T)var re=qg(r,s,u);else s==x||s==_?re=zg(r,s,I):(s==R||s==(T|R))&&!y.length?re=jg(r,s,u,m):re=ls.apply(n,Z);var he=q?_u:ad;return ld(he(re,Z),r,s)}a(on,"createWrap");function Qu(r,s,u,m){return r===n||Ht(r,ur[u])&&!Re.call(m,u)?s:r}a(Qu,"customDefaultsAssignIn");function Zu(r,s,u,m,y,w){return He(r)&&He(s)&&(w.set(s,r),is(r,s,n,Zu,w),w.delete(s)),r}a(Zu,"customDefaultsMerge");function Kg(r){return ui(r)?n:r}a(Kg,"customOmitClone");function Ju(r,s,u,m,y,w){var M=u&v,I=r.length,N=s.length;if(I!=N&&!(M&&N>I))return!1;var k=w.get(r),F=w.get(s);if(k&&F)return k==s&&F==r;var H=-1,q=!0,Z=u&b?new Pn:n;for(w.set(r,s),w.set(s,r);++H<I;){var re=r[H],he=s[H];if(m)var ie=M?m(he,re,H,s,r,w):m(re,he,H,r,s,w);if(ie!==n){if(ie)continue;q=!1;break}if(Z){if(!sa(s,function(ge,be){if(!Yr(Z,be)&&(re===ge||y(re,ge,u,m,w)))return Z.push(be)})){q=!1;break}}else if(!(re===he||y(re,he,u,m,w))){q=!1;break}}return w.delete(r),w.delete(s),q}a(Ju,"equalArrays");function Yg(r,s,u,m,y,w,M){switch(u){case sr:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Kr:return!(r.byteLength!=s.byteLength||!w(new zi(r),new zi(s)));case Qe:case ot:case Ce:return Ht(+r,+s);case fn:return r.name==s.name&&r.message==s.message;case zr:case jr:return r==s+"";case Pe:var I=da;case kt:var N=m&v;if(I||(I=Wi),r.size!=s.size&&!N)return!1;var k=M.get(r);if(k)return k==s;m|=b,M.set(r,s);var F=Ju(I(r),I(s),m,y,w,M);return M.delete(r),F;case Oi:if(ti)return ti.call(r)==ti.call(s)}return!1}a(Yg,"equalByTag");function Qg(r,s,u,m,y,w){var M=u&v,I=Fa(r),N=I.length,k=Fa(s),F=k.length;if(N!=F&&!M)return!1;for(var H=N;H--;){var q=I[H];if(!(M?q in s:Re.call(s,q)))return!1}var Z=w.get(r),re=w.get(s);if(Z&&re)return Z==s&&re==r;var he=!0;w.set(r,s),w.set(s,r);for(var ie=M;++H<N;){q=I[H];var ge=r[q],be=s[q];if(m)var Tt=M?m(be,ge,q,s,r,w):m(ge,be,q,r,s,w);if(!(Tt===n?ge===be||y(ge,be,u,m,w):Tt)){he=!1;break}ie||(ie=q=="constructor")}if(he&&!ie){var ct=r.constructor,Mt=s.constructor;ct!=Mt&&"constructor"in r&&"constructor"in s&&!(typeof ct=="function"&&ct instanceof ct&&typeof Mt=="function"&&Mt instanceof Mt)&&(he=!1)}return w.delete(r),w.delete(s),he}a(Qg,"equalObjects");function an(r){return Ga(sd(r,n,md),r+"")}a(an,"flatRest");function Fa(r){return Eu(r,Ye,Wa)}a(Fa,"getAllKeys");function Pa(r){return Eu(r,pt,ed)}a(Pa,"getAllKeysIn");var Ha=Zi?function(r){return Zi.get(r)}:rl;function hs(r){for(var s=r.name+"",u=hr[s],m=Re.call(hr,s)?u.length:0;m--;){var y=u[m],w=y.func;if(w==null||w==r)return y.name}return s}a(hs,"getFuncName");function gr(r){var s=Re.call(E,"placeholder")?E:r;return s.placeholder}a(gr,"getHolder");function ne(){var r=E.iteratee||tl;return r=r===tl?wu:r,arguments.length?r(arguments[0],arguments[1]):r}a(ne,"getIteratee");function fs(r,s){var u=r.__data__;return sy(s)?u[typeof s=="string"?"string":"hash"]:u.map}a(fs,"getMapData");function Ba(r){for(var s=Ye(r),u=s.length;u--;){var m=s[u],y=r[m];s[u]=[m,y,rd(y)]}return s}a(Ba,"getMatchData");function Wn(r,s){var u=lp(r,s);return bu(u)?u:n}a(Wn,"getNative");function Zg(r){var s=Re.call(r,kn),u=r[kn];try{r[kn]=n;var m=!0}catch{}var y=Gi.call(r);return m&&(s?r[kn]=u:delete r[kn]),y}a(Zg,"getRawTag");var Wa=fa?function(r){return r==null?[]:(r=Ae(r),mn(fa(r),function(s){return ou.call(r,s)}))}:il,ed=fa?function(r){for(var s=[];r;)pn(s,Wa(r)),r=ji(r);return s}:il,it=at;(ma&&it(new ma(new ArrayBuffer(1)))!=sr||Zr&&it(new Zr)!=Pe||pa&&it(pa.resolve())!=xe||dr&&it(new dr)!=kt||Jr&&it(new Jr)!=Xr)&&(it=a(function(r){var s=at(r),u=s==Ue?r.constructor:n,m=u?Vn(u):"";if(m)switch(m){case Op:return sr;case kp:return Pe;case Fp:return xe;case Pp:return kt;case Hp:return Xr}return s},"getTag"));function Jg(r,s,u){for(var m=-1,y=u.length;++m<y;){var w=u[m],M=w.size;switch(w.type){case"drop":r+=M;break;case"dropRight":s-=M;break;case"take":s=rt(s,r+M);break;case"takeRight":r=Xe(r,s-M);break}}return{start:r,end:s}}a(Jg,"getView");function ey(r){var s=r.match(om);return s?s[1].split(am):[]}a(ey,"getWrapDetails");function td(r,s,u){s=bn(s,r);for(var m=-1,y=s.length,w=!1;++m<y;){var M=jt(s[m]);if(!(w=r!=null&&u(r,M)))break;r=r[M]}return w||++m!=y?w:(y=r==null?0:r.length,!!y&&Ss(y)&&ln(M,y)&&(ue(r)||$n(r)))}a(td,"hasPath");function ty(r){var s=r.length,u=new r.constructor(s);return s&&typeof r[0]=="string"&&Re.call(r,"index")&&(u.index=r.index,u.input=r.input),u}a(ty,"initCloneArray");function nd(r){return typeof r.constructor=="function"&&!li(r)?fr(ji(r)):{}}a(nd,"initCloneObject");function ny(r,s,u){var m=r.constructor;switch(s){case Kr:return Da(r);case Qe:case ot:return new m(+r);case sr:return Bg(r,u);case Bo:case Wo:case Vo:case $o:case Uo:case Go:case qo:case zo:case jo:return Hu(r,u);case Pe:return new m;case Ce:case jr:return new m(r);case zr:return Wg(r);case kt:return new m;case Oi:return Vg(r)}}a(ny,"initCloneByTag");function ry(r,s){var u=s.length;if(!u)return r;var m=u-1;return s[m]=(u>1?"& ":"")+s[m],s=s.join(u>2?", ":" "),r.replace(sm,`{
/* [wrapped with `+s+`] */
`)}a(ry,"insertWrapDetails");function iy(r){return ue(r)||$n(r)||!!(au&&r&&r[au])}a(iy,"isFlattenable");function ln(r,s){var u=typeof r;return s=s??J,!!s&&(u=="number"||u!="symbol"&&gm.test(r))&&r>-1&&r%1==0&&r<s}a(ln,"isIndex");function lt(r,s,u){if(!He(u))return!1;var m=typeof s;return(m=="number"?mt(u)&&ln(s,u.length):m=="string"&&s in u)?Ht(u[s],r):!1}a(lt,"isIterateeCall");function Va(r,s){if(ue(r))return!1;var u=typeof r;return u=="number"||u=="symbol"||u=="boolean"||r==null||wt(r)?!0:tm.test(r)||!em.test(r)||s!=null&&r in Ae(s)}a(Va,"isKey");function sy(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}a(sy,"isKeyable");function $a(r){var s=hs(r),u=E[s];if(typeof u!="function"||!(s in ve.prototype))return!1;if(r===u)return!0;var m=Ha(u);return!!m&&r===m[0]}a($a,"isLaziable");function oy(r){return!!ru&&ru in r}a(oy,"isMasked");var ay=$i?cn:sl;function li(r){var s=r&&r.constructor,u=typeof s=="function"&&s.prototype||ur;return r===u}a(li,"isPrototype");function rd(r){return r===r&&!He(r)}a(rd,"isStrictComparable");function id(r,s){return function(u){return u==null?!1:u[r]===s&&(s!==n||r in Ae(u))}}a(id,"matchesStrictComparable");function ly(r){var s=vs(r,function(m){return u.size===d&&u.clear(),m}),u=s.cache;return s}a(ly,"memoizeCapped");function cy(r,s){var u=r[1],m=s[1],y=u|m,w=y<(T|S|U),M=m==U&&u==x||m==U&&u==Y&&r[7].length<=s[8]||m==(U|Y)&&s[7].length<=s[8]&&u==x;if(!(w||M))return r;m&T&&(r[2]=s[2],y|=u&T?0:C);var I=s[3];if(I){var N=r[3];r[3]=N?Wu(N,I,s[4]):I,r[4]=N?gn(r[3],h):s[4]}return I=s[5],I&&(N=r[5],r[5]=N?Vu(N,I,s[6]):I,r[6]=N?gn(r[5],h):s[6]),I=s[7],I&&(r[7]=I),m&U&&(r[8]=r[8]==null?s[8]:rt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=y,r}a(cy,"mergeData");function uy(r){var s=[];if(r!=null)for(var u in Ae(r))s.push(u);return s}a(uy,"nativeKeysIn");function dy(r){return Gi.call(r)}a(dy,"objectToString");function sd(r,s,u){return s=Xe(s===n?r.length-1:s,0),function(){for(var m=arguments,y=-1,w=Xe(m.length-s,0),M=L(w);++y<w;)M[y]=m[s+y];y=-1;for(var I=L(s+1);++y<s;)I[y]=m[y];return I[s]=u(M),Et(r,this,I)}}a(sd,"overRest");function od(r,s){return s.length<2?r:Bn(r,Lt(s,0,-1))}a(od,"parent");function hy(r,s){for(var u=r.length,m=rt(s.length,u),y=ft(r);m--;){var w=s[m];r[m]=ln(w,u)?y[w]:n}return r}a(hy,"reorder");function Ua(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}a(Ua,"safeGet");var ad=cd(_u),ci=Cp||function(r,s){return Ke.setTimeout(r,s)},Ga=cd(kg);function ld(r,s,u){var m=s+"";return Ga(r,ry(m,fy(ey(m),u)))}a(ld,"setWrapToString");function cd(r){var s=0,u=0;return function(){var m=Np(),y=V-(m-u);if(u=m,y>0){if(++s>=fe)return arguments[0]}else s=0;return r.apply(n,arguments)}}a(cd,"shortOut");function ms(r,s){var u=-1,m=r.length,y=m-1;for(s=s===n?m:s;++u<s;){var w=Ia(u,y),M=r[w];r[w]=r[u],r[u]=M}return r.length=s,r}a(ms,"shuffleSelf");var ud=ly(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(nm,function(u,m,y,w){s.push(y?w.replace(um,"$1"):m||u)}),s});function jt(r){if(typeof r=="string"||wt(r))return r;var s=r+"";return s=="0"&&1/r==-z?"-0":s}a(jt,"toKey");function Vn(r){if(r!=null){try{return Ui.call(r)}catch{}try{return r+""}catch{}}return""}a(Vn,"toSource");function fy(r,s){return Rt(te,function(u){var m="_."+u[0];s&u[1]&&!Hi(r,m)&&r.push(m)}),r.sort()}a(fy,"updateWrapDetails");function dd(r){if(r instanceof ve)return r.clone();var s=new _t(r.__wrapped__,r.__chain__);return s.__actions__=ft(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}a(dd,"wrapperClone");function my(r,s,u){(u?lt(r,s,u):s===n)?s=1:s=Xe(de(s),0);var m=r==null?0:r.length;if(!m||s<1)return[];for(var y=0,w=0,M=L(Yi(m/s));y<m;)M[w++]=Lt(r,y,y+=s);return M}a(my,"chunk");function py(r){for(var s=-1,u=r==null?0:r.length,m=0,y=[];++s<u;){var w=r[s];w&&(y[m++]=w)}return y}a(py,"compact");function gy(){var r=arguments.length;if(!r)return[];for(var s=L(r-1),u=arguments[0],m=r;m--;)s[m-1]=arguments[m];return pn(ue(u)?ft(u):[u],Ze(s,1))}a(gy,"concat");var yy=me(function(r,s){return Ge(r)?ri(r,Ze(s,1,Ge,!0)):[]}),vy=me(function(r,s){var u=Dt(s);return Ge(u)&&(u=n),Ge(r)?ri(r,Ze(s,1,Ge,!0),ne(u,2)):[]}),Ey=me(function(r,s){var u=Dt(s);return Ge(u)&&(u=n),Ge(r)?ri(r,Ze(s,1,Ge,!0),n,u):[]});function Sy(r,s,u){var m=r==null?0:r.length;return m?(s=u||s===n?1:de(s),Lt(r,s<0?0:s,m)):[]}a(Sy,"drop");function by(r,s,u){var m=r==null?0:r.length;return m?(s=u||s===n?1:de(s),s=m-s,Lt(r,0,s<0?0:s)):[]}a(by,"dropRight");function wy(r,s){return r&&r.length?os(r,ne(s,3),!0,!0):[]}a(wy,"dropRightWhile");function Ty(r,s){return r&&r.length?os(r,ne(s,3),!0):[]}a(Ty,"dropWhile");function My(r,s,u,m){var y=r==null?0:r.length;return y?(u&&typeof u!="number"&&lt(r,s,u)&&(u=0,m=y),gg(r,s,u,m)):[]}a(My,"fill");function hd(r,s,u){var m=r==null?0:r.length;if(!m)return-1;var y=u==null?0:de(u);return y<0&&(y=Xe(m+y,0)),Bi(r,ne(s,3),y)}a(hd,"findIndex");function fd(r,s,u){var m=r==null?0:r.length;if(!m)return-1;var y=m-1;return u!==n&&(y=de(u),y=u<0?Xe(m+y,0):rt(y,m-1)),Bi(r,ne(s,3),y,!0)}a(fd,"findLastIndex");function md(r){var s=r==null?0:r.length;return s?Ze(r,1):[]}a(md,"flatten");function xy(r){var s=r==null?0:r.length;return s?Ze(r,z):[]}a(xy,"flattenDeep");function Iy(r,s){var u=r==null?0:r.length;return u?(s=s===n?1:de(s),Ze(r,s)):[]}a(Iy,"flattenDepth");function Cy(r){for(var s=-1,u=r==null?0:r.length,m={};++s<u;){var y=r[s];m[y[0]]=y[1]}return m}a(Cy,"fromPairs");function pd(r){return r&&r.length?r[0]:n}a(pd,"head");function Ry(r,s,u){var m=r==null?0:r.length;if(!m)return-1;var y=u==null?0:de(u);return y<0&&(y=Xe(m+y,0)),ar(r,s,y)}a(Ry,"indexOf");function Ay(r){var s=r==null?0:r.length;return s?Lt(r,0,-1):[]}a(Ay,"initial");var _y=me(function(r){var s=Fe(r,Na);return s.length&&s[0]===r[0]?ba(s):[]}),Ny=me(function(r){var s=Dt(r),u=Fe(r,Na);return s===Dt(u)?s=n:u.pop(),u.length&&u[0]===r[0]?ba(u,ne(s,2)):[]}),Ly=me(function(r){var s=Dt(r),u=Fe(r,Na);return s=typeof s=="function"?s:n,s&&u.pop(),u.length&&u[0]===r[0]?ba(u,n,s):[]});function Dy(r,s){return r==null?"":Ap.call(r,s)}a(Dy,"join");function Dt(r){var s=r==null?0:r.length;return s?r[s-1]:n}a(Dt,"last");function Oy(r,s,u){var m=r==null?0:r.length;if(!m)return-1;var y=m;return u!==n&&(y=de(u),y=y<0?Xe(m+y,0):rt(y,m-1)),s===s?fp(r,s,y):Bi(r,Kc,y,!0)}a(Oy,"lastIndexOf");function ky(r,s){return r&&r.length?Iu(r,de(s)):n}a(ky,"nth");var Fy=me(gd);function gd(r,s){return r&&r.length&&s&&s.length?xa(r,s):r}a(gd,"pullAll");function Py(r,s,u){return r&&r.length&&s&&s.length?xa(r,s,ne(u,2)):r}a(Py,"pullAllBy");function Hy(r,s,u){return r&&r.length&&s&&s.length?xa(r,s,n,u):r}a(Hy,"pullAllWith");var By=an(function(r,s){var u=r==null?0:r.length,m=ya(r,s);return Au(r,Fe(s,function(y){return ln(y,u)?+y:y}).sort(Bu)),m});function Wy(r,s){var u=[];if(!(r&&r.length))return u;var m=-1,y=[],w=r.length;for(s=ne(s,3);++m<w;){var M=r[m];s(M,m,r)&&(u.push(M),y.push(m))}return Au(r,y),u}a(Wy,"remove");function qa(r){return r==null?r:Dp.call(r)}a(qa,"reverse");function Vy(r,s,u){var m=r==null?0:r.length;return m?(u&&typeof u!="number"&&lt(r,s,u)?(s=0,u=m):(s=s==null?0:de(s),u=u===n?m:de(u)),Lt(r,s,u)):[]}a(Vy,"slice");function $y(r,s){return ss(r,s)}a($y,"sortedIndex");function Uy(r,s,u){return Ra(r,s,ne(u,2))}a(Uy,"sortedIndexBy");function Gy(r,s){var u=r==null?0:r.length;if(u){var m=ss(r,s);if(m<u&&Ht(r[m],s))return m}return-1}a(Gy,"sortedIndexOf");function qy(r,s){return ss(r,s,!0)}a(qy,"sortedLastIndex");function zy(r,s,u){return Ra(r,s,ne(u,2),!0)}a(zy,"sortedLastIndexBy");function jy(r,s){var u=r==null?0:r.length;if(u){var m=ss(r,s,!0)-1;if(Ht(r[m],s))return m}return-1}a(jy,"sortedLastIndexOf");function Xy(r){return r&&r.length?Nu(r):[]}a(Xy,"sortedUniq");function Ky(r,s){return r&&r.length?Nu(r,ne(s,2)):[]}a(Ky,"sortedUniqBy");function Yy(r){var s=r==null?0:r.length;return s?Lt(r,1,s):[]}a(Yy,"tail");function Qy(r,s,u){return r&&r.length?(s=u||s===n?1:de(s),Lt(r,0,s<0?0:s)):[]}a(Qy,"take");function Zy(r,s,u){var m=r==null?0:r.length;return m?(s=u||s===n?1:de(s),s=m-s,Lt(r,s<0?0:s,m)):[]}a(Zy,"takeRight");function Jy(r,s){return r&&r.length?os(r,ne(s,3),!1,!0):[]}a(Jy,"takeRightWhile");function ev(r,s){return r&&r.length?os(r,ne(s,3)):[]}a(ev,"takeWhile");var tv=me(function(r){return Sn(Ze(r,1,Ge,!0))}),nv=me(function(r){var s=Dt(r);return Ge(s)&&(s=n),Sn(Ze(r,1,Ge,!0),ne(s,2))}),rv=me(function(r){var s=Dt(r);return s=typeof s=="function"?s:n,Sn(Ze(r,1,Ge,!0),n,s)});function iv(r){return r&&r.length?Sn(r):[]}a(iv,"uniq");function sv(r,s){return r&&r.length?Sn(r,ne(s,2)):[]}a(sv,"uniqBy");function ov(r,s){return s=typeof s=="function"?s:n,r&&r.length?Sn(r,n,s):[]}a(ov,"uniqWith");function za(r){if(!(r&&r.length))return[];var s=0;return r=mn(r,function(u){if(Ge(u))return s=Xe(u.length,s),!0}),ca(s,function(u){return Fe(r,oa(u))})}a(za,"unzip");function yd(r,s){if(!(r&&r.length))return[];var u=za(r);return s==null?u:Fe(u,function(m){return Et(s,n,m)})}a(yd,"unzipWith");var av=me(function(r,s){return Ge(r)?ri(r,s):[]}),lv=me(function(r){return _a(mn(r,Ge))}),cv=me(function(r){var s=Dt(r);return Ge(s)&&(s=n),_a(mn(r,Ge),ne(s,2))}),uv=me(function(r){var s=Dt(r);return s=typeof s=="function"?s:n,_a(mn(r,Ge),n,s)}),dv=me(za);function hv(r,s){return ku(r||[],s||[],ni)}a(hv,"zipObject");function fv(r,s){return ku(r||[],s||[],oi)}a(fv,"zipObjectDeep");var mv=me(function(r){var s=r.length,u=s>1?r[s-1]:n;return u=typeof u=="function"?(r.pop(),u):n,yd(r,u)});function vd(r){var s=E(r);return s.__chain__=!0,s}a(vd,"chain");function pv(r,s){return s(r),r}a(pv,"tap");function ps(r,s){return s(r)}a(ps,"thru");var gv=an(function(r){var s=r.length,u=s?r[0]:0,m=this.__wrapped__,y=a(function(w){return ya(w,r)},"interceptor");return s>1||this.__actions__.length||!(m instanceof ve)||!ln(u)?this.thru(y):(m=m.slice(u,+u+(s?1:0)),m.__actions__.push({func:ps,args:[y],thisArg:n}),new _t(m,this.__chain__).thru(function(w){return s&&!w.length&&w.push(n),w}))});function yv(){return vd(this)}a(yv,"wrapperChain");function vv(){return new _t(this.value(),this.__chain__)}a(vv,"wrapperCommit");function Ev(){this.__values__===n&&(this.__values__=Ld(this.value()));var r=this.__index__>=this.__values__.length,s=r?n:this.__values__[this.__index__++];return{done:r,value:s}}a(Ev,"wrapperNext");function Sv(){return this}a(Sv,"wrapperToIterator");function bv(r){for(var s,u=this;u instanceof es;){var m=dd(u);m.__index__=0,m.__values__=n,s?y.__wrapped__=m:s=m;var y=m;u=u.__wrapped__}return y.__wrapped__=r,s}a(bv,"wrapperPlant");function wv(){var r=this.__wrapped__;if(r instanceof ve){var s=r;return this.__actions__.length&&(s=new ve(this)),s=s.reverse(),s.__actions__.push({func:ps,args:[qa],thisArg:n}),new _t(s,this.__chain__)}return this.thru(qa)}a(wv,"wrapperReverse");function Tv(){return Ou(this.__wrapped__,this.__actions__)}a(Tv,"wrapperValue");var Mv=as(function(r,s,u){Re.call(r,u)?++r[u]:sn(r,u,1)});function xv(r,s,u){var m=ue(r)?jc:pg;return u&&lt(r,s,u)&&(s=n),m(r,ne(s,3))}a(xv,"every");function Iv(r,s){var u=ue(r)?mn:yu;return u(r,ne(s,3))}a(Iv,"filter");var Cv=qu(hd),Rv=qu(fd);function Av(r,s){return Ze(gs(r,s),1)}a(Av,"flatMap");function _v(r,s){return Ze(gs(r,s),z)}a(_v,"flatMapDeep");function Nv(r,s,u){return u=u===n?1:de(u),Ze(gs(r,s),u)}a(Nv,"flatMapDepth");function Ed(r,s){var u=ue(r)?Rt:En;return u(r,ne(s,3))}a(Ed,"forEach");function Sd(r,s){var u=ue(r)?Ym:gu;return u(r,ne(s,3))}a(Sd,"forEachRight");var Lv=as(function(r,s,u){Re.call(r,u)?r[u].push(s):sn(r,u,[s])});function Dv(r,s,u,m){r=mt(r)?r:vr(r),u=u&&!m?de(u):0;var y=r.length;return u<0&&(u=Xe(y+u,0)),bs(r)?u<=y&&r.indexOf(s,u)>-1:!!y&&ar(r,s,u)>-1}a(Dv,"includes");var Ov=me(function(r,s,u){var m=-1,y=typeof s=="function",w=mt(r)?L(r.length):[];return En(r,function(M){w[++m]=y?Et(s,M,u):ii(M,s,u)}),w}),kv=as(function(r,s,u){sn(r,u,s)});function gs(r,s){var u=ue(r)?Fe:Tu;return u(r,ne(s,3))}a(gs,"map");function Fv(r,s,u,m){return r==null?[]:(ue(s)||(s=s==null?[]:[s]),u=m?n:u,ue(u)||(u=u==null?[]:[u]),Cu(r,s,u))}a(Fv,"orderBy");var Pv=as(function(r,s,u){r[u?0:1].push(s)},function(){return[[],[]]});function Hv(r,s,u){var m=ue(r)?ia:Qc,y=arguments.length<3;return m(r,ne(s,4),u,y,En)}a(Hv,"reduce");function Bv(r,s,u){var m=ue(r)?Qm:Qc,y=arguments.length<3;return m(r,ne(s,4),u,y,gu)}a(Bv,"reduceRight");function Wv(r,s){var u=ue(r)?mn:yu;return u(r,Es(ne(s,3)))}a(Wv,"reject");function Vv(r){var s=ue(r)?hu:Dg;return s(r)}a(Vv,"sample");function $v(r,s,u){(u?lt(r,s,u):s===n)?s=1:s=de(s);var m=ue(r)?ug:Og;return m(r,s)}a($v,"sampleSize");function Uv(r){var s=ue(r)?dg:Fg;return s(r)}a(Uv,"shuffle");function Gv(r){if(r==null)return 0;if(mt(r))return bs(r)?cr(r):r.length;var s=it(r);return s==Pe||s==kt?r.size:Ta(r).length}a(Gv,"size");function qv(r,s,u){var m=ue(r)?sa:Pg;return u&&lt(r,s,u)&&(s=n),m(r,ne(s,3))}a(qv,"some");var zv=me(function(r,s){if(r==null)return[];var u=s.length;return u>1&&lt(r,s[0],s[1])?s=[]:u>2&&lt(s[0],s[1],s[2])&&(s=[s[0]]),Cu(r,Ze(s,1),[])}),ys=Ip||function(){return Ke.Date.now()};function jv(r,s){if(typeof s!="function")throw new At(o);return r=de(r),function(){if(--r<1)return s.apply(this,arguments)}}a(jv,"after");function bd(r,s,u){return s=u?n:s,s=r&&s==null?r.length:s,on(r,U,n,n,n,n,s)}a(bd,"ary");function wd(r,s){var u;if(typeof s!="function")throw new At(o);return r=de(r),function(){return--r>0&&(u=s.apply(this,arguments)),r<=1&&(s=n),u}}a(wd,"before");var ja=me(function(r,s,u){var m=T;if(u.length){var y=gn(u,gr(ja));m|=R}return on(r,m,s,u,y)}),Td=me(function(r,s,u){var m=T|S;if(u.length){var y=gn(u,gr(Td));m|=R}return on(s,m,r,u,y)});function Md(r,s,u){s=u?n:s;var m=on(r,x,n,n,n,n,n,s);return m.placeholder=Md.placeholder,m}a(Md,"curry");function xd(r,s,u){s=u?n:s;var m=on(r,_,n,n,n,n,n,s);return m.placeholder=xd.placeholder,m}a(xd,"curryRight");function Id(r,s,u){var m,y,w,M,I,N,k=0,F=!1,H=!1,q=!0;if(typeof r!="function")throw new At(o);s=Ot(s)||0,He(u)&&(F=!!u.leading,H="maxWait"in u,w=H?Xe(Ot(u.maxWait)||0,s):w,q="trailing"in u?!!u.trailing:q);function Z(qe){var Bt=m,dn=y;return m=y=n,k=qe,M=r.apply(dn,Bt),M}a(Z,"invokeFunc");function re(qe){return k=qe,I=ci(ge,s),F?Z(qe):M}a(re,"leadingEdge");function he(qe){var Bt=qe-N,dn=qe-k,qd=s-Bt;return H?rt(qd,w-dn):qd}a(he,"remainingWait");function ie(qe){var Bt=qe-N,dn=qe-k;return N===n||Bt>=s||Bt<0||H&&dn>=w}a(ie,"shouldInvoke");function ge(){var qe=ys();if(ie(qe))return be(qe);I=ci(ge,he(qe))}a(ge,"timerExpired");function be(qe){return I=n,q&&m?Z(qe):(m=y=n,M)}a(be,"trailingEdge");function Tt(){I!==n&&Fu(I),k=0,m=N=y=I=n}a(Tt,"cancel");function ct(){return I===n?M:be(ys())}a(ct,"flush");function Mt(){var qe=ys(),Bt=ie(qe);if(m=arguments,y=this,N=qe,Bt){if(I===n)return re(N);if(H)return Fu(I),I=ci(ge,s),Z(N)}return I===n&&(I=ci(ge,s)),M}return a(Mt,"debounced"),Mt.cancel=Tt,Mt.flush=ct,Mt}a(Id,"debounce");var Xv=me(function(r,s){return pu(r,1,s)}),Kv=me(function(r,s,u){return pu(r,Ot(s)||0,u)});function Yv(r){return on(r,le)}a(Yv,"flip");function vs(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new At(o);var u=a(function(){var m=arguments,y=s?s.apply(this,m):m[0],w=u.cache;if(w.has(y))return w.get(y);var M=r.apply(this,m);return u.cache=w.set(y,M)||w,M},"memoized");return u.cache=new(vs.Cache||rn),u}a(vs,"memoize"),vs.Cache=rn;function Es(r){if(typeof r!="function")throw new At(o);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}a(Es,"negate");function Qv(r){return wd(2,r)}a(Qv,"once");var Zv=Hg(function(r,s){s=s.length==1&&ue(s[0])?Fe(s[0],St(ne())):Fe(Ze(s,1),St(ne()));var u=s.length;return me(function(m){for(var y=-1,w=rt(m.length,u);++y<w;)m[y]=s[y].call(this,m[y]);return Et(r,this,m)})}),Xa=me(function(r,s){var u=gn(s,gr(Xa));return on(r,R,n,s,u)}),Cd=me(function(r,s){var u=gn(s,gr(Cd));return on(r,O,n,s,u)}),Jv=an(function(r,s){return on(r,Y,n,n,n,s)});function eE(r,s){if(typeof r!="function")throw new At(o);return s=s===n?s:de(s),me(r,s)}a(eE,"rest");function tE(r,s){if(typeof r!="function")throw new At(o);return s=s==null?0:Xe(de(s),0),me(function(u){var m=u[s],y=wn(u,0,s);return m&&pn(y,m),Et(r,this,y)})}a(tE,"spread");function nE(r,s,u){var m=!0,y=!0;if(typeof r!="function")throw new At(o);return He(u)&&(m="leading"in u?!!u.leading:m,y="trailing"in u?!!u.trailing:y),Id(r,s,{leading:m,maxWait:s,trailing:y})}a(nE,"throttle");function rE(r){return bd(r,1)}a(rE,"unary");function iE(r,s){return Xa(La(s),r)}a(iE,"wrap");function sE(){if(!arguments.length)return[];var r=arguments[0];return ue(r)?r:[r]}a(sE,"castArray");function oE(r){return Nt(r,g)}a(oE,"clone");function aE(r,s){return s=typeof s=="function"?s:n,Nt(r,g,s)}a(aE,"cloneWith");function lE(r){return Nt(r,f|g)}a(lE,"cloneDeep");function cE(r,s){return s=typeof s=="function"?s:n,Nt(r,f|g,s)}a(cE,"cloneDeepWith");function uE(r,s){return s==null||mu(r,s,Ye(s))}a(uE,"conformsTo");function Ht(r,s){return r===s||r!==r&&s!==s}a(Ht,"eq");var dE=ds(Sa),hE=ds(function(r,s){return r>=s}),$n=Su(function(){return arguments}())?Su:function(r){return Be(r)&&Re.call(r,"callee")&&!ou.call(r,"callee")},ue=L.isArray,fE=Vc?St(Vc):bg;function mt(r){return r!=null&&Ss(r.length)&&!cn(r)}a(mt,"isArrayLike");function Ge(r){return Be(r)&&mt(r)}a(Ge,"isArrayLikeObject");function mE(r){return r===!0||r===!1||Be(r)&&at(r)==Qe}a(mE,"isBoolean");var Tn=Rp||sl,pE=$c?St($c):wg;function gE(r){return Be(r)&&r.nodeType===1&&!ui(r)}a(gE,"isElement");function yE(r){if(r==null)return!0;if(mt(r)&&(ue(r)||typeof r=="string"||typeof r.splice=="function"||Tn(r)||yr(r)||$n(r)))return!r.length;var s=it(r);if(s==Pe||s==kt)return!r.size;if(li(r))return!Ta(r).length;for(var u in r)if(Re.call(r,u))return!1;return!0}a(yE,"isEmpty");function vE(r,s){return si(r,s)}a(vE,"isEqual");function EE(r,s,u){u=typeof u=="function"?u:n;var m=u?u(r,s):n;return m===n?si(r,s,n,u):!!m}a(EE,"isEqualWith");function Ka(r){if(!Be(r))return!1;var s=at(r);return s==fn||s==en||typeof r.message=="string"&&typeof r.name=="string"&&!ui(r)}a(Ka,"isError");function SE(r){return typeof r=="number"&&lu(r)}a(SE,"isFinite");function cn(r){if(!He(r))return!1;var s=at(r);return s==tn||s==Te||s==ht||s==qr}a(cn,"isFunction");function Rd(r){return typeof r=="number"&&r==de(r)}a(Rd,"isInteger");function Ss(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=J}a(Ss,"isLength");function He(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}a(He,"isObject");function Be(r){return r!=null&&typeof r=="object"}a(Be,"isObjectLike");var Ad=Uc?St(Uc):Mg;function bE(r,s){return r===s||wa(r,s,Ba(s))}a(bE,"isMatch");function wE(r,s,u){return u=typeof u=="function"?u:n,wa(r,s,Ba(s),u)}a(wE,"isMatchWith");function TE(r){return _d(r)&&r!=+r}a(TE,"isNaN");function ME(r){if(ay(r))throw new ce(i);return bu(r)}a(ME,"isNative");function xE(r){return r===null}a(xE,"isNull");function IE(r){return r==null}a(IE,"isNil");function _d(r){return typeof r=="number"||Be(r)&&at(r)==Ce}a(_d,"isNumber");function ui(r){if(!Be(r)||at(r)!=Ue)return!1;var s=ji(r);if(s===null)return!0;var u=Re.call(s,"constructor")&&s.constructor;return typeof u=="function"&&u instanceof u&&Ui.call(u)==wp}a(ui,"isPlainObject");var Ya=Gc?St(Gc):xg;function CE(r){return Rd(r)&&r>=-J&&r<=J}a(CE,"isSafeInteger");var Nd=qc?St(qc):Ig;function bs(r){return typeof r=="string"||!ue(r)&&Be(r)&&at(r)==jr}a(bs,"isString");function wt(r){return typeof r=="symbol"||Be(r)&&at(r)==Oi}a(wt,"isSymbol");var yr=zc?St(zc):Cg;function RE(r){return r===n}a(RE,"isUndefined");function AE(r){return Be(r)&&it(r)==Xr}a(AE,"isWeakMap");function _E(r){return Be(r)&&at(r)==zf}a(_E,"isWeakSet");var NE=ds(Ma),LE=ds(function(r,s){return r<=s});function Ld(r){if(!r)return[];if(mt(r))return bs(r)?Ft(r):ft(r);if(Qr&&r[Qr])return up(r[Qr]());var s=it(r),u=s==Pe?da:s==kt?Wi:vr;return u(r)}a(Ld,"toArray");function un(r){if(!r)return r===0?r:0;if(r=Ot(r),r===z||r===-z){var s=r<0?-1:1;return s*ye}return r===r?r:0}a(un,"toFinite");function de(r){var s=un(r),u=s%1;return s===s?u?s-u:s:0}a(de,"toInteger");function Dd(r){return r?Hn(de(r),0,$e):0}a(Dd,"toLength");function Ot(r){if(typeof r=="number")return r;if(wt(r))return nt;if(He(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=He(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=Zc(r);var u=fm.test(r);return u||pm.test(r)?jm(r.slice(2),u?2:8):hm.test(r)?nt:+r}a(Ot,"toNumber");function Od(r){return zt(r,pt(r))}a(Od,"toPlainObject");function DE(r){return r?Hn(de(r),-J,J):r===0?r:0}a(DE,"toSafeInteger");function Ie(r){return r==null?"":bt(r)}a(Ie,"toString");var OE=mr(function(r,s){if(li(s)||mt(s)){zt(s,Ye(s),r);return}for(var u in s)Re.call(s,u)&&ni(r,u,s[u])}),kd=mr(function(r,s){zt(s,pt(s),r)}),ws=mr(function(r,s,u,m){zt(s,pt(s),r,m)}),kE=mr(function(r,s,u,m){zt(s,Ye(s),r,m)}),FE=an(ya);function PE(r,s){var u=fr(r);return s==null?u:fu(u,s)}a(PE,"create");var HE=me(function(r,s){r=Ae(r);var u=-1,m=s.length,y=m>2?s[2]:n;for(y&&lt(s[0],s[1],y)&&(m=1);++u<m;)for(var w=s[u],M=pt(w),I=-1,N=M.length;++I<N;){var k=M[I],F=r[k];(F===n||Ht(F,ur[k])&&!Re.call(r,k))&&(r[k]=w[k])}return r}),BE=me(function(r){return r.push(n,Zu),Et(Fd,n,r)});function WE(r,s){return Xc(r,ne(s,3),qt)}a(WE,"findKey");function VE(r,s){return Xc(r,ne(s,3),Ea)}a(VE,"findLastKey");function $E(r,s){return r==null?r:va(r,ne(s,3),pt)}a($E,"forIn");function UE(r,s){return r==null?r:vu(r,ne(s,3),pt)}a(UE,"forInRight");function GE(r,s){return r&&qt(r,ne(s,3))}a(GE,"forOwn");function qE(r,s){return r&&Ea(r,ne(s,3))}a(qE,"forOwnRight");function zE(r){return r==null?[]:rs(r,Ye(r))}a(zE,"functions");function jE(r){return r==null?[]:rs(r,pt(r))}a(jE,"functionsIn");function Qa(r,s,u){var m=r==null?n:Bn(r,s);return m===n?u:m}a(Qa,"get");function XE(r,s){return r!=null&&td(r,s,yg)}a(XE,"has");function Za(r,s){return r!=null&&td(r,s,vg)}a(Za,"hasIn");var KE=ju(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=Gi.call(s)),r[s]=u},el(gt)),YE=ju(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=Gi.call(s)),Re.call(r,s)?r[s].push(u):r[s]=[u]},ne),QE=me(ii);function Ye(r){return mt(r)?du(r):Ta(r)}a(Ye,"keys");function pt(r){return mt(r)?du(r,!0):Rg(r)}a(pt,"keysIn");function ZE(r,s){var u={};return s=ne(s,3),qt(r,function(m,y,w){sn(u,s(m,y,w),m)}),u}a(ZE,"mapKeys");function JE(r,s){var u={};return s=ne(s,3),qt(r,function(m,y,w){sn(u,y,s(m,y,w))}),u}a(JE,"mapValues");var eS=mr(function(r,s,u){is(r,s,u)}),Fd=mr(function(r,s,u,m){is(r,s,u,m)}),tS=an(function(r,s){var u={};if(r==null)return u;var m=!1;s=Fe(s,function(w){return w=bn(w,r),m||(m=w.length>1),w}),zt(r,Pa(r),u),m&&(u=Nt(u,f|p|g,Kg));for(var y=s.length;y--;)Aa(u,s[y]);return u});function nS(r,s){return Pd(r,Es(ne(s)))}a(nS,"omitBy");var rS=an(function(r,s){return r==null?{}:_g(r,s)});function Pd(r,s){if(r==null)return{};var u=Fe(Pa(r),function(m){return[m]});return s=ne(s),Ru(r,u,function(m,y){return s(m,y[0])})}a(Pd,"pickBy");function iS(r,s,u){s=bn(s,r);var m=-1,y=s.length;for(y||(y=1,r=n);++m<y;){var w=r==null?n:r[jt(s[m])];w===n&&(m=y,w=u),r=cn(w)?w.call(r):w}return r}a(iS,"result");function sS(r,s,u){return r==null?r:oi(r,s,u)}a(sS,"set");function oS(r,s,u,m){return m=typeof m=="function"?m:n,r==null?r:oi(r,s,u,m)}a(oS,"setWith");var Hd=Yu(Ye),Bd=Yu(pt);function aS(r,s,u){var m=ue(r),y=m||Tn(r)||yr(r);if(s=ne(s,4),u==null){var w=r&&r.constructor;y?u=m?new w:[]:He(r)?u=cn(w)?fr(ji(r)):{}:u={}}return(y?Rt:qt)(r,function(M,I,N){return s(u,M,I,N)}),u}a(aS,"transform");function lS(r,s){return r==null?!0:Aa(r,s)}a(lS,"unset");function cS(r,s,u){return r==null?r:Du(r,s,La(u))}a(cS,"update");function uS(r,s,u,m){return m=typeof m=="function"?m:n,r==null?r:Du(r,s,La(u),m)}a(uS,"updateWith");function vr(r){return r==null?[]:ua(r,Ye(r))}a(vr,"values");function dS(r){return r==null?[]:ua(r,pt(r))}a(dS,"valuesIn");function hS(r,s,u){return u===n&&(u=s,s=n),u!==n&&(u=Ot(u),u=u===u?u:0),s!==n&&(s=Ot(s),s=s===s?s:0),Hn(Ot(r),s,u)}a(hS,"clamp");function fS(r,s,u){return s=un(s),u===n?(u=s,s=0):u=un(u),r=Ot(r),Eg(r,s,u)}a(fS,"inRange");function mS(r,s,u){if(u&&typeof u!="boolean"&&lt(r,s,u)&&(s=u=n),u===n&&(typeof s=="boolean"?(u=s,s=n):typeof r=="boolean"&&(u=r,r=n)),r===n&&s===n?(r=0,s=1):(r=un(r),s===n?(s=r,r=0):s=un(s)),r>s){var m=r;r=s,s=m}if(u||r%1||s%1){var y=cu();return rt(r+y*(s-r+zm("1e-"+((y+"").length-1))),s)}return Ia(r,s)}a(mS,"random");var pS=pr(function(r,s,u){return s=s.toLowerCase(),r+(u?Wd(s):s)});function Wd(r){return Ja(Ie(r).toLowerCase())}a(Wd,"capitalize");function Vd(r){return r=Ie(r),r&&r.replace(ym,sp).replace(Fm,"")}a(Vd,"deburr");function gS(r,s,u){r=Ie(r),s=bt(s);var m=r.length;u=u===n?m:Hn(de(u),0,m);var y=u;return u-=s.length,u>=0&&r.slice(u,y)==s}a(gS,"endsWith");function yS(r){return r=Ie(r),r&&Qf.test(r)?r.replace(vc,op):r}a(yS,"escape");function vS(r){return r=Ie(r),r&&rm.test(r)?r.replace(Xo,"\\$&"):r}a(vS,"escapeRegExp");var ES=pr(function(r,s,u){return r+(u?"-":"")+s.toLowerCase()}),SS=pr(function(r,s,u){return r+(u?" ":"")+s.toLowerCase()}),bS=Gu("toLowerCase");function wS(r,s,u){r=Ie(r),s=de(s);var m=s?cr(r):0;if(!s||m>=s)return r;var y=(s-m)/2;return us(Qi(y),u)+r+us(Yi(y),u)}a(wS,"pad");function TS(r,s,u){r=Ie(r),s=de(s);var m=s?cr(r):0;return s&&m<s?r+us(s-m,u):r}a(TS,"padEnd");function MS(r,s,u){r=Ie(r),s=de(s);var m=s?cr(r):0;return s&&m<s?us(s-m,u)+r:r}a(MS,"padStart");function xS(r,s,u){return u||s==null?s=0:s&&(s=+s),Lp(Ie(r).replace(Ko,""),s||0)}a(xS,"parseInt");function IS(r,s,u){return(u?lt(r,s,u):s===n)?s=1:s=de(s),Ca(Ie(r),s)}a(IS,"repeat");function CS(){var r=arguments,s=Ie(r[0]);return r.length<3?s:s.replace(r[1],r[2])}a(CS,"replace");var RS=pr(function(r,s,u){return r+(u?"_":"")+s.toLowerCase()});function AS(r,s,u){return u&&typeof u!="number"&&lt(r,s,u)&&(s=u=n),u=u===n?$e:u>>>0,u?(r=Ie(r),r&&(typeof s=="string"||s!=null&&!Ya(s))&&(s=bt(s),!s&&lr(r))?wn(Ft(r),0,u):r.split(s,u)):[]}a(AS,"split");var _S=pr(function(r,s,u){return r+(u?" ":"")+Ja(s)});function NS(r,s,u){return r=Ie(r),u=u==null?0:Hn(de(u),0,r.length),s=bt(s),r.slice(u,u+s.length)==s}a(NS,"startsWith");function LS(r,s,u){var m=E.templateSettings;u&&lt(r,s,u)&&(s=n),r=Ie(r),s=ws({},s,m,Qu);var y=ws({},s.imports,m.imports,Qu),w=Ye(y),M=ua(y,w),I,N,k=0,F=s.interpolate||ki,H="__p += '",q=ha((s.escape||ki).source+"|"+F.source+"|"+(F===Ec?dm:ki).source+"|"+(s.evaluate||ki).source+"|$","g"),Z="//# sourceURL="+(Re.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Vm+"]")+`
`;r.replace(q,function(ie,ge,be,Tt,ct,Mt){return be||(be=Tt),H+=r.slice(k,Mt).replace(vm,ap),ge&&(I=!0,H+=`' +
__e(`+ge+`) +
'`),ct&&(N=!0,H+=`';
`+ct+`;
__p += '`),be&&(H+=`' +
((__t = (`+be+`)) == null ? '' : __t) +
'`),k=Mt+ie.length,ie}),H+=`';
`;var re=Re.call(s,"variable")&&s.variable;if(!re)H=`with (obj) {
`+H+`
}
`;else if(cm.test(re))throw new ce(l);H=(N?H.replace(jf,""):H).replace(Xf,"$1").replace(Kf,"$1;"),H="function("+(re||"obj")+`) {
`+(re?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(N?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var he=Ud(function(){return Me(w,Z+"return "+H).apply(n,M)});if(he.source=H,Ka(he))throw he;return he}a(LS,"template");function DS(r){return Ie(r).toLowerCase()}a(DS,"toLower");function OS(r){return Ie(r).toUpperCase()}a(OS,"toUpper");function kS(r,s,u){if(r=Ie(r),r&&(u||s===n))return Zc(r);if(!r||!(s=bt(s)))return r;var m=Ft(r),y=Ft(s),w=Jc(m,y),M=eu(m,y)+1;return wn(m,w,M).join("")}a(kS,"trim");function FS(r,s,u){if(r=Ie(r),r&&(u||s===n))return r.slice(0,nu(r)+1);if(!r||!(s=bt(s)))return r;var m=Ft(r),y=eu(m,Ft(s))+1;return wn(m,0,y).join("")}a(FS,"trimEnd");function PS(r,s,u){if(r=Ie(r),r&&(u||s===n))return r.replace(Ko,"");if(!r||!(s=bt(s)))return r;var m=Ft(r),y=Jc(m,Ft(s));return wn(m,y).join("")}a(PS,"trimStart");function HS(r,s){var u=Q,m=se;if(He(s)){var y="separator"in s?s.separator:y;u="length"in s?de(s.length):u,m="omission"in s?bt(s.omission):m}r=Ie(r);var w=r.length;if(lr(r)){var M=Ft(r);w=M.length}if(u>=w)return r;var I=u-cr(m);if(I<1)return m;var N=M?wn(M,0,I).join(""):r.slice(0,I);if(y===n)return N+m;if(M&&(I+=N.length-I),Ya(y)){if(r.slice(I).search(y)){var k,F=N;for(y.global||(y=ha(y.source,Ie(Sc.exec(y))+"g")),y.lastIndex=0;k=y.exec(F);)var H=k.index;N=N.slice(0,H===n?I:H)}}else if(r.indexOf(bt(y),I)!=I){var q=N.lastIndexOf(y);q>-1&&(N=N.slice(0,q))}return N+m}a(HS,"truncate");function BS(r){return r=Ie(r),r&&Yf.test(r)?r.replace(yc,mp):r}a(BS,"unescape");var WS=pr(function(r,s,u){return r+(u?" ":"")+s.toUpperCase()}),Ja=Gu("toUpperCase");function $d(r,s,u){return r=Ie(r),s=u?n:s,s===n?cp(r)?yp(r):ep(r):r.match(s)||[]}a($d,"words");var Ud=me(function(r,s){try{return Et(r,n,s)}catch(u){return Ka(u)?u:new ce(u)}}),VS=an(function(r,s){return Rt(s,function(u){u=jt(u),sn(r,u,ja(r[u],r))}),r});function $S(r){var s=r==null?0:r.length,u=ne();return r=s?Fe(r,function(m){if(typeof m[1]!="function")throw new At(o);return[u(m[0]),m[1]]}):[],me(function(m){for(var y=-1;++y<s;){var w=r[y];if(Et(w[0],this,m))return Et(w[1],this,m)}})}a($S,"cond");function US(r){return mg(Nt(r,f))}a(US,"conforms");function el(r){return function(){return r}}a(el,"constant");function GS(r,s){return r==null||r!==r?s:r}a(GS,"defaultTo");var qS=zu(),zS=zu(!0);function gt(r){return r}a(gt,"identity");function tl(r){return wu(typeof r=="function"?r:Nt(r,f))}a(tl,"iteratee");function jS(r){return Mu(Nt(r,f))}a(jS,"matches");function XS(r,s){return xu(r,Nt(s,f))}a(XS,"matchesProperty");var KS=me(function(r,s){return function(u){return ii(u,r,s)}}),YS=me(function(r,s){return function(u){return ii(r,u,s)}});function nl(r,s,u){var m=Ye(s),y=rs(s,m);u==null&&!(He(s)&&(y.length||!m.length))&&(u=s,s=r,r=this,y=rs(s,Ye(s)));var w=!(He(u)&&"chain"in u)||!!u.chain,M=cn(r);return Rt(y,function(I){var N=s[I];r[I]=N,M&&(r.prototype[I]=function(){var k=this.__chain__;if(w||k){var F=r(this.__wrapped__),H=F.__actions__=ft(this.__actions__);return H.push({func:N,args:arguments,thisArg:r}),F.__chain__=k,F}return N.apply(r,pn([this.value()],arguments))})}),r}a(nl,"mixin");function QS(){return Ke._===this&&(Ke._=Tp),this}a(QS,"noConflict");function rl(){}a(rl,"noop");function ZS(r){return r=de(r),me(function(s){return Iu(s,r)})}a(ZS,"nthArg");var JS=Oa(Fe),eb=Oa(jc),tb=Oa(sa);function Gd(r){return Va(r)?oa(jt(r)):Ng(r)}a(Gd,"property");function nb(r){return function(s){return r==null?n:Bn(r,s)}}a(nb,"propertyOf");var rb=Xu(),ib=Xu(!0);function il(){return[]}a(il,"stubArray");function sl(){return!1}a(sl,"stubFalse");function sb(){return{}}a(sb,"stubObject");function ob(){return""}a(ob,"stubString");function ab(){return!0}a(ab,"stubTrue");function lb(r,s){if(r=de(r),r<1||r>J)return[];var u=$e,m=rt(r,$e);s=ne(s),r-=$e;for(var y=ca(m,s);++u<r;)s(u);return y}a(lb,"times");function cb(r){return ue(r)?Fe(r,jt):wt(r)?[r]:ft(ud(Ie(r)))}a(cb,"toPath");function ub(r){var s=++bp;return Ie(r)+s}a(ub,"uniqueId");var db=cs(function(r,s){return r+s},0),hb=ka("ceil"),fb=cs(function(r,s){return r/s},1),mb=ka("floor");function pb(r){return r&&r.length?ns(r,gt,Sa):n}a(pb,"max");function gb(r,s){return r&&r.length?ns(r,ne(s,2),Sa):n}a(gb,"maxBy");function yb(r){return Yc(r,gt)}a(yb,"mean");function vb(r,s){return Yc(r,ne(s,2))}a(vb,"meanBy");function Eb(r){return r&&r.length?ns(r,gt,Ma):n}a(Eb,"min");function Sb(r,s){return r&&r.length?ns(r,ne(s,2),Ma):n}a(Sb,"minBy");var bb=cs(function(r,s){return r*s},1),wb=ka("round"),Tb=cs(function(r,s){return r-s},0);function Mb(r){return r&&r.length?la(r,gt):0}a(Mb,"sum");function xb(r,s){return r&&r.length?la(r,ne(s,2)):0}return a(xb,"sumBy"),E.after=jv,E.ary=bd,E.assign=OE,E.assignIn=kd,E.assignInWith=ws,E.assignWith=kE,E.at=FE,E.before=wd,E.bind=ja,E.bindAll=VS,E.bindKey=Td,E.castArray=sE,E.chain=vd,E.chunk=my,E.compact=py,E.concat=gy,E.cond=$S,E.conforms=US,E.constant=el,E.countBy=Mv,E.create=PE,E.curry=Md,E.curryRight=xd,E.debounce=Id,E.defaults=HE,E.defaultsDeep=BE,E.defer=Xv,E.delay=Kv,E.difference=yy,E.differenceBy=vy,E.differenceWith=Ey,E.drop=Sy,E.dropRight=by,E.dropRightWhile=wy,E.dropWhile=Ty,E.fill=My,E.filter=Iv,E.flatMap=Av,E.flatMapDeep=_v,E.flatMapDepth=Nv,E.flatten=md,E.flattenDeep=xy,E.flattenDepth=Iy,E.flip=Yv,E.flow=qS,E.flowRight=zS,E.fromPairs=Cy,E.functions=zE,E.functionsIn=jE,E.groupBy=Lv,E.initial=Ay,E.intersection=_y,E.intersectionBy=Ny,E.intersectionWith=Ly,E.invert=KE,E.invertBy=YE,E.invokeMap=Ov,E.iteratee=tl,E.keyBy=kv,E.keys=Ye,E.keysIn=pt,E.map=gs,E.mapKeys=ZE,E.mapValues=JE,E.matches=jS,E.matchesProperty=XS,E.memoize=vs,E.merge=eS,E.mergeWith=Fd,E.method=KS,E.methodOf=YS,E.mixin=nl,E.negate=Es,E.nthArg=ZS,E.omit=tS,E.omitBy=nS,E.once=Qv,E.orderBy=Fv,E.over=JS,E.overArgs=Zv,E.overEvery=eb,E.overSome=tb,E.partial=Xa,E.partialRight=Cd,E.partition=Pv,E.pick=rS,E.pickBy=Pd,E.property=Gd,E.propertyOf=nb,E.pull=Fy,E.pullAll=gd,E.pullAllBy=Py,E.pullAllWith=Hy,E.pullAt=By,E.range=rb,E.rangeRight=ib,E.rearg=Jv,E.reject=Wv,E.remove=Wy,E.rest=eE,E.reverse=qa,E.sampleSize=$v,E.set=sS,E.setWith=oS,E.shuffle=Uv,E.slice=Vy,E.sortBy=zv,E.sortedUniq=Xy,E.sortedUniqBy=Ky,E.split=AS,E.spread=tE,E.tail=Yy,E.take=Qy,E.takeRight=Zy,E.takeRightWhile=Jy,E.takeWhile=ev,E.tap=pv,E.throttle=nE,E.thru=ps,E.toArray=Ld,E.toPairs=Hd,E.toPairsIn=Bd,E.toPath=cb,E.toPlainObject=Od,E.transform=aS,E.unary=rE,E.union=tv,E.unionBy=nv,E.unionWith=rv,E.uniq=iv,E.uniqBy=sv,E.uniqWith=ov,E.unset=lS,E.unzip=za,E.unzipWith=yd,E.update=cS,E.updateWith=uS,E.values=vr,E.valuesIn=dS,E.without=av,E.words=$d,E.wrap=iE,E.xor=lv,E.xorBy=cv,E.xorWith=uv,E.zip=dv,E.zipObject=hv,E.zipObjectDeep=fv,E.zipWith=mv,E.entries=Hd,E.entriesIn=Bd,E.extend=kd,E.extendWith=ws,nl(E,E),E.add=db,E.attempt=Ud,E.camelCase=pS,E.capitalize=Wd,E.ceil=hb,E.clamp=hS,E.clone=oE,E.cloneDeep=lE,E.cloneDeepWith=cE,E.cloneWith=aE,E.conformsTo=uE,E.deburr=Vd,E.defaultTo=GS,E.divide=fb,E.endsWith=gS,E.eq=Ht,E.escape=yS,E.escapeRegExp=vS,E.every=xv,E.find=Cv,E.findIndex=hd,E.findKey=WE,E.findLast=Rv,E.findLastIndex=fd,E.findLastKey=VE,E.floor=mb,E.forEach=Ed,E.forEachRight=Sd,E.forIn=$E,E.forInRight=UE,E.forOwn=GE,E.forOwnRight=qE,E.get=Qa,E.gt=dE,E.gte=hE,E.has=XE,E.hasIn=Za,E.head=pd,E.identity=gt,E.includes=Dv,E.indexOf=Ry,E.inRange=fS,E.invoke=QE,E.isArguments=$n,E.isArray=ue,E.isArrayBuffer=fE,E.isArrayLike=mt,E.isArrayLikeObject=Ge,E.isBoolean=mE,E.isBuffer=Tn,E.isDate=pE,E.isElement=gE,E.isEmpty=yE,E.isEqual=vE,E.isEqualWith=EE,E.isError=Ka,E.isFinite=SE,E.isFunction=cn,E.isInteger=Rd,E.isLength=Ss,E.isMap=Ad,E.isMatch=bE,E.isMatchWith=wE,E.isNaN=TE,E.isNative=ME,E.isNil=IE,E.isNull=xE,E.isNumber=_d,E.isObject=He,E.isObjectLike=Be,E.isPlainObject=ui,E.isRegExp=Ya,E.isSafeInteger=CE,E.isSet=Nd,E.isString=bs,E.isSymbol=wt,E.isTypedArray=yr,E.isUndefined=RE,E.isWeakMap=AE,E.isWeakSet=_E,E.join=Dy,E.kebabCase=ES,E.last=Dt,E.lastIndexOf=Oy,E.lowerCase=SS,E.lowerFirst=bS,E.lt=NE,E.lte=LE,E.max=pb,E.maxBy=gb,E.mean=yb,E.meanBy=vb,E.min=Eb,E.minBy=Sb,E.stubArray=il,E.stubFalse=sl,E.stubObject=sb,E.stubString=ob,E.stubTrue=ab,E.multiply=bb,E.nth=ky,E.noConflict=QS,E.noop=rl,E.now=ys,E.pad=wS,E.padEnd=TS,E.padStart=MS,E.parseInt=xS,E.random=mS,E.reduce=Hv,E.reduceRight=Bv,E.repeat=IS,E.replace=CS,E.result=iS,E.round=wb,E.runInContext=A,E.sample=Vv,E.size=Gv,E.snakeCase=RS,E.some=qv,E.sortedIndex=$y,E.sortedIndexBy=Uy,E.sortedIndexOf=Gy,E.sortedLastIndex=qy,E.sortedLastIndexBy=zy,E.sortedLastIndexOf=jy,E.startCase=_S,E.startsWith=NS,E.subtract=Tb,E.sum=Mb,E.sumBy=xb,E.template=LS,E.times=lb,E.toFinite=un,E.toInteger=de,E.toLength=Dd,E.toLower=DS,E.toNumber=Ot,E.toSafeInteger=DE,E.toString=Ie,E.toUpper=OS,E.trim=kS,E.trimEnd=FS,E.trimStart=PS,E.truncate=HS,E.unescape=BS,E.uniqueId=ub,E.upperCase=WS,E.upperFirst=Ja,E.each=Ed,E.eachRight=Sd,E.first=pd,nl(E,function(){var r={};return qt(E,function(s,u){Re.call(E.prototype,u)||(r[u]=s)}),r}(),{chain:!1}),E.VERSION=e,Rt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){E[r].placeholder=E}),Rt(["drop","take"],function(r,s){ve.prototype[r]=function(u){u=u===n?1:Xe(de(u),0);var m=this.__filtered__&&!s?new ve(this):this.clone();return m.__filtered__?m.__takeCount__=rt(u,m.__takeCount__):m.__views__.push({size:rt(u,$e),type:r+(m.__dir__<0?"Right":"")}),m},ve.prototype[r+"Right"]=function(u){return this.reverse()[r](u).reverse()}}),Rt(["filter","map","takeWhile"],function(r,s){var u=s+1,m=u==B||u==K;ve.prototype[r]=function(y){var w=this.clone();return w.__iteratees__.push({iteratee:ne(y,3),type:u}),w.__filtered__=w.__filtered__||m,w}}),Rt(["head","last"],function(r,s){var u="take"+(s?"Right":"");ve.prototype[r]=function(){return this[u](1).value()[0]}}),Rt(["initial","tail"],function(r,s){var u="drop"+(s?"":"Right");ve.prototype[r]=function(){return this.__filtered__?new ve(this):this[u](1)}}),ve.prototype.compact=function(){return this.filter(gt)},ve.prototype.find=function(r){return this.filter(r).head()},ve.prototype.findLast=function(r){return this.reverse().find(r)},ve.prototype.invokeMap=me(function(r,s){return typeof r=="function"?new ve(this):this.map(function(u){return ii(u,r,s)})}),ve.prototype.reject=function(r){return this.filter(Es(ne(r)))},ve.prototype.slice=function(r,s){r=de(r);var u=this;return u.__filtered__&&(r>0||s<0)?new ve(u):(r<0?u=u.takeRight(-r):r&&(u=u.drop(r)),s!==n&&(s=de(s),u=s<0?u.dropRight(-s):u.take(s-r)),u)},ve.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ve.prototype.toArray=function(){return this.take($e)},qt(ve.prototype,function(r,s){var u=/^(?:filter|find|map|reject)|While$/.test(s),m=/^(?:head|last)$/.test(s),y=E[m?"take"+(s=="last"?"Right":""):s],w=m||/^find/.test(s);y&&(E.prototype[s]=function(){var M=this.__wrapped__,I=m?[1]:arguments,N=M instanceof ve,k=I[0],F=N||ue(M),H=a(function(ge){var be=y.apply(E,pn([ge],I));return m&&q?be[0]:be},"interceptor");F&&u&&typeof k=="function"&&k.length!=1&&(N=F=!1);var q=this.__chain__,Z=!!this.__actions__.length,re=w&&!q,he=N&&!Z;if(!w&&F){M=he?M:new ve(this);var ie=r.apply(M,I);return ie.__actions__.push({func:ps,args:[H],thisArg:n}),new _t(ie,q)}return re&&he?r.apply(this,I):(ie=this.thru(H),re?m?ie.value()[0]:ie.value():ie)})}),Rt(["pop","push","shift","sort","splice","unshift"],function(r){var s=Vi[r],u=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",m=/^(?:pop|shift)$/.test(r);E.prototype[r]=function(){var y=arguments;if(m&&!this.__chain__){var w=this.value();return s.apply(ue(w)?w:[],y)}return this[u](function(M){return s.apply(ue(M)?M:[],y)})}}),qt(ve.prototype,function(r,s){var u=E[s];if(u){var m=u.name+"";Re.call(hr,m)||(hr[m]=[]),hr[m].push({name:s,func:u})}}),hr[ls(n,S).name]=[{name:"wrapper",func:n}],ve.prototype.clone=Bp,ve.prototype.reverse=Wp,ve.prototype.value=Vp,E.prototype.at=gv,E.prototype.chain=yv,E.prototype.commit=vv,E.prototype.next=Ev,E.prototype.plant=bv,E.prototype.reverse=wv,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=Tv,E.prototype.first=E.prototype.head,Qr&&(E.prototype[Qr]=Sv),E},"runInContext"),yn=vp();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Ke._=yn,define(function(){return yn})):On?((On.exports=yn)._=yn,ta._=yn):Ke._=yn}).call(Wr)});var Lf=Ms(nr=>{var bo=Nf();function Li(n){return n.reduce(function(e,t,i,o){return e+t})}a(Li,"sum");function Jt(n){if(bo.isArray(n))return n;if(typeof n=="string")return n.split("");throw Error("Parameter must be a string or array.")}a(Jt,"ensureArr");nr.jarowinkler=function(n,e,Y){n=Jt(n),e=Jt(e);var i,o;n.length>e.length?(i=n,o=e):(i=e,o=n);var l=Y||.7,c=.1,d=Math.floor(Math.max(i.length/2-1,0)),h=[],f=[],p,g,v,b,T=0;for(p=0;p<o.length;p++)for(b=o[p],g=Math.max(p-d,0),v=Math.min(p+d+1,i.length);g<v;g++)if(!f[g]&&b===i[g]){h[p]=g,f[g]=!0,T++;break}var S=[],C=[],x,_,R=0,O=0;for(x=0,_=0;x<o.length;x++)h[x]>-1&&(S[_]=o[x],_++);for(x=0,_=0;x<i.length;x++)f[x]&&(C[_]=i[x],_++);for(p=0;p<S.length;p++)S[p]!==C[p]&&R++;for(p=0;p<o.length&&n[p]===e[p];p++)O++;var U=T,Y=R/2;if(U){var le=(U/n.length+U/e.length+(U-Y)/U)/3,Q=le<l?le:le+Math.min(c,1/i.length)*O*(1-le);return Q}else return 0};nr.levenshtein=function(n,e,t){if(n=Jt(n),e=Jt(e),n.length===0)return e.length;if(e.length===0)return n.length;var i=t||{d:1,i:1,s:1},o=[],l=[],c=e.length+1,d,h,f,p;for(d=0;d<c;d++)o[d]=d;for(d=0;d<n.length;d++){for(l[0]=d+1,h=0;h<e.length;h++)f=n[d]===e[h]?0:i.s,l[h+1]=Math.min(l[h]+i.d,o[h+1]+i.i,o[h]+f);for(h=0;h<c;h++)o[h]=l[h]}return p=Math.max(n.length,e.length),(p-l[e.length])/p};nr.ngram=function(n,e,t){n=Jt(n),e=Jt(e);var i=n.length,o=e.length,l=t||2,c,d,h,f,p,g,v,b=[],T=[],S=[],C=[],x=[],_=i+1;if(i===0||o===0)return i===o?1:0;if(c=0,i<l||o<l){for(d=0,f=Math.min(i,o);d<f;d++)n[d]===e[d]&&c++;return c/Math.max(i,o)}for(d=0;d<i+l-1;d++)d<l-1?b[d]=0:b[d]=n[d-l+1];for(d=0;d<=i;d++)T[d]=d;for(h=1;h<=o;h++){if(h<l){for(p=0;p<l-h;p++)x[p]=0;for(p=l-h;p<l;p++)x[p]=e[p-(l-h)]}else x=e.slice(h-l,h);for(S[0]=h,d=1;d<=i;d++){for(c=0,g=l,f=0;f<l;f++)b[d-1+f]!==x[f]?c++:b[d-1+f]===0&&g--;v=c/g,S[d]=Math.min(Math.min(S[d-1]+1,T[d]+1),T[d-1]+v)}C=T,T=S,S=C}return 1-T[i]/Math.max(i,o)};nr.pearson=function(n,e){var t=[];Object.keys(n).forEach(function(g){e[g]&&t.push(g)});var i=t.length;if(i===0)return 0;var o=Li(t.map(function(g){return n[g]})),l=Li(t.map(function(g){return e[g]})),c=Li(t.map(function(g){return Math.pow(n[g],2)})),d=Li(t.map(function(g){return Math.pow(e[g],2)})),h=Li(t.map(function(g){return n[g]*e[g]})),f=h-o*l/i,p=Math.sqrt((c-Math.pow(o,2)/i)*(d-Math.pow(l,2)/i));return p===0?0:f/p};nr.jaccard=function(n,e){return n=Jt(n),e=Jt(e),bo.intersection(n,e).length/bo.union(n,e).length};nr.tanimoto=function(n,e){n=Jt(n),e=Jt(e);var t=bo.intersection(n,e).length;return t/(n.length+e.length-t)}});var zd={examinedAttributes:["class","src","placeholder","href","checked","disabled","contenteditable","draggable","hidden","inputmode","role","title","name","type","readonly","size","required","multiple","min","max","step","maxlength","alt","loop","controls","poster"]};var Er={attributesToExtract:zd.examinedAttributes,structuralVicinity:{type:"fixed",value:6,useDecayingLimit:!0},visualVicinity:{radius:50,scanStep:10},vicinityFeatureElementsOnly:!0,react:{}};var hi=(o=>(o[o.Query=0]="Query",o[o.Intersection=1]="Intersection",o[o.Interactables=2]="Interactables",o[o.All=3]="All",o))(hi||{});var xs={rect:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"]},Sr=class{constructor(e){this.document=e;this.limit=5;this.extractSVG=a(e=>Array.from(e.children).map(t=>{let i=xs[t.tagName.toLowerCase()];if(!i)return null;let o=i.reduce((c,d)=>{let h=t.getAttribute(d);return{...c,[d]:h}},{});return{tagName:t.tagName.toLowerCase(),attributes:o}}).filter(t=>!!t),"extractSVG")}static{a(this,"SVGsExtractor")}extract(e){let t=e.matches("svg")?[e]:e.querySelectorAll("svg");if(!(!t.length||t.length>this.limit))return Array.from(t).map(this.extractSVG)}};function Is(n){if(!n)return!1;let e=n.getBoundingClientRect();return e.top<=window.innerHeight&&e.left<=window.innerWidth&&e.bottom>=0&&e.right>=0}a(Is,"isElementInViewport");function Cs(n,e=!0){let t=window.getComputedStyle(n),i=t.opacity==="0";return{visible:t.visibility!=="hidden"&&t.display!=="none"&&(!e||!i),isTransparent:i}}a(Cs,"isElementVisibleByStyles");function jd(n,e,t=!0,i=!0){let o=n.getBoundingClientRect(),l=e.getBoundingClientRect(),c=o.left<l.right&&o.right>l.left,d=o.top<l.bottom&&o.bottom>l.top;return(!t||c)&&(!i||d)}a(jd,"elementsOverlap");function Xd(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView;if(!t)return null;let i=n.ownerDocument,o={top:0,left:0,right:t.innerWidth||i.documentElement.clientWidth,bottom:t.innerHeight||i.documentElement.clientHeight},l={top:Math.max(e.top,o.top),left:Math.max(e.left,o.left),right:Math.min(e.right,o.right),bottom:Math.min(e.bottom,o.bottom),height:0,width:0};return l.width=l.right-l.left,l.height=l.bottom-l.top,l.width>0&&l.height>0?l:null}a(Xd,"getOverlappingRectangleWithViewport");function ol(n){try{return getComputedStyle(n).position==="fixed"?!0:!n.parentElement||n.parentElement===document.body?!1:ol(n.parentElement)}catch(e){return console.error("isAncestorOrSelfFixed",e),!1}}a(ol,"isAncestorOrSelfFixed");function al(n){let{top:e}=n.getBoundingClientRect();return e<0?-e:0}a(al,"getHeightOfCroppedElementAboveViewport");function ll(n){let{bottom:e}=n.getBoundingClientRect(),t=window.innerHeight;return e>t?e-t:0}a(ll,"getHeightsOfCroppedElementBelowViewport");function Kd(n){if(!n.src)return!0;let e=window.location.origin;try{let t=new URL(n.src).origin;return e!==t}catch{return!1}}a(Kd,"isCrossOriginIframe");var we=a((n,e=document,{excludeCrossOriginIframes:t=!1,includeHTML:i=!1}={})=>{let o=[],l=a(d=>{d.querySelectorAll(n).forEach(h=>o.push(h))},"queryElement"),c=a(d=>{l(d);let h=[],f=a(p=>{p.shadowRoot&&h.push(p.shadowRoot),p.childNodes?.forEach(g=>f(g))},"findShadowRoots");f(d),h.forEach(p=>c(p)),d.querySelectorAll("iframe").forEach(p=>{if(!(t&&Kd(p)))try{let g=p.contentDocument;g&&c(g)}catch{return}})},"queryNode");return c(e),i&&e instanceof Document&&e.documentElement.matches(n)&&o.push(e.documentElement),o},"querySelectorAllExtended"),Un=a((n,e)=>{if(n.matches(e))return n;let t=n.slot;if(t){let l=n.parentElement;for(;l;){if(l.shadowRoot){let c=l.shadowRoot.querySelector(`slot[name="${t}"]`);if(c)return Un(c,e)}l=l.parentElement}return null}let i=n.closest(e);if(i)return i;let o=n.getRootNode();return o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Un(o.host,e):null},"closestExtended"),br=a((n,{flattenShadowRootChildren:e=!1}={})=>{let t=Array.from(n.childNodes);if(n.nodeType===Node.ELEMENT_NODE){let i=n;i.shadowRoot&&(t=t.filter(o=>!o.assignedSlot),e?t=t.concat(Array.from(i.shadowRoot.childNodes)):t.push(i.shadowRoot)),i.tagName.toLowerCase()==="slot"&&t.push(...i.assignedNodes())}return t},"childNodesExtended"),Yd=a(n=>{let e=Array.from(n.children);return n.shadowRoot&&(e=e.filter(t=>!t.assignedSlot),e.push(...Array.from(n.shadowRoot.children))),n.tagName.toLowerCase()==="slot"&&e.push(...n.assignedElements()),e},"childrenExtended");var hn=a(n=>{let e=n.parentElement;if(e)return e;switch(n.nodeType){case Node.ELEMENT_NODE:let i=n;if(i.assignedSlot)return i.assignedSlot;break;case Node.DOCUMENT_FRAGMENT_NODE:return n.host}let t=n.parentNode;if(t)switch(t.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return t.host;case Node.DOCUMENT_NODE:if(window.document===t)return null;let o=Array.from(window.document.querySelectorAll("iframe")).find(l=>l.contentDocument===t);if(o)return o}return null},"parentElementExtended");var fi=a((n,{includeComments:e=!0,includeCDATA:t=!0,trim:i=!0}={})=>{if(!n)return"";function o(h){switch(h.nodeType){case Node.ELEMENT_NODE:return d(h);case Node.TEXT_NODE:return i?h.nodeValue.trim():h.nodeValue;case Node.CDATA_SECTION_NODE:return t?`<![CDATA[${h.nodeValue}]]>`:"";case Node.COMMENT_NODE:return e?`<!--${h.nodeValue}-->`:"";default:return""}}a(o,"serializeNode");function l(h){return Array.from(h.childNodes).map(o).join("")}a(l,"serializeShadowRoot");function c(h){try{let f=h.contentDocument||h.contentWindow.document;return fi(f.documentElement)}catch{return""}}a(c,"serializeIframe");function d(h){let f=h.tagName.toLowerCase(),p=`<${f}`;return Array.from(h.attributes).forEach(g=>{p+=` ${g.name}="${g.value}"`}),p+=">",h.shadowRoot?p+=l(h.shadowRoot):["script","style","svg"].includes(f)||Array.from(h.childNodes).forEach(g=>{g instanceof Element&&g.tagName.toLowerCase()==="iframe"?p+=c(g):p+=o(g)}),p+=`</${f}>`,p}return a(d,"serializeElementNode"),n.tagName.toLowerCase()==="iframe"?c(n):o(n)},"serializeElement");var Xt=class{static{a(this,"ScrollHelper")}constructor(e){this.element=e,this.elRect=this.element.getBoundingClientRect()}scrollIntoView(){if(this.getScrollableParentsPositions(),!this.initialScrollPositions.length)return this;if(this.element.scrollIntoView({block:"center",inline:"center"}),!Is(this.element))for(let e of this.initialScrollPositions){let t=e.element.getBoundingClientRect();if(this.elRect.top<t.top||this.elRect.bottom>t.bottom){let i=this.elRect.top-t.top+e.element.scrollTop;e.element.scrollTop=i}}return this}restore(){this.initialScrollPositions.forEach(({element:e,top:t,left:i})=>{try{e.scroll(i,t)}catch(o){console.warn("[ScrollHelper/restore] couldn't restore initial scroll for",{element:e,top:t,left:i},o)}})}getScrollableParentsPositions(){this.initialScrollPositions=[];let e=hn(this.element);for(;e!=null;)(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&this.initialScrollPositions.push({element:e,top:e.scrollTop,left:e.scrollLeft}),e=hn(e)}};var yt=class n{constructor({target:e=document,disabled:t=!1,log:i=!0,name:o,monitorInput:l=!1}){this.ignoreMutationsWithAttributes=["checksum-data-visible","checksum-data-transparently-visible","checksum-data-visible-under-transparent-element","checksum-data-click-offset","checksum-target-node","checksumid"];this.ignoreMutationsWithAttributeRegexPatterns=["checksum-radial-traverse-.+"];this.ignoreElementsWithClasses=["checksum-dom-cache-ignore"];this.inputEnabledSelectors=["input","textarea","select","[contenteditable=true]"].join(",");this.shouldIgnoreMutationRecord=a(e=>{try{if(e.type==="attributes"&&this.ignoreMutationsWithAttributes.includes(e.attributeName)||e.type==="attributes"&&this.ignoreMutationsWithAttributeRegexPatterns.some(i=>new RegExp("^"+i+"$").test(e.attributeName)))return!0;if(e.type==="attributes"&&e.attributeName==="class"){let i=a(o=>o?o.split(" ").filter(l=>![":hover","rrweb-paused"].includes(l)).sort().join(" "):"","standardizeClassName");return i(e.oldValue)===i(e.target.className)}let t=a(i=>this.ignoreElementsWithClasses.some(o=>i.classList.contains(o)),"doesElementHaveIgnoredClass");if(e.type==="childList"&&Array.from(e.addedNodes).every(i=>t(i))&&Array.from(e.removedNodes).every(i=>t(i)))return!0}catch{}return!1},"shouldIgnoreMutationRecord");this.monitoredTextElements=[];this.monitorInputEnabledElement=a(e=>{e.addEventListener("input",t=>{this.invalidate()})},"monitorInputEnabledElement");this.target=e,this.name=o,this.disabled=t,this.logActivity=i,this.monitorInput=l,this.startObserver()}static{a(this,"DOMMutationDependentCache")}static{this.instances={}}static getInstance(e,t){let i=this.makeNameForCache(e,t?.flags);n.instances[i]||(n.instances[i]=new n({...t,name:t?.name??e}),t?.initialValue&&n.instances[i].set(t?.initialValue));let o=n.instances[i];return t?.invalidate&&o.invalidate(),o}static invalidateAll(){Object.values(n.instances).forEach(e=>e.invalidate())}static makeNameForCache(e,t){return`${e}${t?JSON.stringify(t):""}`}startObserver(){this.observer=new MutationObserver(e=>{e.every(this.shouldIgnoreMutationRecord)||(this.invalidate(),this.monitorInput&&e.forEach(t=>{t.addedNodes.forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE&&i.nodeType===Node.ELEMENT_NODE){let o=i;o.matches(this.inputEnabledSelectors)||o.isContentEditable?this.monitorInputEnabledElement(o):Array.from(o.querySelectorAll("*")).filter(l=>l.matches&&l.matches(this.inputEnabledSelectors)||l.isContentEditable).forEach(this.monitorInputEnabledElement)}})}))}),this.observer.observe(this.target,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.monitorInput&&this.startInputMonitoring()}startInputMonitoring(){this.monitoredTextElements=we(this.inputEnabledSelectors),this.monitoredTextElements.forEach(this.monitorInputEnabledElement)}get(){return this.log("get","has cache:",!!this.cache),this.cache}set(e){this.disabled||(this.cache=e)}hasCache(){return this.log("hasCache",!!this.cache),!!this.cache}invalidate(){this.set(void 0)}log(...e){this.logActivity&&console.log(`[DOMMutationDependentCache] ${this.name?`[${this.name}]`:""}:`,...e)}};function Je(n,e){try{if(!n.ownerDocument)return!1;let t=n.ownerDocument.defaultView;return t?n instanceof t[e]||n instanceof t.top?.[e]:!1}catch{}return!1}a(Je,"isNodeInstanceOf");function wr(n,e){return e??n?.ownerDocument?.defaultView??window}a(wr,"getElementWindow");async function cl(n,e,t){if(!e.length)return[];let i=n.ownerDocument;if(i===document)return[];let o=e.find(c=>c.contentDocument===i);if(!o)return[];let l=await t(o);return[...await cl(o,e,t),l]}a(cl,"getParentFramesSelectors");function Qd({ignoredIframesSelectors:n=[]}={}){let e=a(o=>o.filter(l=>!n.some(c=>l.matches(c))),"makeReturnValue"),t=yt.getInstance("playwrightElementSelectorGeneratorIframes",{log:!1});if(t.hasCache())return e(t.get());let i=we("iframe");return t.set(i),e(i)}a(Qd,"getIframes");function st(n,e={}){let{markTransparentElementsAsHidden:t=!0,markElementsHiddenByTransparentElementAsVisible:i=!1,scrollIntoView:o=!0,useCache:l=!1}=e;if(l){let v=Db(n,{markTransparentElementsAsHidden:t,markElementsHiddenByTransparentElementAsVisible:i,scrollIntoView:o});if(v)return v}let c,d={isHidden:!0},h=a((v,b=!0)=>(b&&c&&c.restore(),l&&Ob(n,v,{markTransparentElementsAsHidden:t,markElementsHiddenByTransparentElementAsVisible:i}),{...d,...v}),"prepareResult");if(!n)return h({isHidden:!0});n=n.tagName==="OPTION"&&(n.closest("select")||n.closest("datalist"))||n;let{visible:f,isTransparent:p}=Cs(n,t);if(d.isTransparent=p,!f)return h({isHidden:!0});if(kb(n,{scrollIntoView:o}))return h({isHidden:!0});try{let T=function(R){let O=R;for(;O;){if(O.nodeType===11)return[O,O.ownerDocument.defaultView];O=O.parentNode}};var g=T;a(T,"findShadowDocument"),o&&(c=new Xt(n).scrollIntoView());let v=Xd(n);if(!v)return h({isHidden:!0});let b=[[v.width/2,v.height/2,!0],[Math.max(v.width*.01,1),Math.max(v.height*.01,1)],[Math.min(v.width*.99,v.width-1),Math.max(v.height*.01,1)],[Math.max(v.width*.01,1),Math.min(v.height*.99,v.height-1)],[Math.min(v.width*.99,v.width-1),Math.min(v.height*.99,v.height-1)]],[S,C]=T(n)??[n.ownerDocument,n.ownerDocument.defaultView],x,_=wr(n);if(_&&n instanceof _.HTMLInputElement&&n.id&&n.type&&["checkbox","radio"].includes(n.type)){let R=we(`label[for="${n.id}"]`,S);R.length&&(x=R[0])}for(let[R,O,U]of b){let Y=v.left+R>=0&&v.left+R<=C.innerWidth?v.left+R:R,le=v.top+O>=0&&v.top+O<=C.innerHeight?v.top+O:O,Q=S.elementFromPoint(Y,le);if(Q===n)return h({isHidden:!1,clickOffset:U?void 0:{x:R,y:O}});if(!Q)continue;if(U===!0&&Q.shadowRoot)return h(st(Q,e));let se=Q;for(;se;){if(se===n||x&&x===se)return h({isHidden:!1,clickOffset:U?void 0:{x:R,y:O}});se=hn(se)}if(i)try{let fe=S.elementsFromPoint(Y,le);for(let V of fe){if(V===n)return h({isHidden:!1,clickOffset:U?void 0:{x:R,y:O},isBehindTransparentElement:!0});let B=C.getComputedStyle(V),X=V.getBoundingClientRect();if(!(B.opacity==="0"||B.visibility==="hidden"||/rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*0\s*\)/.test(B.backgroundColor))||X.width>v.width*1.2||X.height>v.height*1.2)break}}catch(fe){console.error("Error while checking transparent elements over interactable",fe)}}return c&&(c.restore(),c=void 0),x?st(x,e):h({isHidden:!0})}catch(v){throw v}}a(st,"isElementHidden");var Zd=a(n=>{let e=yt.getInstance("isElementHidden",{log:!1,flags:n}),t=e.get();return t||(t=new Map,e.set(t)),t},"getIsHiddenMapFromCache");function Db(n,e={}){let t=Zd(e);return t.has(n)?t.get(n):void 0}a(Db,"getIsElementHiddenFromCache");var Ob=a((n,e,t={})=>{Zd(t).set(n,e)},"setIsElemenetHiddenInCache");function kb(n,{scrollIntoView:e=!0}={}){let t=n.parentElement,i=window.getComputedStyle(n);if(i.position==="absolute"||i.position==="fixed")return!1;let o;e&&(o=new Xt(n).scrollIntoView());let l=a(d=>(o&&o.restore(),d),"restoreAndReturn"),c=wr(n);if(!c)return l(!1);for(;t;){if(!(t instanceof c.Element))return l(!1);let d=window.getComputedStyle(t);if(d.position==="absolute"||d.position==="fixed")return l(!1);let h=d.overflowX==="hidden",f=d.overflowY==="hidden";if((h||f)&&!jd(t,n,h,f))return l(!0);t=t.parentElement}return l(!1)}a(kb,"isHiddenByOverflow");var Gn=a(n=>st(n,{useCache:!0}).isHidden,"getIsElementHidden"),Rs=a((n,e)=>{let t=n.tagName.toLowerCase();switch(t){case"img":case"video":case"audio":return{type:0,tag:t,src:n.getAttribute("src"),size:{width:n.clientWidth,height:n.clientHeight},screenSize:{width:window.innerWidth,height:window.innerHeight},isRoot:e,isHidden:Gn(n)};case"svg":return{type:6,tag:t,components:new Sr(document).extract(n)[0],isRoot:e,isHidden:Gn(n)};case"a":return{type:2,tag:t,href:n.getAttribute("href"),text:n.innerText,isRoot:e,isHidden:Gn(n)};case"button":return{type:3,tag:t,text:n.innerText,buttonType:n.getAttribute("type")||"button",isRoot:e,isHidden:Gn(n)};case"input":return{type:4,tag:t,inputType:n.getAttribute("type"),placeholder:n.getAttribute("placeholder"),isRoot:e,isHidden:Gn(n)};case"table":case"form":case"textarea":case"iframe":case"select":return{type:1,tag:t,isRoot:e,isHidden:Gn(n)}}if(n.innerHTML.trim()===n.innerText&&n.innerHTML.length)return{type:5,tag:t,text:Fb(n.innerHTML),isRoot:e,isHidden:Gn(n)}},"extractFeatureFromElement"),Fb=a(n=>n.length>256?n.substring(0,256)+"...":n,"shortenText");var mi=a(n=>Object.keys(n||{}).reduce((e,t)=>{let i=n[t];return i&&(e[t]=i),e},{}),"sanitizeStaticMetadata"),Jd=a((n,e)=>{let t=mi(n),i=mi(e),o=a(d=>!d||Object.keys(d).length===0,"isEmpty");if(o(t)&&o(i))return!0;if(o(t)||o(i))return!1;let l=Object.keys(t).sort(),c=Object.keys(i).sort();if(l.length!==c.length||!l.every((d,h)=>d===c[h]))return!1;for(let d in t)if(t[d]!==i[d])return!1;return!0},"staticDataMatch"),As=a(n=>{let e=mi(n);return!(!e||!Object.keys(e).length)},"hasStaticData");function eh(n,e){let t=n.filter(d=>!d.isRoot);t.length>10&&(t=Object.values(t.reduce((d,h)=>{let f=`${h.type}_${h.tag}`;return d[f]?d:{...d,[f]:h}},{})));let i=Math.min(Math.ceil(t.length*e.innerFeatures.mandatoryPercentage),e.innerFeatures.mandatoryMax),l=a(d=>d.reduce((h,f)=>{let p=h.map(g=>[...g,f]).filter(g=>g.length<=i);return h.concat(p)},[[]]),"combinations")(t).filter(d=>d.length===i),c=[];return l.forEach(d=>{let h=[];d.forEach(p=>h.push(_s(p))),dl(h).forEach(p=>c.push(p.map(g=>`:has(${g})`).join("")))}),c}a(eh,"getInnerFeaturesQueries");function dl(n){if(!n.length)return[];let e=[],t=n.length-1;function i(o,l){for(var c=0,d=n[l].length;c<d;c++){var h=o.slice(0);h.push(n[l][c]),l===t?e.push(h):i(h,l+1)}}return a(i,"helper"),i([],0),e}a(dl,"cartesian");function _s(n){let e=[n.tag];switch(n.type){case 0:n.src&&e.push(`${n.tag}[src="${n.src}"]`);break;case 2:e.push(`${n.tag}[href="${n.href}"]`);break;case 3:break;case 4:e.push(`${n.tag}[type="${n.inputType}"]`),n.placeholder&&e.push(`${n.tag}[placeholder="${n.placeholder}"]`);break}return e}a(_s,"getFeatureSelector");var th=a((n,e,{contains:t=!1,matchWholeWord:i=!1}={})=>(e=e.replaceAll(`
`,"\\A ").replaceAll('"','\\"'),t?i?`[${n}="${e}"],[${n}*="${e} "],[${n}*=" ${e} "],[${n}*=" ${e}"]`:`[${n}*="${e}"]`:`[${n}="${e}"]`),"buildAttributeEqualityQuerySelector"),hl=a((n,e,{contains:t=!1,matchWholeWord:i=!1}={})=>t?i?n===e||n.startsWith(e)||n.includes(` ${e} `)||n.endsWith(e):n.includes(e):n===e,"checkStringEquality");var Tr=class{constructor(e){this.document=e;this.elementsByQueryCache={}}static{a(this,"AttributesExtractor")}getElementsByQuery(e){return this.elementsByQueryCache[e]||(this.elementsByQueryCache[e]=we(e,this.document)),this.elementsByQueryCache[e]}extract({element:e,setClass:t,setAttribute:i,getElementsInStructuralVicinity:o,getElementsInVisualVicinity:l}){for(let c=0;c<e.attributes.length;++c){let{name:d,value:h}=e.attributes[c];if(Er.attributesToExtract.includes(d)&&typeof h=="string"){if(d==="class"){h.split(" ").forEach(f=>{f.length&&t(f,this.processAttribute({element:e,getElementsInStructuralVicinity:o,getElementsInVisualVicinity:l},d,f,{contains:!0,matchWholeWord:!0}))});continue}i(d,this.processAttribute({element:e,getElementsInStructuralVicinity:o,getElementsInVisualVicinity:l},d,h))}}}processAttribute({element:e,getElementsInStructuralVicinity:t,getElementsInVisualVicinity:i},o,l,c={}){let d=this.getElementsByQuery("*"),h=th(o,l,c),f=this.getElementsByQuery(h),p=this.getElementsByQuery(`${e.tagName.toLowerCase()}`),g=f.filter(C=>C.tagName===e.tagName),v=t?t():[],b=v.filter(C=>C.element.attributes[o]&&hl(C.element.attributes[o].value,l,c)),T=i?i():[],S=T.filter(C=>C.element.attributes[o]&&hl(C.element.attributes[o].value,l,c));return{value:l,globalUniqueness:1-f.length/d.length,tagUniqueness:1-g.length/p.length,structuralVicinityUniqueness:t?1-b.length/v.length:void 0,visualVicinityUniqueness:i?1-S.length/T.length:void 0}}};var nh=a((n,{tag:e="*"}={})=>we(e).filter(t=>t.innerText?.trim()===n.trim()),"findElementsWithText");function Kt(n){let e=n.getRootNode();switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return Pb(n,e);default:return n.innerText}}a(Kt,"getInnerText");function Pb(n,e){let t=n.querySelectorAll("slot");if(!t.length)return n.innerText;let i=n.cloneNode(!0),o=i.querySelectorAll("slot");return t.forEach((l,c)=>{let d=l.assignedNodes();o[c].innerText=d.map(h=>{switch(h.nodeType){case Node.TEXT_NODE:return h.textContent;case Node.ELEMENT_NODE:return h.innerText}}).filter(h=>!!h).join(`
`)}),i.innerText.trim()}a(Pb,"extractInnerTextForElementInShadowDOM");var Ns=class{constructor(e){this.el=null;this.serializedElement="";this.attributes={};this.classes={};this.getElementsInStructuralVicinity=a(()=>this.structuralVicinityData.elementsInStructuralVicinity,"getElementsInStructuralVicinity");this.setElementStructuralVicinityData=a(e=>{this.structuralVicinityData=e},"setElementStructuralVicinityData");this.setElementVisualVicinityData=a(e=>{this.visualVicinityData=e},"setElementVisualVicinityData");this.getElementsInVisualVicinity=a(()=>this.visualVicinityData,"getElementsInVisualVicinity");this.setSerializedElement=a(e=>{this.serializedElement=e},"setSerializedElement");this.setAttribute=a((e,t)=>{this.attributes[e]=t},"setAttribute");this.setClass=a((e,t)=>{this.classes[e]=t},"setClass");this.setInnerText=a(e=>{this.innerText=e},"setInnerText");this.setStyle=a(e=>{this.style=e},"setStyle");this.setTag=a(e=>{this.tag=e},"setTag");this.setReact=a(e=>{this.react=e},"setReact");this.setInnerFeatures=a(e=>{this.innerFeatures=e},"setInnerFeatures");this.setPositioning=a(e=>{this.positioning=e},"setPositioning");this.setSVGs=a(e=>{this.svgs=e},"setSVGs");this.el=e,this.attributesExtractor=new Tr(this.el.ownerDocument)}static{a(this,"ESRAElementMetadataBuilder")}serialize(){}getSerializedElement(){return this.serializedElement}get element(){return this.el}getAttributes(){return this.attributes}getClasses(){return this.classes}getStyle(){return this.style}getInlineStyle(){return this.style.inline}getComputedStyle(){return this.style.computed}getTag(){return this.tag}getInnerFeatures(){return this.innerFeatures}getInnerText(){return this.innerText}getSVGs(){return this.svgs}toMetadata(){return{structuralVicinity:this.makeStructuralVicinityMetadata(),visualVicinity:this.makeVisualVicinityMetadata(),serializedElement:this.getSerializedElement(),attributes:this.getAttributes(),classes:this.getClasses(),innerText:this.getInnerText(),tag:this.getTag(),style:this.getStyle(),innerFeatures:this.getInnerFeatures(),staticCandidates:this.extractStaticCandidates(),positioning:this.positioning,svgs:this.getSVGs()}}extractStaticCandidates(){return mi({text:this.extractStaticTextCandidate(),labeled:this.extractLabeled(),labeling:this.extractLabeling(),svgTitle:this.extractSVGTitle()})}makeVicinityMetadata(e,t){return e.reduce((i,o)=>{let{qualified:l,feature:c}=this.isVicinityQualifiedElement(o.element);if(!l)return i;let d={},h={};this.attributesExtractor.extract({element:o.element,setClass:a((p,g)=>d[p]=g,"setClass"),setAttribute:a((p,g)=>h[p]=g,"setAttribute")});let f={tag:o.element.tagName.toLowerCase(),classes:d,attributes:h,text:this.extractTextForMetadata(o.element),feature:c,relativePosition:this.element.compareDocumentPosition(o.element),...t(o)};return i.push(f),i},[])}makeStructuralVicinityMetadata(){return this.makeVicinityMetadata(this.getElementsInStructuralVicinity(),e=>({position:e.position}))}makeVisualVicinityMetadata(){return this.makeVicinityMetadata(this.getElementsInVisualVicinity(),e=>({position:[e.position],distance:e.distance}))}isVicinityQualifiedElement(e){if(e===this.element)return{qualified:!1};if(!Er.vicinityFeatureElementsOnly)return{qualified:!0};let t=Rs(e);return{qualified:!!t,feature:t}}extractTextForMetadata(e){if(e.innerHTML!==e.innerText)return;let t=e.innerHTML;return t.length>256?t.substring(0,256)+"...":t}extractStaticTextCandidate(){switch(this.tag){case"input":case"textarea":return this.attributes?.placeholder?.value;default:return this.innerText?.content}}extractLabeling(){if(this.element.tagName.toLowerCase()==="label")return Kt(this.element);let e=Un(this.element,"label");if(e&&this.attributeExists(e.getAttribute("for")))return Kt(e);try{if(this.element.id&&this.element.id.length&&we(`[aria-labelledby="${this.element.id}"]`).length)return Kt(this.element)}catch(t){console.error("extractLabeling error",t)}}extractLabeled(){let e=this.element.getAttribute("aria-label");if(this.attributeExists(e))return e;let t=Un(this.element,"label");if(t&&!this.attributeExists(t.getAttribute("for")))return Kt(t);if(this.element.id&&this.element.id.length)try{let o=we(`label[for=${this.element.id}]`);if(o.length)return Kt(o[0])}catch{return}let i=this.element.getAttribute("aria-labelledby");if(this.attributeExists(i)){let o=we(i.split(" ").map(l=>`#${l}`).join(","));if(o.length)return Kt(o[0])}}extractSVGTitle(){try{if(this.element.tagName.toLowerCase()!=="svg")return;let e=this.element.querySelector("title");return e?Kt(e):void 0}catch(e){console.error("extractSVGTitle error",e)}}attributeExists(e){return e&&e.length>0}};var Ls=class{constructor(e,t){this.structuralVicinityData={elementsInStructuralVicinity:[],html:""};this.element=e,this.config=t}static{a(this,"StructuralVicinityExtractor")}getInitialLimit(){switch(this.config.type){case"ratio":return document.querySelectorAll("*").length*this.config.value;case"fixed":return this.config.value}}calculate(){let e=Date.now().toString();return this.structuralVicinityData.html=this.populateStructuralVicinity(this.element,["element"],{runId:e,step:0,limit:this.getInitialLimit()}),this.structuralVicinityData.elementsInStructuralVicinity.forEach(t=>t.element.attributes.removeNamedItem(`checksum-radial-traverse-${e}`)),this.structuralVicinityData}populateStructuralVicinity(e,t,i){let{runId:o,step:l,limit:c}=i;if(!e||l>c||e.attributes[`checksum-radial-traverse-${o}`]!==void 0)return"";this.structuralVicinityData.elementsInStructuralVicinity.push({element:e,position:t}),e.setAttribute(`checksum-radial-traverse-${o}`,l.toString());let f={runId:o,step:l+1,limit:this.config.useDecayingLimit?c-1:c},p=this.populateStructuralVicinity(hn(e),[...t,"parent"],f),g=this.populateStructuralVicinity(e.previousElementSibling,[...t,"left-sibling"],f),v=this.populateStructuralVicinity(e.nextElementSibling,[...t,"right-sibling"],f),b=[];Yd(e).map((S,C)=>b.push(this.populateStructuralVicinity(S,[...t,"child"],f)));let T=g+e.outerHTML.replace(e.innerHTML,b.join(""))+v;return p&&!p.includes(e.outerHTML)?p.replace("></",`>${T}</`):p?p.replace(e.outerHTML,T):T}};var pi=class{constructor(e,t){this.document=e;this.config=t;this.debug=!1;this.sampleBoxColors={0:"green",1:"orange",2:"red",3:"blue"}}static{a(this,"VisualVicinityExtractor")}calculate(e){let t=[],i=this.config.radius,o=this.config.scanStep,l=e.getBoundingClientRect();for(let c=l.left-i;c<l.left+l.width+i;c+=o)for(let d=l.top-i;d<l.top+l.height+i;d+=o){let h=c+o/2,f=d+o/2;if(this.doesRectContain(l,{left:c,top:d,right:c+o,bottom:d+o})){this.addTrace(h,f,o,3);continue}let p=this.document.elementFromPoint(h,f);if(!p)continue;let g=p.getBoundingClientRect();if(g.width>i*2&&g.height>i*2||this.doesRectContain(g,l)){this.addTrace(h,f,o,2);continue}if(!!t.find(({element:S})=>S===p)){this.addTrace(h,f,o,1);continue}let{position:b,distance:T}=this.getPosition(l,g);t.push({element:p,position:b,distance:T}),this.addTrace(h,f,o,0)}return t}getPosition(e,t){let{x:i,y:o}=this.getCenter(t),{x:l,y:c}=this.getCenter(e),d=a(()=>{let f=i-l,p=o-c;return f<0&&p<0?"top-left":f>0&&p<0?"top-right":f<0&&p>0?"bottom-left":f>0&&p>0?"bottom-right":f===0&&p<0?"top":f===0&&p>0?"bottom":f<0&&p===0?"left":f>0&&p===0?"right":"center"},"calcPosition");return{distance:a(()=>Number(Math.sqrt(Math.pow(l-i,2)+Math.pow(c-o,2)).toFixed(2)),"calcDistance")(),position:d()}}getCenter(e){return{x:e.width/2+e.left,y:e.height/2+e.top}}addTrace(e,t,i,o){if(!this.debug)return;let l=this.document.createElement("xdiv");l.setAttribute("style",`position: absolute; width: ${i}px; height: ${i}px; top: ${t}px; left: ${e}px; background: ${this.sampleBoxColors[o]}; z-index: 999999999999;opacity:0.4`),this.document.getElementsByTagName("body")[0].prepend(l)}doesRectContain(e,t){return t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom}doRectsOverlap(e,t){let i=e.right<t.left,o=e.left>t.right,l=e.top>t.bottom,c=e.top<t.top;return!(i||o||l||c)}};window.vve=new pi({radius:50,scanStep:10});var gi=di(rh());window.resq$=gi.resq$;window.resq$$=gi.resq$$;var ml=class{static{a(this,"Provider")}extract(e){let t=this.findParentComponent(e,{ignoreBaseElement:!0});return{component:t,parentComponent:this.findParentComponent(t.node)}}findParentComponent(e,{ignoreBaseElement:t=!1,baseElement:i=void 0}={}){let o=(0,gi.resq$$)("*",e.parentElement).find(l=>l.children.length===1&&l.children[0].node===e);return i=i??e,o&&(t||o.node!==i)?this.parseRESQresult(o):this.findParentComponent(e.parentElement,{baseElement:i,ignoreBaseElement:t})}parseRESQresult(e){if(!e)return;let t=a(i=>{switch(typeof i){case"string":return[i];case"object":return Array.isArray(i)?i.map(t):Object.keys(i)}},"parseState");return{name:e.name,node:e.node,isFragment:e.isFragment,stateTokens:t(e.state),propsNames:Object.keys(e.props),hasChildren:!!e.children.length}}},ih=new ml;var pl=class{static{a(this,"Provider")}extract(e){return{component:void 0,parentComponent:void 0}}},YM=new pl;var Os=class{constructor(e,t){this.provider=ih;this.element=e,this.config=t}static{a(this,"ReactMetadataExtractor")}extract(){return this.provider.extract(this.element)}};var ks=class{constructor(e){this.document=e;this.tagBaseComputedStyle={}}static{a(this,"StyleExtractor")}extract({element:e,setStyle:t}){let i=e.tagName.toLowerCase();try{if(!this.tagBaseComputedStyle[i]){let o=this.document.createElement(i);this.document.getElementsByTagName("body")[0].prepend(o),this.tagBaseComputedStyle[i]=this.sanitzieStyle(window.getComputedStyle(o)),o.remove()}}catch(o){if(console.error("Failed to extract style for tag",i,o),!this.tagBaseComputedStyle[i])return}t({inline:this.sanitzieStyle(e.style,{acceptEmptyValue:!1}),computed:this.diffComputedStyle(this.tagBaseComputedStyle[i],this.sanitzieStyle(window.getComputedStyle(e)))})}diffComputedStyle(e,t){return a((l,c)=>Object.keys(c).reduce((d,h)=>l[h]===c[h]?d:{...d,[h]:c[h]},{}),"oneWayDiff")(e,t)}sanitzieStyle(e,{acceptEmptyValue:t=!0}={}){return Object.keys(e).reduce((i,o)=>{if(!isNaN(o))return i;let l=e[o];return!t&&!l||(i[o]=l),i},{})}};var qn=class{constructor(){this.makeFeatureNode=a((e,t=void 0)=>{let i=e.nodeType===Node.ELEMENT_NODE;return{type:e.nodeType,tag:i?e.tagName.toLowerCase():void 0,feature:i?Rs(e,t):void 0,children:[],isRoot:t}},"makeFeatureNode");this.includeRootElements=!0;this.rootElementsTypeExceptions=[5];this.cache=yt.getInstance("innerFeaturesExtractor",{log:!1})}static{a(this,"InnerFeaturesExtractor")}extract(e){let t=[],i=this.makeFeatureNode(e,!0);return this.walk(e,i,t),t}getMapFromCache(){let e=this.cache.get();return e||(e=new Map,this.cache.set(e)),e}getFeatureNodeFromCache(e){let t=this.getMapFromCache();return t.has(e)?t.get(e):void 0}addFeatureNodeToCache(e,t){let i=this.getMapFromCache();i.set(e,t),this.cache.set(i)}walk(e,t,i){let o=!1;br(e).forEach(c=>{let d=this.getFeatureNodeFromCache(c)??this.makeFeatureNode(c),h=this.walk(c,d,i);h&&t.children.push(d),o||=h});let l=!!t.feature;return l&&(!t.isRoot||this.shouldIncludeRootNode(t))&&i.push(t.feature),this.addFeatureNodeToCache(e,t),l||o}shouldIncludeRootNode(e){return!(!this.includeRootElements||this.rootElementsTypeExceptions.includes(e.type))}};window.inner_features_extractor=new qn;var Mr=class{static{a(this,"InnerTextExtractor")}constructor(){}extract(e){return{content:Kt(e)??void 0}}};var Fs=class{constructor(e){this.document=e}static{a(this,"PositioningExtractor")}extract(e){let{top:t,bottom:i,left:o,right:l}=e.getBoundingClientRect(),c=document.documentElement.scrollHeight,d=document.documentElement.scrollWidth;return{viewport:{size:{height:window.innerHeight,width:window.innerWidth},element:{top:this.normalize(t,window.innerHeight),bottom:this.normalize(i,window.innerHeight),left:this.normalize(o,window.innerWidth),right:this.normalize(l,window.innerWidth)}},document:{size:{height:c,width:d},element:{top:this.normalize(t+window.scrollY,c),bottom:this.normalize(i+window.scrollY,c),left:this.normalize(o+window.scrollX,d),right:this.normalize(l+window.scrollX,d)}}}}normalize(e,t){return e/t}};var ut=class{constructor(e,t){this.stats={serializeElement:0,populateElementsInStructuralVicinity:0,populateElementsInVisualVicinity:0,extractAttributes:0,extractInnerText:0,extractStyle:0,extractTag:0,extractInnerFeatures:0,extractPositioning:0,extractSVGComponents:0,final:0};this.xmlSerializer=new XMLSerializer,this.document=e,this.config=t??Er,this.visualVicinityExtractor=new pi(this.document,this.config.visualVicinity),this.styleExtractor=new ks(this.document),this.innerFeaturesExtractor=new qn,this.innerTextExtractor=new Mr,this.positioningExtractor=new Fs(this.document)}static{a(this,"ESRAElementMetadataExtractor")}isSameDocument(e){return this.document===e}extract(e){let t=new Xt(e).scrollIntoView(),i=Date.now(),o=new Ns(e);return this.serializeElement(o),this.stats.serializeElement+=Date.now()-i,i=Date.now(),this.populateElementsInStructuralVicinity(o),this.stats.populateElementsInStructuralVicinity+=Date.now()-i,i=Date.now(),this.populateElementsInVisualVicinity(o),this.stats.populateElementsInVisualVicinity+=Date.now()-i,i=Date.now(),this.extractAttributes(o),this.stats.extractAttributes+=Date.now()-i,i=Date.now(),this.extractInnerText(o),this.stats.extractInnerText+=Date.now()-i,i=Date.now(),this.extractStyle(o),this.stats.extractStyle+=Date.now()-i,i=Date.now(),this.extractTag(o),this.stats.extractTag+=Date.now()-i,i=Date.now(),this.extractInnerFeatures(o),this.stats.extractInnerFeatures+=Date.now()-i,i=Date.now(),this.extractPositioning(o),this.stats.extractPositioning+=Date.now()-i,i=Date.now(),this.extractSVGComponents(o),this.stats.extractSVGComponents+=Date.now()-i,i=Date.now(),t.restore(),this.stats.final+=Date.now()-i,o}extractReact({element:e,setReact:t}){t(new Os(e,this.config.react).extract())}extractTag({element:e,setTag:t}){t(e.tagName.toLowerCase())}extractPositioning({element:e,setPositioning:t}){t(this.positioningExtractor.extract(e))}extractSVGComponents({element:e,setSVGs:t}){t(new Sr(this.document).extract(e))}serializeElement({element:e,setSerializedElement:t}){}extractAttributes({element:e,setClass:t,setAttribute:i,getElementsInStructuralVicinity:o,getElementsInVisualVicinity:l}){return new Tr(this.document).extract({element:e,setClass:t,setAttribute:i,getElementsInStructuralVicinity:o,getElementsInVisualVicinity:l})}populateElementsInStructuralVicinity({element:e,setElementStructuralVicinityData:t}){t(new Ls(e,this.config.structuralVicinity).calculate())}populateElementsInVisualVicinity({element:e,setElementVisualVicinityData:t}){t(this.visualVicinityExtractor.calculate(e))}extractInnerText({element:e,setInnerText:t}){t(this.innerTextExtractor.extract(e))}extractStyle({element:e,setStyle:t}){return this.styleExtractor.extract({element:e,setStyle:t})}extractInnerFeatures({element:e,setInnerFeatures:t}){t(this.innerFeaturesExtractor.extract(e))}};var et=class{static{a(this,"PlaywrightElementSelectorGenerator")}async injectSelectorsAndLocators(e,{testIdSelector:t,searchParentFrames:i=!0}={}){let o=e.map(l=>({container:l,removedAttributes:this.stripNodeAttributes(l.element)}));return o=await Promise.all(o.map(async l=>{let{selector:c,locator:d,parentFramesSelectors:h}=await this.getSelectorAndLocator(l.container.element,{testIdSelector:t,searchParentFrames:i,stripAttributes:!0});return{...l,selector:c,locator:d,parentFramesSelectors:h}})),o=await Promise.all(o.map(async l=>{if(!l.removedAttributes.id&&!l.removedAttributes.originalClasses||(this.restoreNodeAttributes(l.container.element,l.removedAttributes),window.playwright.$(l.selector)!==void 0))return l;let c=await this.getSelectorAndLocator(l.container.element,{testIdSelector:t,searchParentFrames:i,stripAttributes:!1});return console.log(`Selector ${l.selector} is not valid, generated new one: ${c.selector}`),Object.assign(l,c),l})),o.map(l=>{let{container:c,selector:d,locator:h,parentFramesSelectors:f}=l;return{...c,selector:d,locator:h,parentFramesSelectors:f}})}stripNodeAttributes(e){let t=e,i,o;t.id&&(i=t.id,t.removeAttribute("id"));try{if(o=t.getAttribute("class"),o&&typeof o=="string"){let l=o.split(" ").filter(c=>!c.startsWith("css-")&&!c.startsWith("jss-")).join(" ");t.setAttribute("class",l)}else o=void 0}catch(l){return console.warn("[playwright selector generator] error with class filtering",l),{}}return{id:i,originalClasses:o}}restoreNodeAttributes(e,t){let i=e,{id:o,originalClasses:l}=t;o&&i.setAttribute("id",o),l&&i.setAttribute("class",l)}getElementWindowPlaywright(e){let t=e.ownerDocument.defaultView;return t!==window&&!t.playwright&&(t.playwright=window.playwright),t.playwright}async safeGetSelectorAndLocator(e){try{return await this.getElementWindowPlaywright(e).generateSelectorAndLocator(e)}catch(t){return console.log("get selector and locator error",e.nodeType,e,`
`,t),{selector:"",locator:""}}}async getSelectorAndLocator(e,{testIdSelector:t,searchParentFrames:i=!0,stripAttributes:o=!0,ignoredIframesSelectors:l=[]}={}){if(!e)return null;let c=Qd({ignoredIframesSelectors:l}),d=i?await cl(e,c,async b=>(await this.getSelectorAndLocator(b,{searchParentFrames:!1})).selector):[],h=e,f=this.getTestAttributeSelector(h,t);if(f)return{selector:f,locator:`locator("${f}")`,parentFramesSelectors:d};let p;o&&(p=this.stripNodeAttributes(e));let{selector:g,locator:v}=await this.safeGetSelectorAndLocator(h);return p&&(this.restoreNodeAttributes(e,p),await this.getElementWindowPlaywright(e).$(g)!==e&&(console.log(`Selector ${g} is not valid, trying to generate new one`),{selector:g,locator:v}=await this.safeGetSelectorAndLocator(h))),{selector:g,locator:v,parentFramesSelectors:d}}async findIframeWindowByParentFrameSelectors(e=[]){let t=window.top;if(e&&e.length>0)for(let i of e)t=(await t.playwright.$(i)).contentWindow;return t}async selector(e,t){let i;try{i=await(await this.findIframeWindowByParentFrameSelectors(t)).playwright.$(e)}catch(o){console.log("selector error",e,o)}return i??this.selectFromFirstIframe(e)}getFirstIframeContentWindow(){let e=document.querySelector("iframe");if(!e)return;let t=e.contentWindow;return t.playwright||(t.playwright=window.playwright),t}async selectFromFirstIframe(e){let t=this.getFirstIframeContentWindow();if(t)try{return await t.playwright.$(e)}catch{console.log("selector error",e)}}getTestAttributeSelector(e,t){let i=["data-cy","data-testid","data-test-id","data-test"];for(let l of[t,...i])if(l&&e.getAttribute(l)){let c=`[${l}='${e.getAttribute(l)}']`;if(we(c).length===1)return c;if(we(c).length>1){let h=Array.from(we(c)).indexOf(e);return`${c} >> nth=${h}`}}}replaceAll(e,t,i){return e&&e.replace(new RegExp(t,"g"),i)}escapeSingleQuotes(e){return this.replaceAll(e,"'","\\'")}escapeBackslash(e){return e.replace(/\\/g,"\\\\")}};var sh=[{selector:'path[d="M17.5 13V15.6667C17.5 16.0203 17.3361 16.3594 17.0444 16.6095C16.7527 16.8595 16.357 17 15.9444 17H5.05556C4.643 17 4.24733 16.8595 3.95561 16.6095C3.66389 16.3594 3.5 16.0203 3.5 15.6667V13"] + path[d="M14.6673 6.92057L10.5007 2.75391L6.33398 6.92057"] + path[d="M10.5 2.75391V12.7539"]',description:"export button"},{selector:'path[d="M16.0893 13.1868C16.6838 12.7754 17.1321 12.1858 17.3697 11.503C17.6072 10.8202 17.6216 10.0796 17.4107 9.38816C17.1999 8.69667 16.7748 8.09007 16.1968 7.65594C15.6187 7.2218 14.9177 6.9826 14.1948 6.97285H12.8308C12.6017 6.20011 12.1996 5.48973 11.6549 4.89565C11.1102 4.30157 10.4374 3.83943 9.68735 3.54431C8.93734 3.24918 8.12995 3.12885 7.32648 3.19244C6.52301 3.25603 5.7446 3.50187 5.05036 3.9113C4.35612 4.32072 3.7643 4.88297 3.31985 5.55533C2.8754 6.22769 2.59001 6.99248 2.48535 7.79164C2.38068 8.59079 2.4595 9.40329 2.71582 10.1674C2.97214 10.9316 3.39921 11.6272 3.96461 12.2016"] + path[d="M10.0273 10.0039V16.8241"] + path[d="M13.0585 13.0351L10.0273 10.0039L6.99609 13.0351"]',description:"import button"},{selector:'path[d="M20.4696 21.5303C20.7625 21.8232 21.2373 21.8232 21.5302 21.5303C21.8231 21.2374 21.8231 20.7626 21.5302 20.4697L20.4696 21.5303ZM17.1802 16.1197C16.8873 15.8268 16.4125 15.8268 16.1196 16.1197C15.8267 16.4126 15.8267 16.8874 16.1196 17.1803L17.1802 16.1197ZM18.25 11C18.25 15.0041 15.0041 18.25 11 18.25V19.75C15.8325 19.75 19.75 15.8325 19.75 11H18.25ZM11 18.25C6.99594 18.25 3.75 15.0041 3.75 11H2.25C2.25 15.8325 6.16751 19.75 11 19.75V18.25ZM3.75 11C3.75 6.99594 6.99594 3.75 11 3.75V2.25C6.16751 2.25 2.25 6.16751 2.25 11H3.75ZM11 3.75C15.0041 3.75 18.25 6.99594 18.25 11H19.75C19.75 6.16751 15.8325 2.25 11 2.25V3.75ZM21.5302 20.4697L17.1802 16.1197L16.1196 17.1803L20.4696 21.5303L21.5302 20.4697Z"]',description:"search"},{selector:'path[d="M3.75 10H16.875"] + path[d="M8.125 5L3.125 10L8.125 15"]',description:"back"},{selector:'path[d="M3.33301 8H12.6663"] + path[d="M8 3.33331L12.6667 7.99998L8 12.6666"]',description:"forward"},{selector:'path[d="M10 4.16667V15.8333"] + path[d="M4.16699 10H15.8337"]',description:"new or Add button"},{selector:'path[d="M10 10.75C10.4142 10.75 10.75 10.4142 10.75 10C10.75 9.58579 10.4142 9.25 10 9.25C9.58579 9.25 9.25 9.58579 9.25 10C9.25 10.4142 9.58579 10.75 10 10.75Z"] + path[d="M15.833 10.75C16.2472 10.75 16.583 10.4142 16.583 10C16.583 9.58579 16.2472 9.25 15.833 9.25C15.4188 9.25 15.083 9.58579 15.083 10C15.083 10.4142 15.4188 10.75 15.833 10.75Z"] + path[d="M4.16699 10.75C4.58121 10.75 4.91699 10.4142 4.91699 10C4.91699 9.58579 4.58121 9.25 4.16699 9.25C3.75278 9.25 3.41699 9.58579 3.41699 10C3.41699 10.4142 3.75278 10.75 4.16699 10.75Z"]',description:"open menu"},{selector:'path[d="M10 4.16667V15.8333"] + path[d="M4.16699 10H15.8337"]',description:"add filter"},{selector:'path[d="M15 5L5 15"] + path[d="M5 5L15 15"]',description:"close or remove"},{selector:'path[d="M4 6L8 10L12 6"]',description:"open or close dropdown"},{selector:'path[d="M10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5Z"] + path[d="M12.5 7.5L7.5 12.5"] + path[d="M7.5 7.5L12.5 12.5"]',description:"clear input"},{selector:'path[d="M3.33301 5.49054H4.81449H16.6663"] + path[d="M7.14286 5.49999V3.99999C7.14286 3.60216 7.29337 3.22063 7.56128 2.93932C7.82919 2.65802 8.19255 2.49998 8.57143 2.49998H11.4286C11.8075 2.49998 12.1708 2.65802 12.4387 2.93932C12.7066 3.22063 12.8571 3.60216 12.8571 3.99999V5.49999M15 5.49999V16C15 16.3978 14.8495 16.7793 14.5816 17.0607C14.3137 17.342 13.9503 17.5 13.5714 17.5H6.42857C6.04969 17.5 5.68633 17.342 5.41842 17.0607C5.15051 16.7793 5 16.3978 5 16V5.49999H15Z"] + path[d="M8.33203 9.23726V13.4039"] + path[d="M11.666 9.23726V13.4039"]',description:"delete"},{selector:'path[d="M13.3334 4L6.00008 11.3333L2.66675 8"]',description:"checked"},{selector:'path[d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"]',description:"downward-pointing arrow"},{selector:'path[d="M18.0893 3.08926C18.4147 2.76382 18.4147 2.23618 18.0893 1.91074C17.7638 1.58531 17.2362 1.58531 16.9107 1.91074L18.0893 3.08926ZM9.41074 9.41074L8.82149 10L10 11.1785L10.5893 10.5893L9.41074 9.41074ZM16.9107 1.91074L9.41074 9.41074L10.5893 10.5893L18.0893 3.08926L16.9107 1.91074Z"] + path[d="M17.5 2.5L12.25 17.5L9.25 10.75L2.5 7.75L17.5 2.5Z"]',description:"send"}];var Hb=5*60*1e3,Ps=class{constructor(){this.flashingTextElements=[]}static{a(this,"FlashingElementsDetector")}start(){this.stop(),this.flashingTextElements=[],this.observer=new MutationObserver(e=>{e.forEach(t=>{t.addedNodes.length>0&&t.addedNodes.forEach(i=>{i instanceof HTMLElement&&this.includeElement(i)&&setTimeout(()=>{this.flashingTextElements.push(this.processTextElements(i))},1e3)})})}),this.observer.observe(document.body,{childList:!0,subtree:!0}),this.monitoringPeriodTimeout=setTimeout(()=>{this.stop()},Hb)}stop(){this.monitoringPeriodTimeout&&(clearTimeout(this.monitoringPeriodTimeout),this.monitoringPeriodTimeout=null),this.observer&&(this.observer.disconnect(),this.observer=null)}get(){let e=this.flashingTextElements.map(i=>i.filter(o=>!o.isConnected||st(o.parentElement).isHidden)).filter(i=>i.length).map(i=>`<span>${i.map(o=>o.textContent).join("</span><span>")}</span>`),t=new Set(e);return Array.from(t)}stopAndGet(){return this.stop(),this.get()}includeElement(e){return!(e.getElementsByTagName("*").length>50||e.outerHTML.length>5e3)}processTextElements(e){let t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),i,o=[];for(;i=t.nextNode();)st(i.parentNode).isHidden||o.push(i);return o}};var xr=class{static{a(this,"AlphaNumericCounter")}constructor(e){this.counter=e??"0"}increment(){let e=this.counter.length-1;for(;e>=0;){let t=this.counter[e];if(t==="9"){this.counter=this.replaceAt(this.counter,e,"a");return}else if(t==="z"){if(this.counter=this.replaceAt(this.counter,e,"0"),e===0){this.counter="1"+this.counter;return}e--}else{this.counter=this.replaceAt(this.counter,e,String.fromCharCode(t.charCodeAt(0)+1));return}}}get(){return this.counter}incrementAndGet(){return this.increment(),this.get()}getAndIncrement(){let e=this.get();return this.increment(),e}replaceAt(e,t,i){return e.substr(0,t)+i+e.substr(t+i.length)}static compare(e,t){let i=e.length,o=t.length;if(i!==o)return i-o;for(let l=0;l<i;l++){let c=e.charCodeAt(l),d=t.charCodeAt(l);if(c!==d)return c-d}return 0}};var yi="checksum-ignore",Bs="checksum-get-more-items",oh=20,Bb=.7,Hs,ah,Wb=0,lh=a((n,{forceIncludeAttribute:e,forceIncludeFileInput:t,forceIncludeElements:i,limit:o})=>{n.excludedElements?.forEach(b=>{b.removeAttribute(yi)}),n.excludedElements=new Set;let l=n.element,c=o??Math.min(Math.ceil(l.children.length*.5),l.children.length-oh),d=a(b=>e&&(b.hasAttribute(e)||Array.from(b.querySelectorAll(`[${e}]`)).length>0)||t&&b.tagName.toLowerCase()==="input"&&b.type==="file"?!0:i.includes(b),"isForceIncluded"),h=a(b=>{let T=0;if(n.elementsToKeep.includes(b))return T;let S=gl(b);S.length>=n.attributes.length&&T++;let C=S.filter(R=>n.attributes.includes(R)).length;C===n.attributes.length?T+=3:C>0&&T++;let _=yl(b).filter(R=>n.classes.includes(R)).length;return _===n.classes.length?T+=2:_>0&&T++,T},"scoreElement"),f=Array.from(l.children).filter(b=>b.tagName===n.tagName&&!d(b)).map(b=>({element:b,score:h(b)})).sort((b,T)=>T.score-b.score),{inViewportElements:p,outOfViewportElements:g}=f.reduce((b,T)=>{let{element:S}=T;return Is(Je(S,"Element")?S:S?.parentElement)?b.inViewportElements.push(S):b.outOfViewportElements.push(S),b},{inViewportElements:[],outOfViewportElements:[]}),v=a(b=>{for(let T of b)if(n.excludedElements.add(T),n.excludedElements.size===c)return!0},"excludeElements");return v(g)||v(p),Vb(n),Array.from(n.excludedElements)},"viewportReducer");function Vb(n){let{excludedElements:e,element:t}=n;e.forEach(i=>{i.setAttribute(yi,"")}),t._getmoreitemsid||(t._getmoreitemsid="gm"+Wb++),n.id=t._getmoreitemsid,t.setAttribute(Bs,n.id)}a(Vb,"markTemplateElements");function gl(n){return Array.from(n.attributes).filter(e=>!e.name.startsWith("checksum")).map(e=>e.name.replace(/[0-9]/g,""))}a(gl,"mapAttributes");function yl(n){return n.className?.split(" ").filter(e=>e)??[]}a(yl,"getElementClasses");function zn(n=document.body,{nodeRepetitionsThreshold:e=oh}={}){try{return console.time("bettertemplatize"),Hs=new Set,ch(n,e),console.timeEnd("bettertemplatize"),console.log("[bettertemplatize] templates found:",Array.from(Hs)),Array.from(Hs)}catch(t){return console.error("[bettertemplatize] failed during template processing:",t.message),[]}}a(zn,"bettertemplatize");function ch(n,e){Array.from(n.children).forEach(t=>{if(t instanceof SVGElement)return;let i=t.children.length;if(i>=e){let o=Array.from(t.children),l=Math.ceil(i*Bb);for(let c=0;c<i;c++){let d=0,h=o.slice(0,c);for(let f=c+1;f<i&&d+i-f>=l;f++)try{if(uh(o[c],o[f])){if(d++,d>=l){Hs.add({element:t,...ah,elementsToKeep:h});return}}else h.push(o[f])}catch{return}}}ch(t,e)})}a(ch,"traverse");var $b=.8,Ub=.5,Gb=.8,qb=5;function uh(n,e,t=1){let i,o,l=a(S=>(S&&(ah={attributes:i,classes:o,tagName:n.nodeName}),S),"response");if(n.nodeType!==e.nodeType)return l(!1);if(n instanceof SVGElement&&e instanceof SVGElement||n.nodeType===Node.TEXT_NODE)return l(!0);if(n.nodeType!==Node.ELEMENT_NODE)return l(!1);let c=n,d=e;if(c.tagName.toLowerCase()!==d.tagName.toLowerCase())return l(!1);let h=gl(c),f=gl(d);if(i=h.filter(S=>f.includes(S)),i.length/Math.max(h.length,f.length)<$b)return l(!1);let p=yl(c),g=yl(d);if(o=p.filter(S=>g.includes(S)),o.length/Math.max(p.length,g.length)<Ub)return l(!1);if(t>=qb)return l(!0);if(c.shadowRoot&&!d.shadowRoot||!c.shadowRoot&&d.shadowRoot)return l(!1);let v=Array.from(c.shadowRoot?c.shadowRoot.children:c.children),b=Array.from(d.shadowRoot?d.shadowRoot.children:d.children);if(v.length===0&&b.length===0)return l(!0);let T=0;for(let S=0;S<Math.min(v.length,b.length);S++)uh(v[S],b[S],t+1)&&T++;return T/Math.max(v.length,b.length)<Gb?l(!1):l(!0)}a(uh,"areSimilar");var Mn=a(n=>{},"consoleTime"),xn=a(n=>{},"consoleTimeEnd");var vi=["button","select","input","textarea","option","a","[role=button]","[role=checkbox]","[role=radio]","[role=link]","[type=button]","[aria-disabled=false]",'[id^="react-select"]',"label[for]"],dh=["pointer","grab","text","vertical-text","zoom-in","zoom-out","help"],hh=["onClick","onMouseDown","onKeyDown","onKeyPress","onInput","onSelect","onDoubleClick","onDragStart","onDrag","onDragEnd","onDragOver","onDrop","onToggle","onMouseEnter"],vl=["onclick","onmousedown","onkeydown","onkeypress","oninput","onselect","ondblclick","ondragstart","ondrag","ondragend","ondragover","ondrop","ontoggle","onmouseenter"];var jn=a((n,e=[])=>{if(!n)return n;let t=window.getComputedStyle(n).cursor,i=a((l,c=()=>!1)=>{let d=l;for(;d;){let h=d.parentElement;if(!h||h.nodeType!==Node.ELEMENT_NODE)return d;if(c(h))break;if(window.getComputedStyle(h).cursor!==t)return d;d=h}},"getClosestElementWithCursor"),o=a(l=>{try{if(l.matches("label[for]")&&!l.matches(vi.concat(e).filter(c=>!!c&&c!=="label[for]").join(","))){let c=l.getAttribute("for");if(!c)return!1;let d=document.getElementById(c);if(!d)return!1;let h=d.getAttribute("type");return h?d.tagName.toLowerCase()==="input"&&["checkbox","radio"].includes(h):!1}}catch(c){console.error("interactableParentIsValid",l,c)}return!0},"interactableParentIsValid");try{if("isContentEditable"in n&&n.isContentEditable)return n;if("closest"in n){let c=Un(n,vi.concat(e).filter(d=>!!d).join(","));if(c&&o(c)){if(c===n)return n;let d=i(n,h=>h===c);return d||c}}if(["auto","default","context-menu","help","progress","wait"].includes(t))return n;let l=i(n);return l||n}catch(l){return console.error("getCompoundInteractableRootElement",n,l),n}},"getCompoundInteractableRootElement");var Wt=a((n=document,e={},{allowDisabled:t=!1,useDataVisibleAttributes:i=!0,excludeCrossOriginIframes:o=!1,includeCompoundInnerElements:l=!0}={})=>{let c=yt.getInstance("getAllInteractableHTMLElements",{target:n,log:!1}),d=Date.now(),h=a(b=>{let T=b.reduce((S,C)=>!t&&C.state.disabled?S:[...S,C.element],[]);return console.log("[getAllInteractableHTMLElements] done, took",Date.now()-d,"ms"),T},"makeResponse");if(c.hasCache())return h(c.get());let f=we("*",n,{excludeCrossOriginIframes:o});Mn("[getAllInteractableHTMLElements] items");let p=f.reduce((b,T)=>{let S="disabled"in T&&!!T.disabled;return T.matches(vi.concat(e.appSpecificInteractableElementsSelectors||[]).filter(x=>!!x).join(","))||dh.includes(window.getComputedStyle(T).cursor)||T.isContentEditable&&!T.parentElement?.isContentEditable||!e.ignoreEventListenersWhenDeterminingInteractability&&(vl.some(x=>T[x])||jb(T))?[...b,{element:T,disabled:S}]:b},[]);xn("[getAllInteractableHTMLElements] items"),Mn("[getAllInteractableHTMLElements] getCompoundInteractableRootElement");let g=p.reduce((b,T)=>{let S=jn(T.element,e.appSpecificInteractableElementsSelectors||[]),C=b.find(x=>x.element===S);return C?!T.disabled&&C.state.disabled&&(C.state.disabled=!1):b.push({element:S,state:{disabled:T.disabled}}),l&&T.element!==S&&zb(T.element)&&b.push({...T,state:{disabled:T.disabled}}),b},[]);xn("[getAllInteractableHTMLElements] getCompoundInteractableRootElement"),Mn("[getAllInteractableHTMLElements] isElementHidden");let v=g.filter(({element:b})=>{if(i){if(!b)return!1;let T=b.getAttribute("checksum-data-visible");if(T){let S=T==="true",C=b.getAttribute("checksum-data-visible-under-transparent-element")==="true",x=b.getAttribute("checksum-data-transparently-visible")==="true";return S&&!C||x}}return!st(b,{markTransparentElementsAsHidden:!1}).isHidden});return xn("[getAllInteractableHTMLElements] isElementHidden"),c.set(v),h(v)},"getAllInteractableHTMLElements"),zb=a(n=>["img","video","audio","a","svg","button"].includes(n.tagName.toLowerCase())?!0:Array.from(n.childNodes).filter(e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim()).length>0,"hasUniqueFeatures"),jb=a(n=>{if(n._checksum_eventListenerList){let i=n._checksum_eventListenerList;if(vl.some(o=>i[o.slice(2)]))return!0}let e=Object.keys(n).find(i=>i.startsWith("__reactFiber")),t=e?n[e]:void 0;return!t||!t.memoizedProps?!1:hh.some(i=>t.memoizedProps[i])},"hasFrameworkInteractionListener");var fh=16e3;var Xb=!0,El={markTransparentElementsAsHidden:!1,markElementsHiddenByTransparentElementAsVisible:!0},Ir=class{constructor(){this.checksumIdToRRwebIdMap={};this.flashingElementsDetector=new Ps;this.forceIncludeElements=[];this.preMapReducedHTMLSelectors=!1;this.excludedNodes=0;this.reducePercentage=50;this.defaultReduceHTMLOptions={checkElementInstanceType:!0,extraAllowedAttributes:[],initialChecksumId:void 0,forceIncludeFileInput:!1,forceIncludeAttribute:void 0,invalidateCache:!1,svgIntegration:"aria-label",includeFlashingElements:!0,onForceIncludeElement:a(()=>{},"onForceIncludeElement"),limitNodeRepetitions:50,stopFlashingElementsDetection:!1,assignChecksumIdsToAllElements:!0,assignRrwebIdsToAllElements:!0}}static{a(this,"HTMLReducer")}preprocessDocument(e=document){Mn("[preprocessDocument] querySelectorAllExtended");let t=we("*",e,{includeHTML:!0});xn("[preprocessDocument] querySelectorAllExtended"),Mn("[preprocessDocument] isElementHidden");for(let i of t){if(this.shouldIgnoreElement(i))continue;let o=st(i,El);i.setAttribute("checksum-data-visible",!o.isHidden&&!o.isTransparent?"true":"false"),!o.isHidden&&o.isTransparent&&i.setAttribute("checksum-data-transparently-visible","true"),o.isBehindTransparentElement&&i.setAttribute("checksum-data-visible-under-transparent-element","true"),o.clickOffset&&i.setAttribute("checksum-data-click-offset",`${o.clickOffset.x};${o.clickOffset.y}`)}xn("[preprocessDocument] isElementHidden")}setSessionRecorder(e){this.sessionRecorder=e}markInteractableElements(e,t=document,{forceIncludeAttribute:i,forceIncludeFileInput:o}={}){Mn("[markInteractableElements]"),this.interactableElements=[];let l=Wt(t,e,{allowDisabled:!0,excludeCrossOriginIframes:!1}),c=a((f,p)=>(f._checksumid||(f._checksumid=p??this.checksumIdCounter.getAndIncrement()),f.setAttribute("checksumid",f._checksumid),f.setAttribute("checksuminteractable","true"),f._checksumid),"setChecksumIdForElement"),d=a((f,p=!1,g)=>{if(this.shouldIgnoreElement(f))return;let v=f.getAttribute("checksum-data-click-offset")?.split(";"),b=v&&{x:parseInt(v[0]),y:parseInt(v[1])},T=c(f,g);this.interactableElements.push({checksumId:T,element:f,forced:p,clickOffset:b})},"handleInteractableElement");l.forEach(f=>d(f));let h=a(f=>{we(f,t,{includeHTML:!0}).forEach(p=>d(p,!0))},"forceIncludeSelector");i&&h(`[${i}]`),o&&h("input[type='file']"),this.forceIncludeElements.filter(({element:f})=>f?.isConnected).forEach(({element:f,checksumid:p})=>d(f,!0,p)),console.log(`Marked ${this.interactableElements.length} interactable elements`),xn("[markInteractableElements]")}truthyFilter(e){return!!e}shouldIgnoreElement(e){return e.hasAttribute(yi)}generateSimplifiedDom(e,t,{extraAllowedAttributes:i=[],checkElementInstanceType:o=!0,forceIncludeAttribute:l=void 0,forceIncludeFileInput:c=!1,svgIntegration:d="aria-label",onForceIncludeElement:h=void 0,contentWindow:f=window,assignChecksumIdsToAllElements:p=!0,assignRrwebIdsToAllElements:g=!0}={}){if(!e)return null;let v=a((W,P=W)=>{if(W._originalNode=P,!Je(W,"Element")||!Je(P,"Element"))return W;let te=W,ee=P;return p&&!ee.hasAttribute("checksumid")&&(ee._checksumid||(ee._checksumid=this.checksumIdCounter.getAndIncrement()),te.setAttribute("checksumid",ee._checksumid),this.nonInteractableElementsFromSimplifiedDom.push({checksumId:ee._checksumid,element:ee})),g&&this.sessionRecorder&&(ee._rrwebid||(ee._rrwebid=this.sessionRecorder.getMeta(ee)?.id?.toString()??""),te.setAttribute("rrwebid",ee._rrwebid)),this.checksumIdToRRwebIdMap[ee._checksumid]=parseInt(ee._rrwebid),W},"processSimplifiedDOMNode"),b=a((W,P=e)=>v(document.createTextNode(W),P),"createTextNode"),T=a((W,P=e)=>v(document.createElement(W),P),"createElementNode");if(e.nodeType===Node.ELEMENT_NODE){let W=e;if(W.tagName.toLowerCase()==="head"||this.shouldIgnoreElement(W))return null}if(e.nodeType===Node.TEXT_NODE)return!e.parentElement||e.parentElement.getAttribute("checksum-data-visible")==="false"&&!e.parentElement.hasAttribute("checksumid")||e.parentElement.tagName.toLowerCase()==="body"?null:e.textContent?.trim()?b(e.textContent+" "):null;if(e.nodeType!==Node.ELEMENT_NODE||o&&!(Je(e,"HTMLElement")||Je(e,"SVGElement")))return null;let S=e,C=S.tagName.toLowerCase()==="iframe"&&S.contentDocument,x=br(C?S.contentDocument.documentElement:S,{flattenShadowRootChildren:!0});t.esraSelectionRules?.limitChildren?.forEach(W=>{S.matches(W.selector)&&x.length>W.limit&&x.splice(W.limit)});let _=x.map(W=>this.generateSimplifiedDom(W,t,{extraAllowedAttributes:i,checkElementInstanceType:o,forceIncludeAttribute:l,forceIncludeFileInput:c,svgIntegration:d,onForceIncludeElement:h,contentWindow:C?S.contentWindow:f,assignChecksumIdsToAllElements:p,assignRrwebIdsToAllElements:g})).filter(this.truthyFilter),R=S.getAttribute("checksum-data-visible")!=="false",O=S.hasAttribute("checksumid"),U=S.hasAttribute("role"),{customDescription:Y,customDescriptionTarget:le}=this.getElementCustomDescription(S,{enableSVGCustomDescription:!!d}),Q=!!Y,se=S.hasAttribute("aria-label")||S.hasAttribute("name")||S.hasAttribute("alt"),fe=S.hasAttribute(Bs)||this.forceIncludeElements.map(W=>W.element).includes(S)||!!l&&S.hasAttribute(l)||c&&S.tagName.toLowerCase()==="input"&&S.getAttribute("type")==="file",V=["form","button","input","textarea","a","table","th","tr","td","section","nav","header","footer","main","article","aside","li","ul","select","option","datalist"],B=O||R&&(U||se||Q||S.matches(V.join(",")));if(!(B||fe)){if(!_.length)return null;if(_.length===1&&!Je(_[0],"Text"))return _[0]}!B&&fe&&h?.(S);let K=a(()=>{if(Q)switch(le){case"svg":switch(d){case"aria-label":let P=T("svg");return P.setAttribute("aria-label",Y),{simplifiedNode:P,appendChildren:!1};case"text":if(S.hasAttribute("checksumid")){let ee=T("div");return ee.innerText=Y,{simplifiedNode:ee,appendChildren:!1}}return{simplifiedNode:b(` [${Y}] `),appendChildren:!1}}}let W=S.tagName.toLowerCase()==="body"&&S.ownerDocument!==document?"div":S.tagName;return{simplifiedNode:T(W)}},"makeSimplifiedNode"),{simplifiedNode:z,appendChildren:J=!0}=K();if(!Je(z,"Element"))return z;let ye=z,nt=["aria-.+","data-name","name","type","placeholder","content","value","role","icon","title","checksumid","checksuminteractable","checksum-get-more-items","checked","disabled","selected","label","required","inputmode","min","max","step","minlength","maxlength","alt","hidden","draggable","ondrop","ondragover","contenteditable","href","(data-)?test(-)?id"].concat(i),$e=S.attributes;for(let W of $e)for(let P of nt)new RegExp("^"+P+"$").test(W.name)&&ye.setAttribute(W.name,W.value??!0);if(S.isContentEditable?ye.setAttribute("contenteditable","true"):!["TEXTAREA","INPUT","SELECT"].includes(S.tagName)&&window.getComputedStyle(S).cursor==="text"&&ye.setAttribute("contenteditable","cursor-text"),Je(S,"HTMLInputElement")&&S.getAttribute("type")==="checkbox")S.checked&&ye.setAttribute("checked","true");else if(Je(S,"HTMLInputElement")||Je(S,"HTMLSelectElement"))ye.setAttribute("value",S.value);else if(Je(S,"HTMLTextAreaElement")&&!S.childNodes.length&&S.value){let W=b(S.value);ye.appendChild(W)}return J&&_.forEach(W=>ye.appendChild(W)),ye}getElementCustomDescription(e,{enableSVGCustomDescription:t=!0}={}){return(Je(e,"SVGElement")||e.tagName.toLowerCase()==="svg")&&t?{customDescriptionTarget:"svg",customDescription:this.getSVGDescriptionForElement(e)}:{}}getSVGDescriptionForElement(e){let t=this.findSvgElementDescriptionFromBank(e);if(t)return t;let i=e.querySelector("title");if(i)return i.textContent}findSvgElementDescriptionFromBank(e){return this.getSvgBank().find(t=>e.matches(`svg:has(${t.selector})`))?.description}getSvgBank(){return sh}restoreDom(e=document){we("*",e).forEach(i=>{i.removeAttribute("checksum-data-visible"),i.removeAttribute("checksum-data-transparently-visible"),i.removeAttribute("checksum-data-visible-under-transparent-element"),i.removeAttribute("checksumid"),i.removeAttribute("checksuminteractable"),i.removeAttribute("checksum-data-click-offset"),i.removeAttribute(yi),i.removeAttribute(Bs)})}removeAttribute(e){we("*",document).forEach(i=>{i.removeAttribute(e)})}async mapAndStoreSelectors(){let e={},t=new et;for(let{checksumId:i,element:o,clickOffset:l,selector:c,locator:d,parentFramesSelectors:h}of await t.injectSelectorsAndLocators(this.interactableElementsFromSimplifiedDom)){if(!c){console.warn("Unable to get selector for element",o);continue}let f=o;e[i]={element:f,selector:c,locator:d,clickOffset:l,parentFramesSelectors:h,innerText:f.innerText,rrwebId:this.checksumIdToRRwebIdMap[i]}}return e}shouldFurtherReduce(e){return e?e.outerHTML.length>fh:!0}async reduce(e=document,t,i={}){console.time("reduceHTML");let{initialChecksumId:o,forceIncludeAttribute:l,forceIncludeFileInput:c,invalidateCache:d,includeFlashingElements:h,limitNodeRepetitions:f,stopFlashingElementsDetection:p}=this.lastReduceHTMLOptions={...this.defaultReduceHTMLOptions,...i},g=yt.getInstance("reduce",{target:e,monitorInput:!0,invalidate:d,log:!1});if(g.hasCache())return g.get();let v=h?this.flashingElementsDetector.get():void 0;p&&this.flashingElementsDetector.stop(),this.nodeRepetitionsThreshold=f,this.reducePercentage=50,this.templateNodes=void 0,this.excludedNodes=0;let b=a(x=>lh(x,{forceIncludeAttribute:l,forceIncludeFileInput:c,forceIncludeElements:this.forceIncludeElements.map(_=>_.element),limit:Math.min(Math.ceil(x.element.children.length*(this.reducePercentage/100)),x.element.children.length-6)}),"templateReducer");console.log("Running pre-templatize"),this.templatize(b),console.log("Preprocessing document..."),this.preprocessDocument(e);let T;for((o||!this.checksumIdCounter)&&(this.checksumIdCounter=new xr(o??"0")),console.log("Marking interactable elements..."),this.markInteractableElements(t,e,{forceIncludeAttribute:l,forceIncludeFileInput:c});;){if(console.log("Generating simplified DOM..."),this.nonInteractableElementsFromSimplifiedDom=[],T=this.generateSimplifiedDom(e.documentElement,t,this.lastReduceHTMLOptions),!T)throw new Error("Unable to get simplified DOM");if(this.shouldFurtherReduce(T)){if(console.log(`Will further reduce (${T.outerHTML.length})...`),!this.templatize(b)){console.log(`Exceeded maximum html reduction, stopping (html size: ${T.outerHTML.length})`);break}}else break}console.log("Simplified DOM generated, length:",T.outerHTML.length);let S=new Set(Array.from(T.querySelectorAll("[checksumid]")).map(x=>x.getAttribute("checksumid")));this.interactableElementsFromSimplifiedDom=this.interactableElements.filter(x=>S.has(x.checksumId)),console.log(`Found ${this.interactableElementsFromSimplifiedDom.length} interactable elements in simplified DOM vs ${this.interactableElements.length} in original DOM`),console.log("Restoring DOM..."),this.restoreDom(e),this.preMapReducedHTMLSelectors=Xb?!1:!!t.preMapReducedHTMLSelectors,this.preMapReducedHTMLSelectors?(console.log("Mapping selectors..."),this.selectors=await this.mapAndStoreSelectors(),console.log("Done mapping selectors")):this.selectors={},this.elementsInSimplifiedDomByChecksumId=[...this.interactableElementsFromSimplifiedDom,...this.nonInteractableElementsFromSimplifiedDom].reduce((x,_)=>(x[_.checksumId]=_,x),{});let C={reducedDomHTMLElement:T,reducedHTML:T.outerHTML,currentChecksumId:this.checksumIdCounter.get(),flashingHTML:v};return g.set(C),console.timeEnd("reduceHTML"),C}templatize(e){let t=this.excludedNodes,i=a(()=>Array.from(this.templateNodes).reduce((o,l)=>o+e(l).length,0),"calcExculdedNodes");if(!this.templateNodes)this.templateNodes=zn(document.body,{nodeRepetitionsThreshold:this.nodeRepetitionsThreshold}),this.excludedNodes=i();else do{if(this.reducePercentage<98)this.reducePercentage=Math.min(this.reducePercentage+20,98),console.log("Increasing reduce percentage to",this.reducePercentage);else{if(this.nodeRepetitionsThreshold<=20)return!1;this.reducePercentage=50,this.nodeRepetitionsThreshold-=10,console.log("Reducing node repetitions threshold to",this.nodeRepetitionsThreshold),this.templateNodes=zn(document.body,{nodeRepetitionsThreshold:this.nodeRepetitionsThreshold})}this.excludedNodes=i()}while(t===this.excludedNodes);return console.log(`[templatize] ${this.excludedNodes} elements marked to ignore for ${this.templateNodes.length} templates`),!0}getMoreElementsFromTemplate(e,t){try{let i=this.templateNodes.find(f=>f.id===e);if(!i)throw new Error("Template not found");let{element:o,excludedElements:l}=i;console.log("Preprocessing template node..."),this.preprocessDocument(o),console.log("Marking template interactable elements..."),this.markInteractableElements(t,o,this.lastReduceHTMLOptions);let c=[],d=a(()=>c.map(f=>f.outerHTML).join(""),"getElementsHTML"),h=l.values();for(;d().length<fh*.5;){let f=h.next().value;if(!f)break;let p=Array.from(f.querySelectorAll("[checksumid]")).concat(f._checksumid?[f]:[]);this.interactableElements.filter(g=>p.includes(g.element)).forEach(g=>{this.elementsInSimplifiedDomByChecksumId[g.element._checksumid]=g}),c.push(this.generateSimplifiedDom(f,t,this.lastReduceHTMLOptions)),l.delete(f)}return this.restoreDom(o),{items:d(),hasMoreItems:l.size>0}}catch(i){console.error("[getMoreElementsFromTemplate] error",i);return}}async getSelectorForChecksumId(e,{forceGenerate:t=!1}={}){let i=a(f=>({selector:e,element:f?f.element:null,locator:"",parentFramesSelectors:[],invalid:!0,rrwebId:this.checksumIdToRRwebIdMap[e],clickOffset:f?.clickOffset,innerText:f?f.element.innerText:""}),"makeDefaultResult"),o=new et,l=this.elementsInSimplifiedDomByChecksumId[e];if(!l||!l.element.isConnected)return this.preMapReducedHTMLSelectors&&this.selectors[e]?this.selectors[e]:i(l);let{selector:c,locator:d,parentFramesSelectors:h}=await o.getSelectorAndLocator(l.element);return{...i(l),selector:c,locator:d,parentFramesSelectors:h,invalid:!1}}getElementForChecksumId(e){return this.elementsInSimplifiedDomByChecksumId[e]?.element}hasInnerTextByChecksumId(e,{maxLength:t=void 0,minLength:i=void 0}={}){if(!this.preMapReducedHTMLSelectors){let l=this.elementsInSimplifiedDomByChecksumId[e]?.element?.innerText;return!(!l||i&&l.length<i||t&&l.length>t)}return!!this.selectors[e]?.innerText}getInteractableElements(){return this.interactableElements}getInteractableElementsInReducedHTML(){return this.interactableElementsFromSimplifiedDom}startFlashingElementsDetection(){return this.flashingElementsDetector.start()}addForceIncludeElement(e){this.forceIncludeElements.push(e),e.element._checksumid=e.checksumid}};var Kb=!0,Cr=class{constructor(){this.esraExtractors=[];this.playwrightSelector=new et;this.defaultModulesState={extractReducedHtmlAndSelector:!1,inspectInteractableElements:!1,extractEsraMetadata:!0,extractPlaywrightSelector:!0};this.previousTargetNodeForReducedHTML=void 0;this.currentReducedHTMLChecksumIdAllocationCount="0";this.htmlReducer=new Ir}static{a(this,"SessionDigesterSelector")}async getSelector(e,{extractPlaywrightSelector:t=!0,extractEsraMetadata:i=this.defaultModulesState.extractEsraMetadata,extractReducedHtmlAndSelector:o=this.defaultModulesState.extractReducedHtmlAndSelector,inspectInteractableElements:l=this.defaultModulesState.inspectInteractableElements}={}){if(!e)return null;console.log("[SessionDigesterSelector] generating for node",e);let c={};if(i){console.log("extracting ESRA metadata...");let d=this.getESRAExtractor(e).extract(e);c.esraMetadata=d.toMetadata(),console.log("ESRA metadata extraction complete")}if(t){console.log("extracting playwright selector...");let{selector:d,locator:h,parentFramesSelectors:f}=await this.playwrightSelector.getSelectorAndLocator(e);c.playwrightSelector=d,c.playwrightLocator=h,c.playwrightParentFramesSelectors=f,console.log("Playwright selector extraction complete")}return o&&(console.log("extracting reduced HTML..."),c.reducedHTML=await this.getReducedHTMLAndTargetNodeSelector(e),console.log("Reduced HTML extraction complete")),l&&(console.log("extracting element inspection..."),c.interactionFoundOnInspection=await this.isElementInteractable(e),console.log("Element inspection extraction complete")),console.log("[SessionDigesterSelector] complete",c),c}async selector(e){return this.playwrightSelector.selector(e)}setAppRules(e){this.appSpecificRules=e}setOptions({defaultExtractReducedHtmlAndSelector:e,defaultInspectInteractableElements:t,defaultExtractEsraMetadata:i}){this.defaultModulesState.extractReducedHtmlAndSelector=e,this.defaultModulesState.inspectInteractableElements=t,this.defaultModulesState.extractEsraMetadata=i}async getReducedHTMLAndTargetNodeSelector(e){let t="checksum-target-node";e.setAttribute(t,"true");let i=this.previousTargetNodeForReducedHTML&&this.previousTargetNodeForReducedHTML!==e;this.previousTargetNodeForReducedHTML=e;let o=!1,l=a(g=>{g.hasAttribute(t)&&(o=!0)},"onForceIncludeElement"),{reducedDomHTMLElement:c,reducedHTML:d,currentChecksumId:h}=await this.htmlReducer.reduce(e.ownerDocument,{...this.appSpecificRules,preMapReducedHTMLSelectors:!1},{initialChecksumId:this.currentReducedHTMLChecksumIdAllocationCount,extraAllowedAttributes:[t],checkElementInstanceType:!1,forceIncludeAttribute:Kb?t:void 0,invalidateCache:i,onForceIncludeElement:l});e.removeAttribute(t),this.currentReducedHTMLChecksumIdAllocationCount=h;let f=c.matches(`[${t}=true]`)?c:c.querySelector(`[${t}=true]`),p=f?f.getAttribute("checksumid"):void 0;return{html:d,selector:p,targetForceIncluded:o}}getESRAExtractor(e){let t=this.esraExtractors.find(o=>o.isSameDocument(e.ownerDocument));if(t)return t;let i=new ut(e.ownerDocument);return this.esraExtractors.push(i),i}async isElementInteractable(e){let t=this.htmlReducer.getInteractableElements();return t&&t.length?t.some(o=>o.element===e&&!o.forced):(await Wt(e.ownerDocument,this.appSpecificRules)).includes(e)}};var oe;(function(n){n[n.Document=0]="Document",n[n.DocumentType=1]="DocumentType",n[n.Element=2]="Element",n[n.Text=3]="Text",n[n.CDATA=4]="CDATA",n[n.Comment=5]="Comment"})(oe||(oe={}));function bh(n){return n.nodeType===n.ELEMENT_NODE}a(bh,"isElement");function Qn(n){let e=n?.host;return e?.shadowRoot===n}a(Qn,"isShadowRoot");function Kn(n){return Object.prototype.toString.call(n)==="[object ShadowRoot]"}a(Kn,"isNativeShadowDom");function Yb(n){return n.includes(" background-clip: text;")&&!n.includes(" -webkit-background-clip: text;")&&(n=n.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),n}a(Yb,"fixBrowserCompatibilityIssuesInCSS");function Qb(n){let{cssText:e}=n;if(e.split('"').length<3)return e;let t=["@import",`url(${JSON.stringify(n.href)})`];return n.layerName===""?t.push("layer"):n.layerName&&t.push(`layer(${n.layerName})`),n.supportsText&&t.push(`supports(${n.supportsText})`),n.media.length&&t.push(n.media.mediaText),t.join(" ")+";"}a(Qb,"escapeImportStatement");function Ws(n){try{let e=n.rules||n.cssRules;return e?Yb(Array.from(e,bl).join("")):null}catch{return null}}a(Ws,"stringifyStylesheet");function bl(n){let e;if(Jb(n))try{e=Ws(n.styleSheet)||Qb(n)}catch{}else if(ew(n)&&n.selectorText.includes(":"))return Zb(n.cssText);return e||n.cssText}a(bl,"stringifyRule");function Zb(n){let e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return n.replace(e,"$1\\$2")}a(Zb,"fixSafariColons");function Jb(n){return"styleSheet"in n}a(Jb,"isCSSImportRule");function ew(n){return"selectorText"in n}a(ew,"isCSSStyleRule");var Ei=class{static{a(this,"Mirror")}constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;let i=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return i??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let i=t.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,t)}replace(e,t){let i=this.getNode(e);if(i){let o=this.nodeMetaMap.get(i);o&&this.nodeMetaMap.set(t,o)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function $s(){return new Ei}a($s,"createMirror");function bi({element:n,maskInputOptions:e,tagName:t,type:i,value:o,maskInputFn:l}){let c=o||"",d=i&&Vt(i);return(e[t.toLowerCase()]||d&&e[d])&&(l?c=l(c,n):c="*".repeat(c.length)),c}a(bi,"maskInputValue");function Vt(n){return n.toLowerCase()}a(Vt,"toLowerCase");var mh="__rrweb_original__";function tw(n){let e=n.getContext("2d");if(!e)return!0;let t=50;for(let i=0;i<n.width;i+=t)for(let o=0;o<n.height;o+=t){let l=e.getImageData,c=mh in l?l[mh]:l;if(new Uint32Array(c.call(e,i,o,Math.min(t,n.width-i),Math.min(t,n.height-o)).data.buffer).some(h=>h!==0))return!1}return!0}a(tw,"is2DCanvasBlank");function nw(n,e){return!n||!e||n.type!==e.type?!1:n.type===oe.Document?n.compatMode===e.compatMode:n.type===oe.DocumentType?n.name===e.name&&n.publicId===e.publicId&&n.systemId===e.systemId:n.type===oe.Comment||n.type===oe.Text||n.type===oe.CDATA?n.textContent===e.textContent:n.type===oe.Element?n.tagName===e.tagName&&JSON.stringify(n.attributes)===JSON.stringify(e.attributes)&&n.isSVG===e.isSVG&&n.needBlock===e.needBlock:!1}a(nw,"isNodeMetaEqual");function wi(n){let e=n.type;return n.hasAttribute("data-rr-is-password")?"password":e?Vt(e):null}a(wi,"getInputType");function wh(n,e){var t;let i;try{i=new URL(n,e??window.location.href)}catch{return null}let o=/\.([0-9a-z]+)(?:$)/i,l=i.pathname.match(o);return(t=l?.[1])!==null&&t!==void 0?t:null}a(wh,"extractFileExtension");var rw=1,iw=new RegExp("[^a-z0-9-_:]"),Yn=-2;function wl(){return rw++}a(wl,"genId");function sw(n){if(n instanceof HTMLFormElement)return"form";let e=Vt(n.tagName);return iw.test(e)?"div":e}a(sw,"getValidTagName");function ow(n){let e="";return n.indexOf("//")>-1?e=n.split("/").slice(0,3).join("/"):e=n.split("/")[0],e=e.split("?")[0],e}a(ow,"extractOrigin");var Rr,ph,aw=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,lw=/^(?:[a-z+]+:)?\/\//i,cw=/^www\..*/i,uw=/^(data:)([^,]*),(.*)/i;function Vs(n,e){return(n||"").replace(aw,(t,i,o,l,c,d)=>{let h=o||c||d,f=i||l||"";if(!h)return t;if(lw.test(h)||cw.test(h))return`url(${f}${h}${f})`;if(uw.test(h))return`url(${f}${h}${f})`;if(h[0]==="/")return`url(${f}${ow(e)+h}${f})`;let p=e.split("/"),g=h.split("/");p.pop();for(let v of g)v!=="."&&(v===".."?p.pop():p.push(v));return`url(${f}${p.join("/")}${f})`})}a(Vs,"absoluteToStylesheet");var dw=/^[^ \t\n\r\u000c]+/,hw=/^[, \t\n\r\u000c]+/;function fw(n,e){if(e.trim()==="")return e;let t=0;function i(l){let c,d=l.exec(e.substring(t));return d?(c=d[0],t+=c.length,c):""}a(i,"collectCharacters");let o=[];for(;i(hw),!(t>=e.length);){let l=i(dw);if(l.slice(-1)===",")l=Ar(n,l.substring(0,l.length-1)),o.push(l);else{let c="";l=Ar(n,l);let d=!1;for(;;){let h=e.charAt(t);if(h===""){o.push((l+c).trim());break}else if(d)h===")"&&(d=!1);else if(h===","){t+=1,o.push((l+c).trim());break}else h==="("&&(d=!0);c+=h,t+=1}}}return o.join(", ")}a(fw,"getAbsoluteSrcsetString");var gh=new WeakMap;function Ar(n,e){return!e||e.trim()===""?e:Us(n,e)}a(Ar,"absoluteToDoc");function mw(n){return!!(n.tagName==="svg"||n.ownerSVGElement)}a(mw,"isSVGElement");function Us(n,e){let t=gh.get(n);if(t||(t=n.createElement("a"),gh.set(n,t)),!e)e="";else if(e.startsWith("blob:")||e.startsWith("data:"))return e;return t.setAttribute("href",e),t.href}a(Us,"getHref");function Tl(n,e,t,i){return i&&(t==="src"||t==="href"&&!(e==="use"&&i[0]==="#")||t==="xlink:href"&&i[0]!=="#"||t==="background"&&(e==="table"||e==="td"||e==="th")?Ar(n,i):t==="srcset"?fw(n,i):t==="style"?Vs(i,Us(n)):e==="object"&&t==="data"?Ar(n,i):i)}a(Tl,"transformAttribute");function Ml(n,e,t){return(n==="video"||n==="audio")&&e==="autoplay"}a(Ml,"ignoreAttribute");function pw(n,e,t){try{if(typeof e=="string"){if(n.classList.contains(e))return!0}else for(let i=n.classList.length;i--;){let o=n.classList[i];if(e.test(o))return!0}if(t)return n.matches(t)}catch{}return!1}a(pw,"_isBlockedElement");function Si(n,e,t){if(!n)return!1;if(n.nodeType!==n.ELEMENT_NODE)return t?Si(n.parentNode,e,t):!1;for(let i=n.classList.length;i--;){let o=n.classList[i];if(e.test(o))return!0}return t?Si(n.parentNode,e,t):!1}a(Si,"classMatchesRegex");function xl(n,e,t,i){try{let o=n.nodeType===n.ELEMENT_NODE?n:n.parentElement;if(o===null)return!1;if(typeof e=="string"){if(i){if(o.closest(`.${e}`))return!0}else if(o.classList.contains(e))return!0}else if(Si(o,e,i))return!0;if(t){if(i){if(o.closest(t))return!0}else if(o.matches(t))return!0}}catch{}return!1}a(xl,"needMaskingText");function gw(n,e,t){let i=n.contentWindow;if(!i)return;let o=!1,l;try{l=i.document.readyState}catch{return}if(l!=="complete"){let d=setTimeout(()=>{o||(e(),o=!0)},t);n.addEventListener("load",()=>{clearTimeout(d),o=!0,e()});return}let c="about:blank";if(i.location.href!==c||n.src===c||n.src==="")return setTimeout(e,0),n.addEventListener("load",e);n.addEventListener("load",e)}a(gw,"onceIframeLoaded");function yw(n,e,t){let i=!1,o;try{o=n.sheet}catch{return}if(o)return;let l=setTimeout(()=>{i||(e(),i=!0)},t);n.addEventListener("load",()=>{clearTimeout(l),i=!0,e()})}a(yw,"onceStylesheetLoaded");function vw(n,e){let{doc:t,mirror:i,blockClass:o,blockSelector:l,needsMask:c,inlineStylesheet:d,maskInputOptions:h={},maskTextFn:f,maskInputFn:p,dataURLOptions:g={},inlineImages:v,recordCanvas:b,keepIframeSrcFn:T,newlyAddedElement:S=!1}=e,C=Ew(t,i);switch(n.nodeType){case n.DOCUMENT_NODE:return n.compatMode!=="CSS1Compat"?{type:oe.Document,childNodes:[],compatMode:n.compatMode}:{type:oe.Document,childNodes:[]};case n.DOCUMENT_TYPE_NODE:return{type:oe.DocumentType,name:n.name,publicId:n.publicId,systemId:n.systemId,rootId:C};case n.ELEMENT_NODE:return bw(n,{doc:t,blockClass:o,blockSelector:l,inlineStylesheet:d,maskInputOptions:h,maskInputFn:p,dataURLOptions:g,inlineImages:v,recordCanvas:b,keepIframeSrcFn:T,newlyAddedElement:S,rootId:C});case n.TEXT_NODE:return Sw(n,{doc:t,needsMask:c,maskTextFn:f,rootId:C});case n.CDATA_SECTION_NODE:return{type:oe.CDATA,textContent:"",rootId:C};case n.COMMENT_NODE:return{type:oe.Comment,textContent:n.textContent||"",rootId:C};default:return!1}}a(vw,"serializeNode");function Ew(n,e){if(!e.hasNode(n))return;let t=e.getId(n);return t===1?void 0:t}a(Ew,"getRootId");function Sw(n,e){var t;let{needsMask:i,maskTextFn:o,rootId:l}=e,c=n.parentNode&&n.parentNode.tagName,d=n.textContent,h=c==="STYLE"?!0:void 0,f=c==="SCRIPT"?!0:void 0;if(h&&d){try{n.nextSibling||n.previousSibling||!((t=n.parentNode.sheet)===null||t===void 0)&&t.cssRules&&(d=Ws(n.parentNode.sheet))}catch(p){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${p}`,n)}d=Vs(d,Us(e.doc))}return f&&(d="SCRIPT_PLACEHOLDER"),!h&&!f&&d&&i&&(d=o?o(d,n.parentElement):d.replace(/[\S]/g,"*")),{type:oe.Text,textContent:d||"",isStyle:h,rootId:l}}a(Sw,"serializeTextNode");function bw(n,e){let{doc:t,blockClass:i,blockSelector:o,inlineStylesheet:l,maskInputOptions:c={},maskInputFn:d,dataURLOptions:h={},inlineImages:f,recordCanvas:p,keepIframeSrcFn:g,newlyAddedElement:v=!1,rootId:b}=e,T=pw(n,i,o),S=sw(n),C={},x=n.attributes.length;for(let R=0;R<x;R++){let O=n.attributes[R];Ml(S,O.name,O.value)||(C[O.name]=Tl(t,S,Vt(O.name),O.value))}if(S==="link"&&l){let R=Array.from(t.styleSheets).find(U=>U.href===n.href),O=null;R&&(O=Ws(R)),O&&(delete C.rel,delete C.href,C._cssText=Vs(O,R.href))}if(S==="style"&&n.sheet&&!(n.innerText||n.textContent||"").trim().length){let R=Ws(n.sheet);R&&(C._cssText=Vs(R,Us(t)))}if(S==="input"||S==="textarea"||S==="select"){let R=n.value,O=n.checked;C.type!=="radio"&&C.type!=="checkbox"&&C.type!=="submit"&&C.type!=="button"&&R?C.value=bi({element:n,type:wi(n),tagName:S,value:R,maskInputOptions:c,maskInputFn:d}):O&&(C.checked=O)}if(S==="option"&&(n.selected&&!c.select?C.selected=!0:delete C.selected),S==="canvas"&&p){if(n.__context==="2d")tw(n)||(C.rr_dataURL=n.toDataURL(h.type,h.quality));else if(!("__context"in n)){let R=n.toDataURL(h.type,h.quality),O=document.createElement("canvas");O.width=n.width,O.height=n.height;let U=O.toDataURL(h.type,h.quality);R!==U&&(C.rr_dataURL=R)}}if(S==="img"&&f){Rr||(Rr=t.createElement("canvas"),ph=Rr.getContext("2d"));let R=n,O=R.crossOrigin;R.crossOrigin="anonymous";let U=a(()=>{R.removeEventListener("load",U);try{Rr.width=R.naturalWidth,Rr.height=R.naturalHeight,ph.drawImage(R,0,0),C.rr_dataURL=Rr.toDataURL(h.type,h.quality)}catch(Y){console.warn(`Cannot inline img src=${R.currentSrc}! Error: ${Y}`)}O?C.crossOrigin=O:R.removeAttribute("crossorigin")},"recordInlineImage");R.complete&&R.naturalWidth!==0?U():R.addEventListener("load",U)}if(S==="audio"||S==="video"){let R=C;R.rr_mediaState=n.paused?"paused":"played",R.rr_mediaCurrentTime=n.currentTime,R.rr_mediaPlaybackRate=n.playbackRate,R.rr_mediaMuted=n.muted,R.rr_mediaLoop=n.loop,R.rr_mediaVolume=n.volume}if(v||(n.scrollLeft&&(C.rr_scrollLeft=n.scrollLeft),n.scrollTop&&(C.rr_scrollTop=n.scrollTop)),T){let{width:R,height:O}=n.getBoundingClientRect();C={class:C.class,rr_width:`${R}px`,rr_height:`${O}px`}}S==="iframe"&&!g(C.src)&&(n.contentDocument||(C.rr_src=C.src),delete C.src);let _;try{customElements.get(S)&&(_=!0)}catch{}return{type:oe.Element,tagName:S,attributes:C,childNodes:[],isSVG:mw(n)||void 0,needBlock:T,rootId:b,isCustom:_}}a(bw,"serializeElementNode");function Ne(n){return n==null?"":n.toLowerCase()}a(Ne,"lowerIfExists");function ww(n,e){if(e.comment&&n.type===oe.Comment)return!0;if(n.type===oe.Element){if(e.script&&(n.tagName==="script"||n.tagName==="link"&&(n.attributes.rel==="preload"||n.attributes.rel==="modulepreload")&&n.attributes.as==="script"||n.tagName==="link"&&n.attributes.rel==="prefetch"&&typeof n.attributes.href=="string"&&wh(n.attributes.href)==="js"))return!0;if(e.headFavicon&&(n.tagName==="link"&&n.attributes.rel==="shortcut icon"||n.tagName==="meta"&&(Ne(n.attributes.name).match(/^msapplication-tile(image|color)$/)||Ne(n.attributes.name)==="application-name"||Ne(n.attributes.rel)==="icon"||Ne(n.attributes.rel)==="apple-touch-icon"||Ne(n.attributes.rel)==="shortcut icon")))return!0;if(n.tagName==="meta"){if(e.headMetaDescKeywords&&Ne(n.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Ne(n.attributes.property).match(/^(og|twitter|fb):/)||Ne(n.attributes.name).match(/^(og|twitter):/)||Ne(n.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(Ne(n.attributes.name)==="robots"||Ne(n.attributes.name)==="googlebot"||Ne(n.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&n.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(Ne(n.attributes.name)==="author"||Ne(n.attributes.name)==="generator"||Ne(n.attributes.name)==="framework"||Ne(n.attributes.name)==="publisher"||Ne(n.attributes.name)==="progid"||Ne(n.attributes.property).match(/^article:/)||Ne(n.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(Ne(n.attributes.name)==="google-site-verification"||Ne(n.attributes.name)==="yandex-verification"||Ne(n.attributes.name)==="csrf-token"||Ne(n.attributes.name)==="p:domain_verify"||Ne(n.attributes.name)==="verify-v1"||Ne(n.attributes.name)==="verification"||Ne(n.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}a(ww,"slimDOMExcluded");function Xn(n,e){let{doc:t,mirror:i,blockClass:o,blockSelector:l,maskTextClass:c,maskTextSelector:d,skipChild:h=!1,inlineStylesheet:f=!0,maskInputOptions:p={},maskTextFn:g,maskInputFn:v,slimDOMOptions:b,dataURLOptions:T={},inlineImages:S=!1,recordCanvas:C=!1,onSerialize:x,onIframeLoad:_,iframeLoadTimeout:R=5e3,onStylesheetLoad:O,stylesheetLoadTimeout:U=5e3,keepIframeSrcFn:Y=a(()=>!1,"keepIframeSrcFn"),newlyAddedElement:le=!1}=e,{needsMask:Q}=e,{preserveWhiteSpace:se=!0}=e;!Q&&n.childNodes&&(Q=xl(n,c,d,Q===void 0));let fe=vw(n,{doc:t,mirror:i,blockClass:o,blockSelector:l,needsMask:Q,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:v,dataURLOptions:T,inlineImages:S,recordCanvas:C,keepIframeSrcFn:Y,newlyAddedElement:le});if(!fe)return console.warn(n,"not serialized"),null;let V;i.hasNode(n)?V=i.getId(n):ww(fe,b)||!se&&fe.type===oe.Text&&!fe.isStyle&&!fe.textContent.replace(/^\s+|\s+$/gm,"").length?V=Yn:V=wl();let B=Object.assign(fe,{id:V});if(i.add(n,B),V===Yn)return null;x&&x(n);let X=!h;if(B.type===oe.Element){X=X&&!B.needBlock,delete B.needBlock;let K=n.shadowRoot;K&&Kn(K)&&(B.isShadowHost=!0)}if((B.type===oe.Document||B.type===oe.Element)&&X){b.headWhitespace&&B.type===oe.Element&&B.tagName==="head"&&(se=!1);let K={doc:t,mirror:i,blockClass:o,blockSelector:l,needsMask:Q,maskTextClass:c,maskTextSelector:d,skipChild:h,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:v,slimDOMOptions:b,dataURLOptions:T,inlineImages:S,recordCanvas:C,preserveWhiteSpace:se,onSerialize:x,onIframeLoad:_,iframeLoadTimeout:R,onStylesheetLoad:O,stylesheetLoadTimeout:U,keepIframeSrcFn:Y};if(!(B.type===oe.Element&&B.tagName==="textarea"&&B.attributes.value!==void 0))for(let z of Array.from(n.childNodes)){let J=Xn(z,K);J&&B.childNodes.push(J)}if(bh(n)&&n.shadowRoot)for(let z of Array.from(n.shadowRoot.childNodes)){let J=Xn(z,K);J&&(Kn(n.shadowRoot)&&(J.isShadow=!0),B.childNodes.push(J))}}return n.parentNode&&Qn(n.parentNode)&&Kn(n.parentNode)&&(B.isShadow=!0),B.type===oe.Element&&B.tagName==="iframe"&&gw(n,()=>{let K=n.contentDocument;if(K&&_){let z=Xn(K,{doc:K,mirror:i,blockClass:o,blockSelector:l,needsMask:Q,maskTextClass:c,maskTextSelector:d,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:v,slimDOMOptions:b,dataURLOptions:T,inlineImages:S,recordCanvas:C,preserveWhiteSpace:se,onSerialize:x,onIframeLoad:_,iframeLoadTimeout:R,onStylesheetLoad:O,stylesheetLoadTimeout:U,keepIframeSrcFn:Y});z&&_(n,z)}},R),B.type===oe.Element&&B.tagName==="link"&&typeof B.attributes.rel=="string"&&(B.attributes.rel==="stylesheet"||B.attributes.rel==="preload"&&typeof B.attributes.href=="string"&&wh(B.attributes.href)==="css")&&yw(n,()=>{if(O){let K=Xn(n,{doc:t,mirror:i,blockClass:o,blockSelector:l,needsMask:Q,maskTextClass:c,maskTextSelector:d,skipChild:!1,inlineStylesheet:f,maskInputOptions:p,maskTextFn:g,maskInputFn:v,slimDOMOptions:b,dataURLOptions:T,inlineImages:S,recordCanvas:C,preserveWhiteSpace:se,onSerialize:x,onIframeLoad:_,iframeLoadTimeout:R,onStylesheetLoad:O,stylesheetLoadTimeout:U,keepIframeSrcFn:Y});K&&O(n,K)}},U),B}a(Xn,"serializeNodeWithId");function Th(n,e){let{mirror:t=new Ei,blockClass:i="rr-block",blockSelector:o=null,maskTextClass:l="rr-mask",maskTextSelector:c=null,inlineStylesheet:d=!0,inlineImages:h=!1,recordCanvas:f=!1,maskAllInputs:p=!1,maskTextFn:g,maskInputFn:v,slimDOM:b=!1,dataURLOptions:T,preserveWhiteSpace:S,onSerialize:C,onIframeLoad:x,iframeLoadTimeout:_,onStylesheetLoad:R,stylesheetLoadTimeout:O,keepIframeSrcFn:U=a(()=>!1,"keepIframeSrcFn")}=e||{};return Xn(n,{doc:n,mirror:t,blockClass:i,blockSelector:o,maskTextClass:l,maskTextSelector:c,skipChild:!1,inlineStylesheet:d,maskInputOptions:p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:p===!1?{password:!0}:p,maskTextFn:g,maskInputFn:v,slimDOMOptions:b===!0||b==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:b==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:b===!1?{}:b,dataURLOptions:T,inlineImages:h,recordCanvas:f,preserveWhiteSpace:S,onSerialize:C,onIframeLoad:x,iframeLoadTimeout:_,onStylesheetLoad:R,stylesheetLoadTimeout:O,keepIframeSrcFn:U,newlyAddedElement:!1})}a(Th,"snapshot");var yh=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Tw(n,e={}){let t=1,i=1;function o(W){let P=W.match(/\n/g);P&&(t+=P.length);let te=W.lastIndexOf(`
`);i=te===-1?i+W.length:W.length-te}a(o,"updatePosition");function l(){let W={line:t,column:i};return P=>(P.position=new c(W),T(),P)}a(l,"position");class c{static{a(this,"Position")}constructor(P){this.start=P,this.end={line:t,column:i},this.source=e.source}}c.prototype.content=n;let d=[];function h(W){let P=new Error(`${e.source||""}:${t}:${i}: ${W}`);if(P.reason=W,P.filename=e.source,P.line=t,P.column=i,P.source=n,e.silent)d.push(P);else throw P}a(h,"error");function f(){let W=v();return{type:"stylesheet",stylesheet:{source:e.source,rules:W,parsingErrors:d}}}a(f,"stylesheet");function p(){return b(/^{\s*/)}a(p,"open");function g(){return b(/^}/)}a(g,"close");function v(){let W,P=[];for(T(),S(P);n.length&&n.charAt(0)!=="}"&&(W=nt()||$e());)W&&(P.push(W),S(P));return P}a(v,"rules");function b(W){let P=W.exec(n);if(!P)return;let te=P[0];return o(te),n=n.slice(te.length),P}a(b,"match");function T(){b(/^\s*/)}a(T,"whitespace");function S(W=[]){let P;for(;P=C();)P&&W.push(P),P=C();return W}a(S,"comments");function C(){let W=l();if(n.charAt(0)!=="/"||n.charAt(1)!=="*")return;let P=2;for(;n.charAt(P)!==""&&(n.charAt(P)!=="*"||n.charAt(P+1)!=="/");)++P;if(P+=2,n.charAt(P-1)==="")return h("End of comment missing");let te=n.slice(2,P-2);return i+=2,o(te),n=n.slice(P),i+=2,W({type:"comment",comment:te})}a(C,"comment");function x(){for(T();n[0]=="}";)h("extra closing bracket"),n=n.slice(1),T();let W=b(/^(((?<!\\)"(?:\\"|[^"])*"|(?<!\\)'(?:\\'|[^'])*'|[^{])+)/);if(!W)return;let P=W[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,te=>te.replace(/,/g,"\u200C"));return _(P).map(te=>te.replace(/\u200C/g,",").trim())}a(x,"selector");function _(W){let P=[],te="",ee=0,Oe=0,ht=null;for(let Qe of W){let ot=te.endsWith("\\");ht?ht===Qe&&!ot&&(ht=null):Qe==="("?ee++:Qe===")"?ee--:Qe==="["?Oe++:Qe==="]"?Oe--:`'"`.includes(Qe)&&(ht=Qe),Qe===","&&ee===0&&Oe===0?(P.push(te),te=""):te+=Qe}return te&&P.push(te),P}a(_,"customSplit");function R(){let W=l(),P=b(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!P)return;let te=In(P[0]);if(!b(/^:\s*/))return h("property missing ':'");let ee=b(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),Oe=W({type:"declaration",property:te.replace(yh,""),value:ee?In(ee[0]).replace(yh,""):""});return b(/^[;\s]*/),Oe}a(R,"declaration");function O(){let W=[];if(!p())return h("missing '{'");S(W);let P;for(;P=R();)P!==!1&&(W.push(P),S(W)),P=R();return g()?W:h("missing '}'")}a(O,"declarations");function U(){let W,P=[],te=l();for(;W=b(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)P.push(W[1]),b(/^,\s*/);if(P.length)return te({type:"keyframe",values:P,declarations:O()})}a(U,"keyframe");function Y(){let W=l(),P=b(/^@([-\w]+)?keyframes\s*/);if(!P)return;let te=P[1];if(P=b(/^([-\w]+)\s*/),!P)return h("@keyframes missing name");let ee=P[1];if(!p())return h("@keyframes missing '{'");let Oe,ht=S();for(;Oe=U();)ht.push(Oe),ht=ht.concat(S());return g()?W({type:"keyframes",name:ee,vendor:te,keyframes:ht}):h("@keyframes missing '}'")}a(Y,"atkeyframes");function le(){let W=l(),P=b(/^@supports *([^{]+)/);if(!P)return;let te=In(P[1]);if(!p())return h("@supports missing '{'");let ee=S().concat(v());return g()?W({type:"supports",supports:te,rules:ee}):h("@supports missing '}'")}a(le,"atsupports");function Q(){let W=l();if(!b(/^@host\s*/))return;if(!p())return h("@host missing '{'");let te=S().concat(v());return g()?W({type:"host",rules:te}):h("@host missing '}'")}a(Q,"athost");function se(){let W=l(),P=b(/^@media *([^{]+)/);if(!P)return;let te=In(P[1]);if(!p())return h("@media missing '{'");let ee=S().concat(v());return g()?W({type:"media",media:te,rules:ee}):h("@media missing '}'")}a(se,"atmedia");function fe(){let W=l(),P=b(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(P)return W({type:"custom-media",name:In(P[1]),media:In(P[2])})}a(fe,"atcustommedia");function V(){let W=l();if(!b(/^@page */))return;let te=x()||[];if(!p())return h("@page missing '{'");let ee=S(),Oe;for(;Oe=R();)ee.push(Oe),ee=ee.concat(S());return g()?W({type:"page",selectors:te,declarations:ee}):h("@page missing '}'")}a(V,"atpage");function B(){let W=l(),P=b(/^@([-\w]+)?document *([^{]+)/);if(!P)return;let te=In(P[1]),ee=In(P[2]);if(!p())return h("@document missing '{'");let Oe=S().concat(v());return g()?W({type:"document",document:ee,vendor:te,rules:Oe}):h("@document missing '}'")}a(B,"atdocument");function X(){let W=l();if(!b(/^@font-face\s*/))return;if(!p())return h("@font-face missing '{'");let te=S(),ee;for(;ee=R();)te.push(ee),te=te.concat(S());return g()?W({type:"font-face",declarations:te}):h("@font-face missing '}'")}a(X,"atfontface");let K=ye("import"),z=ye("charset"),J=ye("namespace");function ye(W){let P=new RegExp("^@"+W+"\\s*((?:"+['(?<!\\\\)"(?:\\\\"|[^"])*"',"(?<!\\\\)'(?:\\\\'|[^'])*'","[^;]"].join("|")+")+);");return()=>{let te=l(),ee=b(P);if(!ee)return;let Oe={type:W};return Oe[W]=ee[1].trim(),te(Oe)}}a(ye,"_compileAtrule");function nt(){if(n[0]==="@")return Y()||se()||fe()||le()||K()||z()||J()||B()||V()||Q()||X()}a(nt,"atrule");function $e(){let W=l(),P=x();return P?(S(),W({type:"rule",selectors:P,declarations:O()})):h("selector missing")}return a($e,"rule"),Sl(f())}a(Tw,"parse");function In(n){return n?n.replace(/^\s+|\s+$/g,""):""}a(In,"trim");function Sl(n,e){let t=n&&typeof n.type=="string",i=t?n:e;for(let o of Object.keys(n)){let l=n[o];Array.isArray(l)?l.forEach(c=>{Sl(c,i)}):l&&typeof l=="object"&&Sl(l,i)}return t&&Object.defineProperty(n,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),n}a(Sl,"addParent");var vh={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Mw(n){let e=vh[n.tagName]?vh[n.tagName]:n.tagName;return e==="link"&&n.attributes._cssText&&(e="style"),e}a(Mw,"getTagName");function Eh(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}a(Eh,"escapeRegExp");var Mh=/(max|min)-device-(width|height)/,xw=new RegExp(Mh.source,"g"),xh=/([^\\]):hover/,Iw=new RegExp(xh.source,"g");function Sh(n,e){let t=e?.stylesWithHoverClass.get(n);if(t)return t;let i=Tw(n,{silent:!0});if(!i.stylesheet)return n;let o=[],l=[];function c(h){"selectors"in h&&h.selectors&&h.selectors.forEach(f=>{xh.test(f)&&o.push(f)}),"media"in h&&h.media&&Mh.test(h.media)&&l.push(h.media),"rules"in h&&h.rules&&h.rules.forEach(c)}a(c,"getSelectors"),c(i.stylesheet);let d=n;if(o.length>0){let h=new RegExp(o.filter((f,p)=>o.indexOf(f)===p).sort((f,p)=>p.length-f.length).map(f=>Eh(f)).join("|"),"g");d=d.replace(h,f=>{let p=f.replace(Iw,"$1.\\:hover");return`${f}, ${p}`})}if(l.length>0){let h=new RegExp(l.filter((f,p)=>l.indexOf(f)===p).sort((f,p)=>p.length-f.length).map(f=>Eh(f)).join("|"),"g");d=d.replace(h,f=>f.replace(xw,"$1-$2"))}return e?.stylesWithHoverClass.set(n,d),d}a(Sh,"adaptCssForReplay");function Il(){return{stylesWithHoverClass:new Map}}a(Il,"createCache");function Cw(n,e){var t;let{doc:i,hackCss:o,cache:l}=e;switch(n.type){case oe.Document:return i.implementation.createDocument(null,"",null);case oe.DocumentType:return i.implementation.createDocumentType(n.name||"html",n.publicId,n.systemId);case oe.Element:{let c=Mw(n),d;n.isSVG?d=i.createElementNS("http://www.w3.org/2000/svg",c):(n.isCustom&&(!((t=i.defaultView)===null||t===void 0)&&t.customElements)&&!i.defaultView.customElements.get(n.tagName)&&i.defaultView.customElements.define(n.tagName,class extends i.defaultView.HTMLElement{}),d=i.createElement(c));let h={};for(let f in n.attributes){if(!Object.prototype.hasOwnProperty.call(n.attributes,f))continue;let p=n.attributes[f];if(c==="option"&&f==="selected"&&p===!1||p===null)continue;if(p===!0&&(p=""),f.startsWith("rr_")){h[f]=p;continue}let g=c==="textarea"&&f==="value",v=c==="style"&&f==="_cssText";if(v&&o&&typeof p=="string"&&(p=Sh(p,l)),(g||v)&&typeof p=="string"){d.appendChild(i.createTextNode(p)),n.childNodes=[];continue}try{if(n.isSVG&&f==="xlink:href")d.setAttributeNS("http://www.w3.org/1999/xlink",f,p.toString());else if(f==="onload"||f==="onclick"||f.substring(0,7)==="onmouse")d.setAttribute("_"+f,p.toString());else if(c==="meta"&&n.attributes["http-equiv"]==="Content-Security-Policy"&&f==="content"){d.setAttribute("csp-content",p.toString());continue}else c==="link"&&(n.attributes.rel==="preload"||n.attributes.rel==="modulepreload")&&n.attributes.as==="script"||c==="link"&&n.attributes.rel==="prefetch"&&typeof n.attributes.href=="string"&&n.attributes.href.endsWith(".js")||(c==="img"&&n.attributes.srcset&&n.attributes.rr_dataURL?d.setAttribute("rrweb-original-srcset",n.attributes.srcset):d.setAttribute(f,p.toString()))}catch{}}for(let f in h){let p=h[f];if(c==="canvas"&&f==="rr_dataURL"){let g=document.createElement("img");g.onload=()=>{let v=d.getContext("2d");v&&v.drawImage(g,0,0,g.width,g.height)},g.src=p.toString(),d.RRNodeType&&(d.rr_dataURL=p.toString())}else if(c==="img"&&f==="rr_dataURL"){let g=d;g.currentSrc.startsWith("data:")||(g.setAttribute("rrweb-original-src",n.attributes.src),g.src=p.toString())}if(f==="rr_width")d.style.width=p.toString();else if(f==="rr_height")d.style.height=p.toString();else if(f==="rr_mediaCurrentTime"&&typeof p=="number")d.currentTime=p;else if(f==="rr_mediaState")switch(p){case"played":d.play().catch(g=>console.warn("media playback error",g));break;case"paused":d.pause();break}else f==="rr_mediaPlaybackRate"&&typeof p=="number"?d.playbackRate=p:f==="rr_mediaMuted"&&typeof p=="boolean"?d.muted=p:f==="rr_mediaLoop"&&typeof p=="boolean"?d.loop=p:f==="rr_mediaVolume"&&typeof p=="number"&&(d.volume=p)}if(n.isShadowHost)if(!d.shadowRoot)d.attachShadow({mode:"open"});else for(;d.shadowRoot.firstChild;)d.shadowRoot.removeChild(d.shadowRoot.firstChild);return d}case oe.Text:return i.createTextNode(n.isStyle&&o?Sh(n.textContent,l):n.textContent);case oe.CDATA:return i.createCDATASection(n.textContent);case oe.Comment:return i.createComment(n.textContent);default:return null}}a(Cw,"buildNode");function _r(n,e){let{doc:t,mirror:i,skipChild:o=!1,hackCss:l=!0,afterAppend:c,cache:d}=e;if(i.has(n.id)){let f=i.getNode(n.id),p=i.getMeta(f);if(nw(p,n))return i.getNode(n.id)}let h=Cw(n,{doc:t,hackCss:l,cache:d});if(!h)return null;if(n.rootId&&i.getNode(n.rootId)!==t&&i.replace(n.rootId,t),n.type===oe.Document&&(t.close(),t.open(),n.compatMode==="BackCompat"&&n.childNodes&&n.childNodes[0].type!==oe.DocumentType&&(n.childNodes[0].type===oe.Element&&"xmlns"in n.childNodes[0].attributes&&n.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?t.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):t.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),h=t),i.add(h,n),(n.type===oe.Document||n.type===oe.Element)&&!o)for(let f of n.childNodes){let p=_r(f,{doc:t,mirror:i,skipChild:!1,hackCss:l,afterAppend:c,cache:d});if(!p){console.warn("Failed to rebuild",f);continue}if(f.isShadow&&bh(h)&&h.shadowRoot)h.shadowRoot.appendChild(p);else if(n.type===oe.Document&&f.type==oe.Element){let g=p,v=null;g.childNodes.forEach(b=>{b.nodeName==="BODY"&&(v=b)}),v?(g.removeChild(v),h.appendChild(p),g.appendChild(v)):h.appendChild(p)}else h.appendChild(p);c&&c(p,f.id)}return h}a(_r,"buildNodeWithSN");function Rw(n,e){function t(i){e(i)}a(t,"walk");for(let i of n.getIds())n.has(i)&&t(n.getNode(i))}a(Rw,"visit");function Aw(n,e){let t=e.getMeta(n);if(t?.type!==oe.Element)return;let i=n;for(let o in t.attributes){if(!(Object.prototype.hasOwnProperty.call(t.attributes,o)&&o.startsWith("rr_")))continue;let l=t.attributes[o];o==="rr_scrollLeft"&&(i.scrollLeft=l),o==="rr_scrollTop"&&(i.scrollTop=l)}}a(Aw,"handleScroll");function Ih(n,e){let{doc:t,onVisit:i,hackCss:o=!0,afterAppend:l,cache:c,mirror:d=new Ei}=e,h=_r(n,{doc:t,mirror:d,skipChild:!1,hackCss:o,afterAppend:l,cache:c});return Rw(d,f=>{i&&i(f),Aw(f,d)}),h}a(Ih,"rebuild");function tt(n,e,t=document){let i={capture:!0,passive:!0};return t.addEventListener(n,e,i),()=>t.removeEventListener(n,e,i)}a(tt,"on");var Nr=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,Ch={map:{},getId(){return console.error(Nr),-1},getNode(){return console.error(Nr),null},removeNodeFromMap(){console.error(Nr)},has(){return console.error(Nr),!1},reset(){console.error(Nr)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Ch=new Proxy(Ch,{get(n,e,t){return e==="map"&&console.error(Nr),Reflect.get(n,e,t)}}));function Dr(n,e,t={}){let i=null,o=0;return function(...l){let c=Date.now();!o&&t.leading===!1&&(o=c);let d=e-(c-o),h=this;d<=0||d>e?(i&&(clearTimeout(i),i=null),o=c,n.apply(h,l)):!i&&t.trailing!==!1&&(i=setTimeout(()=>{o=t.leading===!1?0:Date.now(),i=null,n.apply(h,l)},d))}}a(Dr,"throttle");function Zn(n,e,t,i,o=window){let l=o.Object.getOwnPropertyDescriptor(n,e);return o.Object.defineProperty(n,e,i?t:{set(c){setTimeout(()=>{t.set.call(this,c)},0),l&&l.set&&l.set.call(this,c)}}),()=>Zn(n,e,l||{},!0)}a(Zn,"hookSetter");function $t(n,e,t){try{if(!(e in n))return()=>{};let i=n[e],o=t(i);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:i}})),n[e]=o,()=>{n[e]=i}}catch{return()=>{}}}a($t,"patch");var Or=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Or=a(()=>new Date().getTime(),"nowTimestamp"));function Gs(n){var e,t,i,o,l,c;let d=n.document;return{left:d.scrollingElement?d.scrollingElement.scrollLeft:n.pageXOffset!==void 0?n.pageXOffset:d?.documentElement.scrollLeft||((t=(e=d?.body)===null||e===void 0?void 0:e.parentElement)===null||t===void 0?void 0:t.scrollLeft)||((i=d?.body)===null||i===void 0?void 0:i.scrollLeft)||0,top:d.scrollingElement?d.scrollingElement.scrollTop:n.pageYOffset!==void 0?n.pageYOffset:d?.documentElement.scrollTop||((l=(o=d?.body)===null||o===void 0?void 0:o.parentElement)===null||l===void 0?void 0:l.scrollTop)||((c=d?.body)===null||c===void 0?void 0:c.scrollTop)||0}}a(Gs,"getWindowScroll");function qs(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}a(qs,"getWindowHeight");function zs(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}a(zs,"getWindowWidth");function Cl(n){return n?n.nodeType===n.ELEMENT_NODE?n:n.parentElement:null}a(Cl,"closestElementOfNode");function ze(n,e,t,i){if(!n)return!1;let o=Cl(n);if(!o)return!1;try{if(typeof e=="string"){if(o.classList.contains(e)||i&&o.closest("."+e)!==null)return!0}else if(Si(o,e,i))return!0}catch{}return!!(t&&(o.matches(t)||i&&o.closest(t)!==null))}a(ze,"isBlocked");function Rh(n,e){return e.getId(n)!==-1}a(Rh,"isSerialized");function js(n,e){return e.getId(n)===Yn}a(js,"isIgnored");function Rl(n,e){if(Qn(n))return!1;let t=e.getId(n);return e.has(t)?n.parentNode&&n.parentNode.nodeType===n.DOCUMENT_NODE?!1:n.parentNode?Rl(n.parentNode,e):!0:!0}a(Rl,"isAncestorRemoved");function Xs(n){return!!n.changedTouches}a(Xs,"legacy_isTouchEvent");function Ks(n=window){"NodeList"in n&&!n.NodeList.prototype.forEach&&(n.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in n&&!n.DOMTokenList.prototype.forEach&&(n.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===t)return!0;while(t=t&&t.parentNode);return!1})}a(Ks,"polyfill");function Ah(n){let e={},t=a((o,l)=>{let c={value:o,parent:l,children:[]};return e[o.node.id]=c,c},"putIntoMap"),i=[];for(let o of n){let{nextId:l,parentId:c}=o;if(l&&l in e){let d=e[l];if(d.parent){let h=d.parent.children.indexOf(d);d.parent.children.splice(h,0,t(o,d.parent))}else{let h=i.indexOf(d);i.splice(h,0,t(o,null))}continue}if(c in e){let d=e[c];d.children.push(t(o,d));continue}i.push(t(o,null))}return i}a(Ah,"queueToResolveTrees");function Al(n,e){e(n.value);for(let t=n.children.length-1;t>=0;t--)Al(n.children[t],e)}a(Al,"iterateResolveTree");function Cn(n,e){return!!(n.nodeName==="IFRAME"&&e.getMeta(n))}a(Cn,"isSerializedIframe");function Ys(n,e){return!!(n.nodeName==="LINK"&&n.nodeType===n.ELEMENT_NODE&&n.getAttribute&&n.getAttribute("rel")==="stylesheet"&&e.getMeta(n))}a(Ys,"isSerializedStylesheet");function _l(n,e){var t,i;let o=(i=(t=n.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||i===void 0?void 0:i.frameElement;if(!o||o===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};let l=o.getBoundingClientRect(),c=_l(o,e),d=l.height/o.clientHeight;return{x:l.x*c.relativeScale+c.x,y:l.y*c.relativeScale+c.y,relativeScale:d,absoluteScale:c.absoluteScale*d}}a(_l,"getBaseDimension");function Yt(n){return!!n?.shadowRoot}a(Yt,"hasShadowRoot");function kr(n,e){let t=n[e[0]];return e.length===1?t:kr(t.cssRules[e[1]].cssRules,e.slice(2))}a(kr,"getNestedRule");function Nl(n){let e=[...n],t=e.pop();return{positions:e,index:t}}a(Nl,"getPositionsAndIndex");function _h(n){let e=new Set,t=[];for(let i=n.length;i--;){let o=n[i];e.has(o.id)||(t.push(o),e.add(o.id))}return t}a(_h,"uniqueTextMutations");var Lr=class{static{a(this,"StyleSheetMirror")}constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return(t=this.styleIDMap.get(e))!==null&&t!==void 0?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let i;return t===void 0?i=this.id++:i=t,this.styleIDMap.set(e,i),this.idStyleMap.set(i,e),i}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Ll(n){var e,t;let i=null;return((t=(e=n.getRootNode)===null||e===void 0?void 0:e.call(n))===null||t===void 0?void 0:t.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&n.getRootNode().host&&(i=n.getRootNode().host),i}a(Ll,"getShadowHost");function _w(n){let e=n,t;for(;t=Ll(e);)e=t;return e}a(_w,"getRootShadowHost");function Nw(n){let e=n.ownerDocument;if(!e)return!1;let t=_w(n);return e.contains(t)}a(Nw,"shadowHostInDom");function Qs(n){let e=n.ownerDocument;return e?e.contains(n)||Nw(n):!1}a(Qs,"inDom");var G=(n=>(n[n.DomContentLoaded=0]="DomContentLoaded",n[n.Load=1]="Load",n[n.FullSnapshot=2]="FullSnapshot",n[n.IncrementalSnapshot=3]="IncrementalSnapshot",n[n.Meta=4]="Meta",n[n.Custom=5]="Custom",n[n.Plugin=6]="Plugin",n))(G||{}),$=(n=>(n[n.Mutation=0]="Mutation",n[n.MouseMove=1]="MouseMove",n[n.MouseInteraction=2]="MouseInteraction",n[n.Scroll=3]="Scroll",n[n.ViewportResize=4]="ViewportResize",n[n.Input=5]="Input",n[n.TouchMove=6]="TouchMove",n[n.MediaInteraction=7]="MediaInteraction",n[n.StyleSheetRule=8]="StyleSheetRule",n[n.CanvasMutation=9]="CanvasMutation",n[n.Font=10]="Font",n[n.Log=11]="Log",n[n.Drag=12]="Drag",n[n.StyleDeclaration=13]="StyleDeclaration",n[n.Selection=14]="Selection",n[n.AdoptedStyleSheet=15]="AdoptedStyleSheet",n[n.CustomElement=16]="CustomElement",n))($||{}),ae=(n=>(n[n.MouseUp=0]="MouseUp",n[n.MouseDown=1]="MouseDown",n[n.Click=2]="Click",n[n.ContextMenu=3]="ContextMenu",n[n.DblClick=4]="DblClick",n[n.Focus=5]="Focus",n[n.Blur=6]="Blur",n[n.TouchStart=7]="TouchStart",n[n.TouchMove_Departed=8]="TouchMove_Departed",n[n.TouchEnd=9]="TouchEnd",n[n.TouchCancel=10]="TouchCancel",n))(ae||{}),Qt=(n=>(n[n.Mouse=0]="Mouse",n[n.Pen=1]="Pen",n[n.Touch=2]="Touch",n))(Qt||{}),vt=(n=>(n[n["2D"]=0]="2D",n[n.WebGL=1]="WebGL",n[n.WebGL2=2]="WebGL2",n))(vt||{}),pe=(n=>(n.Start="start",n.Pause="pause",n.Resume="resume",n.Resize="resize",n.Finish="finish",n.FullsnapshotRebuilded="fullsnapshot-rebuilded",n.LoadStylesheetStart="load-stylesheet-start",n.LoadStylesheetEnd="load-stylesheet-end",n.SkipStart="skip-start",n.SkipEnd="skip-end",n.MouseInteraction="mouse-interaction",n.EventCast="event-cast",n.CustomEvent="custom-event",n.Flush="flush",n.StateChange="state-change",n.PlayBack="play-back",n.Destroy="destroy",n))(pe||{});function Nh(n){return"__ln"in n}a(Nh,"isNodeInLinkedList");var Dl=class{static{a(this,"DoubleLinkedList")}constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let i=0;i<e;i++)t=t?.next||null;return t}addNode(e){let t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Nh(e.previousSibling)){let i=e.previousSibling.__ln.next;t.next=i,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,i&&(i.previous=t)}else if(e.nextSibling&&Nh(e.nextSibling)&&e.nextSibling.__ln.previous){let i=e.nextSibling.__ln.previous;t.previous=i,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,i&&(i.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;t.next===null&&(this.tail=t),this.length++}removeNode(e){let t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}},Lh=a((n,e)=>`${n}@${e}`,"moveKey"),Zs=class{static{a(this,"MutationBuffer")}constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;let e=[],t=new Set,i=new Dl,o=a(h=>{let f=h,p=Yn;for(;p===Yn;)f=f&&f.nextSibling,p=f&&this.mirror.getId(f);return p},"getNextId"),l=a(h=>{if(!h.parentNode||!Qs(h)||h.parentNode.tagName==="TEXTAREA")return;let f=Qn(h.parentNode)?this.mirror.getId(Ll(h)):this.mirror.getId(h.parentNode),p=o(h);if(f===-1||p===-1)return i.addNode(h);let g=Xn(h,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:a(v=>{Cn(v,this.mirror)&&this.iframeManager.addIframe(v),Ys(v,this.mirror)&&this.stylesheetManager.trackLinkElement(v),Yt(h)&&this.shadowDomManager.addShadowRoot(h.shadowRoot,this.doc)},"onSerialize"),onIframeLoad:a((v,b)=>{this.iframeManager.attachIframe(v,b),this.shadowDomManager.observeAttachShadow(v)},"onIframeLoad"),onStylesheetLoad:a((v,b)=>{this.stylesheetManager.attachLinkElement(v,b)},"onStylesheetLoad")});g&&(e.push({parentId:f,nextId:p,node:g}),t.add(g.id))},"pushAdd");for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let h of this.movedSet)Dh(this.removes,h,this.mirror)&&!this.movedSet.has(h.parentNode)||l(h);for(let h of this.addedSet)!Oh(this.droppedSet,h)&&!Dh(this.removes,h,this.mirror)||Oh(this.movedSet,h)?l(h):this.droppedSet.add(h);let c=null;for(;i.length;){let h=null;if(c){let f=this.mirror.getId(c.value.parentNode),p=o(c.value);f!==-1&&p!==-1&&(h=c)}if(!h){let f=i.tail;for(;f;){let p=f;if(f=f.previous,p){let g=this.mirror.getId(p.value.parentNode);if(o(p.value)===-1)continue;if(g!==-1){h=p;break}else{let b=p.value;if(b.parentNode&&b.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let T=b.parentNode.host;if(this.mirror.getId(T)!==-1){h=p;break}}}}}}if(!h){for(;i.head;)i.removeNode(i.head.value);break}c=h.previous,i.removeNode(h.value),l(h.value)}let d={texts:this.texts.map(h=>{let f=h.node;return f.parentNode&&f.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(f.parentNode),{id:this.mirror.getId(f),value:h.value}}).filter(h=>!t.has(h.id)).filter(h=>this.mirror.has(h.id)),attributes:this.attributes.map(h=>{let{attributes:f}=h;if(typeof f.style=="string"){let p=JSON.stringify(h.styleDiff),g=JSON.stringify(h._unchangedStyles);p.length<f.style.length&&(p+g).split("var(").length===f.style.split("var(").length&&(f.style=h.styleDiff)}return{id:this.mirror.getId(h.node),attributes:f}}).filter(h=>!t.has(h.id)).filter(h=>this.mirror.has(h.id)),removes:this.removes,adds:e};!d.texts.length&&!d.attributes.length&&!d.removes.length&&!d.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(d))},this.genTextAreaValueMutation=e=>{let t=this.attributeMap.get(e);t||(t={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(t),this.attributeMap.set(e,t)),t.attributes.value=Array.from(e.childNodes,i=>i.textContent||"").join("")},this.processMutation=e=>{if(!js(e.target,this.mirror))switch(e.type){case"characterData":{let t=e.target.textContent;!ze(e.target,this.blockClass,this.blockSelector,!1)&&t!==e.oldValue&&this.texts.push({value:xl(e.target,this.maskTextClass,this.maskTextSelector,!0)&&t?this.maskTextFn?this.maskTextFn(t,Cl(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{let t=e.target,i=e.attributeName,o=e.target.getAttribute(i);if(i==="value"){let c=wi(t);o=bi({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:c,value:o,maskInputFn:this.maskInputFn})}if(ze(e.target,this.blockClass,this.blockSelector,!1)||o===e.oldValue)return;let l=this.attributeMap.get(e.target);if(t.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(o))if(!t.contentDocument)i="rr_src";else return;if(l||(l={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(l),this.attributeMap.set(e.target,l)),i==="type"&&t.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&t.setAttribute("data-rr-is-password","true"),!Ml(t.tagName,i)&&(l.attributes[i]=Tl(this.doc,Vt(t.tagName),Vt(i),o),i==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}let c=this.unattachedDoc.createElement("span");e.oldValue&&c.setAttribute("style",e.oldValue);for(let d of Array.from(t.style)){let h=t.style.getPropertyValue(d),f=t.style.getPropertyPriority(d);h!==c.style.getPropertyValue(d)||f!==c.style.getPropertyPriority(d)?f===""?l.styleDiff[d]=h:l.styleDiff[d]=[h,f]:l._unchangedStyles[d]=[h,f]}for(let d of Array.from(c.style))t.style.getPropertyValue(d)===""&&(l.styleDiff[d]=!1)}break}case"childList":{if(ze(e.target,this.blockClass,this.blockSelector,!0))return;if(e.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(e.target);return}e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{let i=this.mirror.getId(t),o=Qn(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);ze(e.target,this.blockClass,this.blockSelector,!1)||js(t,this.mirror)||!Rh(t,this.mirror)||(this.addedSet.has(t)?(Ol(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&i===-1||Rl(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[Lh(i,o)]?Ol(this.movedSet,t):this.removes.push({parentId:o,id:i,isShadow:Qn(e.target)&&Kn(e.target)?!0:void 0})),this.mapRemoves.push(t))});break}}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(js(e,this.mirror))return;this.movedSet.add(e);let i=null;t&&this.mirror.hasNode(t)&&(i=this.mirror.getId(t)),i&&i!==-1&&(this.movedMap[Lh(this.mirror.getId(e),i)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);ze(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(i=>this.genAdds(i)),Yt(e)&&e.shadowRoot.childNodes.forEach(i=>{this.processedNodeManager.add(i,this),this.genAdds(i,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}};function Ol(n,e){n.delete(e),e.childNodes.forEach(t=>Ol(n,t))}a(Ol,"deepDelete");function Dh(n,e,t){return n.length===0?!1:kh(n,e,t)}a(Dh,"isParentRemoved");function kh(n,e,t){let{parentNode:i}=e;if(!i)return!1;let o=t.getId(i);return n.some(l=>l.id===o)?!0:kh(n,i,t)}a(kh,"_isParentRemoved");function Oh(n,e){return n.size===0?!1:Fh(n,e)}a(Oh,"isAncestorInSet");function Fh(n,e){let{parentNode:t}=e;return t?n.has(t)?!0:Fh(n,t):!1}a(Fh,"_isAncestorInSet");var Ti;function Ph(n){Ti=n}a(Ph,"registerErrorHandler");function Hh(){Ti=void 0}a(Hh,"unregisterErrorHandler");var Ee=a(n=>Ti?a((...t)=>{try{return n(...t)}catch(i){if(Ti&&Ti(i)===!0)return;throw i}},"rrwebWrapped"):n,"callbackWrapper");var An=[];function Mi(n){try{if("composedPath"in n){let e=n.composedPath();if(e.length)return e[0]}else if("path"in n&&n.path.length)return n.path[0]}catch{}return n&&n.target}a(Mi,"getEventTarget");function kl(n,e){var t,i;let o=new Zs;An.push(o),o.init(n);let l=window.MutationObserver||window.__rrMutationObserver,c=(i=(t=window?.Zone)===null||t===void 0?void 0:t.__symbol__)===null||i===void 0?void 0:i.call(t,"MutationObserver");c&&window[c]&&(l=window[c]);let d=new l(Ee(o.processMutations.bind(o)));return d.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),d}a(kl,"initMutationObserver");function Lw({mousemoveCb:n,sampling:e,doc:t,mirror:i}){if(e.mousemove===!1)return()=>{};let o=typeof e.mousemove=="number"?e.mousemove:50,l=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500,c=[],d,h=Dr(Ee(g=>{let v=Date.now()-d;n(c.map(b=>(b.timeOffset-=v,b)),g),c=[],d=null}),l),f=Ee(Dr(Ee(g=>{let v=Mi(g),{clientX:b,clientY:T}=Xs(g)?g.changedTouches[0]:g;d||(d=Or()),c.push({x:b,y:T,id:i.getId(v),timeOffset:Or()-d}),h(typeof DragEvent<"u"&&g instanceof DragEvent?$.Drag:g instanceof MouseEvent?$.MouseMove:$.TouchMove)}),o,{trailing:!1})),p=[tt("mousemove",f,t),tt("touchmove",f,t),tt("drag",f,t)];return Ee(()=>{p.forEach(g=>g())})}a(Lw,"initMoveObserver");function Dw({mouseInteractionCb:n,doc:e,mirror:t,blockClass:i,blockSelector:o,sampling:l}){if(l.mouseInteraction===!1)return()=>{};let c=l.mouseInteraction===!0||l.mouseInteraction===void 0?{}:l.mouseInteraction,d=[],h=null,f=a(p=>g=>{let v=Mi(g);if(ze(v,i,o,!0))return;let b=null,T=p;if("pointerType"in g){switch(g.pointerType){case"mouse":b=Qt.Mouse;break;case"touch":b=Qt.Touch;break;case"pen":b=Qt.Pen;break}b===Qt.Touch?ae[p]===ae.MouseDown?T="TouchStart":ae[p]===ae.MouseUp&&(T="TouchEnd"):Qt.Pen}else Xs(g)&&(b=Qt.Touch);b!==null?(h=b,(T.startsWith("Touch")&&b===Qt.Touch||T.startsWith("Mouse")&&b===Qt.Mouse)&&(b=null)):ae[p]===ae.Click&&(b=h,h=null);let S=Xs(g)?g.changedTouches[0]:g;if(!S)return;let C=t.getId(v),{clientX:x,clientY:_}=S;Ee(n)(Object.assign({type:ae[T],id:C,x,y:_},b!==null&&{pointerType:b}))},"getHandler");return Object.keys(ae).filter(p=>Number.isNaN(Number(p))&&!p.endsWith("_Departed")&&c[p]!==!1).forEach(p=>{let g=Vt(p),v=f(p);if(window.PointerEvent)switch(ae[p]){case ae.MouseDown:case ae.MouseUp:g=g.replace("mouse","pointer");break;case ae.TouchStart:case ae.TouchEnd:return}d.push(tt(g,v,e))}),Ee(()=>{d.forEach(p=>p())})}a(Dw,"initMouseInteractionObserver");function Fl({scrollCb:n,doc:e,mirror:t,blockClass:i,blockSelector:o,sampling:l}){let c=Ee(Dr(Ee(d=>{let h=Mi(d);if(!h||ze(h,i,o,!0))return;let f=t.getId(h);if(h===e&&e.defaultView){let p=Gs(e.defaultView);n({id:f,x:p.left,y:p.top})}else n({id:f,x:h.scrollLeft,y:h.scrollTop})}),l.scroll||100));return tt("scroll",c,e)}a(Fl,"initScrollObserver");function Ow({viewportResizeCb:n},{win:e}){let t=-1,i=-1,o=Ee(Dr(Ee(()=>{let l=qs(),c=zs();(t!==l||i!==c)&&(n({width:Number(c),height:Number(l)}),t=l,i=c)}),200));return tt("resize",o,e)}a(Ow,"initViewportResizeObserver");var kw=["INPUT","TEXTAREA","SELECT"],Bh=new WeakMap;function Fw({inputCb:n,doc:e,mirror:t,blockClass:i,blockSelector:o,ignoreClass:l,ignoreSelector:c,maskInputOptions:d,maskInputFn:h,sampling:f,userTriggeredOnInput:p}){function g(_){let R=Mi(_),O=_.isTrusted,U=R&&R.tagName;if(R&&U==="OPTION"&&(R=R.parentElement),!R||!U||kw.indexOf(U)<0||ze(R,i,o,!0)||R.classList.contains(l)||c&&R.matches(c))return;let Y=R.value,le=!1,Q=wi(R)||"";Q==="radio"||Q==="checkbox"?le=R.checked:(d[U.toLowerCase()]||d[Q])&&(Y=bi({element:R,maskInputOptions:d,tagName:U,type:Q,value:Y,maskInputFn:h})),v(R,p?{text:Y,isChecked:le,userTriggered:O}:{text:Y,isChecked:le});let se=R.name;Q==="radio"&&se&&le&&e.querySelectorAll(`input[type="radio"][name="${se}"]`).forEach(fe=>{if(fe!==R){let V=fe.value;v(fe,p?{text:V,isChecked:!le,userTriggered:!1}:{text:V,isChecked:!le})}})}a(g,"eventHandler");function v(_,R){let O=Bh.get(_);if(!O||O.text!==R.text||O.isChecked!==R.isChecked){Bh.set(_,R);let U=t.getId(_);Ee(n)(Object.assign(Object.assign({},R),{id:U}))}}a(v,"cbWithDedup");let T=(f.input==="last"?["change"]:["input","change"]).map(_=>tt(_,Ee(g),e)),S=e.defaultView;if(!S)return()=>{T.forEach(_=>_())};let C=S.Object.getOwnPropertyDescriptor(S.HTMLInputElement.prototype,"value"),x=[[S.HTMLInputElement.prototype,"value"],[S.HTMLInputElement.prototype,"checked"],[S.HTMLSelectElement.prototype,"value"],[S.HTMLTextAreaElement.prototype,"value"],[S.HTMLSelectElement.prototype,"selectedIndex"],[S.HTMLOptionElement.prototype,"selected"]];return C&&C.set&&T.push(...x.map(_=>Zn(_[0],_[1],{set(){Ee(g)({target:this,isTrusted:!1})}},!1,S))),Ee(()=>{T.forEach(_=>_())})}a(Fw,"initInputObserver");function to(n){let e=[];function t(i,o){if(Js("CSSGroupingRule")&&i.parentRule instanceof CSSGroupingRule||Js("CSSMediaRule")&&i.parentRule instanceof CSSMediaRule||Js("CSSSupportsRule")&&i.parentRule instanceof CSSSupportsRule||Js("CSSConditionRule")&&i.parentRule instanceof CSSConditionRule){let c=Array.from(i.parentRule.cssRules).indexOf(i);o.unshift(c)}else if(i.parentStyleSheet){let c=Array.from(i.parentStyleSheet.cssRules).indexOf(i);o.unshift(c)}return o}return a(t,"recurse"),t(n,e)}a(to,"getNestedCSSRulePositions");function Rn(n,e,t){let i,o;return n?(n.ownerNode?i=e.getId(n.ownerNode):o=t.getId(n),{styleId:o,id:i}):{}}a(Rn,"getIdAndStyleId");function Pw({styleSheetRuleCb:n,mirror:e,stylesheetManager:t},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};let o=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:Ee((p,g,v)=>{let[b,T]=v,{id:S,styleId:C}=Rn(g,e,t.styleMirror);return(S&&S!==-1||C&&C!==-1)&&n({id:S,styleId:C,adds:[{rule:b,index:T}]}),p.apply(g,v)})});let l=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(l,{apply:Ee((p,g,v)=>{let[b]=v,{id:T,styleId:S}=Rn(g,e,t.styleMirror);return(T&&T!==-1||S&&S!==-1)&&n({id:T,styleId:S,removes:[{index:b}]}),p.apply(g,v)})});let c;i.CSSStyleSheet.prototype.replace&&(c=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=new Proxy(c,{apply:Ee((p,g,v)=>{let[b]=v,{id:T,styleId:S}=Rn(g,e,t.styleMirror);return(T&&T!==-1||S&&S!==-1)&&n({id:T,styleId:S,replace:b}),p.apply(g,v)})}));let d;i.CSSStyleSheet.prototype.replaceSync&&(d=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=new Proxy(d,{apply:Ee((p,g,v)=>{let[b]=v,{id:T,styleId:S}=Rn(g,e,t.styleMirror);return(T&&T!==-1||S&&S!==-1)&&n({id:T,styleId:S,replaceSync:b}),p.apply(g,v)})}));let h={};eo("CSSGroupingRule")?h.CSSGroupingRule=i.CSSGroupingRule:(eo("CSSMediaRule")&&(h.CSSMediaRule=i.CSSMediaRule),eo("CSSConditionRule")&&(h.CSSConditionRule=i.CSSConditionRule),eo("CSSSupportsRule")&&(h.CSSSupportsRule=i.CSSSupportsRule));let f={};return Object.entries(h).forEach(([p,g])=>{f[p]={insertRule:g.prototype.insertRule,deleteRule:g.prototype.deleteRule},g.prototype.insertRule=new Proxy(f[p].insertRule,{apply:Ee((v,b,T)=>{let[S,C]=T,{id:x,styleId:_}=Rn(b.parentStyleSheet,e,t.styleMirror);return(x&&x!==-1||_&&_!==-1)&&n({id:x,styleId:_,adds:[{rule:S,index:[...to(b),C||0]}]}),v.apply(b,T)})}),g.prototype.deleteRule=new Proxy(f[p].deleteRule,{apply:Ee((v,b,T)=>{let[S]=T,{id:C,styleId:x}=Rn(b.parentStyleSheet,e,t.styleMirror);return(C&&C!==-1||x&&x!==-1)&&n({id:C,styleId:x,removes:[{index:[...to(b),S]}]}),v.apply(b,T)})})}),Ee(()=>{i.CSSStyleSheet.prototype.insertRule=o,i.CSSStyleSheet.prototype.deleteRule=l,c&&(i.CSSStyleSheet.prototype.replace=c),d&&(i.CSSStyleSheet.prototype.replaceSync=d),Object.entries(h).forEach(([p,g])=>{g.prototype.insertRule=f[p].insertRule,g.prototype.deleteRule=f[p].deleteRule})})}a(Pw,"initStyleSheetObserver");function Pl({mirror:n,stylesheetManager:e},t){var i,o,l;let c=null;t.nodeName==="#document"?c=n.getId(t):c=n.getId(t.host);let d=t.nodeName==="#document"?(i=t.defaultView)===null||i===void 0?void 0:i.Document:(l=(o=t.ownerDocument)===null||o===void 0?void 0:o.defaultView)===null||l===void 0?void 0:l.ShadowRoot,h=d?.prototype?Object.getOwnPropertyDescriptor(d?.prototype,"adoptedStyleSheets"):void 0;return c===null||c===-1||!d||!h?()=>{}:(Object.defineProperty(t,"adoptedStyleSheets",{configurable:h.configurable,enumerable:h.enumerable,get(){var f;return(f=h.get)===null||f===void 0?void 0:f.call(this)},set(f){var p;let g=(p=h.set)===null||p===void 0?void 0:p.call(this,f);if(c!==null&&c!==-1)try{e.adoptStyleSheets(f,c)}catch{}return g}}),Ee(()=>{Object.defineProperty(t,"adoptedStyleSheets",{configurable:h.configurable,enumerable:h.enumerable,get:h.get,set:h.set})}))}a(Pl,"initAdoptedStyleSheetObserver");function Hw({styleDeclarationCb:n,mirror:e,ignoreCSSAttributes:t,stylesheetManager:i},{win:o}){let l=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(l,{apply:Ee((d,h,f)=>{var p;let[g,v,b]=f;if(t.has(g))return l.apply(h,[g,v,b]);let{id:T,styleId:S}=Rn((p=h.parentRule)===null||p===void 0?void 0:p.parentStyleSheet,e,i.styleMirror);return(T&&T!==-1||S&&S!==-1)&&n({id:T,styleId:S,set:{property:g,value:v,priority:b},index:to(h.parentRule)}),d.apply(h,f)})});let c=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(c,{apply:Ee((d,h,f)=>{var p;let[g]=f;if(t.has(g))return c.apply(h,[g]);let{id:v,styleId:b}=Rn((p=h.parentRule)===null||p===void 0?void 0:p.parentStyleSheet,e,i.styleMirror);return(v&&v!==-1||b&&b!==-1)&&n({id:v,styleId:b,remove:{property:g},index:to(h.parentRule)}),d.apply(h,f)})}),Ee(()=>{o.CSSStyleDeclaration.prototype.setProperty=l,o.CSSStyleDeclaration.prototype.removeProperty=c})}a(Hw,"initStyleDeclarationObserver");function Bw({mediaInteractionCb:n,blockClass:e,blockSelector:t,mirror:i,sampling:o,doc:l}){let c=Ee(h=>Dr(Ee(f=>{let p=Mi(f);if(!p||ze(p,e,t,!0))return;let{currentTime:g,volume:v,muted:b,playbackRate:T,loop:S}=p;n({type:h,id:i.getId(p),currentTime:g,volume:v,muted:b,playbackRate:T,loop:S})}),o.media||500)),d=[tt("play",c(0),l),tt("pause",c(1),l),tt("seeked",c(2),l),tt("volumechange",c(3),l),tt("ratechange",c(4),l)];return Ee(()=>{d.forEach(h=>h())})}a(Bw,"initMediaInteractionObserver");function Ww({fontCb:n,doc:e}){let t=e.defaultView;if(!t)return()=>{};let i=[],o=new WeakMap,l=t.FontFace;t.FontFace=a(function(h,f,p){let g=new l(h,f,p);return o.set(g,{family:h,buffer:typeof f!="string",descriptors:p,fontSource:typeof f=="string"?f:JSON.stringify(Array.from(new Uint8Array(f)))}),g},"FontFace");let c=$t(e.fonts,"add",function(d){return function(h){return setTimeout(Ee(()=>{let f=o.get(h);f&&(n(f),o.delete(h))}),0),d.apply(this,[h])}});return i.push(()=>{t.FontFace=l}),i.push(c),Ee(()=>{i.forEach(d=>d())})}a(Ww,"initFontObserver");function Vw(n){let{doc:e,mirror:t,blockClass:i,blockSelector:o,selectionCb:l}=n,c=!0,d=Ee(()=>{let h=e.getSelection();if(!h||c&&h?.isCollapsed)return;c=h.isCollapsed||!1;let f=[],p=h.rangeCount||0;for(let g=0;g<p;g++){let v=h.getRangeAt(g),{startContainer:b,startOffset:T,endContainer:S,endOffset:C}=v;ze(b,i,o,!0)||ze(S,i,o,!0)||f.push({start:t.getId(b),startOffset:T,end:t.getId(S),endOffset:C})}l({ranges:f})});return d(),tt("selectionchange",d)}a(Vw,"initSelectionObserver");function $w({doc:n,customElementCb:e}){let t=n.defaultView;return!t||!t.customElements?()=>{}:$t(t.customElements,"define",function(o){return function(l,c,d){try{e({define:{name:l}})}catch{console.warn(`Custom element callback failed for ${l}`)}return o.apply(this,[l,c,d])}})}a($w,"initCustomElementObserver");function Uw(n,e){let{mutationCb:t,mousemoveCb:i,mouseInteractionCb:o,scrollCb:l,viewportResizeCb:c,inputCb:d,mediaInteractionCb:h,styleSheetRuleCb:f,styleDeclarationCb:p,canvasMutationCb:g,fontCb:v,selectionCb:b,customElementCb:T}=n;n.mutationCb=(...S)=>{e.mutation&&e.mutation(...S),t(...S)},n.mousemoveCb=(...S)=>{e.mousemove&&e.mousemove(...S),i(...S)},n.mouseInteractionCb=(...S)=>{e.mouseInteraction&&e.mouseInteraction(...S),o(...S)},n.scrollCb=(...S)=>{e.scroll&&e.scroll(...S),l(...S)},n.viewportResizeCb=(...S)=>{e.viewportResize&&e.viewportResize(...S),c(...S)},n.inputCb=(...S)=>{e.input&&e.input(...S),d(...S)},n.mediaInteractionCb=(...S)=>{e.mediaInteaction&&e.mediaInteaction(...S),h(...S)},n.styleSheetRuleCb=(...S)=>{e.styleSheetRule&&e.styleSheetRule(...S),f(...S)},n.styleDeclarationCb=(...S)=>{e.styleDeclaration&&e.styleDeclaration(...S),p(...S)},n.canvasMutationCb=(...S)=>{e.canvasMutation&&e.canvasMutation(...S),g(...S)},n.fontCb=(...S)=>{e.font&&e.font(...S),v(...S)},n.selectionCb=(...S)=>{e.selection&&e.selection(...S),b(...S)},n.customElementCb=(...S)=>{e.customElement&&e.customElement(...S),T(...S)}}a(Uw,"mergeHooks");function Wh(n,e={}){let t=n.doc.defaultView;if(!t)return()=>{};Uw(n,e);let i;n.recordDOM&&(i=kl(n,n.doc));let o=Lw(n),l=Dw(n),c=Fl(n),d=Ow(n,{win:t}),h=Fw(n),f=Bw(n),p=a(()=>{},"styleSheetObserver"),g=a(()=>{},"adoptedStyleSheetObserver"),v=a(()=>{},"styleDeclarationObserver"),b=a(()=>{},"fontObserver");n.recordDOM&&(p=Pw(n,{win:t}),g=Pl(n,n.doc),v=Hw(n,{win:t}),n.collectFonts&&(b=Ww(n)));let T=Vw(n),S=$w(n),C=[];for(let x of n.plugins)C.push(x.observer(x.callback,t,x.options));return Ee(()=>{An.forEach(x=>x.reset()),i?.disconnect(),o(),l(),c(),d(),h(),f(),p(),g(),v(),b(),T(),S(),C.forEach(x=>x())})}a(Wh,"initObservers");function Js(n){return typeof window[n]<"u"}a(Js,"hasNestedCSSRule");function eo(n){return!!(typeof window[n]<"u"&&window[n].prototype&&"insertRule"in window[n].prototype&&"deleteRule"in window[n].prototype)}a(eo,"canMonkeyPatchNestedCSSRule");var xi=class{static{a(this,"CrossOriginIframeMirror")}constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,i,o){let l=i||this.getIdToRemoteIdMap(e),c=o||this.getRemoteIdToIdMap(e),d=l.get(t);return d||(d=this.generateIdFn(),l.set(t,d),c.set(d,t)),d}getIds(e,t){let i=this.getIdToRemoteIdMap(e),o=this.getRemoteIdToIdMap(e);return t.map(l=>this.getId(e,l,i,o))}getRemoteId(e,t,i){let o=i||this.getRemoteIdToIdMap(e);if(typeof t!="number")return t;let l=o.get(t);return l||-1}getRemoteIds(e,t){let i=this.getRemoteIdToIdMap(e);return t.map(o=>this.getRemoteId(e,o,i))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}};var no=class{static{a(this,"IframeManager")}constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new xi(wl),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new xi(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var i;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(i=this.loadListener)===null||i===void 0||i.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){let t=e;if(t.data.type!=="rrweb"||t.origin!==t.data.origin||!e.source)return;let o=this.crossOriginIframeMap.get(e.source);if(!o)return;let l=this.transformCrossOriginEvent(o,t.data.event);l&&this.wrappedEmit(l,t.data.isCheckout)}transformCrossOriginEvent(e,t){var i;switch(t.type){case G.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);let o=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,o),this.patchRootIdOnNode(t.data.node,o),{timestamp:t.timestamp,type:G.IncrementalSnapshot,data:{source:$.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case G.Meta:case G.Load:case G.DomContentLoaded:return!1;case G.Plugin:return t;case G.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case G.IncrementalSnapshot:switch(t.data.source){case $.Mutation:return t.data.adds.forEach(o=>{this.replaceIds(o,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(o.node,e);let l=this.crossOriginIframeRootIdMap.get(e);l&&this.patchRootIdOnNode(o.node,l)}),t.data.removes.forEach(o=>{this.replaceIds(o,e,["parentId","id"])}),t.data.attributes.forEach(o=>{this.replaceIds(o,e,["id"])}),t.data.texts.forEach(o=>{this.replaceIds(o,e,["id"])}),t;case $.Drag:case $.TouchMove:case $.MouseMove:return t.data.positions.forEach(o=>{this.replaceIds(o,e,["id"])}),t;case $.ViewportResize:return!1;case $.MediaInteraction:case $.MouseInteraction:case $.Scroll:case $.CanvasMutation:case $.Input:return this.replaceIds(t.data,e,["id"]),t;case $.StyleSheetRule:case $.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case $.Font:return t;case $.Selection:return t.data.ranges.forEach(o=>{this.replaceIds(o,e,["start","end"])}),t;case $.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),(i=t.data.styles)===null||i===void 0||i.forEach(o=>{this.replaceStyleIds(o,e,["styleId"])}),t}}return!1}replace(e,t,i,o){for(let l of o)!Array.isArray(t[l])&&typeof t[l]!="number"||(Array.isArray(t[l])?t[l]=e.getIds(i,t[l]):t[l]=e.getId(i,t[l]));return t}replaceIds(e,t,i){return this.replace(this.crossOriginIframeMirror,e,t,i)}replaceStyleIds(e,t,i){return this.replace(this.crossOriginIframeStyleMirror,e,t,i)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(i=>{this.replaceIdOnNode(i,t)})}patchRootIdOnNode(e,t){e.type!==oe.Document&&!e.rootId&&(e.rootId=t),"childNodes"in e&&e.childNodes.forEach(i=>{this.patchRootIdOnNode(i,t)})}};var ro=class{static{a(this,"ShadowDomManager")}constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!Kn(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let i=kl(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>i.disconnect()),this.restoreHandlers.push(Fl(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Pl({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){let i=this;this.restoreHandlers.push($t(e.prototype,"attachShadow",function(o){return function(l){let c=o.call(this,l);return this.shadowRoot&&Qs(this)&&i.addShadowRoot(this.shadowRoot,t),c}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}};function Vh(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}a(Vh,"__rest");function dt(n,e,t,i){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return a(o,"adopt"),new(t||(t=Promise))(function(l,c){function d(p){try{f(i.next(p))}catch(g){c(g)}}a(d,"fulfilled");function h(p){try{f(i.throw(p))}catch(g){c(g)}}a(h,"rejected");function f(p){p.done?l(p.value):o(p.value).then(d,h)}a(f,"step"),f((i=i.apply(n,e||[])).next())})}a(dt,"__awaiter");var Fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ci=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Ii=0;Ii<Fr.length;Ii++)Ci[Fr.charCodeAt(Ii)]=Ii;var Ii,$h=a(function(n){var e=new Uint8Array(n),t,i=e.length,o="";for(t=0;t<i;t+=3)o+=Fr[e[t]>>2],o+=Fr[(e[t]&3)<<4|e[t+1]>>4],o+=Fr[(e[t+1]&15)<<2|e[t+2]>>6],o+=Fr[e[t+2]&63];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},"encode"),Uh=a(function(n){var e=n.length*.75,t=n.length,i,o=0,l,c,d,h;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var f=new ArrayBuffer(e),p=new Uint8Array(f);for(i=0;i<t;i+=4)l=Ci[n.charCodeAt(i)],c=Ci[n.charCodeAt(i+1)],d=Ci[n.charCodeAt(i+2)],h=Ci[n.charCodeAt(i+3)],p[o++]=l<<2|c>>4,p[o++]=(c&15)<<4|d>>2,p[o++]=(d&3)<<6|h&63;return f},"decode");var Gh=new Map;function Gw(n,e){let t=Gh.get(n);return t||(t=new Map,Gh.set(n,t)),t.has(e)||t.set(e,[]),t.get(e)}a(Gw,"variableListFor");var Hl=a((n,e,t)=>{if(!n||!(qh(n,e)||typeof n=="object"))return;let i=n.constructor.name,o=Gw(t,i),l=o.indexOf(n);return l===-1&&(l=o.length,o.push(n)),l},"saveWebGLVar");function io(n,e,t){if(n instanceof Array)return n.map(i=>io(i,e,t));if(n===null)return n;if(n instanceof Float32Array||n instanceof Float64Array||n instanceof Int32Array||n instanceof Uint32Array||n instanceof Uint8Array||n instanceof Uint16Array||n instanceof Int16Array||n instanceof Int8Array||n instanceof Uint8ClampedArray)return{rr_type:n.constructor.name,args:[Object.values(n)]};if(n instanceof ArrayBuffer){let i=n.constructor.name,o=$h(n);return{rr_type:i,base64:o}}else{if(n instanceof DataView)return{rr_type:n.constructor.name,args:[io(n.buffer,e,t),n.byteOffset,n.byteLength]};if(n instanceof HTMLImageElement){let i=n.constructor.name,{src:o}=n;return{rr_type:i,src:o}}else if(n instanceof HTMLCanvasElement){let i="HTMLImageElement",o=n.toDataURL();return{rr_type:i,src:o}}else{if(n instanceof ImageData)return{rr_type:n.constructor.name,args:[io(n.data,e,t),n.width,n.height]};if(qh(n,e)||typeof n=="object"){let i=n.constructor.name,o=Hl(n,e,t);return{rr_type:i,index:o}}}}return n}a(io,"serializeArg");var so=a((n,e,t)=>n.map(i=>io(i,e,t)),"serializeArgs"),qh=a((n,e)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(o=>typeof e[o]=="function").find(o=>n instanceof e[o]),"isInstanceOfWebGLObject");function zh(n,e,t,i){let o=[],l=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(let c of l)try{if(typeof e.CanvasRenderingContext2D.prototype[c]!="function")continue;let d=$t(e.CanvasRenderingContext2D.prototype,c,function(h){return function(...f){return ze(this.canvas,t,i,!0)||setTimeout(()=>{let p=so(f,e,this);n(this.canvas,{type:vt["2D"],property:c,args:p})},0),h.apply(this,f)}});o.push(d)}catch{let h=Zn(e.CanvasRenderingContext2D.prototype,c,{set(f){n(this.canvas,{type:vt["2D"],property:c,args:[f],setter:!0})}});o.push(h)}return()=>{o.forEach(c=>c())}}a(zh,"initCanvas2DMutationObserver");function qw(n){return n==="experimental-webgl"?"webgl":n}a(qw,"getNormalizedContextName");function Bl(n,e,t,i){let o=[];try{let l=$t(n.HTMLCanvasElement.prototype,"getContext",function(c){return function(d,...h){if(!ze(this,e,t,!0)){let f=qw(d);if("__context"in this||(this.__context=f),i&&["webgl","webgl2"].includes(f))if(h[0]&&typeof h[0]=="object"){let p=h[0];p.preserveDrawingBuffer||(p.preserveDrawingBuffer=!0)}else h.splice(0,1,{preserveDrawingBuffer:!0})}return c.apply(this,[d,...h])}});o.push(l)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(l=>l())}}a(Bl,"initCanvasContextObserver");function jh(n,e,t,i,o,l,c){let d=[],h=Object.getOwnPropertyNames(n);for(let f of h)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(f))try{if(typeof n[f]!="function")continue;let p=$t(n,f,function(g){return function(...v){let b=g.apply(this,v);if(Hl(b,c,this),"tagName"in this.canvas&&!ze(this.canvas,i,o,!0)){let T=so(v,c,this),S={type:e,property:f,args:T};t(this.canvas,S)}return b}});d.push(p)}catch{let g=Zn(n,f,{set(v){t(this.canvas,{type:e,property:f,args:[v],setter:!0})}});d.push(g)}return d}a(jh,"patchGLPrototype");function Xh(n,e,t,i,o){let l=[];return l.push(...jh(e.WebGLRenderingContext.prototype,vt.WebGL,n,t,i,o,e)),typeof e.WebGL2RenderingContext<"u"&&l.push(...jh(e.WebGL2RenderingContext.prototype,vt.WebGL2,n,t,i,o,e)),()=>{l.forEach(c=>c())}}a(Xh,"initCanvasWebGLMutationObserver");function Kh(n,e){var t=e===void 0?null:e,i=n.toString(),o=i.split(`
`);o.pop(),o.shift();for(var l=o[0].search(/\S/),c=/(['"])__worker_loader_strict__(['"])/g,d=0,h=o.length;d<h;++d)o[d]=o[d].substring(l).replace(c,"$1use strict$2")+`
`;return t&&o.push("//# sourceMappingURL="+t+`
`),o}a(Kh,"funcToSource");function zw(n,e){var t=Kh(n,e),i=new Blob(t,{type:"application/javascript"});return URL.createObjectURL(i)}a(zw,"createURL");function Yh(n,e){var t;return a(function(o){return t=t||zw(n,e),new Worker(t,o)},"WorkerFactory")}a(Yh,"createInlineWorkerFactory");var Qh=Yh(function(){(function(){"__worker_loader_strict__";function n(f,p,g,v){function b(T){return T instanceof g?T:new g(function(S){S(T)})}return a(b,"adopt"),new(g||(g=Promise))(function(T,S){function C(R){try{_(v.next(R))}catch(O){S(O)}}a(C,"fulfilled");function x(R){try{_(v.throw(R))}catch(O){S(O)}}a(x,"rejected");function _(R){R.done?T(R.value):b(R.value).then(C,x)}a(_,"step"),_((v=v.apply(f,p||[])).next())})}a(n,"__awaiter");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=typeof Uint8Array>"u"?[]:new Uint8Array(256),i=0;i<e.length;i++)t[e.charCodeAt(i)]=i;var o=a(function(f){var p=new Uint8Array(f),g,v=p.length,b="";for(g=0;g<v;g+=3)b+=e[p[g]>>2],b+=e[(p[g]&3)<<4|p[g+1]>>4],b+=e[(p[g+1]&15)<<2|p[g+2]>>6],b+=e[p[g+2]&63];return v%3===2?b=b.substring(0,b.length-1)+"=":v%3===1&&(b=b.substring(0,b.length-2)+"=="),b},"encode");let l=new Map,c=new Map;function d(f,p,g){return n(this,void 0,void 0,function*(){let v=`${f}-${p}`;if("OffscreenCanvas"in globalThis){if(c.has(v))return c.get(v);let b=new OffscreenCanvas(f,p);b.getContext("2d");let S=yield(yield b.convertToBlob(g)).arrayBuffer(),C=o(S);return c.set(v,C),C}else return""})}a(d,"getTransparentBlobFor");let h=self;h.onmessage=function(f){return n(this,void 0,void 0,function*(){if("OffscreenCanvas"in globalThis){let{id:p,bitmap:g,width:v,height:b,dataURLOptions:T}=f.data,S=d(v,b,T),C=new OffscreenCanvas(v,b);C.getContext("2d").drawImage(g,0,0),g.close();let _=yield C.convertToBlob(T),R=_.type,O=yield _.arrayBuffer(),U=o(O);if(!l.has(p)&&(yield S)===U)return l.set(p,U),h.postMessage({id:p});if(l.get(p)===U)return h.postMessage({id:p});h.postMessage({id:p,type:R,base64:U,width:v,height:b}),l.set(p,U)}else return h.postMessage({id:f.data.id})})}})()},null);var oo=class{static{a(this,"CanvasManager")}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(h,f)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(h)||this.pendingCanvasMutations.set(h,[]),this.pendingCanvasMutations.get(h).push(f)};let{sampling:t="all",win:i,blockClass:o,blockSelector:l,recordCanvas:c,dataURLOptions:d}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,c&&t==="all"&&this.initCanvasMutationObserver(i,o,l),c&&typeof t=="number"&&this.initCanvasFPSObserver(t,i,o,l,{dataURLOptions:d})}initCanvasFPSObserver(e,t,i,o,l){let c=Bl(t,i,o,!0),d=new Map,h=new Qh;h.onmessage=T=>{let{id:S}=T.data;if(d.set(S,!1),!("base64"in T.data))return;let{base64:C,type:x,width:_,height:R}=T.data;this.mutationCb({id:S,type:vt["2D"],commands:[{property:"clearRect",args:[0,0,_,R]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:C}],type:x}]},0,0]}]})};let f=1e3/e,p=0,g,v=a(()=>{let T=[];return t.document.querySelectorAll("canvas").forEach(S=>{ze(S,i,o,!0)||T.push(S)}),T},"getCanvas"),b=a(T=>{if(p&&T-p<f){g=requestAnimationFrame(b);return}p=T,v().forEach(S=>dt(this,void 0,void 0,function*(){var C;let x=this.mirror.getId(S);if(d.get(x)||S.width===0||S.height===0)return;if(d.set(x,!0),["webgl","webgl2"].includes(S.__context)){let R=S.getContext(S.__context);((C=R?.getContextAttributes())===null||C===void 0?void 0:C.preserveDrawingBuffer)===!1&&R.clear(R.COLOR_BUFFER_BIT)}let _=yield createImageBitmap(S);h.postMessage({id:x,bitmap:_,width:S.width,height:S.height,dataURLOptions:l.dataURLOptions},[_])})),g=requestAnimationFrame(b)},"takeCanvasSnapshots");g=requestAnimationFrame(b),this.resetObservers=()=>{c(),cancelAnimationFrame(g)}}initCanvasMutationObserver(e,t,i){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let o=Bl(e,t,i,!1),l=zh(this.processMutation.bind(this),e,t,i),c=Xh(this.processMutation.bind(this),e,t,i,this.mirror);this.resetObservers=()=>{o(),l(),c()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=a(t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)},"setLatestRAFTimestamp");requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{let i=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,i)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;let i=this.pendingCanvasMutations.get(e);if(!i||t===-1)return;let o=i.map(c=>Vh(c,["type"])),{type:l}=i[0];this.mutationCb({id:t,type:l,commands:o}),this.pendingCanvasMutations.delete(e)}};var ao=class{static{a(this,"StylesheetManager")}constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Lr,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(e.length===0)return;let i={id:t,styleIds:[]},o=[];for(let l of e){let c;this.styleMirror.has(l)?c=this.styleMirror.getId(l):(c=this.styleMirror.add(l),o.push({styleId:c,rules:Array.from(l.rules||CSSRule,(d,h)=>({rule:bl(d),index:h}))})),i.styleIds.push(c)}o.length>0&&(i.styles=o),this.adoptedStyleSheetCb(i)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}};var lo=class{static{a(this,"ProcessedNodeManager")}constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,t){let i=this.nodeMap.get(e);return i&&Array.from(i).some(o=>o!==t)}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}};var Wl,We,co,Vl,uo=!1;try{if(Array.from([1],n=>n*2)[0]!==2){let n=document.createElement("iframe");document.body.appendChild(n),Array.from=((Wl=n.contentWindow)===null||Wl===void 0?void 0:Wl.Array.from)||Array.from,document.body.removeChild(n)}}catch(n){console.debug("Unable to override Array.from",n)}var Ut=$s();function Zt(n={}){let{emit:e,checkoutEveryNms:t,checkoutEveryNth:i,blockClass:o="rr-block",blockSelector:l=null,ignoreClass:c="rr-ignore",ignoreSelector:d=null,maskTextClass:h="rr-mask",maskTextSelector:f=null,inlineStylesheet:p=!0,maskAllInputs:g,maskInputOptions:v,slimDOMOptions:b,maskInputFn:T,maskTextFn:S,hooks:C,packFn:x,sampling:_={},dataURLOptions:R={},mousemoveWait:O,recordDOM:U=!0,recordCanvas:Y=!1,recordCrossOriginIframes:le=!1,recordAfter:Q=n.recordAfter==="DOMContentLoaded"?n.recordAfter:"load",userTriggeredOnInput:se=!1,collectFonts:fe=!1,inlineImages:V=!1,plugins:B,keepIframeSrcFn:X=a(()=>!1,"keepIframeSrcFn"),ignoreCSSAttributes:K=new Set([]),errorHandler:z}=n;Ph(z);let J=le?window.parent===window:!0,ye=!1;if(!J)try{window.parent.document&&(ye=!1)}catch{ye=!0}if(J&&!e)throw new Error("emit function is required");O!==void 0&&_.mousemove===void 0&&(_.mousemove=O),Ut.reset();let nt=g===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:v!==void 0?v:{password:!0},$e=b===!0||b==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:b==="all",headMetaDescKeywords:b==="all"}:b||{};Ks();let W,P=0,te=a(Te=>{for(let Pe of B||[])Pe.eventProcessor&&(Te=Pe.eventProcessor(Te));return x&&!ye&&(Te=x(Te)),Te},"eventProcessor");We=a((Te,Pe)=>{var Ce;let ke=Te;if(ke.timestamp=Or(),!((Ce=An[0])===null||Ce===void 0)&&Ce.isFrozen()&&ke.type!==G.FullSnapshot&&!(ke.type===G.IncrementalSnapshot&&ke.data.source===$.Mutation)&&An.forEach(Ue=>Ue.unfreeze()),J)e?.(te(ke),Pe);else if(ye){let Ue={type:"rrweb",event:te(ke),origin:window.location.origin,isCheckout:Pe};window.parent.postMessage(Ue,"*")}if(ke.type===G.FullSnapshot)W=ke,P=0;else if(ke.type===G.IncrementalSnapshot){if(ke.data.source===$.Mutation&&ke.data.isAttachIframe)return;P++;let Ue=i&&P>=i,xe=t&&ke.timestamp-W.timestamp>t;(Ue||xe)&&co(!0)}},"wrappedEmit");let ee=a(Te=>{We({type:G.IncrementalSnapshot,data:Object.assign({source:$.Mutation},Te)})},"wrappedMutationEmit"),Oe=a(Te=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.Scroll},Te)}),"wrappedScrollEmit"),ht=a(Te=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.CanvasMutation},Te)}),"wrappedCanvasMutationEmit"),Qe=a(Te=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.AdoptedStyleSheet},Te)}),"wrappedAdoptedStyleSheetEmit"),ot=new ao({mutationCb:ee,adoptedStyleSheetCb:Qe}),en=new no({mirror:Ut,mutationCb:ee,stylesheetManager:ot,recordCrossOriginIframes:le,wrappedEmit:We});for(let Te of B||[])Te.getMirror&&Te.getMirror({nodeMirror:Ut,crossOriginIframeMirror:en.crossOriginIframeMirror,crossOriginIframeStyleMirror:en.crossOriginIframeStyleMirror});let fn=new lo;Vl=new oo({recordCanvas:Y,mutationCb:ht,win:window,blockClass:o,blockSelector:l,mirror:Ut,sampling:_.canvas,dataURLOptions:R});let tn=new ro({mutationCb:ee,scrollCb:Oe,bypassOptions:{blockClass:o,blockSelector:l,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskInputOptions:nt,dataURLOptions:R,maskTextFn:S,maskInputFn:T,recordCanvas:Y,inlineImages:V,sampling:_,slimDOMOptions:$e,iframeManager:en,stylesheetManager:ot,canvasManager:Vl,keepIframeSrcFn:X,processedNodeManager:fn},mirror:Ut});co=a((Te=!1)=>{if(!U)return;We({type:G.Meta,data:{href:window.location.href,width:zs(),height:qs()}},Te),ot.reset(),tn.init(),An.forEach(Ce=>Ce.lock());let Pe=Th(document,{mirror:Ut,blockClass:o,blockSelector:l,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskAllInputs:nt,maskTextFn:S,slimDOM:$e,dataURLOptions:R,recordCanvas:Y,inlineImages:V,onSerialize:a(Ce=>{Cn(Ce,Ut)&&en.addIframe(Ce),Ys(Ce,Ut)&&ot.trackLinkElement(Ce),Yt(Ce)&&tn.addShadowRoot(Ce.shadowRoot,document)},"onSerialize"),onIframeLoad:a((Ce,ke)=>{en.attachIframe(Ce,ke),tn.observeAttachShadow(Ce)},"onIframeLoad"),onStylesheetLoad:a((Ce,ke)=>{ot.attachLinkElement(Ce,ke)},"onStylesheetLoad"),keepIframeSrcFn:X});if(!Pe)return console.warn("Failed to snapshot the document");We({type:G.FullSnapshot,data:{node:Pe,initialOffset:Gs(window)}},Te),An.forEach(Ce=>Ce.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&ot.adoptStyleSheets(document.adoptedStyleSheets,Ut.getId(document))},"takeFullSnapshot");try{let Te=[],Pe=a(ke=>{var Ue;return Ee(Wh)({mutationCb:ee,mousemoveCb:a((xe,qr)=>We({type:G.IncrementalSnapshot,data:{source:qr,positions:xe}}),"mousemoveCb"),mouseInteractionCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.MouseInteraction},xe)}),"mouseInteractionCb"),scrollCb:Oe,viewportResizeCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.ViewportResize},xe)}),"viewportResizeCb"),inputCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.Input},xe)}),"inputCb"),mediaInteractionCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.MediaInteraction},xe)}),"mediaInteractionCb"),styleSheetRuleCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.StyleSheetRule},xe)}),"styleSheetRuleCb"),styleDeclarationCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.StyleDeclaration},xe)}),"styleDeclarationCb"),canvasMutationCb:ht,fontCb:a(xe=>We({type:G.IncrementalSnapshot,data:Object.assign({source:$.Font},xe)}),"fontCb"),selectionCb:a(xe=>{We({type:G.IncrementalSnapshot,data:Object.assign({source:$.Selection},xe)})},"selectionCb"),customElementCb:a(xe=>{We({type:G.IncrementalSnapshot,data:Object.assign({source:$.CustomElement},xe)})},"customElementCb"),blockClass:o,ignoreClass:c,ignoreSelector:d,maskTextClass:h,maskTextSelector:f,maskInputOptions:nt,inlineStylesheet:p,sampling:_,recordDOM:U,recordCanvas:Y,inlineImages:V,userTriggeredOnInput:se,collectFonts:fe,doc:ke,maskInputFn:T,maskTextFn:S,keepIframeSrcFn:X,blockSelector:l,slimDOMOptions:$e,dataURLOptions:R,mirror:Ut,iframeManager:en,stylesheetManager:ot,shadowDomManager:tn,processedNodeManager:fn,canvasManager:Vl,ignoreCSSAttributes:K,plugins:((Ue=B?.filter(xe=>xe.observer))===null||Ue===void 0?void 0:Ue.map(xe=>({observer:xe.observer,options:xe.options,callback:a(qr=>We({type:G.Plugin,data:{plugin:xe.name,payload:qr}}),"callback")})))||[]},C)},"observe");en.addLoadListener(ke=>{try{Te.push(Pe(ke.contentDocument))}catch(Ue){console.warn(Ue)}});let Ce=a(()=>{co(),Te.push(Pe(document)),uo=!0},"init");return document.readyState==="interactive"||document.readyState==="complete"?Ce():(Te.push(tt("DOMContentLoaded",()=>{We({type:G.DomContentLoaded,data:{}}),Q==="DOMContentLoaded"&&Ce()})),Te.push(tt("load",()=>{We({type:G.Load,data:{}}),Q==="load"&&Ce()},window))),()=>{Te.forEach(ke=>ke()),fn.destroy(),uo=!1,Hh()}}catch(Te){console.warn(Te)}}a(Zt,"record");Zt.addCustomEvent=(n,e)=>{if(!uo)throw new Error("please add custom event after start recording");We({type:G.Custom,data:{tag:n,payload:e}})};Zt.freezePage=()=>{An.forEach(n=>n.freeze())};Zt.takeFullSnapshot=n=>{if(!uo)throw new Error("please take full snapshot after start recording");co(n)};Zt.mirror=Ut;var Se;(function(n){n[n.Document=0]="Document",n[n.DocumentType=1]="DocumentType",n[n.Element=2]="Element",n[n.Text=3]="Text",n[n.CDATA=4]="CDATA",n[n.Comment=5]="Comment"})(Se||(Se={}));var $l=class{static{a(this,"Mirror$1")}constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;let i=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return i??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let i=t.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,t)}replace(e,t){let i=this.getNode(e);if(i){let o=this.nodeMetaMap.get(i);o&&this.nodeMetaMap.set(t,o)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function jw(){return new $l}a(jw,"createMirror$1");function Xw(n){let e={},t=/;(?![^(]*\))/g,i=/:(.+)/,o=/\/\*.*?\*\//g;return n.replace(o,"").split(t).forEach(function(l){if(l){let c=l.split(i);c.length>1&&(e[Ul(c[0].trim())]=c[1].trim())}}),e}a(Xw,"parseCSSText");function Zh(n){let e=[];for(let t in n){let i=n[t];if(typeof i!="string")continue;let o=Zw(t);e.push(`${o}: ${i};`)}return e.join(" ")}a(Zh,"toCSSText");var Kw=/-([a-z])/g,Yw=/^--[a-zA-Z0-9-]+$/,Ul=a(n=>Yw.test(n)?n:n.replace(Kw,(e,t)=>t?t.toUpperCase():""),"camelize"),Qw=/\B([A-Z])/g,Zw=a(n=>n.replace(Qw,"-$1").toLowerCase(),"hyphenate"),It=class n{static{a(this,"BaseRRNode")}constructor(...e){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=Ve.ELEMENT_NODE,this.TEXT_NODE=Ve.TEXT_NODE}get childNodes(){let e=[],t=this.firstChild;for(;t;)e.push(t),t=t.nextSibling;return e}contains(e){if(e instanceof n){if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0}else return!1;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};function Jw(n){return class Jh extends n{static{a(this,"BaseRRDocument")}constructor(...t){super(t),this.nodeType=Ve.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=Se.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(t=>t.RRNodeType===Se.Element&&t.tagName==="HTML")||null}get body(){var t;return((t=this.documentElement)===null||t===void 0?void 0:t.childNodes.find(i=>i.RRNodeType===Se.Element&&i.tagName==="BODY"))||null}get head(){var t;return((t=this.documentElement)===null||t===void 0?void 0:t.childNodes.find(i=>i.RRNodeType===Se.Element&&i.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(t){let i=t.RRNodeType;if((i===Se.Element||i===Se.DocumentType)&&this.childNodes.some(l=>l.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${i===Se.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let o=Ql(this,t);return o.parentElement=null,o}insertBefore(t,i){let o=t.RRNodeType;if((o===Se.Element||o===Se.DocumentType)&&this.childNodes.some(c=>c.RRNodeType===o))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${o===Se.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let l=of(this,t,i);return l.parentElement=null,l}removeChild(t){return af(this,t)}open(){this.firstChild=null,this.lastChild=null}close(){}write(t){let i;if(t==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?i="-//W3C//DTD XHTML 1.0 Transitional//EN":t==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(i="-//W3C//DTD HTML 4.0 Transitional//EN"),i){let o=this.createDocumentType("html",i,"");this.open(),this.appendChild(o)}}createDocument(t,i,o){return new Jh}createDocumentType(t,i,o){let l=new(ef(It))(t,i,o);return l.ownerDocument=this,l}createElement(t){let i=new(tf(It))(t);return i.ownerDocument=this,i}createElementNS(t,i){return this.createElement(i)}createTextNode(t){let i=new(nf(It))(t);return i.ownerDocument=this,i}createComment(t){let i=new(rf(It))(t);return i.ownerDocument=this,i}createCDATASection(t){let i=new(sf(It))(t);return i.ownerDocument=this,i}toString(){return"RRDocument"}}}a(Jw,"BaseRRDocumentImpl");function ef(n){return class extends n{static{a(this,"BaseRRDocumentType")}constructor(t,i,o){super(),this.nodeType=Ve.DOCUMENT_TYPE_NODE,this.RRNodeType=Se.DocumentType,this.name=t,this.publicId=i,this.systemId=o,this.nodeName=t,this.textContent=null}toString(){return"RRDocumentType"}}}a(ef,"BaseRRDocumentTypeImpl");function tf(n){return class extends n{static{a(this,"BaseRRElement")}constructor(t){super(),this.nodeType=Ve.ELEMENT_NODE,this.RRNodeType=Se.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(i=>t+=i.textContent),t}set textContent(t){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(t))}get classList(){return new Gl(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let t=this.attributes.style?Xw(this.attributes.style):{},i=/\B([A-Z])/g;return t.setProperty=(o,l,c)=>{if(i.test(o))return;let d=Ul(o);l?t[d]=l:delete t[d],c==="important"&&(t[d]+=" !important"),this.attributes.style=Zh(t)},t.removeProperty=o=>{if(i.test(o))return"";let l=Ul(o),c=t[l]||"";return delete t[l],this.attributes.style=Zh(t),c},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,i){this.attributes[t]=i}setAttributeNS(t,i,o){this.setAttribute(i,o)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return Ql(this,t)}insertBefore(t,i){return of(this,t,i)}removeChild(t){return af(this,t)}attachShadow(t){let i=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=i,i}dispatchEvent(t){return!0}toString(){let t="";for(let i in this.attributes)t+=`${i}="${this.attributes[i]}" `;return`${this.tagName} ${t}`}}}a(tf,"BaseRRElementImpl");function eT(n){return class extends n{static{a(this,"BaseRRMediaElement")}attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}a(eT,"BaseRRMediaElementImpl");function nf(n){return class extends n{static{a(this,"BaseRRText")}constructor(t){super(),this.nodeType=Ve.TEXT_NODE,this.nodeName="#text",this.RRNodeType=Se.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}a(nf,"BaseRRTextImpl");function rf(n){return class extends n{static{a(this,"BaseRRComment")}constructor(t){super(),this.nodeType=Ve.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=Se.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}a(rf,"BaseRRCommentImpl");function sf(n){return class extends n{static{a(this,"BaseRRCDATASection")}constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=Ve.CDATA_SECTION_NODE,this.RRNodeType=Se.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}a(sf,"BaseRRCDATASectionImpl");var Gl=class{static{a(this,"ClassList")}constructor(e,t){if(this.classes=[],this.add=(...i)=>{for(let o of i){let l=String(o);this.classes.indexOf(l)>=0||this.classes.push(l)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...i)=>{this.classes=this.classes.filter(o=>i.indexOf(o)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){let i=e.trim().split(/\s+/);this.classes.push(...i)}this.onChange=t}};function Ql(n,e){return e.parentNode&&e.parentNode.removeChild(e),n.lastChild?(n.lastChild.nextSibling=e,e.previousSibling=n.lastChild):(n.firstChild=e,e.previousSibling=null),n.lastChild=e,e.nextSibling=null,e.parentNode=n,e.parentElement=n,e.ownerDocument=n.ownerDocument,e}a(Ql,"appendChild");function of(n,e,t){if(!t)return Ql(n,e);if(t.parentNode!==n)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return e===t||(e.parentNode&&e.parentNode.removeChild(e),e.previousSibling=t.previousSibling,t.previousSibling=e,e.nextSibling=t,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,e.parentElement=n,e.parentNode=n,e.ownerDocument=n.ownerDocument),e}a(of,"insertBefore");function af(n,e){if(e.parentNode!==n)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:n.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:n.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e.parentElement=null,e.parentNode=null,e}a(af,"removeChild");var Ve;(function(n){n[n.PLACEHOLDER=0]="PLACEHOLDER",n[n.ELEMENT_NODE=1]="ELEMENT_NODE",n[n.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",n[n.TEXT_NODE=3]="TEXT_NODE",n[n.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",n[n.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",n[n.ENTITY_NODE=6]="ENTITY_NODE",n[n.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",n[n.COMMENT_NODE=8]="COMMENT_NODE",n[n.DOCUMENT_NODE=9]="DOCUMENT_NODE",n[n.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",n[n.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(Ve||(Ve={}));var ql={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},tT={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},xt=null;function Ai(n,e,t,i=e.mirror||e.ownerDocument.mirror){n=nT(n,e,t,i),lf(n,e,t,i),rT(n,e,t)}a(Ai,"diff");function nT(n,e,t,i){var o;if(t.afterAppend&&!xt&&(xt=new WeakSet,setTimeout(()=>{xt=null},0)),!Zl(n,e)){let l=Ri(e,t.mirror,i);(o=n.parentNode)===null||o===void 0||o.replaceChild(l,n),n=l}switch(e.RRNodeType){case Se.Document:{if(!Pr(n,e,t.mirror,i)){let l=i.getMeta(e);l&&(t.mirror.removeNodeFromMap(n),n.close(),n.open(),t.mirror.add(n,l),xt?.add(n))}break}case Se.Element:{let l=n,c=e;switch(c.tagName){case"IFRAME":{let d=n.contentDocument;if(!d)break;Ai(d,e.contentDocument,t,i);break}}c.shadowRoot&&(l.shadowRoot||l.attachShadow({mode:"open"}),lf(l.shadowRoot,c.shadowRoot,t,i)),iT(l,c,i);break}}return n}a(nT,"diffBeforeUpdatingChildren");function rT(n,e,t){var i;switch(e.RRNodeType){case Se.Document:{let o=e.scrollData;o&&t.applyScroll(o,!0);break}case Se.Element:{let o=n,l=e;switch(l.scrollData&&t.applyScroll(l.scrollData,!0),l.inputData&&t.applyInput(l.inputData),l.tagName){case"AUDIO":case"VIDEO":{let c=n,d=l;d.paused!==void 0&&(d.paused?c.pause():c.play()),d.muted!==void 0&&(c.muted=d.muted),d.volume!==void 0&&(c.volume=d.volume),d.currentTime!==void 0&&(c.currentTime=d.currentTime),d.playbackRate!==void 0&&(c.playbackRate=d.playbackRate),d.loop!==void 0&&(c.loop=d.loop);break}case"CANVAS":{let c=e;if(c.rr_dataURL!==null){let d=document.createElement("img");d.onload=()=>{let h=o.getContext("2d");h&&h.drawImage(d,0,0,d.width,d.height)},d.src=c.rr_dataURL}c.canvasMutations.forEach(d=>t.applyCanvas(d.event,d.mutation,n));break}case"STYLE":{let c=o.sheet;c&&e.rules.forEach(d=>t.applyStyleSheetMutation(d,c));break}}break}case Se.Text:case Se.Comment:case Se.CDATA:{n.textContent!==e.data&&(n.textContent=e.data);break}}xt?.has(n)&&(xt.delete(n),(i=t.afterAppend)===null||i===void 0||i.call(t,n,t.mirror.getId(n)))}a(rT,"diffAfterUpdatingChildren");function iT(n,e,t){let i=n.attributes,o=e.attributes;for(let l in o){let c=o[l],d=t.getMeta(e);if(d?.isSVG&&ql[l])n.setAttributeNS(ql[l],l,c);else if(e.tagName==="CANVAS"&&l==="rr_dataURL"){let h=document.createElement("img");h.src=c,h.onload=()=>{let f=n.getContext("2d");f&&f.drawImage(h,0,0,h.width,h.height)}}else{if(e.tagName==="IFRAME"&&l==="srcdoc")continue;n.setAttribute(l,c)}}for(let{name:l}of Array.from(i))l in o||n.removeAttribute(l);e.scrollLeft&&(n.scrollLeft=e.scrollLeft),e.scrollTop&&(n.scrollTop=e.scrollTop)}a(iT,"diffProps");function lf(n,e,t,i){let o=Array.from(n.childNodes),l=e.childNodes;if(o.length===0&&l.length===0)return;let c=0,d=o.length-1,h=0,f=l.length-1,p=o[c],g=o[d],v=l[h],b=l[f],T,S;for(;c<=d&&h<=f;)if(p===void 0)p=o[++c];else if(g===void 0)g=o[--d];else if(Pr(p,v,t.mirror,i))p=o[++c],v=l[++h];else if(Pr(g,b,t.mirror,i))g=o[--d],b=l[--f];else if(Pr(p,b,t.mirror,i)){try{n.insertBefore(p,g.nextSibling)}catch(_){console.warn(_)}p=o[++c],b=l[--f]}else if(Pr(g,v,t.mirror,i)){try{n.insertBefore(g,p)}catch(_){console.warn(_)}g=o[--d],v=l[++h]}else{if(!T){T={};for(let R=c;R<=d;R++){let O=o[R];O&&t.mirror.hasNode(O)&&(T[t.mirror.getId(O)]=R)}}S=T[i.getId(v)];let _=o[S];if(S!==void 0&&_&&Pr(_,v,t.mirror,i)){try{n.insertBefore(_,p)}catch(R){console.warn(R)}o[S]=void 0}else{let R=Ri(v,t.mirror,i);n.nodeName==="#document"&&p&&(R.nodeType===R.DOCUMENT_TYPE_NODE&&p.nodeType===p.DOCUMENT_TYPE_NODE||R.nodeType===R.ELEMENT_NODE&&p.nodeType===p.ELEMENT_NODE)&&(n.removeChild(p),t.mirror.removeNodeFromMap(p),p=o[++c]);try{n.insertBefore(R,p||null)}catch(O){console.warn(O)}}v=l[++h]}if(c>d){let _=l[f+1],R=null;for(_&&(R=t.mirror.getNode(i.getId(_)));h<=f;++h){let O=Ri(l[h],t.mirror,i);try{n.insertBefore(O,R)}catch(U){console.warn(U)}}}else if(h>f)for(;c<=d;c++){let _=o[c];if(!(!_||_.parentNode!==n))try{n.removeChild(_),t.mirror.removeNodeFromMap(_)}catch(R){console.warn(R)}}let C=n.firstChild,x=e.firstChild;for(;C!==null&&x!==null;)Ai(C,x,t,i),C=C.nextSibling,x=x.nextSibling}a(lf,"diffChildren");function Ri(n,e,t){let i=t.getId(n),o=t.getMeta(n),l=null;if(i>-1&&(l=e.getNode(i)),l!==null&&Zl(l,n))return l;switch(n.RRNodeType){case Se.Document:l=new Document;break;case Se.DocumentType:l=document.implementation.createDocumentType(n.name,n.publicId,n.systemId);break;case Se.Element:{let c=n.tagName.toLowerCase();c=tT[c]||c,o&&"isSVG"in o&&o?.isSVG?l=document.createElementNS(ql.svg,c):l=document.createElement(n.tagName);break}case Se.Text:l=document.createTextNode(n.data);break;case Se.Comment:l=document.createComment(n.data);break;case Se.CDATA:l=document.createCDATASection(n.data);break}o&&e.add(l,Object.assign({},o));try{xt?.add(l)}catch{}return l}a(Ri,"createOrGetNode");function Zl(n,e){return n.nodeType!==e.nodeType?!1:n.nodeType!==n.ELEMENT_NODE||n.tagName.toUpperCase()===e.tagName}a(Zl,"sameNodeType");function Pr(n,e,t,i){let o=t.getId(n),l=i.getId(e);return o===-1||o!==l?!1:Zl(n,e)}a(Pr,"nodeMatching");var Jn=class n extends Jw(It){static{a(this,"RRDocument")}get unserializedId(){return this._unserializedId--}constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=uT(),this.scrollData=null,e&&(this.mirror=e)}createDocument(e,t,i){return new n}createDocumentType(e,t,i){let o=new sT(e,t,i);return o.ownerDocument=this,o}createElement(e){let t=e.toUpperCase(),i;switch(t){case"AUDIO":case"VIDEO":i=new zl(t);break;case"IFRAME":i=new Kl(t,this.mirror);break;case"CANVAS":i=new jl(t);break;case"STYLE":i=new Xl(t);break;default:i=new er(t);break}return i.ownerDocument=this,i}createComment(e){let t=new aT(e);return t.ownerDocument=this,t}createCDATASection(e){let t=new lT(e);return t.ownerDocument=this,t}createTextNode(e){let t=new oT(e);return t.ownerDocument=this,t}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}},sT=ef(It),er=class extends tf(It){static{a(this,"RRElement")}constructor(){super(...arguments),this.inputData=null,this.scrollData=null}},zl=class extends eT(er){static{a(this,"RRMediaElement")}},jl=class extends er{static{a(this,"RRCanvasElement")}constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}},Xl=class extends er{static{a(this,"RRStyleElement")}constructor(){super(...arguments),this.rules=[]}},Kl=class extends er{static{a(this,"RRIFrameElement")}constructor(e,t){super(e),this.contentDocument=new Jn,this.contentDocument.mirror=t}},oT=nf(It),aT=rf(It),lT=sf(It);function cT(n){return n instanceof HTMLFormElement?"FORM":n.tagName.toUpperCase()}a(cT,"getValidTagName");function Jl(n,e,t,i){let o;switch(n.nodeType){case Ve.DOCUMENT_NODE:i&&i.nodeName==="IFRAME"?o=i.contentDocument:(o=e,o.compatMode=n.compatMode);break;case Ve.DOCUMENT_TYPE_NODE:{let c=n;o=e.createDocumentType(c.name,c.publicId,c.systemId);break}case Ve.ELEMENT_NODE:{let c=n,d=cT(c);o=e.createElement(d);let h=o;for(let{name:f,value:p}of Array.from(c.attributes))h.attributes[f]=p;c.scrollLeft&&(h.scrollLeft=c.scrollLeft),c.scrollTop&&(h.scrollTop=c.scrollTop);break}case Ve.TEXT_NODE:o=e.createTextNode(n.textContent||"");break;case Ve.CDATA_SECTION_NODE:o=e.createCDATASection(n.data);break;case Ve.COMMENT_NODE:o=e.createComment(n.textContent||"");break;case Ve.DOCUMENT_FRAGMENT_NODE:o=i.attachShadow({mode:"open"});break;default:return null}let l=t.getMeta(n);return e instanceof Jn&&(l||(l=ec(o,e.unserializedId),t.add(n,l)),e.mirror.add(o,Object.assign({},l))),o}a(Jl,"buildFromNode");function cf(n,e=jw(),t=new Jn){function i(o,l){let c=Jl(o,t,e,l);if(c!==null)if(l?.nodeName!=="IFRAME"&&o.nodeType!==Ve.DOCUMENT_FRAGMENT_NODE&&(l?.appendChild(c),c.parentNode=l,c.parentElement=l),o.nodeName==="IFRAME"){let d=o.contentDocument;d&&i(d,c)}else(o.nodeType===Ve.DOCUMENT_NODE||o.nodeType===Ve.ELEMENT_NODE||o.nodeType===Ve.DOCUMENT_FRAGMENT_NODE)&&(o.nodeType===Ve.ELEMENT_NODE&&o.shadowRoot&&i(o.shadowRoot,c),o.childNodes.forEach(d=>i(d,c)))}return a(i,"walk"),i(n,null),t}a(cf,"buildFromDom");function uT(){return new Yl}a(uT,"createMirror");var Yl=class{static{a(this,"Mirror")}constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return-1;let i=(t=this.getMeta(e))===null||t===void 0?void 0:t.id;return i??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let i=t.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,t)}replace(e,t){let i=this.getNode(e);if(i){let o=this.nodeMetaMap.get(i);o&&this.nodeMetaMap.set(t,o)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function ec(n,e){switch(n.RRNodeType){case Se.Document:return{id:e,type:n.RRNodeType,childNodes:[]};case Se.DocumentType:{let t=n;return{id:e,type:n.RRNodeType,name:t.name,publicId:t.publicId,systemId:t.systemId}}case Se.Element:return{id:e,type:n.RRNodeType,tagName:n.tagName.toLowerCase(),attributes:{},childNodes:[]};case Se.Text:return{id:e,type:n.RRNodeType,textContent:n.textContent||""};case Se.Comment:return{id:e,type:n.RRNodeType,textContent:n.textContent||""};case Se.CDATA:return{id:e,type:n.RRNodeType,textContent:""}}}a(ec,"getDefaultSN");var uf=new Map;function tc(n,e){let t=uf.get(n);return t||(t=new Map,uf.set(n,t)),t.has(e)||t.set(e,[]),t.get(e)}a(tc,"variableListFor");function Gt(n,e,t){return i=>dt(this,void 0,void 0,function*(){if(i&&typeof i=="object"&&"rr_type"in i)if(t&&(t.isUnchanged=!1),i.rr_type==="ImageBitmap"&&"args"in i){let o=yield Gt(n,e,t)(i.args);return yield createImageBitmap.apply(null,o)}else if("index"in i){if(t||e===null)return i;let{rr_type:o,index:l}=i;return tc(e,o)[l]}else if("args"in i){let{rr_type:o,args:l}=i,c=window[o];return new c(...yield Promise.all(l.map(Gt(n,e,t))))}else{if("base64"in i)return Uh(i.base64);if("src"in i){let o=n.get(i.src);if(o)return o;{let l=new Image;return l.src=i.src,n.set(i.src,l),l}}else if("data"in i&&i.rr_type==="Blob"){let o=yield Promise.all(i.data.map(Gt(n,e,t)));return new Blob(o,{type:i.type})}}else if(Array.isArray(i))return yield Promise.all(i.map(Gt(n,e,t)));return i})}a(Gt,"deserializeArg");function dT(n,e){try{return e===vt.WebGL?n.getContext("webgl")||n.getContext("experimental-webgl"):n.getContext("webgl2")}catch{return null}}a(dT,"getContext");var hT=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function fT(n,e){if(!e?.constructor)return;let{name:t}=e.constructor;if(!hT.includes(t))return;let i=tc(n,t);i.includes(e)||i.push(e)}a(fT,"saveToWebGLVarMap");function df({mutation:n,target:e,type:t,imageMap:i,errorHandler:o}){return dt(this,void 0,void 0,function*(){try{let l=dT(e,t);if(!l)return;if(n.setter){l[n.property]=n.args[0];return}let c=l[n.property],d=yield Promise.all(n.args.map(Gt(i,l))),h=c.apply(l,d);fT(l,h);let f=!1}catch(l){o(n,l)}})}a(df,"webglMutation");function hf({event:n,mutations:e,target:t,imageMap:i,errorHandler:o}){return dt(this,void 0,void 0,function*(){let l=t.getContext("2d");if(!l){o(e[0],new Error("Canvas context is null"));return}let c=e.map(h=>dt(this,void 0,void 0,function*(){return Promise.all(h.args.map(Gt(i,l)))}));(yield Promise.all(c)).forEach((h,f)=>{let p=e[f];try{if(p.setter){l[p.property]=p.args[0];return}let g=l[p.property];p.property==="drawImage"&&typeof p.args[0]=="string"?(i.get(n),g.apply(l,p.args)):g.apply(l,h)}catch(g){o(p,g)}})})}a(hf,"canvasMutation");function nc({event:n,mutation:e,target:t,imageMap:i,canvasEventMap:o,errorHandler:l}){return dt(this,void 0,void 0,function*(){try{let c=o.get(n)||e,d="commands"in c?c.commands:[c];if([vt.WebGL,vt.WebGL2].includes(e.type)){for(let h=0;h<d.length;h++){let f=d[h];yield df({mutation:f,type:e.type,target:t,imageMap:i,errorHandler:l})}return}yield hf({event:n,mutations:d,target:t,imageMap:i,errorHandler:l})}catch(c){l(e,c)}})}a(nc,"canvasMutation");var ic={};Nb(ic,{default:()=>rc});function rc(n){return{all:n=n||new Map,on:a(function(e,t){var i=n.get(e);i?i.push(t):n.set(e,[t])},"on"),off:a(function(e,t){var i=n.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):n.set(e,[]))},"off"),emit:a(function(e,t){var i=n.get(e);i&&i.slice().map(function(o){o(t)}),(i=n.get("*"))&&i.slice().map(function(o){o(e,t)})},"emit")}}a(rc,"mitt");function ff(n=window,e=document){if("scrollBehavior"in e.documentElement.style&&n.__forceSmoothScrollPolyfill__!==!0)return;let t=n.HTMLElement||n.Element,i=468,o={scroll:n.scroll||n.scrollTo,scrollBy:n.scrollBy,elementScroll:t.prototype.scroll||h,scrollIntoView:t.prototype.scrollIntoView},l=n.performance&&n.performance.now?n.performance.now.bind(n.performance):Date.now;function c(x){let _=["MSIE ","Trident/","Edge/"];return new RegExp(_.join("|")).test(x)}a(c,"isMicrosoftBrowser");let d=c(n.navigator.userAgent)?1:0;function h(x,_){this.scrollLeft=x,this.scrollTop=_}a(h,"scrollElement");function f(x){return .5*(1-Math.cos(Math.PI*x))}a(f,"ease");function p(x){if(x===null||typeof x!="object"||x.behavior===void 0||x.behavior==="auto"||x.behavior==="instant")return!0;if(typeof x=="object"&&x.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+x.behavior+" is not a valid value for enumeration ScrollBehavior.")}a(p,"shouldBailOut");function g(x,_){if(_==="Y")return x.clientHeight+d<x.scrollHeight;if(_==="X")return x.clientWidth+d<x.scrollWidth}a(g,"hasScrollableSpace");function v(x,_){let R=n.getComputedStyle(x,null)["overflow"+_];return R==="auto"||R==="scroll"}a(v,"canOverflow");function b(x){let _=g(x,"Y")&&v(x,"Y"),R=g(x,"X")&&v(x,"X");return _||R}a(b,"isScrollable");function T(x){for(;x!==e.body&&b(x)===!1;)x=x.parentNode||x.host;return x}a(T,"findScrollableParent");function S(x){let _=l(),R,O,U,Y=(_-x.startTime)/i;Y=Y>1?1:Y,R=f(Y),O=x.startX+(x.x-x.startX)*R,U=x.startY+(x.y-x.startY)*R,x.method.call(x.scrollable,O,U),(O!==x.x||U!==x.y)&&n.requestAnimationFrame(S.bind(n,x))}a(S,"step");function C(x,_,R){let O,U,Y,le,Q=l();x===e.body?(O=n,U=n.scrollX||n.pageXOffset,Y=n.scrollY||n.pageYOffset,le=o.scroll):(O=x,U=x.scrollLeft,Y=x.scrollTop,le=h),S({scrollable:O,method:le,startTime:Q,startX:U,startY:Y,x:_,y:R})}a(C,"smoothScroll"),n.scroll=n.scrollTo=function(){if(arguments[0]!==void 0){if(p(arguments[0])===!0){o.scroll.call(n,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:n.scrollX||n.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:n.scrollY||n.pageYOffset);return}C.call(n,e.body,arguments[0].left!==void 0?~~arguments[0].left:n.scrollX||n.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:n.scrollY||n.pageYOffset)}},n.scrollBy=function(){if(arguments[0]!==void 0){if(p(arguments[0])){o.scrollBy.call(n,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}C.call(n,e.body,~~arguments[0].left+(n.scrollX||n.pageXOffset),~~arguments[0].top+(n.scrollY||n.pageYOffset))}},t.prototype.scroll=t.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(p(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}let x=arguments[0].left,_=arguments[0].top;C.call(this,this,typeof x>"u"?this.scrollLeft:~~x,typeof _>"u"?this.scrollTop:~~_)},t.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(p(arguments[0])===!0){o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},t.prototype.scrollIntoView=function(){if(p(arguments[0])===!0){o.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}let x=T(this),_=x.getBoundingClientRect(),R=this.getBoundingClientRect();x!==e.body?(C.call(this,x,x.scrollLeft+R.left-_.left,x.scrollTop+R.top-_.top),n.getComputedStyle(x).position!=="fixed"&&n.scrollBy({left:_.left,top:_.top,behavior:"smooth"})):n.scrollBy({left:R.left,top:R.top,behavior:"smooth"})}}a(ff,"polyfill");var ho=class{static{a(this,"Timer")}constructor(e=[],t){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t.speed}addAction(e){let t=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{let i=this.findActionIndex(e);this.actions.splice(i,0,e)}t&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){let e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){let t=this.actions[0];if(this.timeOffset>=t.delay)this.actions.shift(),t.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return this.raf!==null}findActionIndex(e){let t=0,i=this.actions.length-1;for(;t<=i;){let o=Math.floor((t+i)/2);if(this.actions[o].delay<e.delay)t=o+1;else if(this.actions[o].delay>e.delay)i=o-1;else return o+1}return t}};function sc(n,e){if(n.type===G.IncrementalSnapshot&&n.data.source===$.MouseMove&&n.data.positions&&n.data.positions.length){let t=n.data.positions[0].timeOffset,i=n.timestamp+t;return n.delay=i-e,i-e}return n.delay=n.timestamp-e,n.delay}a(sc,"addDelay");function mf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i,o,l=t.call(n),c=[];try{for(;(e===void 0||e-- >0)&&!(i=l.next()).done;)c.push(i.value)}catch(d){o={error:d}}finally{try{i&&!i.done&&(t=l.return)&&t.call(l)}finally{if(o)throw o.error}}return c}a(mf,"t");var Hr;(function(n){n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped"})(Hr||(Hr={}));var Ef={type:"xstate.init"};function oc(n){return n===void 0?[]:[].concat(n)}a(oc,"r");function tr(n){return{type:"xstate.assign",assignment:n}}a(tr,"o");function pf(n,e){return typeof(n=typeof n=="string"&&e&&e[n]?e[n]:n)=="string"?{type:n}:typeof n=="function"?{type:n.name,exec:n}:n}a(pf,"i");function fo(n){return function(e){return n===e}}a(fo,"a");function Sf(n){return typeof n=="string"?{type:n}:n}a(Sf,"u");function gf(n,e){return{value:n,context:e,actions:[],changed:!1,matches:fo(n)}}a(gf,"c");function yf(n,e,t){var i=e,o=!1;return[n.filter(function(l){if(l.type==="xstate.assign"){o=!0;var c=Object.assign({},i);return typeof l.assignment=="function"?c=l.assignment(i,t):Object.keys(l.assignment).forEach(function(d){c[d]=typeof l.assignment[d]=="function"?l.assignment[d](i,t):l.assignment[d]}),i=c,!1}return!0}),i,o]}a(yf,"f");function ac(n,e){e===void 0&&(e={});var t=mf(yf(oc(n.states[n.initial].entry).map(function(c){return pf(c,e.actions)}),n.context,Ef),2),i=t[0],o=t[1],l={config:n,_options:e,initialState:{value:n.initial,actions:i,context:o,matches:fo(n.initial)},transition:a(function(c,d){var h,f,p=typeof c=="string"?{value:c,context:n.context}:c,g=p.value,v=p.context,b=Sf(d),T=n.states[g];if(T.on){var S=oc(T.on[b.type]);try{for(var C=function(ye){var nt=typeof Symbol=="function"&&Symbol.iterator,$e=nt&&ye[nt],W=0;if($e)return $e.call(ye);if(ye&&typeof ye.length=="number")return{next:a(function(){return ye&&W>=ye.length&&(ye=void 0),{value:ye&&ye[W++],done:!ye}},"next")};throw new TypeError(nt?"Object is not iterable.":"Symbol.iterator is not defined.")}(S),x=C.next();!x.done;x=C.next()){var _=x.value;if(_===void 0)return gf(g,v);var R=typeof _=="string"?{target:_}:_,O=R.target,U=R.actions,Y=U===void 0?[]:U,le=R.cond,Q=le===void 0?function(){return!0}:le,se=O===void 0,fe=O??g,V=n.states[fe];if(Q(v,b)){var B=mf(yf((se?oc(Y):[].concat(T.exit,Y,V.entry).filter(function(ye){return ye})).map(function(ye){return pf(ye,l._options.actions)}),v,b),3),X=B[0],K=B[1],z=B[2],J=O??g;return{value:J,context:K,actions:X,changed:O!==g||X.length>0||z,matches:fo(J)}}}}catch(ye){h={error:ye}}finally{try{x&&!x.done&&(f=C.return)&&f.call(C)}finally{if(h)throw h.error}}}return gf(g,v)},"transition")};return l}a(ac,"s");var vf=a(function(n,e){return n.actions.forEach(function(t){var i=t.exec;return i&&i(n.context,e)})},"l");function lc(n){var e=n.initialState,t=Hr.NotStarted,i=new Set,o={_machine:n,send:a(function(l){t===Hr.Running&&(e=n.transition(e,l),vf(e,Sf(l)),i.forEach(function(c){return c(e)}))},"send"),subscribe:a(function(l){return i.add(l),l(e),{unsubscribe:a(function(){return i.delete(l)},"unsubscribe")}},"subscribe"),start:a(function(l){if(l){var c=typeof l=="object"?l:{context:n.config.context,value:l};e={value:c.value,actions:[],context:c.context,matches:fo(c.value)}}return t=Hr.Running,vf(e,Ef),o},"start"),stop:a(function(){return t=Hr.Stopped,i.clear(),o},"stop"),get state(){return e},get status(){return t}};return o}a(lc,"v");function mT(n,e){for(let t=n.length-1;t>=0;t--){let i=n[t];if(i.type===G.Meta&&i.timestamp<=e)return n.slice(t)}return n}a(mT,"discardPriorSnapshots");function bf(n,{getCastFn:e,applyEventsSynchronously:t,emitter:i}){let o=ac({id:"player",context:n,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:tr({lastPlayedEvent:a((l,c)=>c.type==="CAST_EVENT"?c.payload.event:l.lastPlayedEvent,"lastPlayedEvent")}),recordTimeOffset:tr((l,c)=>{let d=l.timeOffset;return"payload"in c&&"timeOffset"in c.payload&&(d=c.payload.timeOffset),Object.assign(Object.assign({},l),{timeOffset:d,baselineTime:l.events[0].timestamp+d})}),play(l){var c;let{timer:d,events:h,baselineTime:f,lastPlayedEvent:p}=l;d.clear();for(let T of h)sc(T,f);let g=mT(h,f),v=p?.timestamp;p?.type===G.IncrementalSnapshot&&p.data.source===$.MouseMove&&(v=p.timestamp+((c=p.data.positions[0])===null||c===void 0?void 0:c.timeOffset)),f<(v||0)&&i.emit(pe.PlayBack);let b=new Array;for(let T of g)if(!(v&&v<f&&(T.timestamp<=v||T===p)))if(T.timestamp<f)b.push(T);else{let S=e(T,!1);d.addAction({doAction:a(()=>{S()},"doAction"),delay:T.delay})}t(b),i.emit(pe.Flush),d.start()},pause(l){l.timer.clear()},resetLastPlayedEvent:tr(l=>Object.assign(Object.assign({},l),{lastPlayedEvent:null})),startLive:tr({baselineTime:a((l,c)=>(l.timer.start(),c.type==="TO_LIVE"&&c.payload.baselineTime?c.payload.baselineTime:Date.now()),"baselineTime")}),addEvent:tr((l,c)=>{let{baselineTime:d,timer:h,events:f}=l;if(c.type==="ADD_EVENT"){let{event:p}=c.payload;sc(p,d);let g=f.length-1;if(!f[g]||f[g].timestamp<=p.timestamp)f.push(p);else{let T=-1,S=0;for(;S<=g;){let C=Math.floor((S+g)/2);f[C].timestamp<=p.timestamp?S=C+1:g=C-1}T===-1&&(T=S),f.splice(T,0,p)}let v=p.timestamp<d,b=e(p,v);v?b():h.isActive()&&h.addAction({doAction:a(()=>{b()},"doAction"),delay:p.delay})}return Object.assign(Object.assign({},l),{events:f})})}});return lc(o)}a(bf,"createPlayerService");function wf(n){let e=ac({id:"speed",context:n,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:a((t,i)=>{"payload"in i&&t.timer.setSpeed(i.payload.speed)},"setSpeed"),recordSpeed:tr({normalSpeed:a(t=>t.timer.speed,"normalSpeed")}),restoreSpeed:a(t=>{t.timer.setSpeed(t.normalSpeed)},"restoreSpeed")}});return lc(e)}a(wf,"createSpeedService");var Tf=a(n=>[`.${n} { background: currentColor }`,"noscript { display: none !important; }"],"rules");var mo=class{static{a(this,"MediaManager")}constructor(e){this.mediaMap=new Map,this.metadataCallbackMap=new Map,this.warn=e.warn,this.service=e.service,this.speedService=e.speedService,this.emitter=e.emitter,this.getCurrentTime=e.getCurrentTime,this.emitter.on(pe.Start,this.start.bind(this)),this.emitter.on(pe.SkipStart,this.start.bind(this)),this.emitter.on(pe.Pause,this.pause.bind(this)),this.emitter.on(pe.Finish,this.pause.bind(this)),this.speedService.subscribe(()=>{this.syncAllMediaElements()})}syncAllMediaElements(e={pause:!1}){this.mediaMap.forEach((t,i)=>{this.syncTargetWithState(i),e.pause&&i.pause()})}start(){this.syncAllMediaElements()}pause(){this.syncAllMediaElements({pause:!0})}seekTo({time:e,target:t,mediaState:i}){if(i.isPlaying){let l=(e-i.lastInteractionTimeOffset)/1e3*i.playbackRate,c="duration"in t&&t.duration;if(Number.isNaN(c)){this.waitForMetadata(t);return}let d=i.currentTimeAtLastInteraction+l;t.loop&&c!==!1&&(d=d%c),t.currentTime=d}else t.pause(),t.currentTime=i.currentTimeAtLastInteraction}waitForMetadata(e){if(this.metadataCallbackMap.has(e)||!("addEventListener"in e))return;let t=a(()=>{this.metadataCallbackMap.delete(e);let i=this.mediaMap.get(e);i&&this.seekTo({time:this.getCurrentTime(),target:e,mediaState:i})},"onLoadedMetadata");this.metadataCallbackMap.set(e,t),e.addEventListener("loadedmetadata",t,{once:!0})}getMediaStateFromMutation({target:e,timeOffset:t,mutation:i}){var o,l,c,d,h;let f=this.mediaMap.get(e),{type:p,playbackRate:g,currentTime:v,muted:b,volume:T,loop:S}=i;return{isPlaying:p===0||p!==1&&(f?.isPlaying||e.getAttribute("autoplay")!==null),currentTimeAtLastInteraction:(o=v??f?.currentTimeAtLastInteraction)!==null&&o!==void 0?o:0,lastInteractionTimeOffset:t,playbackRate:(l=g??f?.playbackRate)!==null&&l!==void 0?l:1,volume:(c=T??f?.volume)!==null&&c!==void 0?c:1,muted:(d=b??f?.muted)!==null&&d!==void 0?d:e.getAttribute("muted")===null,loop:(h=S??f?.loop)!==null&&h!==void 0?h:e.getAttribute("loop")===null}}syncTargetWithState(e){let t=this.mediaMap.get(e);if(!t)return;let{muted:i,loop:o,volume:l,isPlaying:c}=t,d=this.service.state.matches("paused"),h=t.playbackRate*this.speedService.state.context.timer.speed;try{this.seekTo({time:this.getCurrentTime(),target:e,mediaState:t}),e.volume!==l&&(e.volume=l),e.muted=i,e.loop=o,e.playbackRate!==h&&(e.playbackRate=h),c&&!d?e.play():e.pause()}catch(f){this.warn(`Failed to replay media interactions: ${f.message||f}`)}}addMediaElements(e,t,i){if(!["AUDIO","VIDEO"].includes(e.nodeName))return;let o=e,l=i.getMeta(o);if(!l||!("attributes"in l))return;let c=this.service.state.matches("paused"),d=l.attributes,h=!1;d.rr_mediaState?h=d.rr_mediaState==="played":h=o.getAttribute("autoplay")!==null,h&&c&&o.pause();let f=1;typeof d.rr_mediaPlaybackRate=="number"&&(f=d.rr_mediaPlaybackRate);let p=!1;typeof d.rr_mediaMuted=="boolean"?p=d.rr_mediaMuted:p=o.getAttribute("muted")!==null;let g=!1;typeof d.rr_mediaLoop=="boolean"?g=d.rr_mediaLoop:g=o.getAttribute("loop")!==null;let v=1;typeof d.rr_mediaVolume=="number"&&(v=d.rr_mediaVolume);let b=0;typeof d.rr_mediaCurrentTime=="number"&&(b=d.rr_mediaCurrentTime),this.mediaMap.set(o,{isPlaying:h,currentTimeAtLastInteraction:b,lastInteractionTimeOffset:t,playbackRate:f,volume:v,muted:p,loop:g}),this.syncTargetWithState(o)}mediaMutation({target:e,timeOffset:t,mutation:i}){this.mediaMap.set(e,this.getMediaStateFromMutation({target:e,timeOffset:t,mutation:i})),this.syncTargetWithState(e)}isSupportedMediaElement(e){return["AUDIO","VIDEO"].includes(e.nodeName)}reset(){this.mediaMap.clear()}};var pT=5*1e3,gT=rc||ic,Mf="[replayer]",cc={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function xf(n){return n.type==G.IncrementalSnapshot&&(n.data.source==$.TouchMove||n.data.source==$.MouseInteraction&&n.data.type==ae.TouchStart)}a(xf,"indicatesTouchDevice");var _i=class{static{a(this,"Replayer")}get timer(){return this.service.state.context.timer}constructor(e,t){if(this.usingVirtualDom=!1,this.virtualDom=new Jn,this.mouseTail=null,this.tailPositions=[],this.emitter=gT(),this.legacy_missingNodeRetryMap={},this.cache=Il(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=$s(),this.styleMirror=new Lr,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=d=>{this.iframe.style.display="inherit";for(let h of[this.mouseTail,this.iframe])h&&(h.setAttribute("width",String(d.width)),h.setAttribute("height",String(d.height)))},this.applyEventsSynchronously=d=>{for(let h of d){switch(h.type){case G.DomContentLoaded:case G.Load:case G.Custom:continue;case G.FullSnapshot:case G.Meta:case G.Plugin:case G.IncrementalSnapshot:break}this.getCastFn(h,!0)()}},this.getCastFn=(d,h=!1)=>{let f;switch(d.type){case G.DomContentLoaded:case G.Load:break;case G.Custom:f=a(()=>{this.emitter.emit(pe.CustomEvent,d)},"castFn");break;case G.Meta:f=a(()=>this.emitter.emit(pe.Resize,{width:d.data.width,height:d.data.height}),"castFn");break;case G.FullSnapshot:f=a(()=>{var g;if(this.firstFullSnapshot){if(this.firstFullSnapshot===d){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.mediaManager.reset(),this.styleMirror.reset(),this.rebuildFullSnapshot(d,h),(g=this.iframe.contentWindow)===null||g===void 0||g.scrollTo(d.data.initialOffset)},"castFn");break;case G.IncrementalSnapshot:f=a(()=>{if(this.applyIncremental(d,h),!h&&(d===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let g of this.service.state.context.events)if(!(g.timestamp<=d.timestamp)&&this.isUserInteraction(g)){g.delay-d.delay>this.config.inactivePeriodThreshold*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=g);break}if(this.nextUserInteractionEvent){let g=this.nextUserInteractionEvent.delay-d.delay,v={speed:Math.min(Math.round(g/pT),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:v}),this.emitter.emit(pe.SkipStart,v)}}},"castFn");break}return a(()=>{f&&f();for(let v of this.config.plugins||[])v.handler&&v.handler(d,h,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:d}});let g=this.service.state.context.events.length-1;if(!this.config.liveMode&&d===this.service.state.context.events[g]){let v=a(()=>{g<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(pe.Finish))},"finish"),b=50;d.type===G.IncrementalSnapshot&&d.data.source===$.MouseMove&&d.data.positions.length&&(b+=Math.max(0,-d.data.positions[0].timeOffset)),setTimeout(v,b)}this.emitter.emit(pe.EventCast,d)},"wrappedCastFn")},!t?.liveMode&&e.length<2)throw new Error("Replayer need at least 2 events.");let i={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,inactivePeriodThreshold:10*1e3,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:cc,useVirtualDom:!0,logger:console};this.config=Object.assign({},i,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(pe.Resize,this.handleResize),this.setupDom();for(let d of this.config.plugins||[])d.getMirror&&d.getMirror({nodeMirror:this.mirror});this.emitter.on(pe.Flush,()=>{if(this.usingVirtualDom){let d={mirror:this.mirror,applyCanvas:a((h,f,p)=>{nc({event:h,mutation:f,target:p,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},"applyCanvas"),applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:a((h,f)=>{h.source===$.StyleSheetRule?this.applyStyleSheetRule(h,f):h.source===$.StyleDeclaration&&this.applyStyleDeclaration(h,f)},"applyStyleSheetMutation"),afterAppend:a((h,f)=>{for(let p of this.config.plugins||[])p.onBuild&&p.onBuild(h,{id:f,replayer:this})},"afterAppend")};if(this.iframe.contentDocument)try{Ai(this.iframe.contentDocument,this.virtualDom,d,this.virtualDom.mirror)}catch(h){console.warn(h)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let h in this.legacy_missingNodeRetryMap)try{let f=this.legacy_missingNodeRetryMap[h],p=Ri(f.node,this.mirror,this.virtualDom.mirror);Ai(p,f.node,d,this.virtualDom.mirror),f.node=p}catch(f){this.warn(f)}this.constructedStyleMutations.forEach(h=>{this.applyStyleSheetMutation(h)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(h=>{this.applyAdoptedStyleSheet(h)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){let[d,h]=this.lastMouseDownEvent;d.dispatchEvent(h)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(pe.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset()});let o=new ho([],{speed:this.config.speed});this.service=bf({events:e.map(d=>t&&t.unpackFn?t.unpackFn(d):d).sort((d,h)=>d.timestamp-h.timestamp),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(d=>{this.emitter.emit(pe.StateChange,{player:d})}),this.speedService=wf({normalSpeed:-1,timer:o}),this.speedService.start(),this.speedService.subscribe(d=>{this.emitter.emit(pe.StateChange,{speed:d})}),this.mediaManager=new mo({warn:this.warn.bind(this),service:this.service,speedService:this.speedService,emitter:this.emitter,getCurrentTime:this.getCurrentTime.bind(this)});let l=this.service.state.context.events.find(d=>d.type===G.Meta),c=this.service.state.context.events.find(d=>d.type===G.FullSnapshot);if(l){let{width:d,height:h}=l.data;setTimeout(()=>{this.emitter.emit(pe.Resize,{width:d,height:h})},0)}c&&setTimeout(()=>{var d;this.firstFullSnapshot||(this.firstFullSnapshot=c,this.rebuildFullSnapshot(c),(d=this.iframe.contentWindow)===null||d===void 0||d.scrollTo(c.data.initialOffset))},1),this.service.state.context.events.find(xf)&&this.mouse.classList.add("touch-device")}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}setConfig(e){Object.keys(e).forEach(t=>{e[t],this.config[t]=e[t]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){let e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:t}=this.service.state.context;return e-t[0].timestamp}getMirror(){return this.mirror}play(e=0){var t,i;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(i=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.getElementsByTagName("html")[0])===null||i===void 0||i.classList.remove("rrweb-paused"),this.emitter.emit(pe.Start)}pause(e){var t,i;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(i=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.getElementsByTagName("html")[0])===null||i===void 0||i.classList.add("rrweb-paused"),this.emitter.emit(pe.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(pe.Resume)}destroy(){this.pause(),this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset(),this.config.root.removeChild(this.wrapper),this.emitter.emit(pe.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let t=this.config.unpackFn?this.config.unpackFn(e):e;xf(t)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:t}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Il()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(ff(this.iframe.contentWindow,this.iframe.contentDocument),Ks(this.iframe.contentWindow))}rebuildFullSnapshot(e,t=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let i=[],o=a((d,h)=>{if(this.collectIframeAndAttachDocument(i,d),this.mediaManager.isSupportedMediaElement(d)){let{events:f}=this.service.state.context;this.mediaManager.addMediaElements(d,e.timestamp-f[0].timestamp,this.mirror)}for(let f of this.config.plugins||[])f.onBuild&&f.onBuild(d,{id:h,replayer:this})},"afterAppend");this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),Ih(e.data.node,{doc:this.iframe.contentDocument,afterAppend:o,cache:this.cache,mirror:this.mirror}),o(this.iframe.contentDocument,e.data.node.id);for(let{mutationInQueue:d,builtNode:h}of i)this.attachDocumentToIframe(d,h),this.newDocumentQueue=this.newDocumentQueue.filter(f=>f!==d);let{documentElement:l,head:c}=this.iframe.contentDocument;this.insertStyleRules(l,c),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(pe.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,t){var i;let o=Tf(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&o.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let l=this.virtualDom.createElement("style");this.virtualDom.mirror.add(l,ec(l,this.virtualDom.unserializedId)),e.insertBefore(l,t),l.rules.push({source:$.StyleSheetRule,adds:o.map((c,d)=>({rule:c,index:d}))})}else{let l=document.createElement("style");e.insertBefore(l,t);for(let c=0;c<o.length;c++)(i=l.sheet)===null||i===void 0||i.insertRule(o[c],c)}}attachDocumentToIframe(e,t){let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,o=[],l=a((c,d)=>{this.collectIframeAndAttachDocument(o,c);let h=i.getMeta(c);if(h?.type===oe.Element&&h?.tagName.toUpperCase()==="HTML"){let{documentElement:f,head:p}=t.contentDocument;this.insertStyleRules(f,p)}if(!this.usingVirtualDom)for(let f of this.config.plugins||[])f.onBuild&&f.onBuild(c,{id:d,replayer:this})},"afterAppend");_r(e.node,{doc:t.contentDocument,mirror:i,hackCss:!0,skipChild:!1,afterAppend:l,cache:this.cache}),l(t.contentDocument,e.node.id);for(let{mutationInQueue:c,builtNode:d}of o)this.attachDocumentToIframe(c,d),this.newDocumentQueue=this.newDocumentQueue.filter(h=>h!==c)}collectIframeAndAttachDocument(e,t){if(Cn(t,this.mirror)){let i=this.newDocumentQueue.find(o=>o.parentId===this.mirror.getId(t));i&&e.push({mutationInQueue:i,builtNode:t})}}waitForStylesheetLoad(){var e;let t=(e=this.iframe.contentDocument)===null||e===void 0?void 0:e.head;if(t){let i=new Set,o,l=this.service.state,c=a(()=>{l=this.service.state},"stateHandler");this.emitter.on(pe.Start,c),this.emitter.on(pe.Pause,c);let d=a(()=>{this.emitter.off(pe.Start,c),this.emitter.off(pe.Pause,c)},"unsubscribe");t.querySelectorAll('link[rel="stylesheet"]').forEach(h=>{h.sheet||(i.add(h),h.addEventListener("load",()=>{i.delete(h),i.size===0&&o!==-1&&(l.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(pe.LoadStylesheetEnd),o&&clearTimeout(o),d())}))}),i.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(pe.LoadStylesheetStart),o=setTimeout(()=>{l.matches("playing")&&this.play(this.getCurrentTime()),o=-1,d()},this.config.loadTimeout))}}preloadAllImages(){return dt(this,void 0,void 0,function*(){this.service.state;let e=a(()=>{this.service.state},"stateHandler");this.emitter.on(pe.Start,e),this.emitter.on(pe.Pause,e);let t=[];for(let i of this.service.state.context.events)i.type===G.IncrementalSnapshot&&i.data.source===$.CanvasMutation&&(t.push(this.deserializeAndPreloadCanvasEvents(i.data,i)),("commands"in i.data?i.data.commands:[i.data]).forEach(l=>{this.preloadImages(l,i)}));return Promise.all(t)})}preloadImages(e,t){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(t)){let i=document.createElement("canvas"),o=i.getContext("2d"),l=o?.createImageData(i.width,i.height);l?.data,JSON.parse(e.args[0]),o?.putImageData(l,0,0)}}deserializeAndPreloadCanvasEvents(e,t){return dt(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(t)){let i={isUnchanged:!0};if("commands"in e){let o=yield Promise.all(e.commands.map(l=>dt(this,void 0,void 0,function*(){let c=yield Promise.all(l.args.map(Gt(this.imageMap,null,i)));return Object.assign(Object.assign({},l),{args:c})})));i.isUnchanged===!1&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{commands:o}))}else{let o=yield Promise.all(e.args.map(Gt(this.imageMap,null,i)));i.isUnchanged===!1&&this.canvasEventMap.set(t,Object.assign(Object.assign({},e),{args:o}))}}})}applyIncremental(e,t){var i,o,l;let{data:c}=e;switch(c.source){case $.Mutation:{try{this.applyMutation(c,t)}catch(d){this.warn(`Exception in mutation ${d.message||d}`,c)}break}case $.Drag:case $.TouchMove:case $.MouseMove:if(t){let d=c.positions[c.positions.length-1];this.mousePos={x:d.x,y:d.y,id:d.id,debugData:c}}else c.positions.forEach(d=>{let h={doAction:a(()=>{this.moveAndHover(d.x,d.y,d.id,t,c)},"doAction"),delay:d.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(h)}),this.timer.addAction({doAction(){},delay:e.delay-((i=c.positions[0])===null||i===void 0?void 0:i.timeOffset)});break;case $.MouseInteraction:{if(c.id===-1)break;let d=new Event(Vt(ae[c.type])),h=this.mirror.getNode(c.id);if(!h)return this.debugNodeNotFound(c,c.id);this.emitter.emit(pe.MouseInteraction,{type:c.type,target:h});let{triggerFocus:f}=this.config;switch(c.type){case ae.Blur:"blur"in h&&h.blur();break;case ae.Focus:f&&h.focus&&h.focus({preventScroll:!0});break;case ae.Click:case ae.TouchStart:case ae.TouchEnd:case ae.MouseDown:case ae.MouseUp:t?(c.type===ae.TouchStart?this.touchActive=!0:c.type===ae.TouchEnd&&(this.touchActive=!1),c.type===ae.MouseDown?this.lastMouseDownEvent=[h,d]:c.type===ae.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:c.x||0,y:c.y||0,id:c.id,debugData:c}):(c.type===ae.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(c.x||0,c.y||0,c.id,t,c),c.type===ae.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):c.type===ae.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):c.type===ae.TouchEnd?this.mouse.classList.remove("touch-active"):h.dispatchEvent(d));break;case ae.TouchCancel:t?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:h.dispatchEvent(d)}break}case $.Scroll:{if(c.id===-1)break;if(this.usingVirtualDom){let d=this.virtualDom.mirror.getNode(c.id);if(!d)return this.debugNodeNotFound(c,c.id);d.scrollData=c;break}this.applyScroll(c,t);break}case $.ViewportResize:this.emitter.emit(pe.Resize,{width:c.width,height:c.height});break;case $.Input:{if(c.id===-1)break;if(this.usingVirtualDom){let d=this.virtualDom.mirror.getNode(c.id);if(!d)return this.debugNodeNotFound(c,c.id);d.inputData=c;break}this.applyInput(c);break}case $.MediaInteraction:{let d=this.usingVirtualDom?this.virtualDom.mirror.getNode(c.id):this.mirror.getNode(c.id);if(!d)return this.debugNodeNotFound(c,c.id);let h=d,{events:f}=this.service.state.context;this.mediaManager.mediaMutation({target:h,timeOffset:e.timestamp-f[0].timestamp,mutation:c});break}case $.StyleSheetRule:case $.StyleDeclaration:{this.usingVirtualDom?c.styleId?this.constructedStyleMutations.push(c):c.id&&((o=this.virtualDom.mirror.getNode(c.id))===null||o===void 0||o.rules.push(c)):this.applyStyleSheetMutation(c);break}case $.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let d=this.virtualDom.mirror.getNode(c.id);if(!d)return this.debugNodeNotFound(c,c.id);d.canvasMutations.push({event:e,mutation:c})}else{let d=this.mirror.getNode(c.id);if(!d)return this.debugNodeNotFound(c,c.id);nc({event:e,mutation:c,target:d,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case $.Font:{try{let d=new FontFace(c.family,c.buffer?new Uint8Array(JSON.parse(c.fontSource)):c.fontSource,c.descriptors);(l=this.iframe.contentDocument)===null||l===void 0||l.fonts.add(d)}catch(d){this.warn(d)}break}case $.Selection:{if(t){this.lastSelectionData=c;break}this.applySelection(c);break}case $.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(c):this.applyAdoptedStyleSheet(c);break}}}applyMutation(e,t){if(this.config.useVirtualDom&&!this.usingVirtualDom&&t&&(this.usingVirtualDom=!0,cf(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let f in this.legacy_missingNodeRetryMap)try{let p=this.legacy_missingNodeRetryMap[f],g=Jl(p.node,this.virtualDom,this.mirror);g&&(p.node=g)}catch(p){this.warn(p)}let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter(f=>i.getNode(f.id)?!0:(this.warnNodeNotFound(e,f.id),!1)),e.removes.forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return;let v=i.getNode(f.parentId);if(!v)return this.warnNodeNotFound(e,f.parentId);if(f.isShadow&&Yt(v)&&(v=v.shadowRoot),i.removeNodeFromMap(g),v)try{v.removeChild(g),this.usingVirtualDom&&g.nodeName==="#text"&&v.nodeName==="STYLE"&&((p=v.rules)===null||p===void 0?void 0:p.length)>0&&(v.rules=[])}catch(b){if(b instanceof DOMException)this.warn("parent could not remove child in mutation",v,g,e);else throw b}});let o=Object.assign({},this.legacy_missingNodeRetryMap),l=[],c=a(f=>{let p=null;return f.nextId&&(p=i.getNode(f.nextId)),f.nextId!==null&&f.nextId!==void 0&&f.nextId!==-1&&!p},"nextNotInDOM"),d=a(f=>{var p,g;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let v=i.getNode(f.parentId);if(!v)return f.node.type===oe.Document?this.newDocumentQueue.push(f):l.push(f);f.node.isShadow&&(Yt(v)||v.attachShadow({mode:"open"}),v=v.shadowRoot);let b=null,T=null;if(f.previousId&&(b=i.getNode(f.previousId)),f.nextId&&(T=i.getNode(f.nextId)),c(f))return l.push(f);if(f.node.rootId&&!i.getNode(f.node.rootId))return;let S=f.node.rootId?i.getNode(f.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Cn(v,i)){this.attachDocumentToIframe(f,v);return}let C=a((R,O)=>{if(!this.usingVirtualDom)for(let U of this.config.plugins||[])U.onBuild&&U.onBuild(R,{id:O,replayer:this})},"afterAppend"),x=_r(f.node,{doc:S,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:C});if(f.previousId===-1||f.nextId===-1){o[f.node.id]={node:x,mutation:f};return}let _=i.getMeta(v);if(_&&_.type===oe.Element&&_.tagName==="textarea"&&f.node.type===oe.Text){let R=Array.isArray(v.childNodes)?v.childNodes:Array.from(v.childNodes);for(let O of R)O.nodeType===v.TEXT_NODE&&v.removeChild(O)}else if(_?.type===oe.Document){let R=v;f.node.type===oe.DocumentType&&((p=R.childNodes[0])===null||p===void 0?void 0:p.nodeType)===Node.DOCUMENT_TYPE_NODE&&R.removeChild(R.childNodes[0]),x.nodeName==="HTML"&&R.documentElement&&R.removeChild(R.documentElement)}if(b&&b.nextSibling&&b.nextSibling.parentNode?v.insertBefore(x,b.nextSibling):T&&T.parentNode?v.contains(T)?v.insertBefore(x,T):v.insertBefore(x,null):v.appendChild(x),C(x,f.node.id),this.usingVirtualDom&&x.nodeName==="#text"&&v.nodeName==="STYLE"&&((g=v.rules)===null||g===void 0?void 0:g.length)>0&&(v.rules=[]),Cn(x,this.mirror)){let R=this.mirror.getId(x),O=this.newDocumentQueue.find(U=>U.parentId===R);O&&(this.attachDocumentToIframe(O,x),this.newDocumentQueue=this.newDocumentQueue.filter(U=>U!==O))}(f.previousId||f.nextId)&&this.legacy_resolveMissingNode(o,v,x,f)},"appendNode");e.adds.forEach(f=>{d(f)});let h=Date.now();for(;l.length;){let f=Ah(l);if(l.length=0,Date.now()-h>500){this.warn("Timeout in the loop, please check the resolve tree data:",f);break}for(let p of f)i.getNode(p.value.parentId)?Al(p,v=>{d(v)}):this.debug("Drop resolve tree since there is no parent for the root node.",p)}Object.keys(o).length&&Object.assign(this.legacy_missingNodeRetryMap,o),_h(e.texts).forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return e.removes.find(v=>v.id===f.id)?void 0:this.warnNodeNotFound(e,f.id);if(g.textContent=f.value,this.usingVirtualDom){let v=g.parentNode;((p=v?.rules)===null||p===void 0?void 0:p.length)>0&&(v.rules=[])}}),e.attributes.forEach(f=>{var p;let g=i.getNode(f.id);if(!g)return e.removes.find(v=>v.id===f.id)?void 0:this.warnNodeNotFound(e,f.id);for(let v in f.attributes)if(typeof v=="string"){let b=f.attributes[v];if(b===null)g.removeAttribute(v);else if(typeof b=="string")try{if(v==="_cssText"&&(g.nodeName==="LINK"||g.nodeName==="STYLE"))try{let T=i.getMeta(g);Object.assign(T.attributes,f.attributes);let S=_r(T,{doc:g.ownerDocument,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache}),C=g.nextSibling,x=g.parentNode;if(S&&x){x.removeChild(g),x.insertBefore(S,C),i.replace(f.id,S);break}}catch{}if(v==="value"&&g.nodeName==="TEXTAREA"){let T=g;T.childNodes.forEach(C=>T.removeChild(C));let S=(p=g.ownerDocument)===null||p===void 0?void 0:p.createTextNode(b);S&&T.appendChild(S)}else g.setAttribute(v,b)}catch(T){this.warn("An error occurred may due to the checkout feature.",T)}else if(v==="style"){let T=b,S=g;for(let C in T)if(T[C]===!1)S.style.removeProperty(C);else if(T[C]instanceof Array){let x=T[C];S.style.setProperty(C,x[0],x[1])}else{let x=T[C];S.style.setProperty(C,x)}}}})}applyScroll(e,t){var i,o;let l=this.mirror.getNode(e.id);if(!l)return this.debugNodeNotFound(e,e.id);let c=this.mirror.getMeta(l);if(l===this.iframe.contentDocument)(i=this.iframe.contentWindow)===null||i===void 0||i.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else if(c?.type===oe.Document)(o=l.defaultView)===null||o===void 0||o.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else try{l.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"})}catch{}}applyInput(e){let t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch{}}applySelection(e){try{let t=new Set,i=e.ranges.map(({start:o,startOffset:l,end:c,endOffset:d})=>{let h=this.mirror.getNode(o),f=this.mirror.getNode(c);if(!h||!f)return;let p=new Range;p.setStart(h,l),p.setEnd(f,d);let g=h.ownerDocument,v=g?.getSelection();return v&&t.add(v),{range:p,selection:v}});t.forEach(o=>o.removeAllRanges()),i.forEach(o=>{var l;return o&&((l=o.selection)===null||l===void 0?void 0:l.addRange(o.range))})}catch{}}applyStyleSheetMutation(e){var t;let i=null;e.styleId?i=this.styleMirror.getStyle(e.styleId):e.id&&(i=((t=this.mirror.getNode(e.id))===null||t===void 0?void 0:t.sheet)||null),i&&(e.source===$.StyleSheetRule?this.applyStyleSheetRule(e,i):e.source===$.StyleDeclaration&&this.applyStyleDeclaration(e,i))}applyStyleSheetRule(e,t){var i,o,l,c;if((i=e.adds)===null||i===void 0||i.forEach(({rule:d,index:h})=>{try{if(Array.isArray(h)){let{positions:f,index:p}=Nl(h);kr(t.cssRules,f).insertRule(d,p)}else{let f=h===void 0?void 0:Math.min(h,t.cssRules.length);t?.insertRule(d,f)}}catch{}}),(o=e.removes)===null||o===void 0||o.forEach(({index:d})=>{try{if(Array.isArray(d)){let{positions:h,index:f}=Nl(d);kr(t.cssRules,h).deleteRule(f||0)}else t?.deleteRule(d)}catch{}}),e.replace)try{(l=t.replace)===null||l===void 0||l.call(t,e.replace)}catch{}if(e.replaceSync)try{(c=t.replaceSync)===null||c===void 0||c.call(t,e.replaceSync)}catch{}}applyStyleDeclaration(e,t){e.set&&kr(t.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&kr(t.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var t;let i=this.mirror.getNode(e.id);if(!i)return;(t=e.styles)===null||t===void 0||t.forEach(d=>{var h;let f=null,p=null;if(Yt(i)?p=((h=i.ownerDocument)===null||h===void 0?void 0:h.defaultView)||null:i.nodeName==="#document"&&(p=i.defaultView),!!p)try{f=new p.CSSStyleSheet,this.styleMirror.add(f,d.styleId),this.applyStyleSheetRule({source:$.StyleSheetRule,adds:d.rules},f)}catch{}});let o=10,l=0,c=a((d,h)=>{let f=h.map(p=>this.styleMirror.getStyle(p)).filter(p=>p!==null);Yt(d)?d.shadowRoot.adoptedStyleSheets=f:d.nodeName==="#document"&&(d.adoptedStyleSheets=f),f.length!==h.length&&l<o&&(setTimeout(()=>c(d,h),0+100*l),l++)},"adoptStyleSheets");c(i,e.styleIds)}legacy_resolveMissingNode(e,t,i,o){let{previousId:l,nextId:c}=o,d=l&&e[l],h=c&&e[c];if(d){let{node:f,mutation:p}=d;t.insertBefore(f,i),delete e[p.node.id],delete this.legacy_missingNodeRetryMap[p.node.id],(p.previousId||p.nextId)&&this.legacy_resolveMissingNode(e,t,f,p)}if(h){let{node:f,mutation:p}=h;t.insertBefore(f,i.nextSibling),delete e[p.node.id],delete this.legacy_missingNodeRetryMap[p.node.id],(p.previousId||p.nextId)&&this.legacy_resolveMissingNode(e,t,f,p)}}moveAndHover(e,t,i,o,l){let c=this.mirror.getNode(i);if(!c)return this.debugNodeNotFound(l,i);let d=_l(c,this.iframe),h=e*d.absoluteScale+d.x,f=t*d.absoluteScale+d.y;this.mouse.style.left=`${h}px`,this.mouse.style.top=`${f}px`,o||this.drawMouseTail({x:h,y:f}),this.hoverElements(c)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:t,lineWidth:i,strokeStyle:o,duration:l}=this.config.mouseTail===!0?cc:Object.assign({},cc,this.config.mouseTail),c=a(()=>{if(!this.mouseTail)return;let d=this.mouseTail.getContext("2d");!d||!this.tailPositions.length||(d.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),d.beginPath(),d.lineWidth=i,d.lineCap=t,d.strokeStyle=o,d.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(h=>d.lineTo(h.x,h.y)),d.stroke())},"draw");this.tailPositions.push(e),c(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(d=>d!==e),c()},l/this.speedService.state.context.timer.speed)}hoverElements(e){var t;(t=this.lastHoveredRootNode||this.iframe.contentDocument)===null||t===void 0||t.querySelectorAll(".\\:hover").forEach(o=>{o.classList.remove(":hover")}),this.lastHoveredRootNode=e.getRootNode();let i=e;for(;i;)i.classList&&i.classList.add(":hover"),i=i.parentElement}isUserInteraction(e){return e.type!==G.IncrementalSnapshot?!1:e.data.source>$.Mutation&&e.data.source<=$.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(pe.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,t){this.warn(`Node with id '${t}' not found. `,e)}warnCanvasMutationFailed(e,t){this.warn("Has error on canvas update",t,"canvas mutation:",e)}debugNodeNotFound(e,t){this.debug(`Node with id '${t}' not found. `,e)}warn(...e){this.config.showWarning&&this.config.logger.warn(Mf,...e)}debug(...e){this.config.showDebug&&this.config.logger.log(Mf,...e)}};var _n=class{static{a(this,"EventHandlersBase")}setSessionReplayer(e){}skipEvents(e){}preCastEvent(e){}preEvent(e){}postEvent(e,t){return t}handleMeta(e,t){}handleViewportResize(e){}handleMutation(e,t){}handleInput(e,t){}handleClick(e,t){}handleDblClick(e,t){}handleMouseDown(e,t){}handleMouseUp(e,t){}handleMouseMove(e,t){}handleFocus(e,t){}handleBlur(e,t){}handleContentEditableInput(e,t){}handleKeyStroke(e,t){}handleURLChange(e,t){}};var Af=di(po());var go=class extends _n{constructor({sessionMirror:t,elementSelector:i}){super();this.numberOfRetries=3;this.currentHref=void 0;this.previousMousePositionsNodeSelectors={};this.hasUndefinedFocusNode=!1;this.lastMouseUpTime=0;this.lastMouseDownExtract=void 0;this.allInteractableElementsMetadata={mouseMove:void 0,mouseDown:void 0};this.currentEventIndex=-1;this.enableRecordingAvailableInteractableElements=!0;this.useTextInputFastForward=!0;this.getBoundingBox=a(t=>{let i=jn(this.sessionMirror.getNodeById(t),this.appSpecificRules.appSpecificInteractableElementsSelectors);if(i)return i?.getBoundingClientRect()},"getBoundingBox");this.isPointWithinBoundingBox=a((t,i,o)=>t>=o.left&&t<=o.right&&i>=o.top&&i<=o.bottom,"isPointWithinBoundingBox");this.isPointWithinNodeBoundingBox=a((t,i,o)=>{let l=this.getBoundingBox(t);return l?i>=l.left&&i<=l.right&&o>=l.top&&o<=l.bottom:!1},"isPointWithinNodeBoundingBox");this.elementSelector=i,this.sessionMirror=t}static{a(this,"SessionDigesterEventHandlers")}setEvents(t){this.events=t}setConfiguration({enableRecordingAvailableInteractableElements:t,useTextInputFastForward:i=!0}){this.enableRecordingAvailableInteractableElements=t,this.useTextInputFastForward=i}setAppRules(t){this.appSpecificRules=t}skipEvents(t){this.currentEventIndex+=t.length}preEvent(t){++this.currentEventIndex}async postEvent(t,i){return i&&(!i.availableInteractableElementsAtStart&&this.enableRecordingAvailableInteractableElements&&t.type===G.IncrementalSnapshot&&(t.data.source===$.MouseInteraction||t.data.source===$.Input||t.data.source===$.MediaInteraction)&&(i.availableInteractableElementsAtStart=await this.getInteractableElementsMetadata()),i)}handleMeta(t){if(t.href!==this.currentHref)return this.currentHref=t.href,{eventCode:"navigation",url:t.href}}getNextUserTriggeredInputEvent(t){for(let i=this.currentEventIndex+1;i<this.events.length;++i){let o=this.events[i];if(o.type===G.IncrementalSnapshot&&o.data.source===$.Input&&o.data.userTriggered)return o;if(o.timestamp>t)return}}async handleInput(t,i){if(!t.userTriggered)return;let o=await this.getNodeById(t.id),l=this.getInputEventCode(o,t);if(l==="input"&&this.useTextInputFastForward){this.textInputFastForwardInitialSelector||(this.textInputFastForwardInitialSelector=await this.elementSelector.getSelector(o));let d={eventCode:l,...this.textInputFastForwardInitialSelector};return await a(async()=>{let f=this.getNextUserTriggeredInputEvent(i.timestamp+2e3);if(f){let p=f.data,g=await this.getNodeById(p.id);return g!==o?!1:this.getInputEventCode(g,p)==="input"}return!1},"isNextInputEventForSameNode")()||(this.textInputFastForwardInitialSelector=void 0),d}let c=await this.elementSelector.getSelector(o);return{eventCode:l,...c}}async handleMouseMove(t){if(this.previousMousePositions=t.positions,this.previousMousePositionsNodeSelectors={},this.isLastMouseMoveEventBeforeMouseDownOrUndefinedFocus()){this.previousMousePositionsNodeSelectors={};let i={};for(let o of this.previousMousePositions){let l=o.id;if(i[l])continue;i[l]=!0;let c=await this.getNodeById(l);try{this.previousMousePositionsNodeSelectors[l]=await this.elementSelector.getSelector(c)}catch(d){console.warn("error with extracting selector for node during previousMousePositionsNodeSelectors mapping",c,d)}}this.allInteractableElementsMetadata.mouseMove=await this.getInteractableElementsMetadata()}}isLastMouseMoveEventBeforeMouseDownOrUndefinedFocus(){for(let t=this.currentEventIndex+1;t<this.events.length;++t){let i=this.events[t];if(i.type===G.IncrementalSnapshot)switch(i.data.source){case $.MouseMove:return!1;case $.MouseInteraction:switch(i.data.type){case ae.Click:case ae.MouseDown:return!0;case ae.Focus:return i.data.id===-1}}}return!1}async handleMouseDown(t){let i=await this.getNodeById(t.id);try{this.lastMouseDownExtract={node:i,selector:await this.elementSelector.getSelector(i)},this.allInteractableElementsMetadata.mouseDown=await this.getInteractableElementsMetadata()}catch(o){console.warn("error with extracting selector for node during handleMouseDown",i,o)}this.previousMouseDownData=t}async handleMouseUp(t,i){this.lastMouseUpTime=i.timestamp}isLastMouseDownValidForClick(t){return!!this.lastMouseDownExtract&&t-this.lastMouseUpTime<10}invalidateLastMouseDown(){this.lastMouseUpTime=0,this.lastMouseDownExtract=void 0,this.allInteractableElementsMetadata.mouseDown=void 0}async handleFocus(t){this.hasUndefinedFocusNode=t.id===-1}async handleClick(t,i){if(t.x===void 0||t.y===void 0)return;let o=this.isLastMouseDownValidForClick(i.timestamp),c=await a(async()=>{if(o)return{...this.lastMouseDownExtract.selector,playwrightSelectorForSnapshot:(await this.elementSelector.getSelector(this.lastMouseDownExtract.node,{extractEsraMetadata:!1}))?.playwrightSelector,availableInteractableElementsAtStart:this.allInteractableElementsMetadata.mouseDown};let d=this.getNodeIdForClick(t,i),h=await this.getNodeById(d);return this.previousMousePositionsNodeSelectors[d]?{...this.previousMousePositionsNodeSelectors[d],playwrightSelectorForSnapshot:(await this.elementSelector.getSelector(h,{extractEsraMetadata:!1}))?.playwrightSelector,availableInteractableElementsAtStart:this.allInteractableElementsMetadata.mouseMove}:this.elementSelector.getSelector(h)},"getSelector")();return this.invalidateLastMouseDown(),{eventCode:"click",...c}}getNextMouseMoveEvent(){for(let t=this.currentEventIndex+1;t<this.events.length;++t){let i=this.events[t];if(i.type===G.IncrementalSnapshot&&i.data.source===$.MouseMove)return i}}getNodeIdForClick(t,i){if(this.hasUndefinedFocusNode&&this.previousMouseDownData&&this.previousMouseDownData.id!==t.id){let o=a(()=>{let g=this.getNextMouseMoveEvent();if(g){let b=[...g.data.positions].reverse().find(T=>g.timestamp+T.timeOffset<i.timestamp);if(b)return b.id}},"findByNextMousePosition"),l=a(()=>{if(this.previousMousePositions){let g=[...this.previousMousePositions].reverse().find(v=>!0);if(g)return g.id}},"findByPreviousMousePosition"),c=a(()=>{try{let g=this.sessionMirror.getNodeById(t.id),v=Array.from(br(g)).filter(T=>window.getComputedStyle(T).pointerEvents==="none"),b=[];if(v.length){v.forEach(S=>{let C=S,x=C.getAttribute("style");b.push(x),C.setAttribute("style",x+";pointer-events:auto !important")});let T=document.querySelector("iframe").contentDocument.elementFromPoint(t.x,t.y);if(v.forEach((S,C)=>{S.setAttribute("style",b[C])}),T){let S=this.sessionMirror.getMeta(T);if(S)return S.id}}}catch(g){console.warn("element from point calc error",g)}},"findByElementFromPoint"),d={next:o(),previous:l(),point:c(),original:t.id},h=d.next||d.previous||t.id,f=a(()=>{if(h===d.point)return!1;let g=this.sessionMirror.getNodeById(h);return this.isPointWithinBoundingBox(t.x,t.y,g.getBoundingClientRect())},"isElementFromPointContainedInCandidate");return d.point&&f()?d.point:h}return t.id}async getNodeById(t,{retriesLeft:i=this.numberOfRetries,useCompoundInteractableDetection:o=!0}={}){if(!i)return console.error("no node"),null;let l=this.sessionMirror.getNodeById(t);return l?o?jn(l,this.appSpecificRules.appSpecificInteractableElementsSelectors):l:(await(0,Af.default)(100*(this.numberOfRetries-i+1)),this.getNodeById(t,{retriesLeft:i-1,useCompoundInteractableDetection:o}))}getInputEventCode(t,i){switch(t.getAttribute("type")){case"checkbox":case"radio":return i.isChecked?"check":"uncheck";case"text":default:return"input"}}async getInteractableElementsMetadata(){if(!this.enableRecordingAvailableInteractableElements)return[];let i=document.querySelector("iframe").contentWindow.document;console.log("Getting all interactable elements...");let o=Wt(i,this.appSpecificRules);console.log(`Got ${o.length} interactable elements`),console.log("Extracting ESRA metadata for all interactable elements...");let l=new ut(i),c=await Promise.all(o.map(async d=>({esraMetadata:l.extract(d).toMetadata()})));return console.log("Done processing all interactable elements..."),c}};var yo=class{constructor({eventHandlers:e}){this.preCastEvent=a(async e=>this.handlers.preCastEvent(e),"preCastEvent");this.processEvent=a(async(e,t=!0)=>{this.handlers.preEvent(e);let i=t?await this.handleEvent(e):void 0,o=await this.handlers.postEvent(e,i);return this.handlers.controlledReturn?this.handlers.getReturnValue():o},"processEvent");this.skipEvents=a(async e=>this.handlers.skipEvents(e),"skipEvents");this.handlers=e}static{a(this,"EventProcessor")}setHandlers(e){this.handlers=e}async handleEvent(e){switch(e.type){case G.Meta:return this.handlers.handleMeta(e.data,e);case G.IncrementalSnapshot:switch(e.data.source){case $.ViewportResize:return this.handlers.handleViewportResize(e.data,e);case $.Mutation:return this.handlers.handleMutation(e.data,e);case $.Input:return this.handlers.handleInput(e.data,e);case $.MouseInteraction:return this.handleMouseInteraction(e.data,e);case $.MouseMove:return this.handlers.handleMouseMove(e.data,e);default:break}break;case G.Custom:switch(e.data.tag){case"contenteditable-input":return this.handlers.handleContentEditableInput(e.data.payload,e);case"key-stroke":return this.handlers.handleKeyStroke(e.data.payload,e);case"url-change":return this.handlers.handleURLChange(e.data.payload,e)}break;default:break}}async handleMouseInteraction(e,t){switch(e.type){case ae.Click:return this.handlers.handleClick(e,t);case ae.DblClick:return this.handlers.handleDblClick(e,t);case ae.MouseDown:return this.handlers.handleMouseDown(e,t);case ae.MouseUp:return this.handlers.handleMouseUp(e,t);case ae.Focus:return this.handlers.handleFocus(e,t);case ae.Blur:return this.handlers.handleBlur(e,t);default:break}}};var uc=di(po());var vo=class{constructor(e={}){this.events=[];this.castedEvents=[];this.isLive=!0;this.currentTraveledTimestamp=void 0;this.config={enableInteract:!1};this.useTimestampCompression=!0;this.fastForward=a(async(e,t=!1)=>{if(!t&&!this.isLive){this.liveEvents.push(...e);return}let i=e.sort((l,c)=>l.timestamp-c.timestamp);if(this.useTimestampCompression){let l=Date.now();i=i.map((c,d)=>({...c,timestamp:l+d,originalTimestamp:this.getOriginalTimestamp(c)??c.timestamp}))}this.events=[...this.events,...i];let o=new Promise(l=>{this.onEventCast=c=>{this.castedEvents.push(c),this.castedEvents.length===this.events.length&&(this.onEventCast=void 0,l())}});for(let l of i)this.replayer.addEvent(l);return o},"fastForward");this.stop=a(()=>{this.replayer.destroy()},"stop");this.getOriginalTimestamp=a(e=>e.originalTimestamp,"getOriginalTimestamp");this.getNodeById=a(e=>this.replayer.getMirror().getNode(e),"getNodeById");this.getMeta=a(e=>this.replayer.getMirror().getMeta(e),"getMeta");this.config={...this.config,...e}}static{a(this,"SessionReplayer")}start(e){this.startOptions=e;let{firstEventTimestamp:t,speed:i=8,useTimestampCompression:o=!0}=e;this.replayer=new _i([],{mouseTail:!1,pauseAnimation:!1,speed:i,triggerFocus:!0,UNSAFE_replayCanvas:!0,liveMode:!0,showDebug:!1,skipInactive:!0}),this.config.enableInteract?this.replayer.enableInteract():this.replayer.disableInteract(),this.useTimestampCompression=o,this.replayer.startLive(this.useTimestampCompression?Date.now():t),this.replayer.on("event-cast",l=>{this.onEventCast&&this.onEventCast(l)})}async goBack(e,{sleepAfter:t=1e3,beforeTimestamp:i=!1}={}){this.currentTraveledTimestamp!==e&&(this.currentTraveledTimestamp=e,this.isLive&&(this.liveEvents=this.events),this.stop(),this.events=[],this.castedEvents=[],this.start(this.startOptions),this.isLive=!1,await this.fastForward(this.liveEvents.filter(o=>i?this.getOriginalTimestamp(o)<e:this.getOriginalTimestamp(o)<=e),!0),t&&await(0,uc.default)(t))}async goLive(e=1e3){this.isLive||(this.stop(),this.currentTraveledTimestamp=void 0,this.events=[],this.castedEvents=[],this.start(this.startOptions),this.isLive=!0,await this.fastForward(this.liveEvents),e&&await(0,uc.default)(e))}};var Br=class{static{a(this,"Streamer")}constructor(e={}){this.sessionReplayer=new vo(e),this.eventProcessor=new yo({eventHandlers:new _n})}setEventHandlers(e){e.setSessionReplayer(this.sessionReplayer),this.eventHandlers=e,this.eventProcessor.setHandlers(this.eventHandlers)}start(e){this.sessionReplayer.start(e)}async handleEvent(e){return await this.eventProcessor.preCastEvent(e),await this.sessionReplayer.fastForward([e]),await this.eventProcessor.processEvent(e)}async skipEvents(e){await this.eventProcessor.skipEvents(e),await this.sessionReplayer.fastForward(e)}stop(){this.sessionReplayer.stop()}};var Eo=class extends Br{constructor(){super({enableInteract:!0});this.elementSelector=new Cr;this.setEventHandlers(new go({sessionMirror:this.sessionReplayer,elementSelector:this.elementSelector}))}static{a(this,"ChecksumSessionDigester")}setConfiguration({enableRecordingAvailableInteractableElements:t,useTextInputFastForward:i}){this.eventHandlers.setConfiguration({enableRecordingAvailableInteractableElements:t,useTextInputFastForward:i})}setEvents(t){this.eventHandlers.setEvents(t)}setOptions(t){this.elementSelector.setOptions({defaultExtractReducedHtmlAndSelector:t.extractReducedHTML,defaultInspectInteractableElements:t.inspectInteractables,defaultExtractEsraMetadata:t.extractESRAMetadata})}setAppRules(t){this.appSpecificRules=t,this.elementSelector.setAppRules(t),this.eventHandlers.setAppRules(t)}async handleEvent(t){return await super.handleEvent(t)}};var So=class{constructor(e){this.attributes={};this.classes={};if(typeof e=="object")for(let t in e)this[t]=e[t];else if(typeof e=="string"){let t=JSON.parse(e);for(let i in t)this[i]=t[i]}}static{a(this,"ESRAElementMetadata")}serialize(){return JSON.stringify(this)}};var Df=di(Lf());var dc=class{constructor(){this.weightsSum=0;this.config={attributes:{qualification:{globalUniquenessThreshold:.99,tagUniquenessThreshold:.99},decisionWeight:this.makeWeight(2/5)},classes:{qualification:{globalUniquenessThreshold:.99,tagUniquenessThreshold:.99},decisionWeight:this.makeWeight(2/5)},tagName:{decisionWeight:this.makeWeight(3/5)},style:{inlineWeight:.6,computedWeight:.4,decisionWeight:this.makeWeight(2/5)},innerText:{decisionWeight:this.makeWeight(3/5),qualification:{exactMatchMax:20,containsMatchMax:10,maxLength:256,minLength:1},ignoreSimilarityScoreBelow:.6},innerFeatures:{decisionWeight:this.makeWeight(4/5)},visualVicinity:{decisionWeight:this.makeWeight(1/5)},structuralVicinity:{decisionWeight:this.makeWeight(1/5)}}}static{a(this,"ESRASimilarityConfigClass")}makeWeight(e){return this.weightsSum+=e,e}get(){return this.config}weight(e){return e/this.weightsSum}},De=new dc;var wo=class{constructor(e){this.qualifiedAttributes=[];this.qualifiedAttributesMap={};this.qualifiedClasses=[];this.unqualifiedClasses=[];this.qualifiedInnerText=void 0;this.visualVicinityComparable=[];this.structuralVicinityComparable=[];this.innerFeaturesComparable=[];this.rank=a(e=>{if(this.isDealBreaker(e))return{score:0,scores:{}};let t=this.tagSimilarity(e),i=this.attributesSimilarity(e),o=this.classSimilarity(e),l=this.styleSimilarity(e),c=this.innerTextSimilarity(e),d=this.innerFeaturesSimilarity(e),h=this.visualVicinitySimilarity(e),f=this.structuralVicinitySimilarity(e),p=this.svgsSimilarity(e),g={tagScore:t,attributesScore:i,classesScore:o,styleScore:l,innerTextScore:c,innerFeaturesScore:d,visualVicinityScore:h,structuralVicinityScore:f,svgsScore:p},v={tagScore:De.weight(De.get().tagName.decisionWeight)*t,attributesScore:De.weight(De.get().attributes.decisionWeight)*i,classesScore:De.weight(De.get().classes.decisionWeight)*o,innerTextScore:De.weight(De.get().innerText.decisionWeight)*c,innerFeaturesScore:De.weight(De.get().innerFeatures.decisionWeight)*d,styleScore:De.weight(De.get().style.decisionWeight)*l,visualVicinityScore:De.weight(De.get().visualVicinity.decisionWeight)*h,structuralVicinityScore:De.weight(De.get().structuralVicinity.decisionWeight)*f};return{score:Object.values(v).reduce((T,S)=>T+S,0),scores:g}},"rank");this.targetElementESRAMetadata=e,this.setQualifiedAttributes(),this.setQualifiedClasses(),this.setQualifiedInnerText(),this.setVisualVicinityComparable(),this.setStructuralVicinityComparable(),this.setInnerFeaturesComparable()}static{a(this,"ESRASimilarity")}getQualifiedAttributes(){return this.qualifiedAttributes}getQualifiedClasses(){return this.qualifiedClasses}getQualifiedInnerText(){return this.qualifiedInnerText}setQualifiedAttributes(){let e=this.targetElementESRAMetadata.attributes,{qualifiedAttributes:t,qualifiedAttributesMap:i}=this.makeQualifiedAttributes(e);this.qualifiedAttributes=t,this.qualifiedAttributesMap=i}makeQualifiedAttributes(e,t){let i=Object.keys(e).filter(l=>{switch(t){case"input":if(l==="value")return!1;break}let c=e[l];for(let d in c)d.endsWith("Uniqenuess")&&(c[d.replace("Uniqenuess","Uniqueness")]=c[d]);return c.globalUniqueness>De.get().attributes.qualification.globalUniquenessThreshold||c.tagUniqueness>De.get().attributes.qualification.tagUniquenessThreshold}),o=i.reduce((l,c)=>(l[c]=e[c].value,l),{});return{qualifiedAttributes:i,qualifiedAttributesMap:o}}setQualifiedClasses(){this.qualifiedClasses=this.makeQualifiedClasses(this.targetElementESRAMetadata.classes),this.unqualifiedClasses=Object.keys(this.targetElementESRAMetadata.classes).filter(e=>!this.qualifiedClasses.includes(e))}isValidClass(e){return/^[A-Za-z_-][0-9A-Za-z_-]*$/.test(e)}makeQualifiedClasses(e){return Object.keys(e).filter(t=>{let i=e[t];return!this.isValidClass(t)||t.startsWith("jss")||t.startsWith("css-")||t===":hover"?!1:i.globalUniqueness>De.get().classes.qualification.globalUniquenessThreshold||i.tagUniqueness>De.get().classes.qualification.tagUniquenessThreshold})}setQualifiedInnerText(){this.qualifiedInnerText=this.makeQualifiedInnerText(this.targetElementESRAMetadata.innerText)}makeQualifiedInnerText(e){return e&&e.content?.length<=De.get().innerText.qualification.maxLength&&e.content?.length>=De.get().innerText.qualification.minLength?e:null}makeBasicElementPropertiesComparable(e){return e.reduce((t,i)=>{let o=i.position?`${i.tag}.${i.position.slice(0,2).join(",")}`:i.tag,l=`${o}+${i.relativePosition}`,c=this.makeQualifiedClasses(i.classes).map(p=>`${o}.${p}`),d=[];this.makeQualifiedAttributes(i.attributes).qualifiedAttributes.forEach(p=>{d.push(`${o}[${p}]`),d.push(`${o}[${p}]=${i.attributes[p].value}`)});let h=i.feature?this.makeInnerFeaturesComparable([i.feature],{customTag:o,includeTag:!1,featureTypeWhiteList:[6]}):[],f=[...t,o,l,...c,...d,...h];return i.text&&(f.push(`${o}<>`),f.push(`${o}<${i.text}>`)),i.distance&&(f.push(`${o}->${i.distance}`),f.push(`${o}->[]${this.getDistanceRange(i.distance)}`)),f},[])}getDistanceRange(e){let t=[10,20,30,40,50,60,70,80,90,100];for(let i of t)if(e<i)return i;return t[t.length-1]}setVisualVicinityComparable(){this.visualVicinityComparable=this.makeVisualVicinityComparable(this.targetElementESRAMetadata.visualVicinity)}makeVisualVicinityComparable(e){return this.makeBasicElementPropertiesComparable(e)}setStructuralVicinityComparable(){this.structuralVicinityComparable=this.makeStructuralVicinityComparable(this.targetElementESRAMetadata.structuralVicinity)}makeStructuralVicinityComparable(e){return this.makeBasicElementPropertiesComparable(e)}makeInnerFeaturesComparable(e,{customTag:t=void 0,includeTag:i=!0,featureTypeWhiteList:o=void 0}={}){return e.reduce((l,c)=>{if(o&&!o.includes(c.type)||c.isHidden)return l;let d=t??c.tag,h=i?[...l,d]:l;switch(c.type){case 3:h.push(`${d}[type=${c.buttonType}]`);break;case 4:c.inputType&&h.push(`${d}[type=${c.inputType}]`),c.placeholder&&h.push(`${d}[placeholder=${c.placeholder}]`);break;case 6:c.components.forEach(f=>{let p=[];for(let g in f.attributes)p.push(`[${g}=${f.attributes[g]}]`);h.push(`${d}${p.join("")}`)});break}return"text"in c&&c.text&&(h.push(`${d}<>`),h.push(`${d}<${c.text}>`)),h},[])}setInnerFeaturesComparable(){this.innerFeaturesComparable=this.makeInnerFeaturesComparable(this.targetElementESRAMetadata.innerFeatures)}isDealBreaker(e){if(this.targetElementESRAMetadata.tag==="input"&&e.tag==="input"){let t=a(l=>l.type?l.type.value:"text","getType"),i=t(this.targetElementESRAMetadata.attributes),o=t(e.attributes);if(i!==o)return!0}return!1}tagSimilarity(e){return e.tag===this.targetElementESRAMetadata.tag?1:0}attributesSimilarity(e){let t=a(o=>[...this.keyValueObjectToArray(o),...Object.keys(o)],"makeJaccardParam"),{qualifiedAttributesMap:i}=this.makeQualifiedAttributes(e.attributes);return this.jaccard(t(this.qualifiedAttributesMap),t(i))}indicativeAttributesSimilarity(e){return this.qualifiedAttributesMap.placehoder&&e.attributes.placehoder&&this.qualifiedAttributesMap.placehoder===e.attributes.placehoder.value?1:0}classSimilarity(e){return this.jaccard(this.qualifiedClasses,this.makeQualifiedClasses(e.classes))}innerTextSimilarity(e){if(!this.targetElementESRAMetadata.innerText&&!e.innerText)return 1;let t=this.makeQualifiedInnerText(e.innerText);if(!this.qualifiedInnerText||!t)return 0;if(this.qualifiedInnerText.content===t.content)return 1;Object.values({email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,url:/^(http|https):\/\/[^ "]+$/}).forEach(l=>{if(l.test(this.qualifiedInnerText.content)&&l.test(t.content))return .5});try{return new Date(this.qualifiedInnerText.content),new Date(t.content),.5}catch{}let o=a(l=>l.replace(/\d/g,"d").replace(/[a-zA-Z]/g,"s"),"template");return o(this.qualifiedInnerText.content)===o(t.content)?.5:0}innerFeaturesSimilarity(e){return this.jaccard(this.innerFeaturesComparable,this.makeInnerFeaturesComparable(e.innerFeatures))}visualVicinitySimilarity(e){return this.jaccard(this.visualVicinityComparable,this.makeVisualVicinityComparable(e.visualVicinity))}structuralVicinitySimilarity(e){return this.jaccard(this.structuralVicinityComparable,this.makeStructuralVicinityComparable(e.structuralVicinity))}styleSimilarity(e){let t=a(l=>[...this.keyValueObjectToArray(l),...Object.keys(l)],"makeJaccardParam"),i=this.jaccard(t(this.targetElementESRAMetadata.style.inline??{}),t(e.style.inline??{})),o=this.jaccard(t(this.targetElementESRAMetadata.style.computed??{}),t(e.style.computed??{}));return i*De.get().style.inlineWeight+o*De.get().style.computedWeight}svgsSimilarity(e){return!this.targetElementESRAMetadata.svgs&&!e.svgs||this.targetElementESRAMetadata.svgs&&e.svgs&&JSON.stringify(this.targetElementESRAMetadata.svgs)===JSON.stringify(e.svgs)?1:0}keyValueObjectToArray(e,t="=",i=void 0){let o=a(l=>i?i(e,l):e[l],"getValue");return Object.keys(e).map(l=>`${l}${t}${o(l)}`)}jaccard(e,t){return Array.isArray(e)&&Array.isArray(t)&&!e.length&&!t.length?1:(0,Df.jaccard)(e,t)}};var Nn=class extends Error{static{a(this,"TimeoutError")}constructor(){super("Timeout")}};var rr=class n{constructor(e,t){this.POSITIONING_SATISFACTORY_SCORE=1;this.targetElementStaticData={};this.qualifiedAttributes=[];this.qualifiedAttributesMap={};this.qualifiedClasses=[];this.candidateQueries=[];this.candidates=[];this.uniqueCandidates=[];this.queryCandidates=[];this.interactableCandidates=[];this.rankedCandidates=[];this.filteredAndSortedRankedCandidates=[];this.finalCandidates=[];this.weightsSum=0;this.config={innerText:{dropIfMoreThanNCandidates:5},innerFeatures:{mandatoryPercentage:.6,mandatoryMax:6},results:{scorePercentile:.75,epsilon:.01}};this.getSelectionResultForCandidate=a(e=>{let t=yt.getInstance("getElementSelectionResult",{log:!1}),i=t.get();if(i||(i=new Map,t.set(i)),i.has(e))return i.get(e);this.checkTimeout();let o=this.extractMetadata(e),{score:l,scores:c}=this.similarity.rank(o),d={score:l,candidate:e,scores:c,esraMetadata:o};return i.set(e,d),t.set(i),d},"getSelectionResultForCandidate");this.targetElementESRAMetadata=e,this.targetElementStaticData=t||e.staticMetadata,this.similarity=new wo(this.targetElementESRAMetadata),this.esraMetadataExtractor=new ut(document)}static{a(this,"ESRASelector")}makeWeight(e){return this.weightsSum+=e,e}getWeight(e){return e/this.weightsSum}extractMetadata(e){return new So(this.esraMetadataExtractor.extract(e).toMetadata())}getLastSelectionLogs(e=5){if(!this.candidates?.length)return{};let t=new XMLSerializer,i=a((c,d=50)=>c.slice(0,d).map(h=>({score:h.score,metadata:h.metadata,element:t.serializeToString(h.candidate).substring(0,200)})),"printCandidates"),o=this.rankedCandidates[Math.min(this.rankedCandidates.length-1,e)].score,l=a(c=>i(c,e).filter(d=>d.score>=o),"filterByScore");return{candidatesQuery:this.candidateQueries.filter(c=>!!c.length).join(","),totalUniqueCandidates:this.uniqueCandidates.length,topRankingCandidates:i(this.rankedCandidates,e),topRemovedCandidates:{hidden:l(this.removedCandidates.hidden),staticData:l(this.removedCandidates.static)}}}selectByPositioning(){let e=this.targetElementESRAMetadata.positioning;if(window.innerWidth!==e.viewport.size.width||window.innerHeight!==e.viewport.size.height)return;let t=document.elementFromPoint(e.viewport.element.left*window.innerWidth,e.viewport.element.top*window.innerHeight),i=this.extractMetadata(t),{score:o}=this.similarity.rank(i);return o>=this.POSITIONING_SATISFACTORY_SCORE?{candidate:t,score:o,esraMetadata:i}:void 0}collectCandidates(){this.setQualifiedAttributesQueries(),this.setQualifiedClassesQueries(),this.setInnerFeaturesQueries(),this.candidates=[];let e=this.candidateQueries.filter(t=>!!t.length).join(",");this.queryCandidates=[],e.length&&(this.queryCandidates=we(e)),this.interactableCandidates=[],this.elementsFiltering!==0&&(this.interactableCandidates=Wt())}select(){console.log("selecting elements, filtering: ",hi[this.elementsFiltering]);let e=a(l=>{switch(l){case 0:return this.queryCandidates;case 1:return this.intersectElements(this.queryCandidates,this.interactableCandidates);case 2:return this.interactableCandidates;case 3:return this.queryCandidates.concat(this.interactableCandidates)}},"filterElements");for(;this.candidates=e(this.elementsFiltering),!(this.candidates.length||this.elementsFiltering===3);)console.log(`no candidates found, expanding selection to ${hi[this.elementsFiltering+1]}`),this.elementsFiltering++;console.log("# of query/interactable/total candidates:",this.queryCandidates.length,this.interactableCandidates.length,this.candidates.length),this.candidates.push(...this.getInnerTextCandidates()),this.candidates.length||this.candidates.push(...this.getTagCandidates()),this.uniqueCandidates=this.candidates.filter((l,c,d)=>d.indexOf(l)===c);let t=n.limitChildren;t?.length&&(t=t.map(l=>({...l,parent:document.querySelector(l.selector)})),this.uniqueCandidates=this.uniqueCandidates.filter(l=>{for(var c of t)if(c.parent&&this.isDescendant(c.parent,l)&&c.limit--<=0)return!1;return!0})),this.checkTimeout(),this.rankedCandidates=this.uniqueCandidates.filter(l=>l instanceof wr(l).HTMLElement||l instanceof wr(l).SVGElement).map(this.getSelectionResultForCandidate).sort((l,c)=>c.score-l.score),this.removedCandidates={hidden:[],static:[]},this.filteredAndSortedRankedCandidates=this.rankedCandidates.filter(l=>{let{isHidden:c,clickOffset:d}=this.isHidden(l.candidate);return c===!0?(this.removedCandidates.hidden.push(l),!1):(d&&(l.clickOffset=d),As(this.targetElementStaticData)&&!Jd(this.formatStaticCandidates(l.esraMetadata.staticCandidates),this.targetElementStaticData)?(l.metadata=JSON.stringify(l.esraMetadata.staticCandidates),this.removedCandidates.static.push(l),!1):!0)}),this.checkTimeout(),this.removedCandidates.hidden.slice().reverse().forEach((l,c,d)=>{l.candidate.tagName==="INPUT"&&this.filteredAndSortedRankedCandidates.find(h=>h.score>.1&&h.candidate.contains(l.candidate))&&(this.removedCandidates.hidden.splice(d.length-1-c,1),this.filteredAndSortedRankedCandidates.push(l))}),this.filteredAndSortedRankedCandidates=this.filteredAndSortedRankedCandidates.sort((l,c)=>c.score-l.score);let i=this.filteredAndSortedRankedCandidates.length*(1-this.config.results.scorePercentile);this.finalCandidates=[];let o=null;for(let l=0;l<this.filteredAndSortedRankedCandidates.length;++l){let c=this.filteredAndSortedRankedCandidates[l];if(l>=i&&(!o||o.score-c.score>this.config.results.epsilon))break;o=c,this.finalCandidates.push(c)}return this.finalCandidates}intersectElements(e,t){let i=a((d,{useElementSize:h=!1}={})=>{let f=new Set;return d.forEach(p=>{let g=2,v=p;for(;v&&g-- >0&&(f.add(v),!(h&&Math.abs(v.parentElement.clientWidth-v.clientWidth)>v.clientWidth*.3&&Math.abs(v.parentElement.clientHeight-v.clientHeight)>v.clientHeight*.3));)v=v.parentElement}),f},"normalize"),o=i(e),l=i(t),c=new Set;return o.forEach(d=>{l.has(d)&&c.add(d)}),Array.from(c)}checkTimeout(){if(n.timeout&&Date.now()-this.processStartTime>n.timeout)throw new Nn}selectOne({elementsFiltering:e=1,minSelectionScore:t=.3}={}){try{if(this.elementsFiltering=e,this.processStartTime=Date.now(),this.targetElementESRAMetadata.tag==="html"){let o=document.querySelector("html");return{candidate:o,score:1,esraMetadata:this.extractMetadata(o)}}let i=this.selectByPositioning();if(i)return console.log("Found element by positioning"),i;for(this.collectCandidates();;){let o=this.select();if(!o.length)break;let{score:l}=o[0];if(l<t&&this.elementsFiltering!==3){this.elementsFiltering++,console.log(`Best matching element is below threshold (${l}/${t}), expanding selection to ${hi[this.elementsFiltering]}`);continue}return o[0]}}catch(i){i instanceof Nn?console.error("ESRA selection timeout"):console.error("ESRA selection error",i)}return{candidate:void 0,score:0,esraMetadata:void 0}}getFinalCandidates(){return this.finalCandidates}setQualifiedAttributesQueries(){this.candidateQueries.push(this.similarity.getQualifiedAttributes().map(e=>`[${e}="${this.targetElementESRAMetadata.attributes[e].value}"]`).join(","))}setQualifiedClassesQueries(e=[]){this.candidateQueries.push(this.similarity.getQualifiedClasses().map(t=>`.${t}`).join(","))}setInnerFeaturesQueries(){let e=eh(this.targetElementESRAMetadata.innerFeatures,this.config).map(t=>`*${t})`);this.candidateQueries.push(...e)}getInnerTextCandidates(){let e=this.similarity.getQualifiedInnerText();if(!e)return[];let t=nh(e.content);return t.length>this.config.innerText.dropIfMoreThanNCandidates?[]:t}getTagCandidates(){return we(this.targetElementESRAMetadata.tag)}isDescendant(e,t){return e.contains(t)}formatStaticCandidates(e){let t={};return Object.keys(e).forEach(i=>{t[i]=e[i]}),t}isHidden(e){return st(e,{useCache:!0})}};var Of=a(n=>{let e=a(l=>l&&(l instanceof HTMLInputElement&&/|text|email|number|password|search|tel|url/.test(l.type||"")||l instanceof HTMLTextAreaElement)?!(l.disabled||l.readOnly):!1,"isEditableInputOrTextArea"),t=a((l,c)=>{n({key:l,eventTarget:c})},"sendKeyEvent"),i=a(l=>(l.ctrlKey?"ctrl ":"")+(l.altKey?"alt ":"")+(l.shiftKey?"shift ":"")+(l.metaKey?"meta ":"")+l.key,"formatKeyProperties"),o=a(l=>{try{if(e(l.target))return;t(i(l),l.target)}catch{}},"onKeyUp");window.addEventListener("keyup",l=>{o(l)})},"startKeyboardObserver");var To=class n{constructor(e=document,t){this.target=e;this.onEvent=t;this.monitoredTextElements=[];this.inputEnabledSelectors=["[contenteditable=true]"].join(",");this.iframeObservers=[];this.monitorInputEnabledElement=a(e=>{e.addEventListener("input",t=>{this.onEvent({text:t.target?.innerText,eventTarget:t.target})})},"monitorInputEnabledElement")}static{a(this,"ContendEditableObserver")}startObserver(){this.startIframesObserver(),this.observer=new MutationObserver(e=>{e.forEach(t=>{t.addedNodes.forEach(i=>{if(i.querySelector){let o=i.querySelector("iframe");o&&console.log("FFF",o)}if(i.nodeType===Node.ELEMENT_NODE&&i.nodeType===Node.ELEMENT_NODE){let o=i;o.matches(this.inputEnabledSelectors)||o.isContentEditable?this.monitorInputEnabledElement(o):Array.from(we("*",o)).filter(l=>l.matches&&l.matches(this.inputEnabledSelectors)||l.isContentEditable).forEach(this.monitorInputEnabledElement)}})})}),this.observer.observe(this.target,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.startInputMonitoring()}startIframesObserver(){setInterval(()=>{we("iframe",this.target).forEach(t=>{if(this.iframeObservers.find(c=>c.iframe===t))return;let i=a(c=>{if(c.iframe.contentWindow)try{c.observer=new n(c.iframe.contentWindow.document,this.onEvent),c.observer.startObserver()}catch{}},"observeIframe"),o=t,l={iframe:o,observer:null};this.iframeObservers.push(l),o.contentWindow?i(l):o.addEventListener("load",()=>{i(l)})})},500)}startInputMonitoring(){this.monitoredTextElements=we(this.inputEnabledSelectors,this.target),this.monitoredTextElements.forEach(this.monitorInputEnabledElement)}};var Mo=class{constructor(e){this.onEvent=e;this.onURLChange=a(()=>{setTimeout(()=>{let e=window.location.href;if(e!==this.currentURL){this.currentURL=e;try{this.onEvent({url:e})}catch{}}})},"onURLChange")}static{a(this,"URLObserver")}start(){window.addEventListener("popstate",i=>{this.onURLChange()}),window.addEventListener("locationchange",i=>{this.onURLChange()}),window.addEventListener("hashchange",i=>{this.onURLChange()});let e=window.history.pushState;window.history.pushState=(...i)=>(this.onURLChange(),e.apply(window.history,i));let t=window.history.replaceState;window.history.replaceState=(...i)=>(this.onURLChange(),t.apply(window.history,i))}};var xo=class{constructor(e){this.logNativeMutationObserver=!1;this.stopRRWebRecording=a(()=>{},"stopRRWebRecording");this.start=a(()=>{this.stopRRWebRecording=Zt({emit:this.eventHandler,sampling:{mousemove:!1},userTriggeredOnInput:!0}),this.logNativeMutationObserver&&this.selfObserve(),this.startURLObserver(),this.startKeyboardObserver(),this.startContentEditableObserver()},"start");this.stop=a(()=>{this.stopRRWebRecording()},"stop");this.startURLObserver=a(()=>{this.urlObserver=new Mo(({url:e})=>{let t={url:e};this.addCustomEvent("url-change",t)}),this.urlObserver.start()},"startURLObserver");this.startContentEditableObserver=a(()=>{this.contentEditableObserver=new To(document,({text:e,eventTarget:t})=>{let i={text:e,id:this.tryGetMetaFromEventTarget(t)?.id};this.addCustomEvent("contenteditable-input",i)}),this.contentEditableObserver.startObserver()},"startContentEditableObserver");this.startKeyboardObserver=a(()=>{Of(({key:e,eventTarget:t})=>{let i={key:e,id:this.tryGetMetaFromEventTarget(t)?.id};this.addCustomEvent("key-stroke",i)})},"startKeyboardObserver");this.addCustomEvent=a((e,t)=>{Zt.addCustomEvent(e,t)},"addCustomEvent");this.tryGetMetaFromEventTarget=a(e=>{try{return this.getMeta(e)}catch{}},"tryGetMetaFromEventTarget");this.selfObserve=a(()=>{let e=document.getElementsByTagName("body"),t={attributes:!0,childList:!0,subtree:!0},i=a((l,c)=>{for(let d of l)d.type==="childList"?console.log("A child node has been added or removed.",d):d.type==="attributes"&&console.log(`The ${d.attributeName} attribute was modified.`,d)},"callback");new MutationObserver(i).observe(e[0],t)},"selfObserve");this.getNodeById=a(e=>Zt.mirror.getNode(e),"getNodeById");this.getMeta=a(e=>Zt.mirror.getMeta(e),"getMeta");this.eventHandler=e,this.currentURL=window.location.href}static{a(this,"SessionRecorder")}};var kf=["aria-label","aria-labelledby","label","title","alt"];function Pf(n){return n._debugSource?.fileName?n._debugSource?.fileName:""}a(Pf,"getComponentpath");function Ff(n,e){if(n==="Unknown"||typeof n!="string"||n[0]!==n[0].toUpperCase()||e.type.$$typeof===Symbol.for("react.context")||e.type.$$typeof===Symbol.for("react.forward_ref")||e.type.$$typeof===Symbol.for("react.memo")||e.type.$$typeof===Symbol.for("react.profiler")||e.type.$$typeof===Symbol.for("react.suspense"))return!1;let t=Pf(e);return!(/.*\/node_modules\//.test(t)||n===t||/^(?!.*src).*$/.test(t))}a(Ff,"isComponentAllowed");function hc(n,e={}){if(!n)return["",{}];let t=n.type,i=t?t.name||t:"Unknown",o="";if(Ff(i,n)){o+=`<${i}>`;let l=Pf(n);e[i]=l}if(n.child){let[l,c]=hc(n.child,e);o+=l,e={...e,...c}}if(Ff(i,n)&&(o+=`</${i}>`),n.sibling){let[l,c]=hc(n.sibling,e);o+=l,e={...e,...c}}return[o,e]}a(hc,"traverseReactTree");function Hf(n){let e=n._reactRootContainer?._internalRoot.current;return e||console.log("No react tree in element",n),hc(e)}a(Hf,"getReactTree");var Di=class n{static{a(this,"FrontendLogger")}static{this.original={}}static setPrefix(e){["log","warn","error"].forEach(t=>{n.original[t]||(n.original[t]=console[t]),console[t]=(...i)=>{i.unshift(e),n.original[t].apply(console,i)}})}};var Io=class{constructor(e=o=>o.map(l=>l.target),t={childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0},i={collectElement:!0}){this.filterElements=e;this.observeOptions=t;this.options=i;this.mutationEventListeners=[]}static{a(this,"MutationDetector")}addEventListener(e,t){this.mutationEventListeners.push({selector:e,listener:t})}startListening(){this.elements=[],this.observer=new MutationObserver(e=>{this.options.collectElement&&(this.elements=[...this.elements,...this.filterElements(e)]),this.mutationEventListeners.length&&e.forEach(t=>{t.addedNodes.forEach(i=>{if(i.nodeType!==Node.ELEMENT_NODE)return;let o=i;this.mutationEventListeners.forEach(l=>{o.matches(l.selector)?l.listener(o):o.querySelectorAll(l.selector).forEach(c=>{l.listener(c)})})})})}),this.observer.observe(document.body,this.observeOptions)}stopListening(){return this.observer.disconnect(),this.elements}};function Bf(n){let e=n.filter(i=>i.addedNodes.length>0).reduce((i,o)=>[...i,...o.addedNodes],[]),t=n.filter(i=>i.type==="attributes"&&i.attributeName==="style"&&i.target instanceof HTMLElement&&/display\s*:\s*none/.test(i.oldValue)&&Cs(i.target).visible).map(i=>i.target);return[...e,...t]}a(Bf,"poppingElementsFilter");var Vr;function Wf(n){Vr=!1;let e=Vf(n);return Vr?e:null}a(Wf,"getElementCaptionKey");var Vf=a(n=>{let e=a(l=>{if(!(l.tagName.toLowerCase()in xs))return l.tagName.toLowerCase();let c=xs[l.tagName.toLowerCase()].map(d=>`${d}:${l.getAttribute(d)}`).join(",");return c?(Vr=!0,`SVG:${c}`):l.tagName.toLowerCase()},"getSVGKey"),t=a(l=>{Vr=!0;let c=i(l);return`IMG:${l.src}`+(c!==l.tagName.toLowerCase()?`(${c})`:"")},"getIMGKey"),i=a(l=>{let c=window.getComputedStyle(l).backgroundImage;if(c&&c!=="none"){let d=c.match(/url\("(.+)"\)/);if(d)return Vr=!0,`BGIMG:${l.tagName.toLowerCase()+d[1]}`}for(let d of["::before","::after"]){let h=window.getComputedStyle(l,d).content.replace(/['"]/g,""),f=window.getComputedStyle(l,d).fontFamily;if(h!=="none"&&h!==""){Vr=!0;let p=h.charCodeAt(0).toString(16).padStart(4,"0");return`FONT:${l.tagName.toLowerCase()+f+p}`}}return l.tagName.toLowerCase()},"getElementKey");if(!n||n.nodeType===Node.TEXT_NODE||!n.tagName)return;let o=n instanceof SVGElement?e(n):n instanceof HTMLImageElement?t(n):i(n);if(n.childNodes.length>0){let l=Array.from(n.childNodes).map(Vf).filter(Boolean).join("+");l&&l.length>0&&(o+="("+l+")")}return o},"walk");function yT(n,e){let t=new Set;for(;n;)t.add(n),n=n.parentNode;for(;e;){if(t.has(e))return e;e=e.parentNode}return null}a(yT,"findCommonAncestor");function fc(n,e){let t=yT(n,e),i=0,o;if(!t)return 99999;for(o=n;o&&o!==t;)i++,o=o.parentNode;for(o=e;o&&o!==t;)i++,o=o.parentNode;return i}a(fc,"distanceBetweenNodes");var mc=class{constructor(){this.lastHighlights=[]}static{a(this,"ElementHighlighter")}clearHighlights(){this.lastHighlights.length&&(this.lastHighlights.forEach(e=>e.remove()),this.lastHighlights=[])}highlightElement(e,{highlightStyle:t={},textStyle:i={},mousePosition:o,text:l,textType:c="static",textPosition:d="overlap",textWidthType:h="rect",clear:f=!0,shouldFlipHighlightTextOutsideViewport:p=!0,pointerEvents:g,classNames:v=[]}={}){if(f&&this.clearHighlights(),!e)return;let b=e.ownerDocument,T=ol(e),S=e.getBoundingClientRect(),C=b.createElement("div");if(C.style.outline="2px dashed rgba(255,0,0,.75)",C.style.position=T?"fixed":"absolute",C.style.left=S.left+"px",C.style.top=S.top+"px",C.style.width=S.right-S.left+"px",C.style.height=S.bottom-S.top+"px",C.style.pointerEvents=g??"none",C.style.zIndex="2147483647",C.className=["checksum-dom-cache-ignore",...v].join(" "),this.mergeStyle(C,t),o){let R=b.createElement("div");if(R.style.position="absolute",R.style.left=+o.x-16+"px",R.style.top=+o.y-16+"px",R.style.color="#004DFF",R.className=["checksum-dom-cache-ignore","mouse-cross",...v].join(" "),R.style.zIndex="2147483648",!b.head.querySelector("style[role=mouse-location]")){var x=b.head.appendChild(b.createElement("style"));x.setAttribute("role","mouse-location"),x.innerHTML=".mouse-cross:before, .mouse-cross:after {position: absolute;left: 15px;content: ' ';height: 33px;width: 3px;background-color: #004DFF;}.mouse-cross:before {transform: rotate(0deg);}.mouse-cross:after {transform: rotate(-90deg);}"}b.body.appendChild(R),this.lastHighlights.push(R)}let _=b.createElement("div");l&&(_.className=["checksum-dom-cache-ignore",...v].join(" "),_.innerText=l,_.style.fontSize="12px",_.style.width=h==="rect"?`${S.width}px`:"auto",_.style.background="#000000a1",_.style.color="white",_.style.padding="5px",_.style.position="absolute",_.style.pointerEvents="none",_.style.userSelect="none",d==="above"?_.style.bottom=`${S.height}px`:d==="below"&&(_.style.top=`${S.height}px`),this.mergeStyle(_,i),C.appendChild(_),C.style.pointerEvents=g??"none",c==="hover"&&(_.style.display="none",C.addEventListener("mouseover",()=>{_.style.display="block"}),C.addEventListener("mouseout",()=>{_.style.display="none"}))),b.body.appendChild(C),d==="above"&&al(_)>0?(_.style.bottom="initial",_.style.top=`${S.height}px`):d==="below"&&ll(_)>0&&(_.style.top="initial",_.style.bottom=`${S.height}px`),this.lastHighlights.push(C),p&&this.flipHighlightTextPositionOutsideViewport(_,d,S.height)}mergeStyle(e,t){for(let i in t)e.style[i]=t[i]}flipHighlightTextPositionOutsideViewport(e,t,i){t==="above"&&al(e)>0?(e.style.bottom="initial",e.style.top=`${i}px`):t==="below"&&ll(e)>0&&(e.style.top="initial",e.style.bottom=`${i}px`)}},Ln=new mc;var Co=class{constructor(e,t){this.rawDbName=e;this.storeName=t;this.db=null}static{a(this,"IndexedDBClient")}getDBName(){if(!this._dbName){if(!window.name){let e=window.sessionStorage.getItem("nextTabIndex")??"0";window.name=e,window.sessionStorage.setItem("nextTabIndex",`${parseInt(e)+1}`)}this._dbName=`${this.rawDbName}-${window.name}`}return this._dbName}open(e=1){return new Promise((t,i)=>{let o=indexedDB.open(this.getDBName(),e);o.onupgradeneeded=l=>{this.db=o.result,this.db.objectStoreNames.contains(this.storeName)||this.db.createObjectStore(this.storeName)},o.onsuccess=l=>{this.db=o.result,t(this.db)},o.onerror=l=>{console.log("IndexedDBClient.open() error",l,o.error),i(o.error)}})}count(){return new Promise((e,t)=>{if(!this.db){t("Database has not been initialized");return}let l=this.db.transaction([this.storeName]).objectStore(this.storeName).count();l.onsuccess=()=>e(l.result),l.onerror=()=>t(l.error)})}set(e,t){return new Promise((i,o)=>{if(!this.db){o("Database has not been initialized");return}let d=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).add(e,t);d.onsuccess=()=>i(),d.onerror=()=>o(d.error)})}get(e,t,i){return new Promise((o,l)=>{if(!this.db){l("Database has not been initialized");return}let d=this.db.transaction([this.storeName]).objectStore(this.storeName),h=e?d.getAll(t,i):d.get(t);h.onsuccess=()=>o(h.result),h.onerror=()=>l(h.error)})}getOne(e){return this.get(!1,e)}getAll(e,t){return this.get(!0,e,t)}};var pc=class{constructor(){this.initialized=!1;this.rrwebEventsLoaded=!1;this.loadRRwebEvents=[];this.rrwebCrossFrameEventIdCounter=0}static{a(this,"RrwebEventsStorageManager")}async initRRwebEvents(){if(this.initialized){console.warn("[RrwebEventsStorageManager] initRRwebEvents called more than once");return}this.initialized=!0,this.rrwebEventsIndexedDB=new Co("checksum","rrwebEvents");try{await this.rrwebEventsIndexedDB.open()}catch{return}this.rrwebCrossFrameEventIdCounter=await this.rrwebEventsIndexedDB.count(),this.loadRRwebEvents.forEach(e=>{this.rrwebEventsIndexedDB.set(e,this.rrwebCrossFrameEventIdCounter++)}),this.rrwebEventsLoaded=!0}onRRwebEvent(e){this.rrwebEventsLoaded?this.rrwebEventsIndexedDB.set(e,this.rrwebCrossFrameEventIdCounter++):this.loadRRwebEvents.push(e)}isInitialized(){return this.initialized}getLastRRwebEventKey(){return this.rrwebCrossFrameEventIdCounter-1}async postRRwebEvents(e){if(!this.rrwebEventsLoaded)return[];let t=await this.rrwebEventsIndexedDB.getAll();return fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async getRRwebEvents(e){return this.rrwebEventsLoaded?await this.rrwebEventsIndexedDB.getAll(IDBKeyRange.lowerBound(e)):[]}async getRRwebEvent(e){return this.rrwebEventsLoaded?this.rrwebEventsIndexedDB.getOne(e):null}},Dn=new pc;function $f(n=5,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"){let t="";for(let i=n;i>0;--i)t+=e[Math.floor(Math.random()*e.length)];return t}a($f,"randomString");function Ro(n,e){return typeof n!="string"?Uf(n):`${JSON.stringify(n)}${e?"s":"i"}`}a(Ro,"escapeForTextSelector");function gc(n,e=!1){return typeof n!="string"?Uf(n):`"${n.replace(/\\/g,"\\\\").replace(/["]/g,'\\"')}"${e?"s":"i"}`}a(gc,"escapeForAttributeSelector");function Uf(n){return n.unicode||n.unicodeSets?String(n):String(n).replace(/(^|[^\\])(\\\\)*(["'`])/g,"$1$2\\$3").replace(/>>/g,"\\>\\>")}a(Uf,"escapeRegexForSelector");var vT=10,Ur=vT/2;var ET=100,ST=120,bT=140,wT=160,TT=180,MT=200;var R1=ET+Ur,A1=ST+Ur,_1=bT+Ur,N1=wT+Ur,L1=TT+Ur,D1=MT+Ur;function $r(n){let e={full:"",immediate:[]};if(!xT(n)){let t="";if(n instanceof HTMLInputElement&&(n.type==="submit"||n.type==="button"))e={full:n.value,immediate:[n.value]};else{for(let i=n.firstChild;i;i=i.nextSibling)i.nodeType===Node.TEXT_NODE?(e.full+=i.nodeValue||"",t+=i.nodeValue||""):(t&&e.immediate.push(t),t="",i.nodeType===Node.ELEMENT_NODE&&(e.full+=$r(i).full));t&&e.immediate.push(t),n.shadowRoot&&(e.full+=$r(n.shadowRoot).full)}}return e}a($r,"elementText");function Ao(n){return n.replace(/\u200b/g,"").trim().replace(/\s+/g," ")}a(Ao,"normalizeWhiteSpace");function xT(n){let e=n.ownerDocument;return n.nodeName==="SCRIPT"||n.nodeName==="NOSCRIPT"||n.nodeName==="STYLE"||e.head&&e.head.contains(n)}a(xT,"shouldSkipForTextMatching");var ir=class{constructor(e=document){this.rootNode=e;this.MAX_TESTING_SELECTORS=50;this.MAX_SINGLE_ELEMENT_SELECTORS=5;this.MAX_PROCESSING_TIME=15e3}static{a(this,"PlaywrightCustomLocatorGenerator")}testSelector(e,t){let i=this.getLocatorBase(t).locator(e);return i.elements.length!==1||t!==i.element?{valid:!1}:{valid:!0,selector:e,locator:this.getSelectorLocator(e,t)}}async generate(e,t=[],{isPartOfListItem:i=!1}={}){this.usedFilters={hasText:[],has:[]},this.targetElement=e,this.startTimestamp=Date.now();let o=[];for(t=t.filter(c=>Array.from(document.querySelectorAll(c.selector)).includes(c.element));e&&e!==this.rootNode;){let c=this.getAllLocators(e,t),d=[],h=a(f=>{try{let{elements:p}=this.getLocatorBase(e).locator(f);p.some(g=>g===this.targetElement)&&d.push({selector:f,locator:this.getSelectorLocator(f),elements:p.filter(g=>g instanceof HTMLElement)})}catch(p){console.log(p)}},"testSelector");if(o.length?c.forEach(f=>{o.forEach(p=>h(`${f} >> ${p.selector}`))}):c.forEach(f=>h(f)),d.length===0&&o.length===0){let f=e.tagName.toLowerCase();o.push({selector:f,locator:f,elements:window.playwright.locator(e.tagName.toLowerCase()).elements.filter(p=>p instanceof HTMLElement)})}if(o.push(...d),o.length>this.MAX_TESTING_SELECTORS||o.filter(f=>f.elements.length===1).length>this.MAX_SINGLE_ELEMENT_SELECTORS||this.checkTimeout(!1))break;e=e.parentElement}if(i){let c=this.filterListItemsSelectors(o);if(c?.length)return c.map(({selector:d,locator:h})=>({selector:d,locator:h,isListSelector:!0}))}let l=[];try{l=o.reduce((c,d)=>(this.checkTimeout(),c.push(...d.elements.length===1?[d]:this.reduceMultiCandidates(d)),c),[])}catch(c){c instanceof Nn&&console.log("Timeout error")}if(l?.length||console.log("no single element selector found"),this.rootNode===document){let{selector:c,locator:d}=await new et().getSelectorAndLocator(this.targetElement);l.unshift({selector:c,locator:d})}return l.map(({selector:c,locator:d})=>({selector:c,locator:d}))}filterListItemsSelectors(e){try{let t=zn(document.body,{nodeRepetitionsThreshold:10});if(!t?.length)throw new Error("No templates found in the page");return e.filter(i=>{if(i.elements.length<2)return!1;let o=new Gr().getSmallestCommonRoot(i.elements);return!(!t.some(l=>l.element===o)||Array.from(o.children).some(l=>{let c=l.querySelectorAll(i.selector).length,d=l.matches(i.selector)?1:0;return c+d>1}))})}catch(t){console.error("[filterListItemsSelectors] error",t.message)}}getElementWindowPlaywright(e){let t=e.ownerDocument.defaultView;return t!==window&&!t.playwright&&(t.playwright=window.playwright),t.playwright}getLocatorBase(e){let t=this.getElementWindowPlaywright(e);return this.rootNode===document?t:t.locator(t.selector(this.rootNode))}getSelectorLocator(e,t){return this.getElementWindowPlaywright(t??this.targetElement).asLocator("javascript",e)}reduceMultiCandidates(e){let{elements:t}=e,i=e.selector.split(" >> "),o=[],l=a(h=>{try{o.push({selector:h,locator:this.getSelectorLocator(h),elements:window.playwright.locator(h,e.options).elements.filter(f=>f instanceof HTMLElement),options:e.options})}catch(f){console.error(f)}},"addCandidateWithSelector"),c=a(h=>e.selector+(i[i.length-1]===this.targetElement.tagName.toLowerCase()?h:` >> internal:and=${IT(this.targetElement.tagName.toLowerCase()+h)}`),"addCSSFilterToLocator");if(t.length<5){let h=t.indexOf(this.targetElement);h!==-1&&l(e.selector+` >> nth=${h}`)}let d=this.targetElement.parentElement;if(t.every(h=>h.parentElement===d&&h.tagName===this.targetElement.tagName)){let h=Array.from(d.children).indexOf(this.targetElement);h!==-1&&l(c(`:nth-child(${h+1})`))}return Array.from(this.targetElement.classList).forEach(h=>{let f=c(`.${this.escapeSelector(h)}`);try{this.getLocatorBase(this.targetElement).locator(f,e.options).elements.length===1&&l(f)}catch(p){console.error(p)}}),Array.from(this.targetElement.attributes).filter(h=>!["class","style","id","href","src"].includes(h.name)).forEach(h=>{let f=c(`[${h.name}`+(h.value?`="${h.value}"]`:"]"));try{this.getLocatorBase(this.targetElement).locator(f,e.options).elements.length===1&&l(f)}catch(p){console.error(p)}}),o}getAllLocators(e,t,i={returnSelector:!1,exact:!0}){return[this.getByRoleLocator(e,i),this.getByTextLocator(e,i),this.getByLabelLocator(e,i),this.getByPlaceholderLocator(e,i),this.getByTitleLocator(e,i),this.getByAltLocator(e,i),this.getTestIdLocator(e,i),...t.filter(o=>o.element===e).map(o=>o.selector)].filter(o=>o)}getByRoleLocator(e,t={}){try{if(!(e instanceof HTMLElement))throw new Error("Provided element is not an HTMLElement");let i={button:"button",input:a(p=>p.type==="checkbox"?"checkbox":p.type==="radio"?"radio":"textbox","input"),select:"listbox",a:"link",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",li:"listitem",option:"option",textarea:"textbox",table:"table",tr:"row",th:"columnheader",td:"cell"},o=e.tagName.toLowerCase(),l=e.getAttribute("role")||(i[o]instanceof Function?i[o](e):i[o]);if(!l)return;let c=[];if(l==="heading"&&!e.hasAttribute("aria-level")){let p=parseInt(o.charAt(1),10);c.push(["level",String(p)])}(l==="checkbox"||l==="radio")&&c.push(["checked",String(e.getAttribute("aria-checked")??e.getAttribute("checked")??"false")]);let d=e.getAttribute("aria-label")||e.getAttribute("aria-labelledby")||Ao($r(e).full),{text:h,exact:f}=this.limitTextLength(this.normalize(d),t.exact);return h&&h.length>0&&h.length<30&&c.push(["name",gc(h,f)]),t.returnSelector?`getByRole('${l}', { ${c.join(", ")} })`:`internal:role=${l}${c.map(([p,g])=>`[${p}=${g}]`).join("")}`}catch{}}getByTextLocator(e,t={}){try{if(!(e instanceof HTMLElement))return;let i=Ao($r(e).full);if(!i?.length||i.length>100)return;if(Array.from(e.children).filter(l=>l instanceof HTMLElement).some(l=>Ao($r(l).full)===i))return this.usedFilters.hasText.includes(i)?void 0:(this.usedFilters.hasText.push(i),`${e.tagName.toLowerCase()} >> internal:has-text=${Ro(i,!0)}`);let o=Ro(i,t.exact);return t.returnSelector?`getByText('${o}')`:"internal:text="+o}catch{}}getByLabelLocator(e,t={}){try{if(!(e instanceof HTMLElement)||!["input","textarea","select"].includes(e.tagName.toLowerCase()))return;let i=a(d=>t.returnSelector?`getByLabel('${d}')`:`internal:label=${Ro(d,t.exact)}`,"respond"),o=e.getAttribute("aria-label");if(o)return i(o);let l=e.getAttribute("aria-labelledby");if(l){let d=document.getElementById(l);if(d){let h=d.innerText.trim();if(h)return i(h)}}let c=e.getAttribute("id");if(c){let d=document.querySelector(`label[for="${c}"]`);if(d){let h=d.innerText.trim();if(h)return i(h)}}}catch{}}getByPlaceholderLocator(e,t={}){if(["input","textarea"].includes(e.tagName?.toLowerCase()))return this.getByAttributeLocator(e,"placeholder",t)}getByTitleLocator(e,t={}){return this.getByAttributeLocator(e,"title",t)}getByAltLocator(e,t={}){return this.getByAttributeLocator(e,"alt",t)}getTestIdLocator(e,t={}){for(let i of["data-testid","data-test-id","data-test"])if(e.getAttribute(i))return this.getByAttributeLocator(e,i,t)}getByAttributeLocator(e,t,i={}){try{if(!(e instanceof HTMLElement))return;let o=e.getAttribute(t);if(o)return i.returnSelector?`getBy${t.charAt(0).toUpperCase()+t.slice(1)}('${o}')`:`internal:attr=[${t}=${gc(o,i.exact)}]`}catch{}}escapeSelector(e){return e.trim().replace(/([!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1")}normalize(e){return e.replace(/\n/g,"").replace(/[ \t]+/g," ").trim()}limitTextLength(e,t=!0,i=30){for(;e?.length>30&&e.length<100&&e.includes(" ");)e=e.split(" ").slice(0,-1).join(" "),t=!1;return{text:e,exact:t}}checkTimeout(e=!0){if(this.MAX_PROCESSING_TIME&&Date.now()-this.startTimestamp>this.MAX_PROCESSING_TIME){if(e)throw new Nn;return!0}}};function IT(n,e=!1){return`"${n.replace(/\\/g,"\\\\").replace(/["]/g,'\\"')}"`}a(IT,"escapeForAndLocator");var Gr=class{constructor(e){this.htmlReducer=e;this.BASE_MAX_COMPONENTS_FOR_SELECTOR_COMBINATION=13;this.MAX_SELECTORS_PER_CONTEXT_ELEMENT=10;this.innerFeaturesExtractor=new qn;this.innerTextExtractor=new Mr}static{a(this,"CompoundSelector")}async generate(e){let t=e.filter(l=>l.isTarget)[0];if(e=e.map(l=>(l.element=this.htmlReducer.getElementForChecksumId(l.selection.checksumid),l)).filter(l=>!!l.element&&!e.find(c=>c.element===l.element||c.element.contains(l.element))),e.filter(l=>l.element)?.length<2)throw new Error("Not enough elements found for the given checksum ids");if(!t?.element)throw new Error("Target element not found");let i=this.getSmallestCommonRoot(e.map(l=>l.element));if(!i)throw new Error("No common root found for the given elements");return this.extractFeaturesMetadata(e),{id:$f(5),targetSelection:{xpath:this.getRelativeXPath(i,t.element),cssSelectors:this.generateAllContextualSelectors(i,t.element).filter(l=>l&&l.trim().length>0),playwrightSelectors:await new ir(i).generate(t.element),featuresMetadata:t.featuresMetadata},contextElements:e}}async select(e){let{contextElements:t}=e;t.forEach(o=>this.getSelectorCandidatesForContextElement(o));let i=dl(t.map(o=>o.candidatesSelectors.map((l,c)=>c)));for(let o of i){t.forEach((c,d)=>c.selector=c.candidatesSelectors[o[d]]);let l=this.getSmallestCommonParents(t).map(this.calculateElementSize).sort((c,d)=>c.size-d.size).map(c=>c.element);for(let c of l){let d=this.generateTargetSelectotionHistogram(c,e.targetSelection);if(d.size>0)return(await new et().getSelectorAndLocator(d.entries().next().value[0])).selector}}}generateTargetSelectotionHistogram(e,t){let i=new Map,o=a(l=>{l.filter(c=>c instanceof HTMLElement).forEach(c=>{i.set(c,(i.get(c)||0)+1)})},"addElementstoHistogram");if(t.xpath)try{o(this.findElementsByXPath(e,t.xpath))}catch{}return t.cssSelectors.forEach(l=>{try{o(Array.from(e.querySelectorAll(l)))}catch{}}),new Map([...i.entries()].sort((l,c)=>c[1]-l[1]))}calculateElementSize(e){let t=e.getBoundingClientRect();return{element:e,size:t.width*t.height}}buildSelectorForContextElement(e,{useTag:t=!0,useInnerFeatures:i=!0,useClasses:o=!0,useAttributes:l=!0}){let c=t?e.featuresMetadata.tag:"";o&&e.featuresMetadata.classes.length&&(c+="."+e.featuresMetadata.classes.map(d=>d.trim().replace(/([!\"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1")).join(".")),l&&(c+=Object.entries(e.featuresMetadata.attributes).map(([d,h])=>`[${d}="${h}"]`).join("")),i&&(c+=e.featuresMetadata.innerFeatures.filter(d=>!d.isRoot).map(d=>`:has(${_s(d)})`).join("")),e.selector=c}getSelectorCandidatesForContextElement(e){let t=this.buildSelectorsCombination(e.featuresMetadata);e.candidatesSelectors=[];for(let i=0;i<t.length&&e.candidatesSelectors.length<this.MAX_SELECTORS_PER_CONTEXT_ELEMENT;i++)document.querySelector(t[i])&&e.candidatesSelectors.push(t[i])}buildSelectorsCombination(e){let t=this.BASE_MAX_COMPONENTS_FOR_SELECTOR_COMBINATION,i=a(v=>{let b=[[]];for(let T=0;T<v.length;T++){let S=b.length;for(let C=0;C<S;C++)b.push(b[C].concat(v[T]))}return b},"getCombinations"),o=a(v=>v.trim().replace(/([!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1"),"escapeSelector"),l=e.tag,c=e.innerFeatures.filter(v=>!v.isRoot).map(v=>`:has(${_s(v)})`).slice(0,4),d=e.classes.map(v=>`.${o(v)}`),h=Object.entries(e.attributes).map(([v,b])=>`[${v}="${o(b)}"]`),f=a(()=>c.length+1+d.length+h.length>t,"exceedsMaxLength");for(;f()&&(d.pop(),!!f());)h.pop();let p=i([...d,...h,...c]),g=p.map(v=>[l,...v]);return p.push(...g),p.map(v=>v.join("")).filter(v=>v).sort((v,b)=>b.length-v.length)}extractFeaturesMetadata(e){e.forEach(t=>{t.featuresMetadata={id:t.element.getAttribute("id")??void 0,tag:t.element.tagName.toLowerCase(),innerText:this.innerTextExtractor.extract(t.element),innerFeatures:this.innerFeaturesExtractor.extract(t.element),classes:t.element.className?.trim().split(/\s+/)||[],attributes:Array.from(t.element.attributes).reduce((i,o)=>(["class","style","id"].includes(o.name)||(i[o.name]=o.value),i),{})}})}generateAllContextualSelectors(e,t){let i=[],o=[!0,!1];for(let l of o)for(let c of o)for(let d of o)i.push({useId:l,useClasses:c,useTag:d});return i.map(l=>this.createContextualSelector(e,t,l)).filter(l=>{let c=e.querySelectorAll(l);return c.length===1&&c[0]===t})}getRelativeXPath(e,t){try{let i=function(c){let d=c.nodeName.toLowerCase(),h=!1;if(["name","label","aria-label","data-testid","role"].forEach(f=>{c.hasAttribute(f)&&(d+=`[@${f}="${c.getAttribute(f)}"]`,h=!0)}),!h){let f=1,p=c.previousSibling;for(;p;)p.nodeType===Node.ELEMENT_NODE&&p.nodeName===c.nodeName&&f++,p=p.previousSibling;f>1&&(d+=`[${f}]`)}return d};if(a(i,"getNodeIdentifier"),!e||!t||!e.contains(t))throw new Error("Child is not a descendant of the given element.");let o=[],l=t;for(;l!==e;)l.nodeType===Node.ELEMENT_NODE&&o.unshift(i(l)),l=l.parentElement;return o.join("/")}catch(i){console.error("Failed to get relative xpath",i);return}}findElementsByXPath(e,t){return[new XPathEvaluator().evaluate(t,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue].filter(l=>l instanceof HTMLElement)}createContextualSelector(e,t,{useId:i=!1,useClasses:o=!0,useTag:l=!0}){if(!e||!t)return null;let c=a(f=>{if(i&&f.id)return`#${f.id}`;let p=l?f.tagName.toLowerCase():"";return o&&f.className&&(p+="."+f.className.trim().split(/\s+/).join(".")),["name","label","aria-label","data-testid","role"].forEach(g=>{f.hasAttribute(g)&&(p+=`[${g}="${f.getAttribute(g)}"]`)}),p.trim()},"getSelectorPart"),d=[],h=t;for(;h&&h!==e;)d.unshift(c(h)),h=h.parentElement;return h?d.join(" "):null}getSmallestCommonRoot(e){let t=a(o=>{let l=[];for(;o;)l.push(o),o=o.parentElement;return l},"getAncestors"),i=t(e[0]);for(let o=1;o<e.length;o++){let l=t(e[o]);i=i.filter(c=>l.includes(c))}return i.length>0?i[0]:null}getSmallestCommonParents(e){let t=e.map(d=>{try{let h=Array.from(document.querySelectorAll(d.selector));return d.selection.type==="content"?h.filter(f=>f.textContent===d.selection.value):h}catch{return[]}});if(t.some(d=>d.length===0))return[];let i=new Set,o=e.map(d=>d.selector),l=a((d,h=0)=>{if(h===o.length){let f=this.getSmallestCommonRoot(d);f&&i.add(f);return}t[h].forEach(f=>{l([...d,f],h+1)})},"combine");l([]);let c=Array.from(i);return c.filter(d=>!c.some(h=>d!==h&&d.contains(h)))}};var _o=class{constructor(){this.MAX_SNIPPET_SIZE=12e3;this.MAX_LIONTAIL_SIZE=6e3;this.MAX_ATTRIBUTE_SIZE=100}static{a(this,"ParentChainReducer")}async reduce(e,t={useLionTail:!0}){if(console.log("[ParentChainReducer] will reduce",e),!Je(e,"HTMLElement"))throw new Error("Element is not an HTMLElement");return{reducedHTML:this.getAncestorsHTMLSnippet(e,t)}}getElementForChecksumId(e){return this.elementsInSimplifiedDomByChecksumId[e]}getAncestorsHTMLSnippet(e,{useLionTail:t=!0}={}){this.elementsInSimplifiedDomByChecksumId={};let i=this.MAX_LIONTAIL_SIZE,o=this.MAX_ATTRIBUTE_SIZE,l=[],c=e;e.setAttribute("checksum-selected","true");try{for(;c;)l.push(c),c.parentNode&&c.parentNode instanceof ShadowRoot?c=c.parentNode.host:c=c.parentElement;l.reverse();let d=a(g=>{for(let v=g.attributes.length-1;v>=0;v--){let b=g.attributes[v];b.name.length+b.value.length>o&&g.removeAttribute(b.name)}return g},"normalizeNode"),h,f=new xr;do{h=l[0].cloneNode(!1);let g=h;for(let v=1;v<l.length;v++){if(t){let S=fi(l[v]).length;if(S<=i&&fi(h).length+S<=this.MAX_SNIPPET_SIZE){let C=this.deepCloneNode(l[v],f);g.appendChild(C);break}}let b=d(l[v].cloneNode(l[v]===e)),T=f.getAndIncrement();b.setAttribute("checksumid",T),this.elementsInSimplifiedDomByChecksumId[T]=l[v],g.appendChild(b),g=b}i=Math.max(i-10,0),o=Math.max(o-10,0)}while(h.outerHTML.length>this.MAX_SNIPPET_SIZE&&o>0);return h.querySelectorAll("*").forEach(g=>{}),fi(h)}catch(d){console.error("Error while getting ancestors HTML snippet",d)}finally{e.removeAttribute("checksum-selected")}}deepCloneNode(e,t){let i=e.cloneNode(!1),o=[e],l=[i];for(;o.length;){let c=o.shift(),d=l.shift();for(let h=0;h<c.childNodes.length;h++){let f=c.childNodes[h],p=f.cloneNode(!1);if(d.appendChild(p),Je(f,"HTMLElement")){let g=t.getAndIncrement();p.setAttribute("checksumid",g),this.elementsInSimplifiedDomByChecksumId[g]=f}o.push(f),l.push(p)}}return i}};var CT="$checksum",No=class{constructor(e={}){this.options={skipElementHighlighting:!1};this.testIdCounter=0;this.initialized=!1;Di.setPrefix(CT),this.elementSelector=new et,this.options={...this.options,...e},this.htmlReducer=new Ir,this.parentChainReducer=new _o,this.compoundSelector=new Gr(this.htmlReducer)}static{a(this,"ChecksumTestGenerator")}getCompoundSelector(){return this.compoundSelector}betterTemplatizr(e){return zn(e)}async buildCustomPlaywrightSelectors(e,t=[],i={isPartOfListItem:!1},o=document){typeof e=="string"&&(e=this.htmlReducer.getElementForChecksumId(e));let l=t.map(c=>({...c,element:this.parentChainReducer.getElementForChecksumId(c.checksumId)})).filter(({element:c})=>!!c);return await new ir(o).generate(e,l,i)}testElementSelector(e,t){return typeof t=="string"&&(t=this.htmlReducer.getElementForChecksumId(t)),new ir().testSelector(e,t)}async getParentChainHTML(e,t=!0){return typeof e=="string"&&(e=this.htmlReducer.getElementForChecksumId(e)),(await this.parentChainReducer.reduce(e,{useLionTail:t})).reducedHTML}init(e,t={},{sessionRecorder:i=!0}={},o={}){this.appSpecificRules=e,this.config=t,this.options={...this.options,...o},!this.initialized&&(this.initialized=!0,i&&(this.sessionMirror=new xo(l=>{Dn.onRRwebEvent(l)}),Dn.initRRwebEvents()),this.sessionMirror&&(this.sessionMirror.start(),this.htmlReducer.setSessionRecorder(this.sessionMirror)),rr.limitChildren=this.appSpecificRules?.esraSelectionRules?.limitChildren??[],rr.timeout=this.config.esraTimeout,this.config.logPrefix?.length&&Di.setPrefix(this.config.logPrefix))}getElementSelector(){return this.elementSelector}getLastSelectionLogs(){return this.currentESRASelector?this.currentESRASelector.getLastSelectionLogs():{}}getBestMatchingElementSimilarityScore(e){return this.currentESRASelector=new rr(e),this.currentESRASelector.selectOne().score}async extractESRAMetadata(e){return new ut(document).extract(e).toMetadata()}async select(e,t){return await this.elementSelector.selector(e,t)}async getSelectionDataForSelector(e,t){try{let i=await this.elementSelector.selector(e,t);if(!i)return console.warn("could not find element for selector: "+e),null;let{locator:o}=await this.elementSelector.getSelectorAndLocator(i,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),l=await this.extractESRAMetadata(i);return{generatedLocator:o,esraMetadata:l,selector:e,parentFramesSelectors:t}}catch(i){console.log("getMetadataForSelector exception",i);return}}async getMatchingElementSelectionData(e,{minSelectionScore:t,cachedSelector:i,staticMetadata:o}={minSelectionScore:.3},l=!1){try{let c,d,h;if(i&&(console.log("Trying to locate using cached selector",i),c=await this.elementSelector.selector(i)),!c){console.log("Trying to locate using ESRA",e),As(o)&&console.log("and static data",o),this.currentESRASelector=new rr(e,o);let p=this.currentESRASelector.selectOne({minSelectionScore:t});p.score>=t?(c=p.candidate,d=p.score,h=p.clickOffset):console.log("Best matching element was below threshold",p)}if(console.log(c?[`Located with score ${d}`,c]:"Element not located"),!c)return;l&&new Xt(c).scrollIntoView(),this.highlightElement(c);let f=await this.makeMatchingElementSelectionData(c,d);return h&&(f.clickOffset=h),f}catch(c){console.log("getMatchingElementSelectionData exception",c);return}}getAllInteractableElementsForLastSelectQuery(){let e=this.currentESRASelector.getFinalCandidates();return Promise.all(e.map(async t=>({esraMetadata:t.esraMetadata,selectionData:await this.makeMatchingElementSelectionData(t.candidate,t.score)})))}async getInteractableElementsRaw(){return Wt()}async getInteractableElements(){let e=Wt(),t=new ut(document);return Promise.all(e.map(async i=>{let o=t.extract(i).toMetadata(),l=await this.makeMatchingElementSelectionData(i);return{esraMetadata:o,selectionData:l}}))}getCurrentESRASelector(){return this.currentESRASelector}startFlashingElementsDetection(){return this.htmlReducer.startFlashingElementsDetection()}async postRRwebEvents(e){return Dn.postRRwebEvents(e)}async getRRwebEvents(e){return Dn.getRRwebEvents(e)}async reduceHTML(e={},t={},i=document){let o=await this.htmlReducer.reduce(i,{...this.appSpecificRules,...e},t),l=Dn.isInitialized()?Dn.getLastRRwebEventKey():void 0;if(l){let c=await Dn.getRRwebEvent(l);c&&(o.lastRRwebEvent={key:l,timestamp:c.timestamp})}if(t.extractESRAForInterpretationRequiredElements){console.log("Extracting ESRA for interpretation required elements...");let c=this.htmlReducer.getInteractableElementsInReducedHTML();o.elementsForNodeInterpretation=c.reduce((d,{checksumId:h,element:f})=>{if(!(f instanceof HTMLElement)||f.innerText?.trim().length)return d;let g=new ut(document).extract(f).toMetadata();return[...d,{checksumId:h,esraMetadata:g}]},[]),console.log("Done with ESRA extraction for interpretation required elements")}return o}getMoreItemsForTemplate(e,t={}){return this.htmlReducer.getMoreElementsFromTemplate(e,{...this.appSpecificRules,...t})}displayInterpretationForElements(e){this.clearHighlights(),this.htmlReducer.getInteractableElements().forEach(({checksumId:i,element:o})=>{let l=e[i];if(l){if(!o.isConnected){console.log(`Element ${i} is not connected to the DOM, skipping display`);return}this.highlightElement(o,{text:l,textType:"hover",clear:!1,textStyle:{width:"120px"}})}})}async overlayInteractableElementsWithChecksumId({reduceBeforeRender:e=!1,mode:t="full",textPosition:i=t==="tag"?"above":void 0,shouldFlipHighlightTextOutsideViewport:o=!0,scrollIntoView:l=!1,checksumId:c}={}){this.clearHighlights(),e&&await this.reduceHTML();let d=a((f,p,g)=>{if(!p.isConnected){console.log(`Element ${f} is not connected to the DOM, skipping display`);return}let{width:v,height:b}=p.getBoundingClientRect();if(v<=0||b<=0)return;function T(_){switch(t){case"tag":return{background:_,width:"initial",left:"-2px",border:`3px dashed ${_}`,"font-weight":"bold"};case"full":return{background:"black",height:"100%"}}}a(T,"getTextStyleByMode");function S(_){let R=["red","gold","green","steelBlue","orange","hotPink","darkViolet","brown"];return _?R[_%R.length]:"red"}a(S,"getColor");let C=S(g);function x(){switch(t){case"tag":return{outline:`3px dashed ${C}`};case"full":return{outline:"none"};case"selected":return{outline:"6px dashed red",opacity:"0.7"}}}a(x,"getHighlightStyle"),this.highlightElement(p,{text:f,clear:!1,highlightStyle:x(),...i?{textPosition:i}:{},textStyle:T(C),shouldFlipHighlightTextOutsideViewport:o})},"overlayElement");if(t==="selected"&&c){let f=await this.getElementForChecksumId(c);d(null,f,0);return}this.htmlReducer.getInteractableElementsInReducedHTML().filter(f=>!st(f.element,{...El,scrollIntoView:l}).isHidden).forEach(({checksumId:f,element:p},g)=>{d(f,p,g)})}async getElementForChecksumId(e){return this.htmlReducer.getElementForChecksumId(e)}async getSelectorForChecksumId(e){let t=await this.htmlReducer.getSelectorForChecksumId(e),{element:i,innerText:o,...l}=t;return l}hasInnerTextByChecksumId(e){return this.htmlReducer.hasInnerTextByChecksumId(e)}async getSelectorByPosition(e,t){let i=document.elementFromPoint(e,t),{selector:o,locator:l,parentFramesSelectors:c}=await this.elementSelector.getSelectorAndLocator(i);return{selector:o,locator:l,parentFramesSelectors:c}}isInput(e){let t=we(e);if(t.length)return["input","textarea"].includes(t[0].tagName.toLowerCase())}querySelectorExtended(e){return we(e)}getReactTree(e){return Hf(e)}isHidden(e,t){return st(e,t)}showGrid(){this.removeGrid();let e=document.createElement("style");e.id="checksum_grid_style",e.innerHTML=`
                  .checksum_grid {
                        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAJ1JREFUaEPtksEJgDAUxX73H1oRxAECkSrppacXaNI1M8f84Kz7Idf95XP0kM3yVWSzIFORikgG+lqSWIytCFYnDSsiicXYimB10rAikliMrQhWJw0rIonF2IpgddKwIpJYjK0IVicNKyKJxdiKYHXSsCKSWIytCFYnDSsiicXYimB10rAikliMrQhWJw0rIonF2IpgddLwKSLx38Oej8ZiASoSUGMAAAAASUVORK5CYII=");
                        background-repeat: repeat;
                        background-size: 20px;
                        background-position: 0px 0px;
                        position: absolute;
                        top: 0;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        height: 100%;
                        z-index: 1000;
                  }
`,document.body.prepend(e);let t=document.createElement("div");t.classList.add("checksum_grid"),document.body.prepend(t)}removeGrid(){let e=document.querySelector("#checksum_grid_style");e&&e.remove();let t=document.querySelector(".checksum_grid");t&&t.remove()}clearHighlights(){Ln.clearHighlights()}highlightElement(e,t={}){this.options.skipElementHighlighting||Ln.highlightElement(e,t)}async getInspectedElementSelectionResultByRRwebId(e,t={fromTimeMachine:!1}){let o=await(t.fromTimeMachine?window.checksum.timeMachine.sessionReplayer:this.sessionMirror).getNodeById(e);if(o)return await this.elementSelector.getSelectorAndLocator(o,{ignoredIframesSelectors:t.fromTimeMachine?[".replayer-wrapper > iframe"]:[]})}getNodeSelector(e){return new Cr().getSelector(e)}startListeningForHTMLChanges(){this.mutationDetector&&this.mutationDetector.stopListening(),this.mutationDetector=new Io(Bf),this.mutationDetector.startListening()}stopListeningForHTMLChanges(e){let t=this.mutationDetector.stopListening();switch(e){default:return t.map(i=>(i.innerText??i.textContent)?.trim())}}async recordScrollPosition(e){let t=await this.getElementForChecksumId(e);if(!t)return;let i=new Xt(t);i.getScrollableParentsPositions(),t._checksumScrollHelper=i}async restoreScrollPosition(e){let t=await this.getElementForChecksumId(e);!t||!("_checksumScrollHelper"in t)||(t._checksumScrollHelper.restore(),delete t._checksumScrollHelper)}async getElementCaptioningKeyForChecksumId(e){let t=this.htmlReducer.getElementForChecksumId(e);if(!t){console.warn(`Element with checksumId ${e} not found`);return}return Wf(t)}determineClosestNode(e,t,i){return fc(e,i)-fc(t,i)}addForceIncludeElement(e,t){this.htmlReducer.addForceIncludeElement({element:e,checksumid:t})}shouldCaptionElement(e,{recursive:t}={recursive:!0}){let i=this.htmlReducer.getElementForChecksumId(e);if(!i)return!1;let o=kf,l=a(f=>{let p=f.parentElement;if(!p||p.nodeType!==Node.ELEMENT_NODE)return!1;let{width:g,height:v}=p.getBoundingClientRect(),{width:b,height:T}=f.getBoundingClientRect();return Math.abs(g-b)<15&&Math.abs(v-T)<15},"shouldCheckParent"),c=!1,d=i,h=a(()=>(c?d=d?.parentElement:c=!0,d),"getNextParent");for(;;){let f=h();if(o.some(p=>f.getAttribute(p))||f.querySelectorAll("[checksuminteractable]").length>0||o.filter(p=>f.querySelectorAll(`[${p}]`)).length===1)return!1;if(!t||!l(f))break}return!0}async makeMatchingElementSelectionData(e,t,i){try{let o=this.setAndGetTestId(e),l=this.getVisibleParent(e),c=this.setAndGetTestId(l),d=this.getElementAtCenterOfElement(e),h=this.setAndGetTestId(d),f={element:o,visibleElement:c===o?void 0:c,atPointElement:h===o||h===c?void 0:h},p=await this.elementSelector.getSelectorAndLocator(e,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),g=await this.elementSelector.getSelectorAndLocator(d,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),v=await this.elementSelector.getSelectorAndLocator(l,{testIdSelector:this.appSpecificRules?.esraSelectionRules?.testIdSelector}),b={element:p?.selector,visibleElement:v?.selector,atPointElement:g?.selector},T={element:p?.parentFramesSelectors,visibleElement:v?.parentFramesSelectors,atPointElement:g?.parentFramesSelectors},S=a(O=>({tag:O.tagName.toLowerCase()}),"makeElementData"),C={element:S(e),visibleElement:f.visibleElement?S(l):void 0,atPointElement:f.atPointElement?S(d):void 0},x=a(async O=>O===e&&i?i:new ut(document).extract(O).toMetadata(),"makeESRAMetadata"),_={element:await x(e),visibleElement:f.visibleElement?await x(l):void 0,atPointElement:f.atPointElement?await x(d):void 0},R=p?.locator;return{testIds:f,selectors:b,parentFramesSelectors:T,elementData:C,score:t,esraMetadata:_,generatedLocator:R}}catch(o){return console.log("[makeMatchingElementSelectionData] exception",o),{testIds:{element:void 0},selectors:{element:void 0},parentFramesSelectors:{element:void 0},elementData:{element:void 0},esraMetadata:{element:void 0},generatedLocator:void 0}}}getElementAtCenterOfElement(e){let{x:t,y:i}=e.getBoundingClientRect(),o=e.ownerDocument.elementFromPoint(t,i);return o instanceof HTMLElement?o:void 0}setAndGetTestId(e){if(!e)return;let t=e.getAttribute("data-checksum-testid");if(t)return t;let i=(this.testIdCounter++).toString();return e.setAttribute("data-checksum-testid",i),i}getVisibleParent(e){return!(e instanceof HTMLElement)||e.offsetParent!==null?e:this.getVisibleParent(hn(e))}};var Lo=class{static{a(this,"GoalTracker")}constructor(){this.goals={}}async init(){}recordGoalFinished(e){console.log(`Goal reached: ${e}`),this.goals[e]||(this.goals[e]=0),this.goals[e]+=1,window.checksumai?.capture("goal_reached",{goalName:e})}getGoals(){return this.goals}};var Do=class extends Br{constructor(){super({enableInteract:!0});this.shouldHandleEvents=!0}static{a(this,"TimeMachine")}setEventHandlers(t,i=!0){this.shouldHandleEvents=i,super.setEventHandlers(t)}async handleEvents(t,i){console.log("starting handleEvents",i);try{for(let o of t)await this.eventProcessor.processEvent(o,this.shouldHandleEvents),await this.skipEvents([o])}catch(o){console.error(o)}console.log("done handleEvents",i)}setShouldHandleEvents(t){this.shouldHandleEvents=t}goBack(t,i={}){return t?this.sessionReplayer.goBack(t,i):this.goLive()}getElementByRRwebId(t){return this.sessionReplayer.getNodeById(t)}goLive(){return this.sessionReplayer.goLive()}};var Gf=di(po());var Oo=class{constructor(){this.esraExtractors=[];this.playwrightSelector=new et}static{a(this,"TimeMachineElementSelection")}async getSelector(e,{extractPlaywrightSelector:t=!0,extractEsraMetadata:i=!0}={}){if(!e)return null;console.log("[SessionDigesterSelector] generating for node",e);let o={};if(i)try{console.log("extracting ESRA metadata...");let l=this.getESRAExtractor(e).extract(e);o.esraMetadata=l.toMetadata(),console.log("ESRA metadata extraction complete")}catch(l){console.error("Failed to extract ESRA metadata",l)}if(t){console.log("extracting playwright selector...");let{selector:l,locator:c,parentFramesSelectors:d}=await this.playwrightSelector.getSelectorAndLocator(e);o.playwrightSelector=l,o.playwrightLocator=c,o.playwrightParentFramesSelectors=d,console.log("Playwright selector extraction complete")}return o}getESRAExtractor(e){let t=e.ownerDocument;if(!t)throw console.warn("Node does not have an owner document",e),new Error("Node does not have an owner document");let i=this.esraExtractors.find(l=>l.isSameDocument(t));if(i)return i;let o=new ut(t);return this.esraExtractors.push(o),o}};var ko=class n{static{a(this,"SequenceMatcher")}findSequence(e,t,i){for(let o=0;o<=e.length-t.length;o++){let l=this.findMatch(o,e,t,i);if(l!==null)return l}return null}findMatch(e,t,i,o){let l={},c=[];for(let d=0;d<i.length;d++){let h=t[e+d],f=i[d];if(!this.matchItem(f,h,l,o??h))return null;c.push(h)}return{items:c,token_values:l}}matchItem(e,t,i,o){if(Array.isArray(e)&&Array.isArray(t))return this.matchArray(e,t,i,o);if(typeof e=="object"&&e!==null&&typeof t=="object"&&t!==null){for(let l in e){let c=e[l],d=t[l];if(typeof c=="string"&&c.startsWith("$")){if(i[c]===void 0)i[c]={value:d,item:o};else if(i[c].value!==d)return!1}else if(typeof c=="object"&&c!==null){if(!this.matchItem(c,d,i,o))return!1}else if(c!==d)return!1}return!0}else return e===t}matchArray(e,t,i,o){for(let l=0;l<=t.length-e.length;l++){let c=t.slice(l,l+e.length),d=this.findSequence(c,e,o);if(d){for(let h in d.token_values)if(i[h]===void 0)i[h]={value:d.token_values[h].value,item:o};else if(i[h].value!==d.token_values[h].value)return!1;return!0}}return!1}runExample(){let e=[{x:"banana",id:"1gf3",class:"fruit",index:"3",details:{a:1,b:2,nested:{key:"value1"}},arr:[{a:3,b:2},{a:1,b:2}]},{y:"apple",id:"4gs2",class:"fruit",parentIndex:"3",index:"7",details:{a:1,b:2,nested:{key:"value1"}}}],t=[{class:"$1",index:"$2",details:{a:1,b:"$3",nested:{key:"$4"}},arr:[{a:1,b:"$5"}]},{class:"$1",parentIndex:"$2",details:{a:1,b:"$3",nested:{key:"$4"}}}],o=new n().findSequence(e,t);console.log(o)}};var Fo=class extends _n{constructor(){super();this.events=[];this.interactions=[];this.lastInteractionEventIndex=0;this.sequences=[];this.sequenceMatcher=new ko;this.inputFilter=void 0;this.clickFilter=void 0;this.releasePendingInputAction=a(()=>{clearTimeout(this.inputFilter.timeout),this.addInteraction(this.inputFilter.action),this.inputFilter=void 0},"releasePendingInputAction");this.releasePendingClickActions=a((t=!0)=>{clearTimeout(this.clickFilter.timeout),t&&this.clickFilter.actions.forEach(i=>this.addInteraction(i)),this.clickFilter=void 0},"releasePendingClickActions");this.dragAndDropSequence={events:[{type:G.IncrementalSnapshot,data:{source:$.MouseInteraction,type:ae.MouseDown}},{type:G.IncrementalSnapshot,data:{source:$.Mutation,adds:[{parentId:"$dropzoneId",node:{id:"$draggableId"}}],removes:[{id:"$draggableId"}]}}],handler:a(async({token_values:{$dropzoneId:t,$draggableId:i},items:o})=>{await this.sessionReplayer.goBack(i.item.timestamp);let l=i.value,c=await this.getNodeById(l);if(!c)return;let d=await this.elementSelector.getSelector(c);if(!d)return;await this.sessionReplayer.goBack(t.item.timestamp);let h=t.value,f=await this.getNodeById(h);if(!f)return;let p=await this.elementSelector.getSelector(f);if(p)return console.log("Drag and drop",d.playwrightLocator,p.playwrightLocator),[this.makePageAction("drag_and_drop",o[0],d,{dropTarget:{selector:p.playwrightSelector,locator:p.playwrightLocator,parentFramesSelectors:p.playwrightParentFramesSelectors,esraMetadata:p.esraMetadata}})]},"handler")};this.maxNumberOfGetNodeRetries=3;this.elementSelector=new Oo,this.buildSequences()}static{a(this,"VisualTestGenerationTimeMachineEventHandlers")}setSessionReplayer(t){this.sessionReplayer=t}getInteractions(t=0){return this.interactions.slice(t)}preEvent(t){this.inputFilter&&this.isActionEvent(t)&&!this.isConsecutiveInputEvent(t)&&this.releasePendingInputAction(),this.clickFilter&&this.isActionEvent(t)&&!this.isConsecutiveClickEvent(t)&&this.releasePendingClickActions(),this.events.push(t)}async postEvent(t,i){try{await this.performSequenceSearch()}catch(o){console.error("performSequenceSearch",o)}}async handleInput(t,i,o=!1){if(this.inputFilter){this.inputFilter.action.fillValue=t.text,this.inputFilter.timeout=this.setInputWaitTimeout();return}if(!t.userTriggered)return;let l=await this.getNodeById(t.id);if(!l)return;let c=await this.elementSelector.getSelector(l);if(!c)return;let d=this.makePageAction(this.getInputEventCode(l,t),i,c);if(d.eventCode==="input"){d.fillValue=t.text,this.inputFilter={action:d,nodeId:t.id,contenteditable:o,timeout:this.setInputWaitTimeout()};return}d.eventCode==="upload_files"&&(d.files=[],d.files.push(t.text)),this.addInteraction(d)}isConsecutiveInputEvent(t){return this.inputFilter?this.inputFilter.contenteditable?t.type===G.Custom&&t.data.tag==="contenteditable-input"&&t.data.payload.id===this.inputFilter.nodeId:t.type===G.IncrementalSnapshot&&t.data.source===$.Input&&t.data.id===this.inputFilter.nodeId&&!!t.data.userTriggered:!1}setInputWaitTimeout(){return this.inputFilter?.timeout&&clearTimeout(this.inputFilter.timeout),setTimeout(this.releasePendingInputAction,1e3)}handleContentEditableInput(t,i){this.handleInput({userTriggered:!0,id:t.id,text:t.text,isChecked:!1,source:$.Input},i,!0)}handleKeyStroke(t,i){}async handleClick(t,i){if(t.x===void 0||t.y===void 0)return;let o=await this.getNodeById(t.id);if(!o)return;let l=await this.elementSelector.getSelector(o);if(!l)return;let c=this.makePageAction("click",i,l);if(this.clickFilter){this.clickFilter.actions.push(c);return}this.clickFilter={actions:[c],nodeId:t.id,timeout:this.setClickWaitTimeout()}}isConsecutiveClickEvent(t){return this.clickFilter?t.type===G.IncrementalSnapshot&&t.data.source===$.MouseInteraction&&t.data.type===ae.Click&&t.data.id===this.clickFilter.nodeId:!1}setClickWaitTimeout(){return this.clickFilter?.timeout&&clearTimeout(this.clickFilter.timeout),setTimeout(this.releasePendingClickActions,600)}async handleDblClick(t,i){if(t.x===void 0||t.y===void 0)return;let o=await this.getNodeById(t.id);if(!o)return;let l=await this.elementSelector.getSelector(o);if(!l)return;let c=this.makePageAction("double_click",i,l);this.addInteraction(c),this.releasePendingClickActions(!1)}buildSequences(){this.sequences.push(this.dragAndDropSequence)}async performSequenceSearch(){let t=this.events.slice(this.lastInteractionEventIndex);for(let i of this.sequences){let o=this.sequenceMatcher.findSequence(t,i.events);if(o){let l=await i.handler(o);l&&l.forEach(c=>this.addInteraction(c))}}await this.sessionReplayer.goLive()}isActionEvent(t){switch(t.type){case G.Meta:return!1;case G.IncrementalSnapshot:switch(t.data.source){case $.Input:return t.data.userTriggered;case $.MouseInteraction:case $.MouseMove:return!0;default:return!1}case G.Custom:switch(t.data.tag){case"contenteditable-input":return!0;default:return!1}default:return!1}}addInteraction(t){this.interactions.push(t),this.lastInteractionEventIndex=this.events.length}makePageAction(t,i,o,l={}){return{nodeId:this.interactions.length.toString(),eventCode:t,selector:o.playwrightSelector,locator:o.playwrightLocator,parentFramesSelectors:o.playwrightParentFramesSelectors,esraMetadata:o.esraMetadata,pageId:void 0,timestamp:i.timestamp,...l}}async getNodeById(t,{retriesLeft:i=this.maxNumberOfGetNodeRetries,useCompoundInteractableDetection:o=!0}={}){if(!i)return console.error("no node"),null;let l=this.sessionReplayer.getNodeById(t);return l?o?jn(l,[]):l:(await(0,Gf.default)(100*(this.maxNumberOfGetNodeRetries-i+1)),this.getNodeById(t,{retriesLeft:i-1,useCompoundInteractableDetection:o}))}getInputEventCode(t,i){switch(t.getAttribute("type")){case"file":return"upload_files";case"checkbox":case"radio":return i.isChecked?"check":"uncheck";case"text":default:return"input"}}};var Po=class n{constructor(e=document,t,i){this.rootDocument=e;this.defaultView=t;this.topLevelInspector=i;this.wasHoveredElementSelected=!1;this.selected=[];this.singleSelection=!0;this.subDocumentInspector=null;this.listening=!1;this.onMouseOver=a(async e=>{let t=e.composedPath()[0];if("getRootNode"in t){let d=t.getRootNode();if(d!==this.rootDocument){this.handleSubDocument(d,this.defaultView);return}}if(t instanceof this.defaultView.HTMLIFrameElement){this.handleSubDocument(t.contentDocument,t.contentDocument.defaultView);return}if(this.subDocumentInspector&&this.stopSubDocumentInspector(!0),!(t instanceof this.defaultView.Element)||t===this.hoveredElement||t.matches(".element-inspector-ignore"))return;Ln.clearHighlights(),this.hoveredElement&&this.hoveredElement.removeEventListener("click",this.onClick,{capture:!0});let{locator:i,selector:o,parentFramesSelectors:l}=await this.playwrightElementSelectorGenerator.getSelectorAndLocator(t);Ln.highlightElement(t,{text:i.replace("frameLocator('iframe').",""),textPosition:"below",textWidthType:"auto",pointerEvents:"none",classNames:["element-inspector-ignore"]});let c=await this.playwrightElementSelectorGenerator.selector(o,l);c!==t&&Ln.highlightElement(c,{clear:!1,pointerEvents:"none",classNames:["element-inspector-ignore"]}),this.hoveredElement=t,this.hoveredElementSelection={locator:i,selector:o,parentFramesSelectors:l},this.wasHoveredElementSelected=!1,t.addEventListener("click",this.onClick,{capture:!0})},"onMouseOver");this.onClick=a(async e=>{e.stopPropagation(),e.preventDefault(),!this.wasHoveredElementSelected&&(this.wasHoveredElementSelected=!0,this.selected.push(this.hoveredElementSelection),this.singleSelection&&(this.topLevelInspector?this.topLevelInspector.stop():this.stop()),console.log("selected",this.selected))},"onClick");this.handleSubDocument=a((e,t)=>{if(this.subDocumentInspector){if(this.subDocumentInspector.rootDocument===e)return!0;this.stopSubDocumentInspector(!0)}return this.subDocumentInspector=new n(e,t,this.topLevelInspector??this),this.subDocumentInspector.start(this.singleSelection),!0},"handleSubDocument");this.stopSubDocumentInspector=a(e=>{this.subDocumentInspector&&(this.subDocumentInspector.stop(e),this.subDocumentInspector=null)},"stopSubDocumentInspector");this.playwrightElementSelectorGenerator=new et,t||(this.defaultView=this.rootDocument.nodeType===Node.DOCUMENT_NODE?this.rootDocument.defaultView:window)}static{a(this,"ElementInspector")}start(e=!0){this.singleSelection=e,this.stop(),this.cleanSelection(),this.rootDocument.addEventListener("mouseover",this.onMouseOver),this.listening=!0}stop(e=!1){this.listening&&(this.listening=!1,this.subDocumentInspector&&this.stopSubDocumentInspector(e),Ln.clearHighlights(),this.hoveredElement&&this.hoveredElement.removeEventListener("click",this.onClick,{capture:!0}),this.hoveredElement=null,this.wasHoveredElementSelected=!1,this.rootDocument.removeEventListener("mouseover",this.onMouseOver),e&&this.cleanSelection())}cleanSelection(){this.subDocumentInspector&&this.subDocumentInspector.cleanSelection(),this.selected=[]}consumeSelections(){if(this.subDocumentInspector)return this.subDocumentInspector.consumeSelections();let e=this.selected;return this.cleanSelection(),e}};var Ho=class{constructor(e){this.timeMachine=e;this.lengthOfConsumedInteractions=0;this.eventHandlers=new Fo}static{a(this,"VisualTestGenerator")}init(e=!0){this.timeMachine.setEventHandlers(this.eventHandlers,e)}consumeInteractions(){let e=this.eventHandlers.getInteractions(this.lengthOfConsumedInteractions);return this.lengthOfConsumedInteractions+=e.length,e}startInspector(e=!0,t){this.elementInspector=new Po(t??this.getRRwebReplayerDocument()),this.elementInspector.start(e)}getRRwebReplayerDocument(){return document.querySelector(".replayer-wrapper > iframe").contentDocument}stopInspector(){this.elementInspector.stop()}consumeSelections(){return this.elementInspector.consumeSelections()}};(function(){let n=Element.prototype.addEventListener;Element.prototype.addEventListener=function(e,t,i){n.call(this,e,t,i),this._checksum_eventListenerList||(this._checksum_eventListenerList={}),this._checksum_eventListenerList[e]||(this._checksum_eventListenerList[e]=[]),this._checksum_eventListenerList[e].push(t)}})();if(!window.checksum){let n=new No,e=new Eo,t=new Lo,i=new Do,o=new Ho(i);window.checksum={testGenerator:n,sessionDigester:e,goalTracker:t,timeMachine:i,visualTestGenerator:o}}})();
/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

rrweb/es/rrweb/ext/tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

rrweb/es/rrweb/_virtual/image-bitmap-data-url-worker.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

rrweb/es/rrweb/ext/@xstate/fsm/es/index.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
